---
title: Gestione degli errori parziali
description: Architettura di microservizi .NET per applicazioni .NET in contenitori | Gestione degli errori parziali
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 05/26/2017
ms.openlocfilehash: 957a0b1b8b4d217fac591db54e4ee053098bc7da
ms.sourcegitcommit: 979597cd8055534b63d2c6ee8322938a27d0c87b
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 06/29/2018
ms.locfileid: "37105195"
---
# <a name="handling-partial-failure"></a><span data-ttu-id="88161-103">Gestione degli errori parziali</span><span class="sxs-lookup"><span data-stu-id="88161-103">Handling partial failure</span></span>

<span data-ttu-id="88161-104">Nei sistemi distribuiti come le applicazioni basate su microservizi, esiste un onnipresente rischio di errore parziale.</span><span class="sxs-lookup"><span data-stu-id="88161-104">In distributed systems like microservices-based applications, there is an ever-present risk of partial failure.</span></span> <span data-ttu-id="88161-105">Ad esempio, può verificarsi un errore in un singolo microservizio/contenitore oppure questo potrebbe non essere disponibile per rispondere per un breve periodo di tempo oppure può verificarsi un arresto anomalo di una macchina virtuale o di un server.</span><span class="sxs-lookup"><span data-stu-id="88161-105">For instance, a single microservice/container can fail or might not be available to respond for a short time, or a single VM or server can crash.</span></span> <span data-ttu-id="88161-106">Poiché i client e i servizi sono processi separati, un servizio potrebbe non riuscire a rispondere tempestivamente a una richiesta del client.</span><span class="sxs-lookup"><span data-stu-id="88161-106">Since clients and services are separate processes, a service might not be able to respond in a timely way to a client’s request.</span></span> <span data-ttu-id="88161-107">Il servizio potrebbe essere sovraccarico e rispondere alle richieste con estrema lentezza oppure potrebbe semplicemente non essere accessibile per un breve periodo di tempo a causa di problemi di rete.</span><span class="sxs-lookup"><span data-stu-id="88161-107">The service might be overloaded and responding extremely slowly to requests, or might simply not be accessible for a short time because of network issues.</span></span>

<span data-ttu-id="88161-108">Si consideri ad esempio la pagina dei dettagli dell'ordine dell'applicazione di esempio eShopOnContainers.</span><span class="sxs-lookup"><span data-stu-id="88161-108">For example, consider the Order details page from the eShopOnContainers sample application.</span></span> <span data-ttu-id="88161-109">Se il microservizio degli ordini non risponde quando l'utente tenta di inviare un ordine, un'implementazione non corretta del processo client (l'applicazione Web MVC), se ad esempio il codice client usasse RPC sincrone senza timeout, bloccherebbe i thread a tempo indefinito in attesa di una risposta.</span><span class="sxs-lookup"><span data-stu-id="88161-109">If the ordering microservice is unresponsive when the user tries to submit an order, a bad implementation of the client process (the MVC web application)—for example, if the client code were to use synchronous RPCs with no timeout—would block threads indefinitely waiting for a response.</span></span> <span data-ttu-id="88161-110">Oltre a creare un'esperienza utente non corretta, ogni attesa senza risposta utilizza o blocca un thread e i thread sono estremamente preziosi nelle applicazioni a scalabilità elevata.</span><span class="sxs-lookup"><span data-stu-id="88161-110">In addition to creating a bad user experience, every unresponsive wait consumes or blocks a thread, and threads are extremely valuable in highly scalable applications.</span></span> <span data-ttu-id="88161-111">Se molti thread sono bloccati, il runtime dell'applicazione alla fine li esaurirà.</span><span class="sxs-lookup"><span data-stu-id="88161-111">If there are many blocked threads, eventually the application’s runtime can run out of threads.</span></span> <span data-ttu-id="88161-112">In questo caso, l'applicazione potrebbe non rispondere a livello globale anziché solo parzialmente, come mostrato nella figura 10-1.</span><span class="sxs-lookup"><span data-stu-id="88161-112">In that case, the application can become globally unresponsive instead of just partially unresponsive, as show in Figure 10-1.</span></span>

![](./media/image1.png)

<span data-ttu-id="88161-113">**Figura 10-1**.</span><span class="sxs-lookup"><span data-stu-id="88161-113">**Figure 10-1**.</span></span> <span data-ttu-id="88161-114">Errori parziali dovuti a dipendenze che influiscono sulla disponibilità dei thread del servizio</span><span class="sxs-lookup"><span data-stu-id="88161-114">Partial failures because of dependencies that impact service thread availability</span></span>

<span data-ttu-id="88161-115">In applicazioni basate su microservizi di grandi dimensioni, ogni errore parziale può risultare amplificato, in particolare se la maggior parte dell'interazione tra i microservizi interni è basata su chiamate HTTP sincrone (scenario definito come antipattern).</span><span class="sxs-lookup"><span data-stu-id="88161-115">In a large microservices-based application, any partial failure can be amplified, especially if most of the internal microservices interaction is based on synchronous HTTP calls (which is considered an anti-pattern).</span></span> <span data-ttu-id="88161-116">Si pensi a un sistema che riceve milioni di chiamate in ingresso al giorno.</span><span class="sxs-lookup"><span data-stu-id="88161-116">Think about a system that receives millions of incoming calls per day.</span></span> <span data-ttu-id="88161-117">Se il sistema presenta una progettazione scarsa basata su lunghe catene di chiamate HTTP sincrone, le chiamate in ingresso potrebbero generare molti milioni di chiamate in uscita, si supponga un rapporto di 1:4, a dozzine di microservizi interni come dipendenze sincrone.</span><span class="sxs-lookup"><span data-stu-id="88161-117">If your system has a bad design that is based on long chains of synchronous HTTP calls, these incoming calls might result in many more millions of outgoing calls (let’s suppose a ratio of 1:4) to dozens of internal microservices as synchronous dependencies.</span></span> <span data-ttu-id="88161-118">La situazione è mostrata nella figura 10-2, in particolare per la dipendenza \#3.</span><span class="sxs-lookup"><span data-stu-id="88161-118">This situation is shown in Figure 10-2, especially dependency \#3.</span></span>

![](./media/image2.png)

<span data-ttu-id="88161-119">**Figura 10-2**.</span><span class="sxs-lookup"><span data-stu-id="88161-119">**Figure 10-2**.</span></span> <span data-ttu-id="88161-120">L'impatto di una progettazione non corretta che prevede lunghe catene di richieste HTTP</span><span class="sxs-lookup"><span data-stu-id="88161-120">The impact of having an incorrect design featuring long chains of HTTP requests</span></span>

<span data-ttu-id="88161-121">L'errore intermittente è virtualmente garantito in un sistema distribuito basato sul cloud, anche se ogni dipendenza presenta una disponibilità eccellente.</span><span class="sxs-lookup"><span data-stu-id="88161-121">Intermittent failure is virtually guaranteed in a distributed and cloud based system, even if every dependency itself has excellent availability.</span></span> <span data-ttu-id="88161-122">Questo è un aspetto da prendere in considerazione.</span><span class="sxs-lookup"><span data-stu-id="88161-122">This should be a fact you need to consider.</span></span>

<span data-ttu-id="88161-123">Se non si progettano e implementano tecniche in grado di garantire la tolleranza di errore, anche brevi periodi di inattività possono risultare amplificati.</span><span class="sxs-lookup"><span data-stu-id="88161-123">If you do not design and implement techniques to ensure fault tolerance, even small downtimes can be amplified.</span></span> <span data-ttu-id="88161-124">Ad esempio, 50 dipendenze ognuna con una disponibilità del 99,99% genererebbero diverse ore di inattività al mese a causa dell'effetto domino.</span><span class="sxs-lookup"><span data-stu-id="88161-124">As an example, 50 dependencies each with 99.99% of availability would result in several hours of downtime each month because of this ripple effect.</span></span> <span data-ttu-id="88161-125">Quando si verifica un errore nella dipendenza di un microservizio durante la gestione di un volume elevato di richieste, l'errore può saturare velocemente tutti i thread delle richieste disponibili in ogni servizio e determinare un arresto anomalo dell'intera applicazione.</span><span class="sxs-lookup"><span data-stu-id="88161-125">When a microservice dependency fails while handling a high volume of requests, that failure can quickly saturate all available request threads in each service and crash the whole application.</span></span>

![](./media/image3.png)

<span data-ttu-id="88161-126">**Figura 10-3**.</span><span class="sxs-lookup"><span data-stu-id="88161-126">**Figure 10-3**.</span></span> <span data-ttu-id="88161-127">Errore parziale amplificato da microservizi con lunghe catene di chiamate HTTP sincrone</span><span class="sxs-lookup"><span data-stu-id="88161-127">Partial failure amplified by microservices with long chains of synchronous HTTP calls</span></span>

<span data-ttu-id="88161-128">Per ridurre al minimo l'impatto del problema, nella sezione "*L'integrazione di microservizi asincroni impone l'autonomia del microservizio*" del capitolo relativo all'architettura, si incoraggia l'uso della comunicazione asincrona tra i microservizi interni.</span><span class="sxs-lookup"><span data-stu-id="88161-128">To minimize this problem, in the section "*Asynchronous microservice integration enforce microservice’s autonomy*” (in the architecture chapter), we encouraged you to use asynchronous communication across the internal microservices.</span></span> <span data-ttu-id="88161-129">Verranno fornite ulteriori spiegazioni nella sezione successiva.</span><span class="sxs-lookup"><span data-stu-id="88161-129">We briefly explain more in the next section.</span></span>

<span data-ttu-id="88161-130">Inoltre, è essenziale progettare i microservizi e le applicazioni client per la gestione degli errori parziali, ovvero creare microservizi e applicazioni client resilienti.</span><span class="sxs-lookup"><span data-stu-id="88161-130">In addition, it is essential that you design your microservices and client applications to handle partial failures—that is, to build resilient microservices and client applications.</span></span>


>[!div class="step-by-step"]
<span data-ttu-id="88161-131">[Precedente](index.md)
[Successivo](partial-failure-strategies.md)</span><span class="sxs-lookup"><span data-stu-id="88161-131">[Previous](index.md)
[Next](partial-failure-strategies.md)</span></span>
