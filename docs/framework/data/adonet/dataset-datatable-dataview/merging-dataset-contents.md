---
title: Unione di contenuti di dataset
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-ado
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
ms.assetid: e5e9309a-3ebb-4a9c-9d78-21c4e2bafc5b
caps.latest.revision: "4"
author: JennieHubbard
ms.author: jhubbard
manager: jhubbard
ms.workload: dotnet
ms.openlocfilehash: 44d171cab4099436d7daea26def831f149b75b13
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/22/2017
---
# <a name="merging-dataset-contents"></a><span data-ttu-id="adc47-102">Unione di contenuti di dataset</span><span class="sxs-lookup"><span data-stu-id="adc47-102">Merging DataSet Contents</span></span>
<span data-ttu-id="adc47-103">È possibile usare il metodo <xref:System.Data.DataSet.Merge%2A> per unire il contenuto di un oggetto <xref:System.Data.DataSet>, <xref:System.Data.DataTable> o una matrice <xref:System.Data.DataRow> in un `DataSet` esistente.</span><span class="sxs-lookup"><span data-stu-id="adc47-103">You can use the <xref:System.Data.DataSet.Merge%2A> method to merge the contents of a <xref:System.Data.DataSet>, <xref:System.Data.DataTable>, or <xref:System.Data.DataRow> array into an existing `DataSet`.</span></span> <span data-ttu-id="adc47-104">L'unione di nuovi dati in un `DataSet` esistente è influenzata da diversi fattori e opzioni.</span><span class="sxs-lookup"><span data-stu-id="adc47-104">Several factors and options affect how new data is merged into an existing `DataSet`.</span></span>  
  
## <a name="primary-keys"></a><span data-ttu-id="adc47-105">Chiavi primarie</span><span class="sxs-lookup"><span data-stu-id="adc47-105">Primary Keys</span></span>  
 <span data-ttu-id="adc47-106">Se la tabella che riceve i nuovi dati e lo schema da un'operazione di unione dispone di una chiave primaria, le nuove righe dei dati in arrivo verranno associate alle righe esistenti i cui valori di chiave primaria <xref:System.Data.DataRowVersion.Original> corrispondono a quelli presenti nei dati in arrivo.</span><span class="sxs-lookup"><span data-stu-id="adc47-106">If the table receiving new data and schema from a merge has a primary key, new rows from the incoming data are matched with existing rows that have the same <xref:System.Data.DataRowVersion.Original> primary key values as those in the incoming data.</span></span> <span data-ttu-id="adc47-107">Se le colonne dello schema in arrivo corrispondono alle colonne dello schema esistente, i dati delle righe esistenti verranno modificati.</span><span class="sxs-lookup"><span data-stu-id="adc47-107">If the columns from the incoming schema match those of the existing schema, the data in the existing rows is modified.</span></span> <span data-ttu-id="adc47-108">Le colonne che non corrispondono allo schema esistente verranno ignorate o aggiunte in base al parametro <xref:System.Data.Common.DataAdapter.MissingSchemaAction%2A>.</span><span class="sxs-lookup"><span data-stu-id="adc47-108">Columns that do not match the existing schema are either ignored or added based on the <xref:System.Data.Common.DataAdapter.MissingSchemaAction%2A> parameter.</span></span> <span data-ttu-id="adc47-109">Le nuove righe contenenti valori di chiave primaria non corrispondenti a nessuna delle righe esistenti verranno aggiunte alla tabella esistente.</span><span class="sxs-lookup"><span data-stu-id="adc47-109">New rows with primary key values that do not match any existing rows are appended to the existing table.</span></span>  
  
 <span data-ttu-id="adc47-110">Se alle righe in arrivo o esistenti è associato uno stato di riga <xref:System.Data.DataRowState.Added>, i relativi valori di chiave primaria verranno associati tramite il valore di chiave primaria <xref:System.Data.DataRowVersion.Current> della riga `Added`, poiché non è presente nessuna versione di riga `Original`.</span><span class="sxs-lookup"><span data-stu-id="adc47-110">If incoming or existing rows have a row state of <xref:System.Data.DataRowState.Added>, their primary key values are matched using the <xref:System.Data.DataRowVersion.Current> primary key value of the `Added` row because no `Original` row version exists.</span></span>  
  
 <span data-ttu-id="adc47-111">Se in una tabella in arrivo e una tabella esistente è contenuta una colonna con lo stesso nome ma con tipi di dati diversi, verranno generati un'eccezione e l'evento <xref:System.Data.DataSet.MergeFailed> del `DataSet`.</span><span class="sxs-lookup"><span data-stu-id="adc47-111">If an incoming table and an existing table contain a column with the same name but different data types, an exception is thrown and the <xref:System.Data.DataSet.MergeFailed> event of the `DataSet` is raised.</span></span> <span data-ttu-id="adc47-112">Se nella tabella in arrivo e nella tabella esistente sono state definite chiavi, ma le chiavi primarie sono relative a colonne diverse, verranno generati un'eccezione e l'evento `MergeFailed` del `DataSet`.</span><span class="sxs-lookup"><span data-stu-id="adc47-112">If an incoming table and an existing table both have defined keys, but the primary keys are for different columns, an exception is thrown and the `MergeFailed` event of the `DataSet` is raised.</span></span>  
  
 <span data-ttu-id="adc47-113">Se la tabella che riceve i nuovi dati da un'operazione di unione non dispone di alcuna chiave primaria, non sarà possibile associare i nuovi valori relativi ai dati in arrivo alle righe esistenti della tabella. Tali valori verranno quindi aggiunti alla tabella esistente.</span><span class="sxs-lookup"><span data-stu-id="adc47-113">If the table receiving new data from a merge does not have a primary key, new rows from the incoming data cannot be matched to existing rows in the table and are instead appended to the existing table.</span></span>  
  
## <a name="table-names-and-namespaces"></a><span data-ttu-id="adc47-114">Nomi di tabella e spazi dei nomi</span><span class="sxs-lookup"><span data-stu-id="adc47-114">Table Names and Namespaces</span></span>  
 <span data-ttu-id="adc47-115">Se necessario, agli oggetti <xref:System.Data.DataTable> è possibile assegnare un valore della proprietà <xref:System.Data.DataTable.Namespace%2A>.</span><span class="sxs-lookup"><span data-stu-id="adc47-115"><xref:System.Data.DataTable> objects can optionally be assigned a <xref:System.Data.DataTable.Namespace%2A> property value.</span></span> <span data-ttu-id="adc47-116">Quando vengono assegnati i valori di <xref:System.Data.DataTable.Namespace%2A>, un oggetto <xref:System.Data.DataSet> può contenere più oggetti <xref:System.Data.DataTable> con lo stesso valore <xref:System.Data.DataTable.TableName%2A>.</span><span class="sxs-lookup"><span data-stu-id="adc47-116">When <xref:System.Data.DataTable.Namespace%2A> values are assigned, a <xref:System.Data.DataSet> can contain multiple <xref:System.Data.DataTable> objects with the same <xref:System.Data.DataTable.TableName%2A> value.</span></span> <span data-ttu-id="adc47-117">Durante le operazioni di unione vengono usati <xref:System.Data.DataTable.TableName%2A> e <xref:System.Data.DataTable.Namespace%2A> per identificare la destinazione di un'unione.</span><span class="sxs-lookup"><span data-stu-id="adc47-117">During merge operations, both <xref:System.Data.DataTable.TableName%2A> and <xref:System.Data.DataTable.Namespace%2A> are used to identify the target of a merge.</span></span> <span data-ttu-id="adc47-118">Se è stato assegnato <xref:System.Data.DataTable.Namespace%2A>, per identificare la destinazione di un'unione viene usato <xref:System.Data.DataTable.TableName%2A>.</span><span class="sxs-lookup"><span data-stu-id="adc47-118">If no <xref:System.Data.DataTable.Namespace%2A> has been assigned, only the <xref:System.Data.DataTable.TableName%2A> is used to identify the target of a merge.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="adc47-119">Questo comportamento è stato modificato in .NET Framework versione 2.0.</span><span class="sxs-lookup"><span data-stu-id="adc47-119">This behavior changed in version 2.0 of the .NET Framework.</span></span> <span data-ttu-id="adc47-120">Nella versione 1.1 gli spazi dei nomi sono supportati ma vengono ignorati durante le operazioni di unione.</span><span class="sxs-lookup"><span data-stu-id="adc47-120">In version 1.1, namespaces were supported but were ignored during merge operations.</span></span> <span data-ttu-id="adc47-121">Per questo motivo il comportamento di un oggetto <xref:System.Data.DataSet> che usa i valori della proprietà <xref:System.Data.DataTable.Namespace%2A> a seconda della versione di .NET Framework in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="adc47-121">For this reason, a <xref:System.Data.DataSet> that uses <xref:System.Data.DataTable.Namespace%2A> property values will have different behaviors depending on which version of the .NET Framework you are running.</span></span> <span data-ttu-id="adc47-122">Ad esempio, si supponga di disporre di due `DataSets` contenenti `DataTables` con lo stesso valore della proprietà <xref:System.Data.DataTable.TableName%2A> ma valori diversi della proprietà <xref:System.Data.DataTable.Namespace%2A>.</span><span class="sxs-lookup"><span data-stu-id="adc47-122">For example, suppose you have two `DataSets` containing `DataTables` with the same <xref:System.Data.DataTable.TableName%2A> property values but different <xref:System.Data.DataTable.Namespace%2A> property values.</span></span> <span data-ttu-id="adc47-123">Nella versione 1.1 di .NET Framework, i diversi nomi di <xref:System.Data.DataTable.Namespace%2A> verranno ignorati durante l'unione dei due oggetti <xref:System.Data.DataSet>.</span><span class="sxs-lookup"><span data-stu-id="adc47-123">In version 1.1 of the .NET Framework, the different <xref:System.Data.DataTable.Namespace%2A> names will be ignored when merging the two <xref:System.Data.DataSet> objects.</span></span> <span data-ttu-id="adc47-124">A partire dalla versione 2.0, invece, in seguito all'unione vengono creati due nuovi oggetti `DataTables` nell'oggetto <xref:System.Data.DataSet> di destinazione.</span><span class="sxs-lookup"><span data-stu-id="adc47-124">However, starting with version 2.0, merging causes two new `DataTables` to be created in the target <xref:System.Data.DataSet>.</span></span> <span data-ttu-id="adc47-125">I `DataTables` originali non verranno interessati dall'unione.</span><span class="sxs-lookup"><span data-stu-id="adc47-125">The original `DataTables` will be unaffected by the merge.</span></span>  
  
## <a name="preservechanges"></a><span data-ttu-id="adc47-126">PreserveChanges</span><span class="sxs-lookup"><span data-stu-id="adc47-126">PreserveChanges</span></span>  
 <span data-ttu-id="adc47-127">Quando si passa una matrice `DataSet`, `DataTable` o `DataRow` al metodo `Merge`, è possibile includere parametri facoltativi che consentano di specificare se mantenere o meno le modifiche nel `DataSet` esistente e come gestire i nuovi elementi dello schema individuati nei dati in arrivo.</span><span class="sxs-lookup"><span data-stu-id="adc47-127">When you pass a `DataSet`, `DataTable`, or `DataRow` array to the `Merge` method, you can include optional parameters that specify whether or not to preserve changes in the existing `DataSet`, and how to handle new schema elements found in the incoming data.</span></span> <span data-ttu-id="adc47-128">Il primo di tali parametri successivi ai dati in arrivo è un flag booleano, <xref:System.Data.LoadOption.PreserveChanges>, che consente di specificare se conservare o meno le modifiche nel `DataSet` esistente.</span><span class="sxs-lookup"><span data-stu-id="adc47-128">The first of these parameters after the incoming data is a Boolean flag, <xref:System.Data.LoadOption.PreserveChanges>, which specifies whether or not to preserve the changes in the existing `DataSet`.</span></span> <span data-ttu-id="adc47-129">Se il flag `PreserveChanges` è impostato su `true`, i valori esistenti nella versione di riga `Current` della riga esistente non verranno sovrascritti dai valori in arrivo.</span><span class="sxs-lookup"><span data-stu-id="adc47-129">If the `PreserveChanges` flag is set to `true`, incoming values do not overwrite existing values in the `Current` row version of the existing row.</span></span> <span data-ttu-id="adc47-130">Se il flag `PreserveChanges` è impostato su `false`, i valori esistenti nella versione di riga `Current` della riga esistente verranno sovrascritti dai valori in arrivo.</span><span class="sxs-lookup"><span data-stu-id="adc47-130">If the `PreserveChanges` flag is set to `false`, incoming values do overwrite the existing values in the `Current` row version of the existing row.</span></span> <span data-ttu-id="adc47-131">Se non è specificato, il flag `PreserveChanges` viene impostato su `false` per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="adc47-131">If the `PreserveChanges` flag is not specified, it is set to `false` by default.</span></span> <span data-ttu-id="adc47-132">Per ulteriori informazioni sulle versioni delle righe, vedere [stati delle righe e le versioni di riga](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/row-states-and-row-versions.md).</span><span class="sxs-lookup"><span data-stu-id="adc47-132">For more information about row versions, see [Row States and Row Versions](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/row-states-and-row-versions.md).</span></span>  
  
 <span data-ttu-id="adc47-133">Se `PreserveChanges` è `true`, i dati della riga esistente verranno mantenuti nella versione di riga <xref:System.Data.DataRowVersion.Current> della riga esistente, mentre i dati della versione di riga <xref:System.Data.DataRowVersion.Original> della riga esistente verranno sovrascritti dai dati della versione di riga `Original` della riga in arrivo.</span><span class="sxs-lookup"><span data-stu-id="adc47-133">When `PreserveChanges` is `true`, the data from the existing row is maintained in the <xref:System.Data.DataRowVersion.Current> row version of the existing row, while the data from the <xref:System.Data.DataRowVersion.Original> row version of the existing row is overwritten with the data from the `Original` row version of the incoming row.</span></span> <span data-ttu-id="adc47-134">La proprietà <xref:System.Data.DataRow.RowState%2A> della riga esistente è impostata su <xref:System.Data.DataRowState.Modified>.</span><span class="sxs-lookup"><span data-stu-id="adc47-134">The <xref:System.Data.DataRow.RowState%2A> of the existing row is set to <xref:System.Data.DataRowState.Modified>.</span></span> <span data-ttu-id="adc47-135">Vengono applicate le seguenti eccezioni:</span><span class="sxs-lookup"><span data-stu-id="adc47-135">The following exceptions apply:</span></span>  
  
-   <span data-ttu-id="adc47-136">Se il valore di `RowState` per la riga esistente è `Deleted`, il valore di `RowState` rimane `Deleted` e non viene impostato su `Modified`.</span><span class="sxs-lookup"><span data-stu-id="adc47-136">If the existing row has a `RowState` of `Deleted`, this `RowState` remains `Deleted` and is not set to `Modified`.</span></span> <span data-ttu-id="adc47-137">In questo caso i dati contenuti nella riga in arrivo verranno archiviati comunque nella versione di riga `Original` della riga esistente, sovrascrivendo la versione di riga `Original` della riga esistente (a meno che il valore di `RowState` per la riga in arrivo non sia `Added`).</span><span class="sxs-lookup"><span data-stu-id="adc47-137">In this case, the data from the incoming row will still be stored in the `Original` row version of the existing row, overwriting the `Original` row version of the existing row (unless the incoming row has a `RowState` of `Added`).</span></span>  
  
-   <span data-ttu-id="adc47-138">Se il valore di `RowState` per la riga in arrivo è `Added`, i dati della versione di riga `Original` della riga esistente non verranno sovrascritti con i dati della riga in arrivo, poiché a tale riga non è associata nessuna versione di riga `Original`.</span><span class="sxs-lookup"><span data-stu-id="adc47-138">If the incoming row has a `RowState` of `Added`, the data from the `Original` row version of the existing row will not be overwritten with data from the incoming row, because the incoming row does not have an `Original` row version.</span></span>  
  
 <span data-ttu-id="adc47-139">Se `PreserveChanges` è `false`, le versioni di riga `Current` e `Original` della riga esistente verranno sovrascritte con i dati della riga in arrivo e il valore di `RowState` della riga esistente verrà impostato sul valore di `RowState` della riga in arrivo.</span><span class="sxs-lookup"><span data-stu-id="adc47-139">When `PreserveChanges` is `false`, both the `Current` and `Original` row versions in the existing row are overwritten with the data from the incoming row, and the `RowState` of the existing row is set to the `RowState` of the incoming row.</span></span> <span data-ttu-id="adc47-140">Vengono applicate le seguenti eccezioni:</span><span class="sxs-lookup"><span data-stu-id="adc47-140">The following exceptions apply:</span></span>  
  
-   <span data-ttu-id="adc47-141">Se il valore di `RowState` per la riga in arrivo è `Unchanged` e il valore di `RowState` per la riga esistente è `Modified`, `Deleted`o `Added`, il valore di `RowState` per la riga esistente verrà impostato su `Modified`.</span><span class="sxs-lookup"><span data-stu-id="adc47-141">If the incoming row has a `RowState` of `Unchanged` and the existing row has a `RowState` of `Modified`, `Deleted`, or `Added`, the `RowState` of the existing row is set to `Modified`.</span></span>  
  
-   <span data-ttu-id="adc47-142">Se il valore di `RowState` per la riga in arrivo è `Added` e il valore di `RowState` per la riga esistente è `Unchanged`, `Modified` o `Deleted`, il valore di `RowState` per la riga esistente verrà impostato su `Modified`.</span><span class="sxs-lookup"><span data-stu-id="adc47-142">If the incoming row has a `RowState` of `Added`, and the existing row has a `RowState` of `Unchanged`, `Modified`, or `Deleted`, the `RowState` of the existing row is set to `Modified`.</span></span> <span data-ttu-id="adc47-143">I dati contenuti nella versione di riga `Original` della riga esistente non verranno inoltre sovrascritti con i dati della riga in arrivo, poiché a tale riga non è associata nessuna versione di riga `Original`.</span><span class="sxs-lookup"><span data-stu-id="adc47-143">Also, the data from the `Original` row version of the existing row is not overwritten with data from the incoming row, because the incoming row does not have an `Original` row version.</span></span>  
  
## <a name="missingschemaaction"></a><span data-ttu-id="adc47-144">MissingSchemaAction</span><span class="sxs-lookup"><span data-stu-id="adc47-144">MissingSchemaAction</span></span>  
 <span data-ttu-id="adc47-145">È possibile usare il parametro facoltativo <xref:System.Data.MissingSchemaAction> del metodo `Merge` per specificare in che modo `Merge` gestirà gli elementi dello schema nei dati in arrivo che non fanno parte del `DataSet` esistente.</span><span class="sxs-lookup"><span data-stu-id="adc47-145">You can use the optional <xref:System.Data.MissingSchemaAction> parameter of the `Merge` method to specify how `Merge` will handle schema elements in the incoming data that are not part of the existing `DataSet`.</span></span>  
  
 <span data-ttu-id="adc47-146">Nella tabella seguente vengono descritte le opzioni per `MissingSchemaAction`.</span><span class="sxs-lookup"><span data-stu-id="adc47-146">The following table describes the options for `MissingSchemaAction`.</span></span>  
  
|<span data-ttu-id="adc47-147">Opzione MissingSchemaAction</span><span class="sxs-lookup"><span data-stu-id="adc47-147">MissingSchemaAction option</span></span>|<span data-ttu-id="adc47-148">Descrizione</span><span class="sxs-lookup"><span data-stu-id="adc47-148">Description</span></span>|  
|--------------------------------|-----------------|  
|<xref:System.Data.MissingSchemaAction.Add>|<span data-ttu-id="adc47-149">Aggiunge le nuove informazioni dello schema al `DataSet` e popola le nuove colonne usando i valori in arrivo.</span><span class="sxs-lookup"><span data-stu-id="adc47-149">Add the new schema information to the `DataSet` and populate the new columns with the incoming values.</span></span> <span data-ttu-id="adc47-150">Questa è l'impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="adc47-150">This is the default.</span></span>|  
|<xref:System.Data.MissingSchemaAction.AddWithKey>|<span data-ttu-id="adc47-151">Aggiunge le nuove informazioni sullo schema e sulla chiave primaria al `DataSet` e popola le nuove colonne usando i valori in arrivo.</span><span class="sxs-lookup"><span data-stu-id="adc47-151">Add the new schema and primary key information to the `DataSet` and populate the new columns with the incoming values.</span></span>|  
|<xref:System.Data.MissingSchemaAction.Error>|<span data-ttu-id="adc47-152">Genera un'eccezione nel caso in cui vengano rilevate delle informazioni relative allo schema non associate correttamente.</span><span class="sxs-lookup"><span data-stu-id="adc47-152">Throw an exception if mismatched schema information is encountered.</span></span>|  
|<xref:System.Data.MissingSchemaAction.Ignore>|<span data-ttu-id="adc47-153">Ignora le nuove informazioni relative allo schema.</span><span class="sxs-lookup"><span data-stu-id="adc47-153">Ignore the new schema information.</span></span>|  
  
## <a name="constraints"></a><span data-ttu-id="adc47-154">Vincoli</span><span class="sxs-lookup"><span data-stu-id="adc47-154">Constraints</span></span>  
 <span data-ttu-id="adc47-155">Se si usa il metodo `Merge`, la verifica dei vincoli viene eseguita solo quando tutti i nuovi dati sono stati aggiunti al `DataSet` esistente.</span><span class="sxs-lookup"><span data-stu-id="adc47-155">With the `Merge` method, constraints are not checked until all new data has been added to the existing `DataSet`.</span></span> <span data-ttu-id="adc47-156">Una volta aggiunti i dati, i vincoli vengono applicati ai valori correnti del `DataSet`.</span><span class="sxs-lookup"><span data-stu-id="adc47-156">Once the data has been added, constraints are enforced on the current values in the `DataSet`.</span></span> <span data-ttu-id="adc47-157">È necessario assicurarsi che il codice sia in grado di gestire eventuali eccezioni generate a causa di violazioni dei vincoli.</span><span class="sxs-lookup"><span data-stu-id="adc47-157">You must ensure that your code handles any exceptions that might be thrown due to constraint violations.</span></span>  
  
 <span data-ttu-id="adc47-158">Si consideri il caso in cui una riga esistente di un `DataSet` è una riga `Unchanged` con un valore di chiave primaria di 1.</span><span class="sxs-lookup"><span data-stu-id="adc47-158">Consider a case where an existing row in a `DataSet` is an `Unchanged` row with a primary key value of 1.</span></span> <span data-ttu-id="adc47-159">Durante un'operazione di unione con una riga in arrivo `Modified` in cui il valore di chiave primaria `Original` è 2 il valore di chiave primaria `Current` è 1, la riga esistente e la riga in arrivo non vengono considerate corrispondenti perché i valori della chiave primaria di `Original` sono diversi.</span><span class="sxs-lookup"><span data-stu-id="adc47-159">During a merge operation with a `Modified` incoming row with an `Original` primary key value of 2 and a `Current` primary key value of 1, the existing row and the incoming row are not considered matching because the `Original` primary key values differ.</span></span> <span data-ttu-id="adc47-160">Tuttavia, una volta completata l'unione e verificati i vincoli, verrà generata un'eccezione, poiché i valori di chiave primaria `Current` violano il vincolo univoco per la colonna di chiave primaria.</span><span class="sxs-lookup"><span data-stu-id="adc47-160">However, when the merge is completed and constraints are checked, an exception will be thrown because the `Current` primary key values violate the unique constraint for the primary key column.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="adc47-161">Quando si inseriscono righe in una tabella di database contenente una colonna a incremento automatico ad esempio una colonna Identity, è possibile che il valore della colonna Identity restituito dall'inserimento non corrisponda al valore di `DataSet`, pertanto le righe restituite verranno aggiunte anziché unite.</span><span class="sxs-lookup"><span data-stu-id="adc47-161">When rows are inserted into a database table containing an auto incrementing column such as an identity column, the identity column value returned by the insert may not match the value in the `DataSet`, causing the returned rows to be appended instead of merged.</span></span> <span data-ttu-id="adc47-162">Per ulteriori informazioni, vedere [il recupero dei valori di identità o contatore](../../../../../docs/framework/data/adonet/retrieving-identity-or-autonumber-values.md).</span><span class="sxs-lookup"><span data-stu-id="adc47-162">For more information, see [Retrieving Identity or Autonumber Values](../../../../../docs/framework/data/adonet/retrieving-identity-or-autonumber-values.md).</span></span>  
  
 <span data-ttu-id="adc47-163">Nell'esempio di codice seguente viene eseguito il merge di due oggetti `DataSet` con schemi diversi in un unico `DataSet` contenente una combinazione degli schemi dei due oggetti `DataSet` in arrivo.</span><span class="sxs-lookup"><span data-stu-id="adc47-163">The following code example merges two `DataSet` objects with differents schemas into one `DataSet` with the combined schemas of the two incoming `DataSet` objects.</span></span>  
  
 [!code-csharp[DataWorks DataSet.Merge#1](../../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks DataSet.Merge/CS/source.cs#1)]
 [!code-vb[DataWorks DataSet.Merge#1](../../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks DataSet.Merge/VB/source.vb#1)]  
  
 <span data-ttu-id="adc47-164">Nell'esempio di codice seguente viene selezionato un `DataSet` esistente con aggiornamenti e tali aggiornamenti vengono passati a un `DataAdapter` per l'elaborazione nell'origine dati.</span><span class="sxs-lookup"><span data-stu-id="adc47-164">The following code example takes an existing `DataSet` with updates and passes those updates to a `DataAdapter` to be processed at the data source.</span></span> <span data-ttu-id="adc47-165">I risultati vengono quindi uniti nel `DataSet` originale.</span><span class="sxs-lookup"><span data-stu-id="adc47-165">The results are then merged into the original `DataSet`.</span></span> <span data-ttu-id="adc47-166">Dopo aver rifiutato le modifiche che causavano un errore, le modifiche unite vengono confermate tramite `AcceptChanges`.</span><span class="sxs-lookup"><span data-stu-id="adc47-166">After rejecting changes that resulted in an error, the merged changes are committed with `AcceptChanges`.</span></span>  
  
 [!code-csharp[DataWorks DataSet.MergeAcceptChanges#1](../../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks DataSet.MergeAcceptChanges/CS/source.cs#1)]
 [!code-vb[DataWorks DataSet.MergeAcceptChanges#1](../../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks DataSet.MergeAcceptChanges/VB/source.vb#1)]  
  
 [!code-csharp[DataWorks DataSet.MergeAcceptChanges#2](../../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks DataSet.MergeAcceptChanges/CS/source.cs#2)]
 [!code-vb[DataWorks DataSet.MergeAcceptChanges#2](../../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks DataSet.MergeAcceptChanges/VB/source.vb#2)]  
  
## <a name="see-also"></a><span data-ttu-id="adc47-167">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="adc47-167">See Also</span></span>  
 [<span data-ttu-id="adc47-168">Oggetti DataSet, DataTable e DataView</span><span class="sxs-lookup"><span data-stu-id="adc47-168">DataSets, DataTables, and DataViews</span></span>](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/index.md)  
 [<span data-ttu-id="adc47-169">Stati e versioni delle righe</span><span class="sxs-lookup"><span data-stu-id="adc47-169">Row States and Row Versions</span></span>](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/row-states-and-row-versions.md)  
 [<span data-ttu-id="adc47-170">DataAdapter e DataReader</span><span class="sxs-lookup"><span data-stu-id="adc47-170">DataAdapters and DataReaders</span></span>](../../../../../docs/framework/data/adonet/dataadapters-and-datareaders.md)  
 [<span data-ttu-id="adc47-171">Recupero e modifica di dati in ADO.NET</span><span class="sxs-lookup"><span data-stu-id="adc47-171">Retrieving and Modifying Data in ADO.NET</span></span>](../../../../../docs/framework/data/adonet/retrieving-and-modifying-data.md)  
 [<span data-ttu-id="adc47-172">Recupero di identità o di valori numerati automaticamente</span><span class="sxs-lookup"><span data-stu-id="adc47-172">Retrieving Identity or Autonumber Values</span></span>](../../../../../docs/framework/data/adonet/retrieving-identity-or-autonumber-values.md)  
 [<span data-ttu-id="adc47-173">Provider gestiti ADO.NET e Centro per sviluppatori di set di dati</span><span class="sxs-lookup"><span data-stu-id="adc47-173">ADO.NET Managed Providers and DataSet Developer Center</span></span>](http://go.microsoft.com/fwlink/?LinkId=217917)
