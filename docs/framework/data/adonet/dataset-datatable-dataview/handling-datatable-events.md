---
title: Gestione di eventi DataTable
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 62f404a5-13ea-4b93-a29f-55b74a16c9d3
ms.openlocfilehash: 542437b419547ffd00dff193546b6d29cdc7e63a
ms.sourcegitcommit: 2eceb05f1a5bb261291a1f6a91c5153727ac1c19
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/04/2018
ms.locfileid: "43504293"
---
# <a name="handling-datatable-events"></a><span data-ttu-id="46caa-102">Gestione di eventi DataTable</span><span class="sxs-lookup"><span data-stu-id="46caa-102">Handling DataTable Events</span></span>
<span data-ttu-id="46caa-103">Nell'oggetto <xref:System.Data.DataTable> sono disponibili diversi eventi che possono essere elaborati da un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="46caa-103">The <xref:System.Data.DataTable> object provides a series of events that can be processed by an application.</span></span> <span data-ttu-id="46caa-104">Nella tabella seguente vengono descritti gli eventi di `DataTable`.</span><span class="sxs-lookup"><span data-stu-id="46caa-104">The following table describes `DataTable` events.</span></span>  
  
|<span data-ttu-id="46caa-105">Evento</span><span class="sxs-lookup"><span data-stu-id="46caa-105">Event</span></span>|<span data-ttu-id="46caa-106">Descrizione</span><span class="sxs-lookup"><span data-stu-id="46caa-106">Description</span></span>|  
|-----------|-----------------|  
|<xref:System.Data.DataTable.Initialized>|<span data-ttu-id="46caa-107">Viene generato dopo la chiamata al metodo <xref:System.Data.DataTable.EndInit%2A> di `DataTable`.</span><span class="sxs-lookup"><span data-stu-id="46caa-107">Occurs after the <xref:System.Data.DataTable.EndInit%2A> method of a `DataTable` is called.</span></span> <span data-ttu-id="46caa-108">Questo evento è progettato principalmente per supportare gli scenari in fase di progettazione.</span><span class="sxs-lookup"><span data-stu-id="46caa-108">This event is intended primarily to support design-time scenarios.</span></span>|  
|<xref:System.Data.DataTable.ColumnChanged>|<span data-ttu-id="46caa-109">Viene generato dopo la modifica di un valore in <xref:System.Data.DataColumn>.</span><span class="sxs-lookup"><span data-stu-id="46caa-109">Occurs after a value has been successfully changed in a <xref:System.Data.DataColumn>.</span></span>|  
|<xref:System.Data.DataTable.ColumnChanging>|<span data-ttu-id="46caa-110">Viene generato quando un valore è stato inviato per una `DataColumn`.</span><span class="sxs-lookup"><span data-stu-id="46caa-110">Occurs when a value has been submitted for a `DataColumn`.</span></span>|  
|<xref:System.Data.DataTable.RowChanged>|<span data-ttu-id="46caa-111">Viene generato dopo la modifica di un valore `DataColumn` o di <xref:System.Data.DataRow.RowState%2A> di <xref:System.Data.DataRow> nella `DataTable`.</span><span class="sxs-lookup"><span data-stu-id="46caa-111">Occurs after a `DataColumn` value or the <xref:System.Data.DataRow.RowState%2A> of a <xref:System.Data.DataRow> in the `DataTable` has been changed successfully.</span></span>|  
|<xref:System.Data.DataTable.RowChanging>|<span data-ttu-id="46caa-112">Viene generato quando è stata inviata una modifica per un valore `DataColumn` o per `RowState` di `DataRow` nella `DataTable`.</span><span class="sxs-lookup"><span data-stu-id="46caa-112">Occurs when a change has been submitted for a `DataColumn` value or the `RowState` of a `DataRow` in the `DataTable`.</span></span>|  
|<xref:System.Data.DataTable.RowDeleted>|<span data-ttu-id="46caa-113">Viene generato dopo che una `DataRow` nella `DataTable` è stata contrassegnata come `Deleted`.</span><span class="sxs-lookup"><span data-stu-id="46caa-113">Occurs after a `DataRow` in the `DataTable` has been marked as `Deleted`.</span></span>|  
|<xref:System.Data.DataTable.RowDeleting>|<span data-ttu-id="46caa-114">Viene generato prima che una `DataRow` nella `DataTable` venga contrassegnata come `Deleted`.</span><span class="sxs-lookup"><span data-stu-id="46caa-114">Occurs before a `DataRow` in the `DataTable` is marked as `Deleted`.</span></span>|  
|<xref:System.Data.DataTable.TableCleared>|<span data-ttu-id="46caa-115">Viene generato dopo che una chiamata al metodo <xref:System.Data.DataTable.Clear%2A> di `DataTable` ha cancellato correttamente ogni `DataRow`.</span><span class="sxs-lookup"><span data-stu-id="46caa-115">Occurs after a call to the <xref:System.Data.DataTable.Clear%2A> method of the `DataTable` has successfully cleared every `DataRow`.</span></span>|  
|<xref:System.Data.DataTable.TableClearing>|<span data-ttu-id="46caa-116">Viene generato dopo una chiamata al metodo `Clear` ma prima dell'inizio dell'operazione `Clear`.</span><span class="sxs-lookup"><span data-stu-id="46caa-116">Occurs after the `Clear` method is called but before the `Clear` operation begins.</span></span>|  
|<xref:System.Data.DataTable.TableNewRow>|<span data-ttu-id="46caa-117">Viene generato dopo la creazione di una nuova `DataRow` tramite una chiamata al metodo `NewRow` della `DataTable`.</span><span class="sxs-lookup"><span data-stu-id="46caa-117">Occurs after a new `DataRow` is created by a call to the `NewRow` method of the `DataTable`.</span></span>|  
|<xref:System.ComponentModel.MarshalByValueComponent.Disposed>|<span data-ttu-id="46caa-118">Viene generato quando `DataTable` è `Disposed`.</span><span class="sxs-lookup"><span data-stu-id="46caa-118">Occurs when the `DataTable` is `Disposed`.</span></span> <span data-ttu-id="46caa-119">La proprietà viene ereditata da <xref:System.ComponentModel.MarshalByValueComponent>.</span><span class="sxs-lookup"><span data-stu-id="46caa-119">Inherited from <xref:System.ComponentModel.MarshalByValueComponent>.</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="46caa-120">La maggior parte delle operazioni che aggiungono o eliminano righe non generano gli eventi `ColumnChanged` e `ColumnChanging`.</span><span class="sxs-lookup"><span data-stu-id="46caa-120">Most operations that add or delete rows do not raise the `ColumnChanged` and `ColumnChanging` events.</span></span> <span data-ttu-id="46caa-121">Tuttavia, il metodo `ReadXml` genera gli eventi `ColumnChanged` e `ColumnChanging`, a meno che `XmlReadMode` non sia impostato su `DiffGram` o su `Auto` quando il documento XML da leggere è un `DiffGram`.</span><span class="sxs-lookup"><span data-stu-id="46caa-121">However, the `ReadXml` method does raise `ColumnChanged` and `ColumnChanging` events, unless the `XmlReadMode` is set to `DiffGram` or is set to `Auto` when the XML document being read is a `DiffGram`.</span></span>  
  
> [!WARNING]
>  <span data-ttu-id="46caa-122">I dati possono venire danneggiati se vengono modificati in un oggetto `DataSet` da cui viene generato l'evento `RowChanged`.</span><span class="sxs-lookup"><span data-stu-id="46caa-122">Data corruption can occur if data is modified in a `DataSet` from which the `RowChanged` event is raised.</span></span> <span data-ttu-id="46caa-123">In caso di danneggiamento dei dati, non viene generata alcuna eccezione.</span><span class="sxs-lookup"><span data-stu-id="46caa-123">No exception will be raised if such data corruption occurs.</span></span>  
  
## <a name="additional-related-events"></a><span data-ttu-id="46caa-124">Eventi correlati aggiuntivi</span><span class="sxs-lookup"><span data-stu-id="46caa-124">Additional Related Events</span></span>  
 <span data-ttu-id="46caa-125">La proprietà <xref:System.Data.DataTable.Constraints%2A> contiene un'istanza di <xref:System.Data.ConstraintCollection>.</span><span class="sxs-lookup"><span data-stu-id="46caa-125">The <xref:System.Data.DataTable.Constraints%2A> property holds a <xref:System.Data.ConstraintCollection> instance.</span></span> <span data-ttu-id="46caa-126">La classe <xref:System.Data.ConstraintCollection> espone un evento <xref:System.Data.ConstraintCollection.CollectionChanged>.</span><span class="sxs-lookup"><span data-stu-id="46caa-126">The <xref:System.Data.ConstraintCollection> class exposes a <xref:System.Data.ConstraintCollection.CollectionChanged> event.</span></span> <span data-ttu-id="46caa-127">Questo evento viene attivato quando un vincolo viene aggiunto, modificato o rimosso da `ConstraintCollection`.</span><span class="sxs-lookup"><span data-stu-id="46caa-127">This event fires when a constraint is added, modified, or removed from the `ConstraintCollection`.</span></span>  
  
 <span data-ttu-id="46caa-128">La proprietà <xref:System.Data.DataTable.Columns%2A> contiene un'istanza di <xref:System.Data.DataColumnCollection>.</span><span class="sxs-lookup"><span data-stu-id="46caa-128">The <xref:System.Data.DataTable.Columns%2A> property holds a <xref:System.Data.DataColumnCollection> instance.</span></span> <span data-ttu-id="46caa-129">La classe `DataColumnCollection` espone un evento <xref:System.Data.DataColumnCollection.CollectionChanged>.</span><span class="sxs-lookup"><span data-stu-id="46caa-129">The `DataColumnCollection` class exposes a <xref:System.Data.DataColumnCollection.CollectionChanged> event.</span></span> <span data-ttu-id="46caa-130">Questo evento viene attivato quando una `DataColumn` viene aggiunta, modificata o rimossa da `DataColumnCollection`.</span><span class="sxs-lookup"><span data-stu-id="46caa-130">This event fires when a `DataColumn` is added, modified, or removed from the `DataColumnCollection`.</span></span> <span data-ttu-id="46caa-131">Le modifiche che causano l'attivazione dell'evento includono le modifiche al nome, tipo, espressione o posizione ordinale di una colonna.</span><span class="sxs-lookup"><span data-stu-id="46caa-131">Modifications that cause the event to fire include changes to the name, type, expression or ordinal position of a column.</span></span>  
  
 <span data-ttu-id="46caa-132">La proprietà <xref:System.Data.DataSet.Tables%2A> di <xref:System.Data.DataSet> contiene un'istanza di <xref:System.Data.DataTableCollection>.</span><span class="sxs-lookup"><span data-stu-id="46caa-132">The <xref:System.Data.DataSet.Tables%2A> property of a <xref:System.Data.DataSet> holds a <xref:System.Data.DataTableCollection> instance.</span></span> <span data-ttu-id="46caa-133">La classe `DataTableCollection` espone sia un evento `CollectionChanged` sia un evento `CollectionChanging`.</span><span class="sxs-lookup"><span data-stu-id="46caa-133">The `DataTableCollection` class exposes both a `CollectionChanged` and a `CollectionChanging` event.</span></span> <span data-ttu-id="46caa-134">Questi eventi vengono attivati quando una `DataTable` viene aggiunta, modificata o rimossa dal `DataSet`.</span><span class="sxs-lookup"><span data-stu-id="46caa-134">These events fire when a `DataTable` is added to or removed from the `DataSet`.</span></span>  
  
 <span data-ttu-id="46caa-135">Le modifiche a `DataRows` possono attivare anche eventi per un oggetto <xref:System.Data.DataView> associato.</span><span class="sxs-lookup"><span data-stu-id="46caa-135">Changes to `DataRows` can also trigger events for an associated <xref:System.Data.DataView>.</span></span> <span data-ttu-id="46caa-136">La classe `DataView` espone un evento <xref:System.Data.DataView.ListChanged> che viene attivato quando viene modificato un valore `DataColumn` oppure la composizione o l'ordine della visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="46caa-136">The `DataView` class exposes a <xref:System.Data.DataView.ListChanged> event that fires when a `DataColumn` value changes or when the composition or sort order of the view changes.</span></span> <span data-ttu-id="46caa-137">La classe <xref:System.Data.DataRowView> espone un evento <xref:System.Data.DataRowView.PropertyChanged> che viene attivato quando viene modificato valore `DataColumn` associato.</span><span class="sxs-lookup"><span data-stu-id="46caa-137">The <xref:System.Data.DataRowView> class exposes a <xref:System.Data.DataRowView.PropertyChanged> event that fires when an associated `DataColumn` value changes.</span></span>  
  
## <a name="sequence-of-operations"></a><span data-ttu-id="46caa-138">Sequenza delle operazioni</span><span class="sxs-lookup"><span data-stu-id="46caa-138">Sequence of Operations</span></span>  
 <span data-ttu-id="46caa-139">Di seguito è riportata la sequenza delle operazioni che si verificano quando una `DataRow` viene aggiunta, modificata o eliminata:</span><span class="sxs-lookup"><span data-stu-id="46caa-139">Here is the sequence of operations that occur when a `DataRow` is added, modified, or deleted:</span></span>  
  
1.  <span data-ttu-id="46caa-140">Creare il record proposto e applicare eventuali modifiche.</span><span class="sxs-lookup"><span data-stu-id="46caa-140">Create the proposed record and apply any changes.</span></span>  
  
2.  <span data-ttu-id="46caa-141">Verificare i vincoli per le colonne non espressioni.</span><span class="sxs-lookup"><span data-stu-id="46caa-141">Check constraints for non-expression columns.</span></span>  
  
3.  <span data-ttu-id="46caa-142">Generare gli eventi `RowChanging` o `RowDeleting` come applicabile.</span><span class="sxs-lookup"><span data-stu-id="46caa-142">Raise the `RowChanging` or `RowDeleting` events as applicable.</span></span>  
  
4.  <span data-ttu-id="46caa-143">Impostare il record proposto come record corrente.</span><span class="sxs-lookup"><span data-stu-id="46caa-143">Set the proposed record to be the current record.</span></span>  
  
5.  <span data-ttu-id="46caa-144">Aggiornare gli eventuali indici associati.</span><span class="sxs-lookup"><span data-stu-id="46caa-144">Update any associated indexes.</span></span>  
  
6.  <span data-ttu-id="46caa-145">Generare gli eventi `ListChanged` per gli oggetti `DataView` associati e gli eventi `PropertyChanged` per gli oggetti `DataRowView` associati.</span><span class="sxs-lookup"><span data-stu-id="46caa-145">Raise `ListChanged` events for associated `DataView` objects and `PropertyChanged` events for associated `DataRowView` objects.</span></span>  
  
7.  <span data-ttu-id="46caa-146">Valutare tutte le colonne espressioni, ma rimandare la verifica della presenza di vincoli su queste colonne.</span><span class="sxs-lookup"><span data-stu-id="46caa-146">Evaluate all expression columns, but delay checking any constraints on these columns.</span></span>  
  
8.  <span data-ttu-id="46caa-147">Generare gli eventi `ListChanged` per gli oggetti `DataView` associati e gli eventi `PropertyChanged` per gli oggetti `DataRowView` associati interessati dalle valutazioni delle colonne espressioni.</span><span class="sxs-lookup"><span data-stu-id="46caa-147">Raise `ListChanged` events for associated `DataView` objects and `PropertyChanged` events for associated `DataRowView` objects affected by the expression column evaluations.</span></span>  
  
9. <span data-ttu-id="46caa-148">Generare gli eventi `RowChanged` o `RowDeleted` come applicabile.</span><span class="sxs-lookup"><span data-stu-id="46caa-148">Raise `RowChanged` or `RowDeleted` events as applicable.</span></span>  
  
10. <span data-ttu-id="46caa-149">Verificare i vincoli per le colonne espressioni.</span><span class="sxs-lookup"><span data-stu-id="46caa-149">Check constraints on expression columns.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="46caa-150">Le modifiche alle colonne espressioni non generano mai eventi `DataTable`,</span><span class="sxs-lookup"><span data-stu-id="46caa-150">Changes to expression columns never raise `DataTable` events.</span></span> <span data-ttu-id="46caa-151">ma generano solo eventi `DataView` e `DataRowView`,</span><span class="sxs-lookup"><span data-stu-id="46caa-151">Changes to expression columns only raise `DataView` and `DataRowView` events.</span></span> <span data-ttu-id="46caa-152">Le colonne espressioni possono avere dipendenze su molte altre colonne e possono essere valutate più volte durante una singola operazione `DataRow`.</span><span class="sxs-lookup"><span data-stu-id="46caa-152">Expression columns can have dependencies on multiple other columns, and can be evaluated multiple times during a single `DataRow` operation.</span></span> <span data-ttu-id="46caa-153">Ogni valutazione di espressione genera eventi e una singola operazione `DataRow` può generare più eventi `ListChanged` e `PropertyChanged` quando sono interessate colonne espressioni, magari con più eventi per la stessa colonna espressioni.</span><span class="sxs-lookup"><span data-stu-id="46caa-153">Each expression evaluation raises events, and a single `DataRow` operation can raise multiple `ListChanged` and `PropertyChanged` events when expression columns are affected, possibly including multiple events for the same expression column.</span></span>  
  
> [!WARNING]
>  <span data-ttu-id="46caa-154">Non generare un'eccezione <xref:System.NullReferenceException> all'interno del gestore eventi `RowChanged`.</span><span class="sxs-lookup"><span data-stu-id="46caa-154">Do not throw a <xref:System.NullReferenceException> within the `RowChanged` event handler.</span></span> <span data-ttu-id="46caa-155">Se viene generata un'eccezione <xref:System.NullReferenceException> all'interno dell'evento `RowChanged` di un oggetto `DataTable`, allora il `DataTable` sarà danneggiato.</span><span class="sxs-lookup"><span data-stu-id="46caa-155">If a <xref:System.NullReferenceException> is thrown within the `RowChanged` event of a `DataTable`, then the `DataTable` will be corrupted.</span></span>  
  
### <a name="example"></a><span data-ttu-id="46caa-156">Esempio</span><span class="sxs-lookup"><span data-stu-id="46caa-156">Example</span></span>  
 <span data-ttu-id="46caa-157">Nell'esempio seguente viene illustrato come creare gestori per gli eventi `RowChanged`, `RowChanging`, `RowDeleted`, `RowDeleting`, `ColumnChanged`, `ColumnChanging`, `TableNewRow`, `TableCleared` e `TableClearing`.</span><span class="sxs-lookup"><span data-stu-id="46caa-157">The following example demonstrates how to create event handlers for the `RowChanged`, `RowChanging`, `RowDeleted`, `RowDeleting`, `ColumnChanged`, `ColumnChanging`, `TableNewRow`, `TableCleared`, and `TableClearing` events.</span></span> <span data-ttu-id="46caa-158">Ogni gestore evento visualizza l'output nella finestra della console quando viene attivato.</span><span class="sxs-lookup"><span data-stu-id="46caa-158">Each event handler displays output in the console window when it is fired.</span></span>  
  
 [!code-csharp[DataWorks DataTable.Events#1](../../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks DataTable.Events/CS/source.cs#1)]
 [!code-vb[DataWorks DataTable.Events#1](../../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks DataTable.Events/VB/source.vb#1)]  
  
## <a name="see-also"></a><span data-ttu-id="46caa-159">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="46caa-159">See Also</span></span>  
 [<span data-ttu-id="46caa-160">Manipolazione di dati in un oggetto DataTable</span><span class="sxs-lookup"><span data-stu-id="46caa-160">Manipulating Data in a DataTable</span></span>](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/manipulating-data-in-a-datatable.md)  
 [<span data-ttu-id="46caa-161">Gestione di eventi DataAdapter</span><span class="sxs-lookup"><span data-stu-id="46caa-161">Handling DataAdapter Events</span></span>](../../../../../docs/framework/data/adonet/handling-dataadapter-events.md)  
 [<span data-ttu-id="46caa-162">Gestione di eventi di set di dati</span><span class="sxs-lookup"><span data-stu-id="46caa-162">Handling DataSet Events</span></span>](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/handling-dataset-events.md)  
 [<span data-ttu-id="46caa-163">Provider gestiti ADO.NET e Centro per sviluppatori di set di dati</span><span class="sxs-lookup"><span data-stu-id="46caa-163">ADO.NET Managed Providers and DataSet Developer Center</span></span>](https://go.microsoft.com/fwlink/?LinkId=217917)
