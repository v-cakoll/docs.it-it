---
title: "Supporto SqlClient per disponibilità elevata, ripristino di emergenza"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-ado
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 61e0b396-09d7-4e13-9711-7dcbcbd103a0
caps.latest.revision: "13"
author: douglaslMS
ms.author: douglasl
manager: craigg
ms.workload: dotnet
ms.openlocfilehash: 4f6ede253f52682cfe5a698cf4fb02841dc4c1e0
ms.sourcegitcommit: c0dd436f6f8f44dc80dc43b07f6841a00b74b23f
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/19/2018
---
# <a name="sqlclient-support-for-high-availability-disaster-recovery"></a><span data-ttu-id="0faac-102">Supporto SqlClient per disponibilità elevata, ripristino di emergenza</span><span class="sxs-lookup"><span data-stu-id="0faac-102">SqlClient Support for High Availability, Disaster Recovery</span></span>
<span data-ttu-id="0faac-103">In questo argomento viene descritto il supporto di SqlClient (aggiunto in [!INCLUDE[net_v45](../../../../../includes/net-v45-md.md)]) per i gruppi di disponibilità AlwaysOn, con disponibilità elevata e ripristino di emergenza.</span><span class="sxs-lookup"><span data-stu-id="0faac-103">This topic discusses SqlClient support (added in [!INCLUDE[net_v45](../../../../../includes/net-v45-md.md)]) for high-availability, disaster recovery -- AlwaysOn Availability Groups.</span></span>  <span data-ttu-id="0faac-104">La funzionalità dei gruppi di disponibilità AlwaysOn è stata aggiunta in [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012.</span><span class="sxs-lookup"><span data-stu-id="0faac-104">AlwaysOn Availability Groups feature was added to [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012.</span></span> <span data-ttu-id="0faac-105">Per altre informazioni sui gruppi di disponibilità AlwaysOn, vedere la documentazione online di [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="0faac-105">For more information about AlwaysOn Availability Groups, see [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] Books Online.</span></span>  
  
 <span data-ttu-id="0faac-106">È ora possibile specificare il listener di un gruppo di disponibilità (AG) (disponibilità elevata, ripristino di emergenza) o l'istanza del cluster di failover di [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012 nella proprietà di connessione.</span><span class="sxs-lookup"><span data-stu-id="0faac-106">You can now specify the availability group listener of a (high-availability, disaster-recovery) availability group (AG) or [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012 Failover Cluster Instance in the connection property.</span></span> <span data-ttu-id="0faac-107">Se un'applicazione di SqlClient è connessa a un database AlwaysOn che esegue il failover, la connessione originale viene interrotta e l'applicazione deve aprire una nuova connessione per continuare a funzionare dopo il failover.</span><span class="sxs-lookup"><span data-stu-id="0faac-107">If a SqlClient application is connected to an AlwaysOn database that fails over, the original connection is broken and the application must open a new connection to continue work after the failover.</span></span>  
  
 <span data-ttu-id="0faac-108">Se non si stabilisce la connessione a un listener gruppo di disponibilità o all'istanza del cluster di failover di [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012 e se sono associati più indirizzi IP a un nome host, SqlClient scorrerà in sequenza tutti gli indirizzi IP associati alla voce DNS.</span><span class="sxs-lookup"><span data-stu-id="0faac-108">If you are not connecting to an availability group listener or [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012 Failover Cluster Instance, and if multiple IP addresses are associated with a hostname, SqlClient will iterate sequentially through all IP addresses associated with DNS entry.</span></span> <span data-ttu-id="0faac-109">Ciò può richiedere molto tempo se il primo indirizzo IP restituito dal server DNS non è associato a una scheda di interfaccia di rete (NIC).</span><span class="sxs-lookup"><span data-stu-id="0faac-109">This can be time consuming if the first IP address returned by DNS server is not bound to any network interface card (NIC).</span></span> <span data-ttu-id="0faac-110">Quando si stabilisce la connessione a un listener gruppo di disponibilità o all'istanza del cluster di failover di [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012, SqlClient tenta di connettersi a tutti gli indirizzi IP in parallelo e se un tentativo di connessione riesce, il driver rimuove tutti i tentativi di connessione in sospeso.</span><span class="sxs-lookup"><span data-stu-id="0faac-110">When connecting to an availability group listener or [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012 Failover Cluster Instance, SqlClient attempts to establish connections to all IP addresses in parallel and if a connection attempt succeeds, the driver will discard any pending connection attempts.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="0faac-111">L'aumento del timeout di connessione e l'implementazione di una logica di ripetizione dei tentativi di connessione aumenterà la probabilità che un'applicazione si connetta a un gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="0faac-111">Increasing connection timeout and implementing connection retry logic will increase the probability that an application will connect to an availability group.</span></span> <span data-ttu-id="0faac-112">Inoltre, poiché una connessione può avere esito negativo a causa di un failover, è necessario implementare la logica di ripetizione dei tentativi di connessione, in modo che una connessione non riuscita venga ripetuta finché non avrà esito positivo.</span><span class="sxs-lookup"><span data-stu-id="0faac-112">Also, because a connection can fail because of a failover, you should implement connection retry logic, retrying a failed connection until it reconnects.</span></span>  
  
 <span data-ttu-id="0faac-113">Le seguenti proprietà di connessione sono state aggiunte a SqlClient in [!INCLUDE[net_v45](../../../../../includes/net-v45-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="0faac-113">The following connection properties were added to SqlClient in [!INCLUDE[net_v45](../../../../../includes/net-v45-md.md)]:</span></span>  
  
-   `ApplicationIntent`  
  
-   `MultiSubnetFailover`  
  
 <span data-ttu-id="0faac-114">A livello di programmazione è possibile modificare queste parole chiave della stringa di connessione con:</span><span class="sxs-lookup"><span data-stu-id="0faac-114">You can programmatically modify these connection string keywords with:</span></span>  
  
1.  <xref:System.Data.SqlClient.SqlConnectionStringBuilder.ApplicationIntent%2A>  
  
2.  <xref:System.Data.SqlClient.SqlConnectionStringBuilder.MultiSubnetFailover%2A>  

> [!NOTE]
>  <span data-ttu-id="0faac-115">Impostazione `MultiSubnetFailover` a `true` non è necessario con [!INCLUDE[net_v461](../../../../../includes/net-v461-md.md)]) o versioni successive.</span><span class="sxs-lookup"><span data-stu-id="0faac-115">Setting `MultiSubnetFailover` to `true` isn't required with [!INCLUDE[net_v461](../../../../../includes/net-v461-md.md)]) or later versions.</span></span>
  
## <a name="connecting-with-multisubnetfailover"></a><span data-ttu-id="0faac-116">Connessione con MultiSubnetFailover</span><span class="sxs-lookup"><span data-stu-id="0faac-116">Connecting With MultiSubnetFailover</span></span>  
 <span data-ttu-id="0faac-117">Specificare sempre `MultiSubnetFailover=True` quando si stabilisce la connessione a un listener gruppo di disponibilità di [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012 o all'istanza del cluster di failover di [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012.</span><span class="sxs-lookup"><span data-stu-id="0faac-117">Always specify `MultiSubnetFailover=True` when connecting to a [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012 availability group listener or [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012 Failover Cluster Instance.</span></span> <span data-ttu-id="0faac-118">`MultiSubnetFailover` abilita il failover più veloce per tutti gruppi di disponibilità o per l'istanza del cluster di failover in [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012, riducendo notevolmente il tempo di failover per le topologie AlwaysOn con una o più subnet.</span><span class="sxs-lookup"><span data-stu-id="0faac-118">`MultiSubnetFailover` enables faster failover for all Availability Groups and or Failover Cluster Instance in [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012 and will significantly reduce failover time for single and multi-subnet AlwaysOn topologies.</span></span> <span data-ttu-id="0faac-119">Durante il failover di più subnet, il client tenterà di stabilire connessioni in parallelo.</span><span class="sxs-lookup"><span data-stu-id="0faac-119">During a multi-subnet failover, the client will attempt connections in parallel.</span></span> <span data-ttu-id="0faac-120">Durante il failover di una subnet, riproverà continuamente la connessione TCP.</span><span class="sxs-lookup"><span data-stu-id="0faac-120">During a subnet failover, will aggressively retry the TCP connection.</span></span>  
  
 <span data-ttu-id="0faac-121">La proprietà di connessione `MultiSubnetFailover` indica che l'applicazione viene distribuita in un gruppo di disponibilità o nell'istanza del cluster di failover di [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012 e che SqlClient tenterà di connettersi al database sull'istanza principale di [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)], tentando di connettersi a tutti gli indirizzi IP.</span><span class="sxs-lookup"><span data-stu-id="0faac-121">The `MultiSubnetFailover` connection property indicates that the application is being deployed in an availability group or [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012 Failover Cluster Instance and that SqlClient will try to connect to the database on the primary [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] instance by trying to connect to all the IP addresses.</span></span> <span data-ttu-id="0faac-122">Quando si specifica `MultiSubnetFailover=True` per una connessione, il client ripete i tentativi di connessione TCP più velocemente degli intervalli di ritrasmissione TCP predefiniti del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="0faac-122">When `MultiSubnetFailover=True` is specified for a connection, the client retries TCP connection attempts faster than the operating system’s default TCP retransmit intervals.</span></span> <span data-ttu-id="0faac-123">In questo modo viene abilitata la riconnessione più veloce dopo il failover di un gruppo di disponibilità AlwaysOn o di un'istanza del cluster di failover AlwaysOn ed è applicabile sia ai gruppi di disponibilità che alle istanze del cluster di failover con più subnet.</span><span class="sxs-lookup"><span data-stu-id="0faac-123">This enables faster reconnection after failover of either an AlwaysOn Availability Group or an AlwaysOn Failover Cluster Instance, and is applicable to both single- and multi-subnet Availability Groups and Failover Cluster Instances.</span></span>  
  
 <span data-ttu-id="0faac-124">Per altre informazioni sulle parole chiave della stringa di connessione in SqlClient, vedere <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A>.</span><span class="sxs-lookup"><span data-stu-id="0faac-124">For more information about connection string keywords in SqlClient, see <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A>.</span></span>  
  
 <span data-ttu-id="0faac-125">L'utilizzo di `MultiSubnetFailover=True` quando si stabilisce la connessione a un elemento diverso da un listener gruppo di disponibilità o da un'istanza del cluster di failover di [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012, può avere un impatto negativo sulle prestazioni e non è supportato.</span><span class="sxs-lookup"><span data-stu-id="0faac-125">Specifying `MultiSubnetFailover=True` when connecting to something other than a availability group listener or [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012 Failover Cluster Instance may result in a negative performance impact, and is not supported.</span></span>  
  
 <span data-ttu-id="0faac-126">Usare le linee guida seguenti per connettersi a un server in un gruppo di disponibilità o in un'istanza del cluster di failover di [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012:</span><span class="sxs-lookup"><span data-stu-id="0faac-126">Use the following guidelines to connect to a server in an availability group or [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012 Failover Cluster Instance:</span></span>  
  
-   <span data-ttu-id="0faac-127">Usare la proprietà di connessione `MultiSubnetFailover` quando ci si connette a una o più subnet per ottenere un miglioramento delle prestazioni di entrambi.</span><span class="sxs-lookup"><span data-stu-id="0faac-127">Use the `MultiSubnetFailover` connection property when connecting to a single subnet or multi-subnet; it will improve performance for both.</span></span>  
  
-   <span data-ttu-id="0faac-128">Per connettersi a un gruppo di disponibilità, specificare il listener gruppo di disponibilità come server nella stringa di connessione.</span><span class="sxs-lookup"><span data-stu-id="0faac-128">To connect to an availability group, specify the availability group listener of the availability group as the server in your connection string.</span></span>  
  
-   <span data-ttu-id="0faac-129">La connessione a un'istanza di [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] con più di 64 indirizzi IP genera un errore di connessione.</span><span class="sxs-lookup"><span data-stu-id="0faac-129">Connecting to a [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] instance configured with more than 64 IP addresses will cause a connection failure.</span></span>  
  
-   <span data-ttu-id="0faac-130">Il comportamento di un'applicazione che usa la proprietà di connessione `MultiSubnetFailover` non verrà modificato in base al tipo di autenticazione, ovvero autenticazione di [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)], autenticazione Kerberos o autenticazione di Windows.</span><span class="sxs-lookup"><span data-stu-id="0faac-130">Behavior of an application that uses the `MultiSubnetFailover` connection property is not affected based on the type of authentication: [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] Authentication, Kerberos Authentication, or Windows Authentication.</span></span>  
  
-   <span data-ttu-id="0faac-131">Aumentare il valore di `Connect Timeout` per adattarlo al tempo di failover e ridurre i tentativi di connessione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="0faac-131">Increase the value of `Connect Timeout` to accommodate for failover time and reduce application connection retry attempts.</span></span>  
  
-   <span data-ttu-id="0faac-132">Le transazioni distribuite non sono supportate.</span><span class="sxs-lookup"><span data-stu-id="0faac-132">Distributed transactions are not supported.</span></span>  
  
 <span data-ttu-id="0faac-133">Se il routing di sola lettura non è attivo, la connessione a un percorso di replica secondaria avrà esito negativo nelle seguenti situazioni:</span><span class="sxs-lookup"><span data-stu-id="0faac-133">If read-only routing is not in effect, connecting to a secondary replica location will fail in the following situations:</span></span>  
  
1.  <span data-ttu-id="0faac-134">Se il percorso di replica secondaria non è configurato per accettare connessioni.</span><span class="sxs-lookup"><span data-stu-id="0faac-134">If the secondary replica location is not configured to accept connections.</span></span>  
  
2.  <span data-ttu-id="0faac-135">Se un'applicazione usa `ApplicationIntent=ReadWrite` (illustrato di seguito) e il percorso di replica secondaria è configurato per l'accesso di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="0faac-135">If an application uses `ApplicationIntent=ReadWrite` (discussed below) and the secondary replica location is configured for read-only access.</span></span>  
  
 <span data-ttu-id="0faac-136"><xref:System.Data.SqlClient.SqlDependency> non è supportato per le repliche secondarie di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="0faac-136"><xref:System.Data.SqlClient.SqlDependency> is not supported on read-only secondary replicas.</span></span>  
  
 <span data-ttu-id="0faac-137">Una connessione non riuscirà se una replica primaria è configurata per rifiutare i carichi di lavoro di sola lettura e la stringa di connessione contiene `ApplicationIntent=ReadOnly`.</span><span class="sxs-lookup"><span data-stu-id="0faac-137">A connection will fail if a primary replica is configured to reject read-only workloads and the connection string contains `ApplicationIntent=ReadOnly`.</span></span>  
  
## <a name="upgrading-to-use-multi-subnet-clusters-from-database-mirroring"></a><span data-ttu-id="0faac-138">Aggiornamento per l'uso di cluster con più subnet dal mirroring del database</span><span class="sxs-lookup"><span data-stu-id="0faac-138">Upgrading to Use Multi-Subnet Clusters from Database Mirroring</span></span>  
 <span data-ttu-id="0faac-139">Si verificherà un errore di connessione (<xref:System.ArgumentException>) se nella stringa di connessione sono presenti le parole chiave di connessione `MultiSubnetFailover` e `Failover Partner` o se vengono usati `MultiSubnetFailover=True` e un protocollo diverso da TCP.</span><span class="sxs-lookup"><span data-stu-id="0faac-139">A connection error (<xref:System.ArgumentException>) will occur if the `MultiSubnetFailover` and `Failover Partner` connection keywords are present in the connection string, or if `MultiSubnetFailover=True` and a protocol other than TCP is used.</span></span> <span data-ttu-id="0faac-140">Si verificherà inoltre un errore (<xref:System.Data.SqlClient.SqlException>) se si usa `MultiSubnetFailover` e [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] restituisce una risposta di un partner di failover che ne indica l'appartenenza a una coppia di mirroring del database.</span><span class="sxs-lookup"><span data-stu-id="0faac-140">An error (<xref:System.Data.SqlClient.SqlException>) will also occur if `MultiSubnetFailover` is used and the [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] returns a failover partner response indicating it is part of a database mirroring pair.</span></span>  
  
 <span data-ttu-id="0faac-141">Se si aggiorna un'applicazione SqlClient che attualmente usa il mirroring del database in uno scenario con più subnet, è necessario rimuovere la proprietà di connessione `Failover Partner` e sostituirla con `MultiSubnetFailover` impostata su `True` e sostituire il nome del server nella stringa di connessione con un listener gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="0faac-141">If you upgrade a SqlClient application that currently uses database mirroring to a multi-subnet scenario, you should remove the `Failover Partner` connection property and replace it with `MultiSubnetFailover` set to `True` and replace the server name in the connection string with an availability group listener.</span></span> <span data-ttu-id="0faac-142">Se in una stringa di connessione si usa `Failover Partner` e `MultiSubnetFailover=True`, il driver genererà un errore.</span><span class="sxs-lookup"><span data-stu-id="0faac-142">If a connection string uses `Failover Partner` and `MultiSubnetFailover=True`, the driver will generate an error.</span></span> <span data-ttu-id="0faac-143">Se tuttavia in una stringa di connessione si usa `Failover Partner` e `MultiSubnetFailover=False` (o `ApplicationIntent=ReadWrite`), l'applicazione utilizzerà il mirroring del database.</span><span class="sxs-lookup"><span data-stu-id="0faac-143">However, if a connection string uses `Failover Partner` and `MultiSubnetFailover=False` (or `ApplicationIntent=ReadWrite`), the application will use database mirroring.</span></span>  
  
 <span data-ttu-id="0faac-144">Il driver restituirà un errore se il mirroring del database viene usato nel database primario del gruppo di disponibilità e se `MultiSubnetFailover=True` viene usata nella stringa di connessione che si connette a un database primario anziché a un listener gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="0faac-144">The driver will return an error if database mirroring is used on the primary database in the AG, and if `MultiSubnetFailover=True` is used in the connection string that connects to a primary database instead of to an availability group listener.</span></span>  
  
## <a name="specifying-application-intent"></a><span data-ttu-id="0faac-145">Impostazione della finalità dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="0faac-145">Specifying Application Intent</span></span>  
 <span data-ttu-id="0faac-146">Se `ApplicationIntent=ReadOnly`, il client richiede un carico di lavoro di lettura quando si connette a un database abilitato per AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="0faac-146">When `ApplicationIntent=ReadOnly`, the client requests a read workload when connecting to an AlwaysOn enabled database.</span></span> <span data-ttu-id="0faac-147">Il server applicherà la finalità al momento della connessione e durante un'istruzione USE del database, ma solo a un database abilitato per AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="0faac-147">The server will enforce the intent at connection time and during a USE database statement but only to an Always On enabled database.</span></span>  
  
 <span data-ttu-id="0faac-148">La parola chiave `ApplicationIntent` non funziona con i database legacy di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="0faac-148">The `ApplicationIntent` keyword does not work with legacy, read-only databases.</span></span>  
  
 <span data-ttu-id="0faac-149">Un database può consentire o non consentire carichi di lavoro di lettura nel database AlwaysOn di destinazione.</span><span class="sxs-lookup"><span data-stu-id="0faac-149">A database can allow or disallow read workloads on the targeted AlwaysOn database.</span></span> <span data-ttu-id="0faac-150">Questa operazione viene eseguita con la clausola `ALLOW_CONNECTIONS` delle istruzioni `PRIMARY_ROLE` e `SECONDARY_ROLE`[!INCLUDE[tsql](../../../../../includes/tsql-md.md)].</span><span class="sxs-lookup"><span data-stu-id="0faac-150">(This is done with the `ALLOW_CONNECTIONS` clause of the `PRIMARY_ROLE` and `SECONDARY_ROLE`[!INCLUDE[tsql](../../../../../includes/tsql-md.md)] statements.)</span></span>  
  
 <span data-ttu-id="0faac-151">La parola chiave `ApplicationIntent` viene usata per abilitare il routing di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="0faac-151">The `ApplicationIntent` keyword is used to enable read-only routing.</span></span>  
  
## <a name="read-only-routing"></a><span data-ttu-id="0faac-152">Routing di sola lettura</span><span class="sxs-lookup"><span data-stu-id="0faac-152">Read-Only Routing</span></span>  
 <span data-ttu-id="0faac-153">Il routing di sola lettura è una funzionalità che può garantire la disponibilità di una replica di sola lettura di un database.</span><span class="sxs-lookup"><span data-stu-id="0faac-153">Read-only routing is a feature that can ensure the availability of a read only replica of a database.</span></span> <span data-ttu-id="0faac-154">Per abilitare il routing di sola lettura:</span><span class="sxs-lookup"><span data-stu-id="0faac-154">To enable read-only routing:</span></span>  
  
1.  <span data-ttu-id="0faac-155">È necessario connettersi a un listener gruppo di disponibilità di un gruppo di disponibilità AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="0faac-155">You must connect to an Always On Availability Group availability group listener.</span></span>  
  
2.  <span data-ttu-id="0faac-156">La parola chiave della stringa di connessione `ApplicationIntent` deve essere impostata su `ReadOnly`.</span><span class="sxs-lookup"><span data-stu-id="0faac-156">The `ApplicationIntent` connection string keyword must be set to `ReadOnly`.</span></span>  
  
3.  <span data-ttu-id="0faac-157">Il gruppo di disponibilità deve essere configurato dall'amministratore del database in modo da abilitare il routing di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="0faac-157">The Availability Group must be configured by the database administrator to enable read-only routing.</span></span>  
  
 <span data-ttu-id="0faac-158">È possibile che più connessioni che usano il routing di sola lettura non si connettano tutte alla stessa replica di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="0faac-158">It is possible that multiple connections using read-only routing will not all connect to the same read-only replica.</span></span> <span data-ttu-id="0faac-159">Le modifiche apportate alla sincronizzazione del database o alla configurazione del routing del server possono comportare connessioni client a repliche di sola lettura diverse.</span><span class="sxs-lookup"><span data-stu-id="0faac-159">Changes in database synchronization or changes in the server's routing configuration can result in client connections to different read-only replicas.</span></span> <span data-ttu-id="0faac-160">Per accertarsi che tutte le richieste di sola lettura si connettano alla stessa replica di sola lettura, non passare un listener gruppo di disponibilità alla parola chiave della stringa di connessione `Data Source`.</span><span class="sxs-lookup"><span data-stu-id="0faac-160">To ensure that all read-only requests connect to the same read-only replica, do not pass an availability group listener to the `Data Source` connection string keyword.</span></span> <span data-ttu-id="0faac-161">Specificare invece il nome dell'istanza di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="0faac-161">Instead, specify the name of the read-only instance.</span></span>  
  
 <span data-ttu-id="0faac-162">Il routing di sola lettura può richiedere più tempo rispetto alla connessione al database primario, poiché il routing di sola lettura si connette innanzitutto al database primario, quindi effettua la ricerca del miglior database secondario leggibile disponibile.</span><span class="sxs-lookup"><span data-stu-id="0faac-162">Read-only routing may take longer than connecting to the primary because read only routing first connects to the primary and then looks for the best available readable secondary.</span></span> <span data-ttu-id="0faac-163">Per questo motivo, è necessario aumentare il timeout di accesso.</span><span class="sxs-lookup"><span data-stu-id="0faac-163">Because of this, you should increase your login timeout.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0faac-164">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="0faac-164">See Also</span></span>  
 [<span data-ttu-id="0faac-165">Funzionalità di SQL Server e ADO.NET</span><span class="sxs-lookup"><span data-stu-id="0faac-165">SQL Server Features and ADO.NET</span></span>](../../../../../docs/framework/data/adonet/sql/sql-server-features-and-adonet.md)  
 [<span data-ttu-id="0faac-166">Provider gestiti ADO.NET e Centro per sviluppatori di set di dati</span><span class="sxs-lookup"><span data-stu-id="0faac-166">ADO.NET Managed Providers and DataSet Developer Center</span></span>](http://go.microsoft.com/fwlink/?LinkId=217917)
