---
title: Esecuzione di query tra relazioni
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 297878d0-685b-4c01-b2e0-9d731b7322bc
ms.openlocfilehash: 2e1cf9efcf47fc70421c64541aead5fb36d8c9d1
ms.sourcegitcommit: 5b6d778ebb269ee6684fb57ad69a8c28b06235b9
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/08/2019
ms.locfileid: "59083153"
---
# <a name="querying-across-relationships"></a><span data-ttu-id="21570-102">Esecuzione di query tra relazioni</span><span class="sxs-lookup"><span data-stu-id="21570-102">Querying Across Relationships</span></span>
<span data-ttu-id="21570-103">I riferimenti ad altri oggetti o raccolte di altri oggetti nelle definizioni della classe corrispondono direttamente alle relazioni di chiavi esterne nel database.</span><span class="sxs-lookup"><span data-stu-id="21570-103">References to other objects or collections of other objects in your class definitions directly correspond to foreign-key relationships in the database.</span></span> <span data-ttu-id="21570-104">È possibile usare queste relazioni quando si esegue una query usando la notazione del punto per accedere alle proprietà della relazione e spostarsi tra gli oggetti.</span><span class="sxs-lookup"><span data-stu-id="21570-104">You can use these relationships when you query by using dot notation to access the relationship properties and navigate from one object to another.</span></span> <span data-ttu-id="21570-105">Queste operazioni di accesso vengono convertite in join più complessi o sottoquery correlate nell'equivalente SQL.</span><span class="sxs-lookup"><span data-stu-id="21570-105">These access operations translate to more complex joins or correlated subqueries in the equivalent SQL.</span></span>  
  
 <span data-ttu-id="21570-106">Ad esempio, usando la query seguente è possibile spostarsi da ordini a clienti per limitare i risultati solo agli ordini per i clienti residenti nell'area londinese.</span><span class="sxs-lookup"><span data-stu-id="21570-106">For example, the following query navigates from orders to customers as a way to restrict the results to only those orders for customers located in London.</span></span>  
  
 [!code-csharp[DLinqQueryConcepts#3](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQueryConcepts/cs/Program.cs#3)]
 [!code-vb[DLinqQueryConcepts#3](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQueryConcepts/vb/Module1.vb#3)]  
  
 <span data-ttu-id="21570-107">Se le proprietà della relazione non esiste, è necessario scriverle manualmente come *join*, esattamente come si farebbe in una query SQL, come nel codice seguente:</span><span class="sxs-lookup"><span data-stu-id="21570-107">If relationship properties did not exist you would have to write them manually as *joins*, just as you would do in a SQL query, as in the following code:</span></span>  
  
 [!code-csharp[DLinqQueryConcepts#4](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQueryConcepts/cs/Program.cs#4)]
 [!code-vb[DLinqQueryConcepts#4](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQueryConcepts/vb/Module1.vb#4)]  
  
 <span data-ttu-id="21570-108">È possibile usare la *relazione* proprietà per definire questa particolare relazione una sola volta.</span><span class="sxs-lookup"><span data-stu-id="21570-108">You can use the *relationship* property to define this particular relationship one time.</span></span> <span data-ttu-id="21570-109">quindi usare la più pratica sintassi del punto.</span><span class="sxs-lookup"><span data-stu-id="21570-109">You can then use the more convenient dot syntax.</span></span> <span data-ttu-id="21570-110">Le proprietà della relazione esistono tuttavia soprattutto perché i modelli a oggetti specifici del dominio sono in genere definiti come gerarchie o grafici.</span><span class="sxs-lookup"><span data-stu-id="21570-110">But relationship properties exist more importantly because domain-specific object models are typically defined as hierarchies or graphs.</span></span> <span data-ttu-id="21570-111">Gli oggetti usati nella programmazione dispongono di riferimenti ad altri oggetti.</span><span class="sxs-lookup"><span data-stu-id="21570-111">The objects that you program against have references to other objects.</span></span> <span data-ttu-id="21570-112">È solo una coincidenza che le relazioni da oggetto a oggetto corrispondano alle relazioni di tipo chiave esterna nei database.</span><span class="sxs-lookup"><span data-stu-id="21570-112">It is only a happy coincidence that object-to-object relationships correspond to foreign-key-styled relationships in databases.</span></span> <span data-ttu-id="21570-113">L'accesso alle proprietà offre quindi un modo pratico per scrivere join.</span><span class="sxs-lookup"><span data-stu-id="21570-113">Property access then provides a convenient way to write joins.</span></span>  
  
 <span data-ttu-id="21570-114">A questo riguardo, le proprietà della relazione sono più importanti sul lato dei risultati di una query anziché nella query stessa.</span><span class="sxs-lookup"><span data-stu-id="21570-114">With regard to this, relationship properties are more important on the results side of a query than as part of the query itself.</span></span> <span data-ttu-id="21570-115">Dopo il recupero dei dati su un cliente particolare tramite la query, la definizione della classe indica che sono presenti ordini.</span><span class="sxs-lookup"><span data-stu-id="21570-115">After the query has retrieved data about a particular customer, the class definition indicates that customers have orders.</span></span> <span data-ttu-id="21570-116">In altre parole, si prevede che la proprietà `Orders` di un particolare cliente sia una raccolta popolata con tutti gli ordini di tale cliente.</span><span class="sxs-lookup"><span data-stu-id="21570-116">In other words, you expect the `Orders` property of a particular customer to be a collection that is populated with all the orders from that customer.</span></span> <span data-ttu-id="21570-117">Si tratta in effetti del contratto dichiarato definendo le classi in questo modo.</span><span class="sxs-lookup"><span data-stu-id="21570-117">That is in fact the contract you declared by defining the classes in this manner.</span></span> <span data-ttu-id="21570-118">Si prevede che nei risultati siano inclusi gli ordini, anche se non sono stati espressamente richiesti nella query.</span><span class="sxs-lookup"><span data-stu-id="21570-118">You expect to see the orders there even if the query did not request orders.</span></span> <span data-ttu-id="21570-119">Si prevede che il modello a oggetti appaia come un'estensione in memoria del database con gli oggetti correlati immediatamente disponibili.</span><span class="sxs-lookup"><span data-stu-id="21570-119">You expect your object model to maintain an illusion that it is an in-memory extension of the database with related objects immediately available.</span></span>  
  
 <span data-ttu-id="21570-120">Dopo avere creato le relazioni, è possibile scrivere query facendo riferimento alle proprietà delle relazioni definite nelle classi.</span><span class="sxs-lookup"><span data-stu-id="21570-120">Now that you have relationships, you can write queries by referring to the relationship properties defined in your classes.</span></span> <span data-ttu-id="21570-121">Questi riferimenti alle relazioni corrispondono alle relazioni di chiave esterna nel database.</span><span class="sxs-lookup"><span data-stu-id="21570-121">These relationship references correspond to foreign-key relationships in the database.</span></span> <span data-ttu-id="21570-122">Le operazioni che usano queste relazioni vengono convertite in join più complessi nell'equivalente SQL.</span><span class="sxs-lookup"><span data-stu-id="21570-122">Operations that use these relationships translate to more complex joins in the equivalent SQL.</span></span> <span data-ttu-id="21570-123">A condizione che sia stata definita una relazione usando l'attributo <xref:System.Data.Linq.Mapping.AssociationAttribute>, non sarà necessario codificare un join esplicito in [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)].</span><span class="sxs-lookup"><span data-stu-id="21570-123">As long as you have defined a relationship (using the <xref:System.Data.Linq.Mapping.AssociationAttribute> attribute), you do not have to code an explicit join in [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)].</span></span>  
  
 <span data-ttu-id="21570-124">Per mantenere questa apparenza [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] implementa una tecnica denominata *caricamento posticipato*.</span><span class="sxs-lookup"><span data-stu-id="21570-124">To help maintain this illusion, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] implements a technique called *deferred loading*.</span></span> <span data-ttu-id="21570-125">Per altre informazioni, vedere [posticipato e immediato caricamento](../../../../../../docs/framework/data/adonet/sql/linq/deferred-versus-immediate-loading.md).</span><span class="sxs-lookup"><span data-stu-id="21570-125">For more information, see [Deferred versus Immediate Loading](../../../../../../docs/framework/data/adonet/sql/linq/deferred-versus-immediate-loading.md).</span></span>  
  
 <span data-ttu-id="21570-126">Si consideri la query SQL seguente per un elenco di progetti `CustomerID` - `OrderID` coppie:</span><span class="sxs-lookup"><span data-stu-id="21570-126">Consider the following SQL query to project a list of `CustomerID`-`OrderID` pairs:</span></span>  
  
```  
SELECT t0.CustomerID, t1.OrderID  
FROM   Customers AS t0 INNER JOIN  
          Orders AS t1 ON t0.CustomerID = t1.CustomerID  
WHERE  (t0.City = @p0)  
```  
  
 <span data-ttu-id="21570-127">Per ottenere gli stessi risultati tramite [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)], usare il riferimento alla proprietà `Orders` esistente nella classe `Customer`.</span><span class="sxs-lookup"><span data-stu-id="21570-127">To obtain the same results by using [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)], you use the `Orders` property reference already existing in the `Customer` class.</span></span> <span data-ttu-id="21570-128">Il `Orders` riferimento fornisce le informazioni necessarie per eseguire la query e creare le `CustomerID` - `OrderID` coppie, come nel codice seguente:</span><span class="sxs-lookup"><span data-stu-id="21570-128">The `Orders` reference provides the necessary information to execute the query and project the `CustomerID`-`OrderID` pairs, as in the following code:</span></span>  
  
 [!code-csharp[DLinqQueryConcepts#5](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQueryConcepts/cs/Program.cs#5)]
 [!code-vb[DLinqQueryConcepts#5](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQueryConcepts/vb/Module1.vb#5)]  
  
 <span data-ttu-id="21570-129">È inoltre possibile procedere in senso inverso,</span><span class="sxs-lookup"><span data-stu-id="21570-129">You can also do the reverse.</span></span> <span data-ttu-id="21570-130">ovvero eseguire una query su `Orders` e usare il relativo riferimento alla relazione di `Customer` per accedere alle informazioni sull'oggetto `Customer` associato.</span><span class="sxs-lookup"><span data-stu-id="21570-130">That is, you can query `Orders` and use its `Customer` relationship reference to access information about the associated `Customer` object.</span></span> <span data-ttu-id="21570-131">Il codice seguente vengono proiettate le stesse `CustomerID` - `OrderID` coppie eseguendo una query come indicato in precedenza, ma questa volta `Orders` invece di `Customers`.</span><span class="sxs-lookup"><span data-stu-id="21570-131">The following code projects the same `CustomerID`-`OrderID` pairs as before, but this time by querying `Orders` instead of `Customers`.</span></span>  
  
 [!code-csharp[DLinqQueryConcepts#6](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQueryConcepts/cs/Program.cs#6)]
 [!code-vb[DLinqQueryConcepts#6](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQueryConcepts/vb/Module1.vb#6)]  
  
## <a name="see-also"></a><span data-ttu-id="21570-132">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="21570-132">See also</span></span>

- [<span data-ttu-id="21570-133">Concetti relatici alle query</span><span class="sxs-lookup"><span data-stu-id="21570-133">Query Concepts</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/query-concepts.md)
