---
title: Caricamento di contenuto posticipato (WCF Data Services)
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- WCF Data Services, client library
- WCF Data Services, deferred content
- WCF Data Services, loading data
ms.assetid: 32f9b588-c832-44c4-a7e0-fcce635df59a
ms.openlocfilehash: 8ab4dea9e4f687f9548bb2b46a8f6baf428e29af
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/04/2018
ms.locfileid: "33365202"
---
# <a name="loading-deferred-content-wcf-data-services"></a><span data-ttu-id="1d1e1-102">Caricamento di contenuto posticipato (WCF Data Services)</span><span class="sxs-lookup"><span data-stu-id="1d1e1-102">Loading Deferred Content (WCF Data Services)</span></span>
<span data-ttu-id="1d1e1-103">Per impostazione predefinita, [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] limita la quantità di dati restituiti da una query.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-103">By default, [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] limits the amount of data that a query returns.</span></span> <span data-ttu-id="1d1e1-104">Se necessario, dal servizio dati è tuttavia possibile caricare in modo esplicito dati aggiuntivi, tra cui entità correlate, dati di risposta di paging e flussi di dati binari.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-104">However, you can explicitly load additional data, including related entities, paged response data, and binary data streams, from the data service when it is needed.</span></span> <span data-ttu-id="1d1e1-105">In questo argomento viene descritto come caricare questo tipo di contenuto posticipato nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-105">This topic describes how to load such deferred content into your application.</span></span>  
  
## <a name="related-entities"></a><span data-ttu-id="1d1e1-106">Entità correlate</span><span class="sxs-lookup"><span data-stu-id="1d1e1-106">Related Entities</span></span>  
 <span data-ttu-id="1d1e1-107">Quando si esegue una query, vengono restituite solo le entità incluse nel set di entità indirizzato.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-107">When you execute a query, only entities in the addressed entity set are returned.</span></span> <span data-ttu-id="1d1e1-108">Ad esempio, quando una query eseguita sul servizio dati Northwind restituisce le entità `Customers`, per impostazione predefinita non vengono restituite le entità `Orders` correlate, anche se esiste una relazione tra `Customers` e `Orders`.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-108">For example, when a query against the Northwind data service returns `Customers` entities, by default the related `Orders` entities are not returned, even though there is a relationship between `Customers` and `Orders`.</span></span> <span data-ttu-id="1d1e1-109">Inoltre, quando nel servizio dati è abilitato il paging, è necessario caricare in modo esplicito le pagine di dati successive dal servizio.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-109">Also, when paging is enabled in the data service, you must explicitly load subsequent data pages from the service.</span></span> <span data-ttu-id="1d1e1-110">Per caricare le entità correlate è possibile usare due modi:</span><span class="sxs-lookup"><span data-stu-id="1d1e1-110">There are two ways to load related entities:</span></span>  
  
-   <span data-ttu-id="1d1e1-111">**Caricamento eager**: È possibile utilizzare il `$expand` opzione di query per richiedere che la query restituisca le entità correlate da un'associazione per l'entità impostare che la query richiesta.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-111">**Eager loading**: You can use the `$expand` query option to request that the query return entities that are related by an association to the entity set that the query requested.</span></span> <span data-ttu-id="1d1e1-112">Usare il metodo <xref:System.Data.Services.Client.DataServiceQuery%601.Expand%2A> su <xref:System.Data.Services.Client.DataServiceQuery%601> per aggiungere l'opzione `$expand` alla query inviata al servizio dati.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-112">Use the <xref:System.Data.Services.Client.DataServiceQuery%601.Expand%2A> method on the <xref:System.Data.Services.Client.DataServiceQuery%601> to add the `$expand` option to the query that is sent to the data service.</span></span> <span data-ttu-id="1d1e1-113">È possibile richiedere più set di entità correlati separandoli con una virgola, come illustrato nell'esempio seguente.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-113">You can request multiple related entity sets by separating them by a comma, as in the following example.</span></span> <span data-ttu-id="1d1e1-114">Tutte le entità richieste dalla query vengono restituite in un'unica risposta.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-114">All entities requested by the query are returned in a single response.</span></span> <span data-ttu-id="1d1e1-115">Nell'esempio seguente vengono restituiti `Order_Details` e `Customers` insieme al set di entità `Orders`:</span><span class="sxs-lookup"><span data-stu-id="1d1e1-115">The following example returns `Order_Details` and `Customers` together with the `Orders` entity set:</span></span>  
  
     [!code-csharp[Astoria Northwind Client#ExpandOrderDetailsSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#expandorderdetailsspecific)]
     [!code-vb[Astoria Northwind Client#ExpandOrderDetailsSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#expandorderdetailsspecific)]  
  
     <span data-ttu-id="1d1e1-116">In [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] il numero di set di entità che possono essere inclusi in una sola query è limitato a 12 tramite l'opzione query `$expand`.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-116">[!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] limits to 12 the number of entity sets that can be included in a single query by using the `$expand` query option.</span></span>  
  
-   <span data-ttu-id="1d1e1-117">**Caricamento esplicito**: È possibile chiamare il <xref:System.Data.Services.Client.DataServiceContext.LoadProperty%2A> metodo sul <xref:System.Data.Services.Client.DataServiceContext> istanza da caricare in modo esplicito le entità correlate.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-117">**Explicit loading**: You can call the <xref:System.Data.Services.Client.DataServiceContext.LoadProperty%2A> method on the <xref:System.Data.Services.Client.DataServiceContext> instance to explicitly load related entities.</span></span> <span data-ttu-id="1d1e1-118">Ogni chiamata del metodo <xref:System.Data.Services.Client.DataServiceContext.LoadProperty%2A> determina la creazione di una richiesta distinta al servizio dati.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-118">Each call to the <xref:System.Data.Services.Client.DataServiceContext.LoadProperty%2A> method creates a separate request to the data service.</span></span> <span data-ttu-id="1d1e1-119">Nell'esempio seguente viene caricato in modo esplicito `Order_Details` per un'entità `Orders`.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-119">The following example explicitly loads `Order_Details` for an `Orders` entity:</span></span>  
  
     [!code-csharp[Astoria Northwind Client#LoadRelatedOrderDetailsSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#loadrelatedorderdetailsspecific)]
     [!code-vb[Astoria Northwind Client#LoadRelatedOrderDetailsSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#loadrelatedorderdetailsspecific)]  
  
 <span data-ttu-id="1d1e1-120">Nella scelta dell'opzione da usare tener presente che è possibile un compromesso tra il numero di richieste per il servizio dati e la quantità di dati restituiti in una singola risposta.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-120">When you consider which option to use, realize that there is a tradeoff between the number of requests to the data service and the amount of data that is returned in a single response.</span></span> <span data-ttu-id="1d1e1-121">Usare il caricamento eager quando l'applicazione richiede oggetti associati e si desidera evitare la latenza aggiunta per le richieste supplementari necessaria per il loro recupero in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-121">Use eager loading when your application requires associated objects and you want to avoid the added latency of additional requests to explicitly retrieve them.</span></span> <span data-ttu-id="1d1e1-122">Tuttavia, se vi sono casi in cui l'applicazione necessita solo dei dati per le istanze di entità correlate specifiche, considerare la possibilità di caricare in modo esplicito tali entità chiamando il metodo <xref:System.Data.Services.Client.DataServiceContext.LoadProperty%2A>.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-122">However, if there are cases when the application only needs the data for specific related entity instances, you should consider explicitly loading those entities by calling the <xref:System.Data.Services.Client.DataServiceContext.LoadProperty%2A> method.</span></span> <span data-ttu-id="1d1e1-123">Per ulteriori informazioni, vedere [procedura: caricamento di entità correlate](../../../../docs/framework/data/wcf/how-to-load-related-entities-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="1d1e1-123">For more information, see [How to: Load Related Entities](../../../../docs/framework/data/wcf/how-to-load-related-entities-wcf-data-services.md).</span></span>  
  
## <a name="paged-content"></a><span data-ttu-id="1d1e1-124">Contenuto di paging</span><span class="sxs-lookup"><span data-stu-id="1d1e1-124">Paged Content</span></span>  
 <span data-ttu-id="1d1e1-125">Quando nel servizio dati è abilitato il paging, il numero di voci incluse nel feed restituito dal servizio dati è limitato dalla configurazione del servizio dati.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-125">When paging is enabled in the data service, the number of entries in the feed that the data service returns is limited by the configuration of the data service.</span></span> <span data-ttu-id="1d1e1-126">È possibile impostare i limiti di paging separatamente per ogni set di entità.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-126">Page limits can be set separately for each entity set.</span></span> <span data-ttu-id="1d1e1-127">Per ulteriori informazioni, vedere [configurazione del servizio dati](../../../../docs/framework/data/wcf/configuring-the-data-service-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="1d1e1-127">For more information, see [Configuring the Data Service](../../../../docs/framework/data/wcf/configuring-the-data-service-wcf-data-services.md).</span></span> <span data-ttu-id="1d1e1-128">Quando il paging è abilitato, la voce finale nel feed contiene un collegamento alla pagina di dati successiva.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-128">When paging is enabled, the final entry in the feed contains a link to the next page of data.</span></span> <span data-ttu-id="1d1e1-129">Questo collegamento è incluso in un oggetto <xref:System.Data.Services.Client.DataServiceQueryContinuation%601>.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-129">This link is contained in a <xref:System.Data.Services.Client.DataServiceQueryContinuation%601> object.</span></span> <span data-ttu-id="1d1e1-130">È possibile ottenere l'URI della pagina successiva di dati chiamando il metodo <xref:System.Data.Services.Client.QueryOperationResponse%601.GetContinuation%2A> sull'oggetto <xref:System.Data.Services.Client.QueryOperationResponse%601> restituito durante l'esecuzione di <xref:System.Data.Services.Client.DataServiceQuery%601>.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-130">You obtain the URI to the next page of data by calling the <xref:System.Data.Services.Client.QueryOperationResponse%601.GetContinuation%2A> method on the <xref:System.Data.Services.Client.QueryOperationResponse%601> returned when the <xref:System.Data.Services.Client.DataServiceQuery%601> is executed.</span></span> <span data-ttu-id="1d1e1-131">L'oggetto <xref:System.Data.Services.Client.DataServiceQueryContinuation%601> restituito viene quindi usato per caricare la pagina di risultati successiva.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-131">The returned <xref:System.Data.Services.Client.DataServiceQueryContinuation%601> object is then used to load the next page of results.</span></span> <span data-ttu-id="1d1e1-132">Prima di chiamare il metodo <xref:System.Data.Services.Client.QueryOperationResponse%601.GetContinuation%2A>, è necessario enumerare i risultati della query.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-132">You must enumerate the query result before you call the <xref:System.Data.Services.Client.QueryOperationResponse%601.GetContinuation%2A> method.</span></span> <span data-ttu-id="1d1e1-133">Considerare la possibilità di usare un ciclo `do…while` per enumerare innanzitutto i risultati della query e verificare quindi se il valore del collegamento successivo corrisponde a `non-null`.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-133">Consider using a `do…while` loop to first enumerate the query result and then check for a `non-null` next link value.</span></span> <span data-ttu-id="1d1e1-134">Quando il metodo <xref:System.Data.Services.Client.QueryOperationResponse%601.GetContinuation%2A> restituisce `null` (`Nothing` in Visual Basic), significa che per la query originale non sono disponibili pagine di risultati aggiuntive.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-134">When the <xref:System.Data.Services.Client.QueryOperationResponse%601.GetContinuation%2A> method returns `null` (`Nothing` in Visual Basic), there are no additional result pages for the original query.</span></span> <span data-ttu-id="1d1e1-135">Nell'esempio seguente viene illustrato un ciclo `do…while` che carica i dati dei clienti di cui è stato eseguito il paging dal servizio dati Northwind di esempio.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-135">The following example shows a `do…while` loop that loads paged customer data from the Northwind sample data service.</span></span>  
  
 [!code-csharp[Astoria Northwind Client#LoadNextLink](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#loadnextlink)]
 [!code-vb[Astoria Northwind Client#LoadNextLink](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#loadnextlink)]  
  
 <span data-ttu-id="1d1e1-136">Quando una query richiede che le entità correlate vengano restituite in un'unica risposta insieme al set di entità richiesto, è possibile che i limiti di paging abbiano effetto sui feed annidati inclusi inline con la risposta.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-136">When a query requests that related entities are returned in a single response together with the requested entity set, paging limits may affect nested feeds that are included inline with the response.</span></span> <span data-ttu-id="1d1e1-137">Ad esempio, quando un limite di paging viene impostato nel servizio dati Northwind di esempio per il set di entità `Customers`, è inoltre possibile impostare un limite di paging indipendente per il set di entità `Orders` correlato, come illustrato nell'esempio seguente relativo al file Northwind.svc.cs che definisce il servizio dati Northwind di esempio.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-137">For example, when a paging limit is set in the Northwind sample data service for the `Customers` entity set, an independent paging limit can also be set for the related `Orders` entity set, as in the following example from the Northwind.svc.cs file that defines the Northwind sample data service.</span></span>  
  
 [!code-csharp[Astoria Northwind Service#DataServiceConfigPaging](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind service/cs/northwind.svc.cs#dataserviceconfigpaging)]
 [!code-vb[Astoria Northwind Service#DataServiceConfigPaging](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind service/vb/northwind.svc.vb#dataserviceconfigpaging)]  
  
 <span data-ttu-id="1d1e1-138">In questo caso, sarà necessario implementare il paging per i feed dell'entità `Customers` di primo livello e feed dell'entità `Orders` annidati.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-138">In this case, you must implement paging for both the top-level `Customers` and the nested `Orders` entity feeds.</span></span> <span data-ttu-id="1d1e1-139">Nell'esempio seguente viene illustrato il ciclo `while` usato per caricare pagine di entità `Orders` correlate a un'entità `Customers` selezionata.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-139">The following example shows the `while` loop used to load pages of `Orders` entities related to a selected `Customers` entity.</span></span>  
  
 [!code-csharp[Astoria Northwind Client#LoadNextOrdersLink](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#loadnextorderslink)]
 [!code-vb[Astoria Northwind Client#LoadNextOrdersLink](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#loadnextorderslink)]  
  
 <span data-ttu-id="1d1e1-140">Per ulteriori informazioni, vedere [come: risultati di paging carico](../../../../docs/framework/data/wcf/how-to-load-paged-results-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="1d1e1-140">For more information, see [How to: Load Paged Results](../../../../docs/framework/data/wcf/how-to-load-paged-results-wcf-data-services.md).</span></span>  
  
## <a name="binary-data-streams"></a><span data-ttu-id="1d1e1-141">Flussi di dati binari</span><span class="sxs-lookup"><span data-stu-id="1d1e1-141">Binary Data Streams</span></span>  
 [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)]<span data-ttu-id="1d1e1-142"> consente di accedere a dati BLOB (Binary Large Object) come flusso di dati.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-142"> enables you to access binary large object (BLOB) data as a data stream.</span></span> <span data-ttu-id="1d1e1-143">Il flusso posticipa il caricamento dei dati binari fino al momento opportuno per consentire al client di elaborare i dati in maniera più efficiente.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-143">Streaming defers the loading of binary data until it is needed, and the client can more efficiently process this data.</span></span> <span data-ttu-id="1d1e1-144">Per trarre vantaggio da questa funzionalità, il servizio dati deve implementare il provider <xref:System.Data.Services.Providers.IDataServiceStreamProvider>.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-144">In order to take advantage of this functionality, the data service must implement the <xref:System.Data.Services.Providers.IDataServiceStreamProvider> provider.</span></span> <span data-ttu-id="1d1e1-145">Per ulteriori informazioni, vedere [Provider di flusso](../../../../docs/framework/data/wcf/streaming-provider-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="1d1e1-145">For more information, see [Streaming Provider](../../../../docs/framework/data/wcf/streaming-provider-wcf-data-services.md).</span></span> <span data-ttu-id="1d1e1-146">Quando il flusso è abilitato, i tipi di entità vengono restituiti senza i dati binari correlati.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-146">When streaming is enabled, entity types are returned without the related binary data.</span></span> <span data-ttu-id="1d1e1-147">In questo caso, è necessario utilizzare il <xref:System.Data.Services.Client.DataServiceContext.GetReadStream%2A> metodo la <xref:System.Data.Services.Client.DataServiceContext> classe per accedere al flusso di dati per i dati binari dal servizio.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-147">In this case, you must use the <xref:System.Data.Services.Client.DataServiceContext.GetReadStream%2A> method of the <xref:System.Data.Services.Client.DataServiceContext> class to access the data stream for the binary data from the service.</span></span> <span data-ttu-id="1d1e1-148">In modo analogo, usare il metodo <xref:System.Data.Services.Client.DataServiceContext.SetSaveStream%2A> per aggiungere o modificare i dati binari di un'entità come flusso.</span><span class="sxs-lookup"><span data-stu-id="1d1e1-148">Similarly, use the <xref:System.Data.Services.Client.DataServiceContext.SetSaveStream%2A> method to add or change binary data for an entity as a stream.</span></span> <span data-ttu-id="1d1e1-149">Per ulteriori informazioni, vedere [funziona con dati binari](../../../../docs/framework/data/wcf/working-with-binary-data-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="1d1e1-149">For more information, see [Working with Binary Data](../../../../docs/framework/data/wcf/working-with-binary-data-wcf-data-services.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1d1e1-150">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="1d1e1-150">See Also</span></span>  
 [<span data-ttu-id="1d1e1-151">Libreria client WCF Data Services</span><span class="sxs-lookup"><span data-stu-id="1d1e1-151">WCF Data Services Client Library</span></span>](../../../../docs/framework/data/wcf/wcf-data-services-client-library.md)  
 [<span data-ttu-id="1d1e1-152">Esecuzione di query sul servizio dati</span><span class="sxs-lookup"><span data-stu-id="1d1e1-152">Querying the Data Service</span></span>](../../../../docs/framework/data/wcf/querying-the-data-service-wcf-data-services.md)
