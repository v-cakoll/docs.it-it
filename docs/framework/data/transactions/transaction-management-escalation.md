---
title: Escalation della gestione delle transazioni
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 1e96331e-31b6-4272-bbbd-29ed1e110460
caps.latest.revision: "3"
author: Erikre
ms.author: erikre
manager: erikre
ms.openlocfilehash: 0ac45390d78f4fbce15c8910fcdcc95713c5898a
ms.sourcegitcommit: bd1ef61f4bb794b25383d3d72e71041a5ced172e
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/18/2017
---
# <a name="transaction-management-escalation"></a><span data-ttu-id="6f4c9-102">Escalation della gestione delle transazioni</span><span class="sxs-lookup"><span data-stu-id="6f4c9-102">Transaction Management Escalation</span></span>
<span data-ttu-id="6f4c9-103">In Windows è disponibile un set di servizi e moduli che costituisce una gestione transazioni.</span><span class="sxs-lookup"><span data-stu-id="6f4c9-103">Windows hosts a set of services and modules that together constitute a transaction manager.</span></span> <span data-ttu-id="6f4c9-104">L'escalation della gestione transazioni consiste nel migrare una transazione da un componente di gestione transazioni a un altro.</span><span class="sxs-lookup"><span data-stu-id="6f4c9-104">Transaction management escalation describes the process of migrating a transaction from one of the transaction manager's components to another.</span></span>  
  
 <span data-ttu-id="6f4c9-105">Lo spazio dei nomi <xref:System.Transactions> comprende un componente di gestione transazioni finalizzato a coordinare una transazione che prevede al più un'unica risorsa durevole o più risorse volatili.</span><span class="sxs-lookup"><span data-stu-id="6f4c9-105"><xref:System.Transactions> includes a transaction manager component that coordinates a transaction involving at most, a single durable resource or multiple volatile resources.</span></span> <span data-ttu-id="6f4c9-106">La gestione transazioni offre le migliori prestazioni, in quanto esegue chiamate che riguardano esclusivamente un determinato dominio applicazione.</span><span class="sxs-lookup"><span data-stu-id="6f4c9-106">Because the transaction manager uses only intra-application domain calls, it yields the best performance.</span></span> <span data-ttu-id="6f4c9-107">Gli sviluppatori possono evitare di interagire direttamente con la gestione transazioni,</span><span class="sxs-lookup"><span data-stu-id="6f4c9-107">Developers need not interact with the transaction manager directly.</span></span> <span data-ttu-id="6f4c9-108">in quanto lo spazio dei nomi <xref:System.Transactions> fornisce un'infrastruttura comune che definisce interfacce, comportamenti comuni e classi helper.</span><span class="sxs-lookup"><span data-stu-id="6f4c9-108">Instead, a common infrastructure that defines interfaces, common behavior, and helper classes is provided by the <xref:System.Transactions> namespace.</span></span>  
  
 <span data-ttu-id="6f4c9-109">Quando si desidera fornire la transazione a un oggetto in un altro dominio applicazione (inclusi attraverso i limiti di processo e del computer) nello stesso computer, il <xref:System.Transactions> infrastruttura inoltra automaticamente la transazione deve essere gestito da Microsoft Distributed Transaction Coordinator (MSDTC).</span><span class="sxs-lookup"><span data-stu-id="6f4c9-109">When you want to provide the transaction to an object in another application domain (including across process and machine boundaries) on the same computer, the <xref:System.Transactions> infrastructure automatically escalates the transaction to be managed by the Microsoft Distributed Transaction Coordinator (MSDTC).</span></span> <span data-ttu-id="6f4c9-110">L'escalation si verifica anche quando si integra un altro gestore di risorse durevoli.</span><span class="sxs-lookup"><span data-stu-id="6f4c9-110">The escalation also occurs if you enlist another durable resource manager.</span></span> <span data-ttu-id="6f4c9-111">Dopo l'escalation, la transazione viene gestita nello stato superiore fino al suo completamento.</span><span class="sxs-lookup"><span data-stu-id="6f4c9-111">When escalated, the transaction remains managed in its elevated state until its completion.</span></span>  
  
 <span data-ttu-id="6f4c9-112">Fra la transazione dello spazio dei nomi <xref:System.Transactions> e la transazione MSDTC esiste un tipo intermedio di transazione reso disponibile tramite l'integrazione PSPE (Promotable Single Phase Enlistment),</span><span class="sxs-lookup"><span data-stu-id="6f4c9-112">Between the <xref:System.Transactions> transaction and MSDTC transaction, there is an intermediary type of transaction that is made available through the Promotable Single Phase Enlistment (PSPE).</span></span> <span data-ttu-id="6f4c9-113">ovvero un altro importante meccanismo dello spazio dei nomi <xref:System.Transactions> finalizzato all'ottimizzazione delle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="6f4c9-113">PSPE is another important mechanism in <xref:System.Transactions> for performance optimization.</span></span> <span data-ttu-id="6f4c9-114">L'integrazione PSPE consente a una risorsa durevole remota appartenente a un altro dominio applicazione, processo o computer di partecipare a una transazione dello spazio dei nomi <xref:System.Transactions> senza comportarne l'escalation a una transazione MSDTC.</span><span class="sxs-lookup"><span data-stu-id="6f4c9-114">It allows a remote durable resource, located in a different application domain, process or computer, to participate in a <xref:System.Transactions> transaction without causing it to be escalated to an MSDTC transaction.</span></span> <span data-ttu-id="6f4c9-115">Per ulteriori informazioni su PSPE, vedere [l'integrazione di risorse come partecipanti in una transazione](../../../../docs/framework/data/transactions/enlisting-resources-as-participants-in-a-transaction.md).</span><span class="sxs-lookup"><span data-stu-id="6f4c9-115">For more information about PSPE, see [Enlisting Resources as Participants in a Transaction](../../../../docs/framework/data/transactions/enlisting-resources-as-participants-in-a-transaction.md).</span></span>  
  
## <a name="how-escalation-is-initiated"></a><span data-ttu-id="6f4c9-116">Condizioni e modalità di avvio delle escalation</span><span class="sxs-lookup"><span data-stu-id="6f4c9-116">How Escalation is Initiated</span></span>  
 <span data-ttu-id="6f4c9-117">L'escalation delle transazioni riduce le prestazioni in quanto il gestore MSDTC risiede in un processo a parte. Inoltre, l'escalation di una transazione al gestore MSDTC comporta l'invio di messaggi fra i processi.</span><span class="sxs-lookup"><span data-stu-id="6f4c9-117">Transaction escalation reduces performance because the MSDTC resides in a separate process, and escalating a transaction to the MSDTC results in messages being sent across process.</span></span> <span data-ttu-id="6f4c9-118">Per migliorare le prestazioni, è necessario ritardare o evitare l'escalation a MSDTC; di conseguenza, è necessario sapere come e quando viene avviata l'escalation.</span><span class="sxs-lookup"><span data-stu-id="6f4c9-118">To improve performance, you should delay or avoid escalation to MSDTC; thus, you need to know how and when the escalation is initiated.</span></span>  
  
 <span data-ttu-id="6f4c9-119">Finché l'infrastruttura <xref:System.Transactions> gestisce risorse volatili e al massimo una risorsa durevole che supporta le notifiche monofase, la transazione resta proprietà dell'infrastruttura <xref:System.Transactions>.</span><span class="sxs-lookup"><span data-stu-id="6f4c9-119">As long as the <xref:System.Transactions> infrastructure handles volatile resources and at most one durable resource that supports single-phase notifications, the transaction remains in the ownership of the <xref:System.Transactions> infrastructure.</span></span> <span data-ttu-id="6f4c9-120">La gestione transazioni utilizza soltanto le risorse che risultano attive nello stesso dominio applicazione e per cui non è necessario eseguire la registrazione, ovvero la scrittura su disco del risultato della transazione.</span><span class="sxs-lookup"><span data-stu-id="6f4c9-120">The transaction manager avails itself only to those resources that live in the same application domain and for which logging (writing the transaction outcome to disk) is not required.</span></span> <span data-ttu-id="6f4c9-121">Le escalation che comportano il trasferimento della proprietà di una transazione dall'infrastruttura <xref:System.Transactions> al gestore MSDTC si verificano nei casi seguenti:</span><span class="sxs-lookup"><span data-stu-id="6f4c9-121">An escalation that results in the <xref:System.Transactions> infrastructure transferring the ownership of the transaction to MSDTC happens when:</span></span>  
  
-   <span data-ttu-id="6f4c9-122">Almeno una risorsa durevole che non supporta le notifiche monofase viene integrata nella transazione.</span><span class="sxs-lookup"><span data-stu-id="6f4c9-122">At least one durable resource that does not support single-phase notifications is enlisted in the transaction.</span></span>  
  
-   <span data-ttu-id="6f4c9-123">Almeno due risorse durevoli che supportano le notifiche monofase vengono integrate nella transazione.</span><span class="sxs-lookup"><span data-stu-id="6f4c9-123">At least two durable resources that support single-phase notifications are enlisted in the transaction.</span></span> <span data-ttu-id="6f4c9-124">Ad esempio, l'integrazione di una sola connessione a un database [!INCLUDE[sqprsqlong](../../../../includes/sqprsqlong-md.md)] non comporta l'escalation di una transazione.</span><span class="sxs-lookup"><span data-stu-id="6f4c9-124">For example, enlisting a single connection with [!INCLUDE[sqprsqlong](../../../../includes/sqprsqlong-md.md)] does not cause a transaction to be promoted.</span></span> <span data-ttu-id="6f4c9-125">Tuttavia, quando si apre una seconda connessione a un database [!INCLUDE[sqprsqlong](../../../../includes/sqprsqlong-md.md)] che ne comporta l'integrazione, l'infrastruttura <xref:System.Transactions> rileva che la transazione presenta due risorse durevoli e quindi ne esegue l'escalation a transazione MSDTC.</span><span class="sxs-lookup"><span data-stu-id="6f4c9-125">However, whenever you open a second connection to a [!INCLUDE[sqprsqlong](../../../../includes/sqprsqlong-md.md)] database causing the database to enlist, the <xref:System.Transactions> infrastructure detects that it is the second durable resource in the transaction, and escalates it to an MSDTC transaction.</span></span>  
  
-   <span data-ttu-id="6f4c9-126">Si verifica una richiesta di "marshalling" della transazione a un altro dominio applicazione o processo.</span><span class="sxs-lookup"><span data-stu-id="6f4c9-126">A request to "marshal" the transaction to a different application domain or different process is invoked.</span></span> <span data-ttu-id="6f4c9-127">Si consideri ad esempio il caso della serializzazione di un oggetto di transazione passato attraverso il confine di un dominio applicazione.</span><span class="sxs-lookup"><span data-stu-id="6f4c9-127">For example, the serialization of the transaction object across an application domain boundary.</span></span> <span data-ttu-id="6f4c9-128">In tal caso il sistema esegue il marshalling dell'oggetto di transazione per valore: se si tenta di passare tale oggetto attraverso il confine di un dominio applicazione (anche nello stesso processo), l'oggetto di transazione viene serializzato.</span><span class="sxs-lookup"><span data-stu-id="6f4c9-128">The transaction object is marshaled-by-value, meaning that any attempt to pass it across an application domain boundary (even in the same process) results in serialization of the transaction object.</span></span> <span data-ttu-id="6f4c9-129">È possibile passare gli oggetti di transazione effettuando una chiamata a un metodo remoto che accetta come parametro un oggetto <xref:System.Transactions.Transaction>. In alternativa, è possibile tentare di accedere a un componente remoto che supporta le transazioni.</span><span class="sxs-lookup"><span data-stu-id="6f4c9-129">You can pass the transaction objects by making a call on a remote method that takes a <xref:System.Transactions.Transaction> as a parameter or you can try to access a remote transactional-serviced component.</span></span> <span data-ttu-id="6f4c9-130">Ciò comporta la serializzazione dell'oggetto di transazione nonché un'escalation, analogamente al caso di serializzazione di una transazione passata attraverso il confine di un dominio applicazione.</span><span class="sxs-lookup"><span data-stu-id="6f4c9-130">This serializes the transaction object and results in an escalation, as when a transaction is serialized across an application domain.</span></span> <span data-ttu-id="6f4c9-131">Ciò si verifica in quanto la transazione viene distribuita e quindi la gestione transazioni locali non è più adeguata.</span><span class="sxs-lookup"><span data-stu-id="6f4c9-131">It is being distributed and the local transaction manager is no longer adequate.</span></span>  
  
 <span data-ttu-id="6f4c9-132">Nella tabella seguente sono elencate tutte le eccezioni che possono essere generate durante un'escalation.</span><span class="sxs-lookup"><span data-stu-id="6f4c9-132">The following table lists all the possible exceptions that can be thrown during escalation.</span></span>  
  
|<span data-ttu-id="6f4c9-133">Tipo di eccezione</span><span class="sxs-lookup"><span data-stu-id="6f4c9-133">Exception type</span></span>|<span data-ttu-id="6f4c9-134">Condizione</span><span class="sxs-lookup"><span data-stu-id="6f4c9-134">Condition</span></span>|  
|--------------------|---------------|  
|<xref:System.InvalidOperationException>|<span data-ttu-id="6f4c9-135">Tentativo di escalation di una transazione con livello di isolamento uguale a <xref:System.Transactions.IsolationLevel.Snapshot>.</span><span class="sxs-lookup"><span data-stu-id="6f4c9-135">An attempt to escalate a transaction with isolation level equal to <xref:System.Transactions.IsolationLevel.Snapshot>.</span></span>|  
|<xref:System.Transactions.TransactionAbortedException>|<span data-ttu-id="6f4c9-136">La gestione transazioni non è disponibile.</span><span class="sxs-lookup"><span data-stu-id="6f4c9-136">The transaction manager is down.</span></span>|  
|<xref:System.Transactions.TransactionException>|<span data-ttu-id="6f4c9-137">L'escalation non riesce e l'applicazione viene interrotta.</span><span class="sxs-lookup"><span data-stu-id="6f4c9-137">The escalation fails and the application is aborted.</span></span>|
