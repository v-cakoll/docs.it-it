---
title: Scenari non supportati
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 72027d0f-146d-40c5-9d72-e94392c8bb40
caps.latest.revision: "43"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: 3bb2646a500db299f164dce34fb062a509f90047
ms.sourcegitcommit: ce279f2d7fe2220e6ea0a25a8a7a5370ddf8d9f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/02/2017
---
# <a name="unsupported-scenarios"></a><span data-ttu-id="18194-102">Scenari non supportati</span><span class="sxs-lookup"><span data-stu-id="18194-102">Unsupported Scenarios</span></span>
<span data-ttu-id="18194-103">Per varie ragioni, [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] non supporta alcuni scenari di sicurezza specifici.</span><span class="sxs-lookup"><span data-stu-id="18194-103">For various reasons, [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] does not support some specific security scenarios.</span></span> <span data-ttu-id="18194-104">Ad esempio, i protocolli di autenticazione SSPI e Kerberos non sono implementati in [!INCLUDE[wxp](../../../../includes/wxp-md.md)] Home Edition. Pertanto, in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] l'esecuzione dei servizi che utilizzano l'autenticazione di Windows su questa piattaforma non è supportata.</span><span class="sxs-lookup"><span data-stu-id="18194-104">For example, [!INCLUDE[wxp](../../../../includes/wxp-md.md)] Home Edition does not implement the SSPI or Kerberos authentication protocols, and therefore [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] does not support running a service with Windows authentication on that platform.</span></span> <span data-ttu-id="18194-105">Altri meccanismi di autenticazione, ad esempio l'autenticazione integrata basata su nome utente/password e HTTP/HTTPS, sono supportati se [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] viene eseguito in Windows XP Home Edition.</span><span class="sxs-lookup"><span data-stu-id="18194-105">Other authentication mechanisms, such as username/password and HTTP/HTTPS integrated authentication are supported when running [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] under Windows XP Home Edition.</span></span>  
  
## <a name="impersonation-scenarios"></a><span data-ttu-id="18194-106">Scenari di rappresentazione</span><span class="sxs-lookup"><span data-stu-id="18194-106">Impersonation Scenarios</span></span>  
  
### <a name="impersonated-identity-might-not-flow-when-clients-make-asynchronous-calls"></a><span data-ttu-id="18194-107">L'identità rappresentata potrebbe non fluire quando i client effettuano chiamate asincrone</span><span class="sxs-lookup"><span data-stu-id="18194-107">Impersonated Identity Might Not Flow When Clients Make Asynchronous Calls</span></span>  
 <span data-ttu-id="18194-108">Quando un client WCF effettua chiamate asincrone a un servizio WCF utilizzando l'autenticazione di Windows sotto rappresentazione, potrebbe verificarsi l'autenticazione con l'identità del processo client anziché con l'identità rappresentata.</span><span class="sxs-lookup"><span data-stu-id="18194-108">When a WCF client makes asynchronous calls to a WCF service using Windows authentication under impersonation, authentication might occur with the identity of the client process instead of the impersonated identity.</span></span>  
  
### <a name="windows-xp-and-secure-context-token-cookie-enabled"></a><span data-ttu-id="18194-109">Windows XP con cookie di token del contesto di sicurezza attivo</span><span class="sxs-lookup"><span data-stu-id="18194-109">Windows XP and Secure Context Token Cookie Enabled</span></span>  
 <span data-ttu-id="18194-110">In [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] non è supportata la rappresentazione e quando sussistono le condizioni elencate di seguito viene generata un'eccezione <xref:System.InvalidOperationException>:</span><span class="sxs-lookup"><span data-stu-id="18194-110">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] does not support impersonation and an <xref:System.InvalidOperationException> is thrown when the following conditions exist:</span></span>  
  
-   <span data-ttu-id="18194-111">Il sistema operativo è [!INCLUDE[wxp](../../../../includes/wxp-md.md)].</span><span class="sxs-lookup"><span data-stu-id="18194-111">The operating system is [!INCLUDE[wxp](../../../../includes/wxp-md.md)].</span></span>  
  
-   <span data-ttu-id="18194-112">La modalità di autenticazione genera un'identità Windows.</span><span class="sxs-lookup"><span data-stu-id="18194-112">The authentication mode results in a Windows identity.</span></span>  
  
-   <span data-ttu-id="18194-113">La proprietà <xref:System.ServiceModel.OperationBehaviorAttribute.Impersonation%2A> di <xref:System.ServiceModel.OperationBehaviorAttribute> è impostata su <xref:System.ServiceModel.ImpersonationOption.Required>.</span><span class="sxs-lookup"><span data-stu-id="18194-113">The <xref:System.ServiceModel.OperationBehaviorAttribute.Impersonation%2A> property of the <xref:System.ServiceModel.OperationBehaviorAttribute> is set to <xref:System.ServiceModel.ImpersonationOption.Required>.</span></span>  
  
-   <span data-ttu-id="18194-114">Viene creato un token del contesto di sicurezza SCT (Security Context Token) basato sullo stato. Per impostazione predefinita, la creazione è disattivata.</span><span class="sxs-lookup"><span data-stu-id="18194-114">A state-based security context token (SCT) is created (by default, creation is disabled).</span></span>  
  
 <span data-ttu-id="18194-115">Il token SCT basato sullo stato può essere creato solo tramite un'associazione personalizzata.</span><span class="sxs-lookup"><span data-stu-id="18194-115">The state-based SCT can only be created using a custom binding.</span></span> [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)]<span data-ttu-id="18194-116">[Procedura: creare un contesto di sicurezza per una sessione protetta](../../../../docs/framework/wcf/feature-details/how-to-create-a-security-context-token-for-a-secure-session.md).) In codice, per attivare il token occorre creare un elemento di associazione di sicurezza (<xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement> o <xref:System.ServiceModel.Channels.AsymmetricSecurityBindingElement>) utilizzando il metodo <xref:System.ServiceModel.Channels.SecurityBindingElement.CreateSspiNegotiationBindingElement%28System.Boolean%29?displayProperty=nameWithType> o il metodo <xref:System.ServiceModel.Channels.SecurityBindingElement.CreateSecureConversationBindingElement%28System.ServiceModel.Channels.SecurityBindingElement%2CSystem.Boolean%29?displayProperty=nameWithType> e impostando il parametro `requireCancellation` su `false`.</span><span class="sxs-lookup"><span data-stu-id="18194-116"> [How to: Create a Security Context Token for a Secure Session](../../../../docs/framework/wcf/feature-details/how-to-create-a-security-context-token-for-a-secure-session.md).) In code, the token is enabled by creating a security binding element (either <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement> or <xref:System.ServiceModel.Channels.AsymmetricSecurityBindingElement>) using the <xref:System.ServiceModel.Channels.SecurityBindingElement.CreateSspiNegotiationBindingElement%28System.Boolean%29?displayProperty=nameWithType> or the <xref:System.ServiceModel.Channels.SecurityBindingElement.CreateSecureConversationBindingElement%28System.ServiceModel.Channels.SecurityBindingElement%2CSystem.Boolean%29?displayProperty=nameWithType> method and setting the `requireCancellation` parameter to `false`.</span></span> <span data-ttu-id="18194-117">Il parametro fa riferimento alla memorizzazione nella cache del token SCT.</span><span class="sxs-lookup"><span data-stu-id="18194-117">The parameter refers to the caching of the SCT.</span></span> <span data-ttu-id="18194-118">L'impostazione del valore su `false` comporta l'attivazione della funzionalità del token SCT basato sullo stato.</span><span class="sxs-lookup"><span data-stu-id="18194-118">Setting the value to `false` enables the state-based SCT feature.</span></span>  
  
 <span data-ttu-id="18194-119">In alternativa, nella configurazione, il token è abilitato per la creazione di un <`customBinding`>, quindi aggiungendo un <`security`> elemento e l'impostazione di `authenticationMode` attributo SecureConversation e `requireSecurityContextCancellation` attributo `true`.</span><span class="sxs-lookup"><span data-stu-id="18194-119">Alternatively, in configuration, the token is enabled by creating a <`customBinding`>, then adding a <`security`> element, and setting the `authenticationMode` attribute to SecureConversation and the `requireSecurityContextCancellation` attribute to `true`.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="18194-120">I requisiti precedenti sono specifici.</span><span class="sxs-lookup"><span data-stu-id="18194-120">The preceding requirements are specific.</span></span> <span data-ttu-id="18194-121">Ad esempio, il metodo <xref:System.ServiceModel.Channels.SecurityBindingElement.CreateKerberosBindingElement%2A> crea un elemento di associazione che genera un'identità Windows senza tuttavia creare un token SCT.</span><span class="sxs-lookup"><span data-stu-id="18194-121">For example, the <xref:System.ServiceModel.Channels.SecurityBindingElement.CreateKerberosBindingElement%2A> creates a binding element that results in a Windows identity, but does not establish an SCT.</span></span> <span data-ttu-id="18194-122">È pertanto possibile utilizzare questa identità con l'opzione `Required` di [!INCLUDE[wxp](../../../../includes/wxp-md.md)].</span><span class="sxs-lookup"><span data-stu-id="18194-122">Therefore, you can use it with the `Required` option on [!INCLUDE[wxp](../../../../includes/wxp-md.md)].</span></span>  
  
### <a name="possible-aspnet-conflict"></a><span data-ttu-id="18194-123">Possibile conflitto con ASP.NET</span><span class="sxs-lookup"><span data-stu-id="18194-123">Possible ASP.NET Conflict</span></span>  
 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]<span data-ttu-id="18194-124"> e [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] possono entrambi attivare o disattivare la rappresentazione.</span><span class="sxs-lookup"><span data-stu-id="18194-124"> and [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] can both enable or disable impersonation.</span></span> <span data-ttu-id="18194-125">Quando [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] ospita un'applicazione [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] è possibile che si verifichi un conflitto tra le impostazioni di configurazione di [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] e [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)].</span><span class="sxs-lookup"><span data-stu-id="18194-125">When [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] hosts an [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] application, a conflict may exist between the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] and [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] configuration settings.</span></span> <span data-ttu-id="18194-126">In caso di conflitto, l'impostazione di [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] ha la precedenza, a meno che la proprietà <xref:System.ServiceModel.OperationBehaviorAttribute.Impersonation%2A> sia impostata su <xref:System.ServiceModel.ImpersonationOption.NotAllowed>. In questo caso, l'impostazione della rappresentazione [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] ha la precedenza.</span><span class="sxs-lookup"><span data-stu-id="18194-126">In case of conflict, the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] setting takes precedence, unless the <xref:System.ServiceModel.OperationBehaviorAttribute.Impersonation%2A> property is set to <xref:System.ServiceModel.ImpersonationOption.NotAllowed>, in which case the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] impersonation setting takes precedence.</span></span>  
  
### <a name="assembly-loads-may-fail-under-impersonation"></a><span data-ttu-id="18194-127">Possibilità di esito negativo dei caricamenti dell'assembly in caso di utilizzo della rappresentazione</span><span class="sxs-lookup"><span data-stu-id="18194-127">Assembly Loads May Fail Under Impersonation</span></span>  
 <span data-ttu-id="18194-128">Se il contesto rappresentato non dispone delle autorizzazioni di accesso per caricare un assembly e se è la prima volta che il Common Language Runtime (CLR) tenta di caricare l'assembly per tale dominio applicazione, il dominio <xref:System.AppDomain> memorizza l'errore nella cache.</span><span class="sxs-lookup"><span data-stu-id="18194-128">If the impersonated context does not have access rights to load an assembly and if it is the first time the common language runtime (CLR) is attempting to load the assembly for that AppDomain, the <xref:System.AppDomain> caches the failure.</span></span> <span data-ttu-id="18194-129">I tentativi successivi di caricamento dell'assembly (o degli assembly) hanno esito negativo, anche dopo aver ripristinato la rappresentazione e anche se il contesto ripristinato dispone delle autorizzazioni di accesso per caricare l'assembly.</span><span class="sxs-lookup"><span data-stu-id="18194-129">Subsequent attempts to load that assembly (or assemblies) fail, even after reverting the impersonation, and even if the reverted context has access rights to load the assembly.</span></span> <span data-ttu-id="18194-130">Ciò è dovuto al fatto che CLR non esegue nuovi tentativi di caricamento dopo che il contesto utente è cambiato.</span><span class="sxs-lookup"><span data-stu-id="18194-130">This is because the CLR does not re-attempt the load after the user context is changed.</span></span> <span data-ttu-id="18194-131">Per risolvere il problema è necessario riavviare il dominio applicazione.</span><span class="sxs-lookup"><span data-stu-id="18194-131">You must restart the application domain to recover from the failure.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="18194-132">Il valore predefinito della proprietà <xref:System.ServiceModel.Security.WindowsClientCredential.AllowedImpersonationLevel%2A> della classe <xref:System.ServiceModel.Security.WindowsClientCredential> è <xref:System.Security.Principal.TokenImpersonationLevel.Identification>.</span><span class="sxs-lookup"><span data-stu-id="18194-132">The default value for the <xref:System.ServiceModel.Security.WindowsClientCredential.AllowedImpersonationLevel%2A> property of the <xref:System.ServiceModel.Security.WindowsClientCredential> class is <xref:System.Security.Principal.TokenImpersonationLevel.Identification>.</span></span> <span data-ttu-id="18194-133">Nella maggior parte dei casi, un contesto di rappresentazione a livello di identificazione non dispone di alcun diritto che consenta il caricamento di assembly aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="18194-133">In most cases, an identification-level impersonation context has no rights to load any additional assemblies.</span></span> <span data-ttu-id="18194-134">Poiché si tratta di un valore predefinito, questo caso risulta essere molto comune e merita particolare attenzione.</span><span class="sxs-lookup"><span data-stu-id="18194-134">This is the default value, so this is a very common condition to be aware of.</span></span> <span data-ttu-id="18194-135">La rappresentazione a livello di identificazione si verifica anche quando il processo di rappresentazione non dispone del privilegio `SeImpersonate`.</span><span class="sxs-lookup"><span data-stu-id="18194-135">Identification-level impersonation also occurs when the impersonating process does not have the `SeImpersonate` privilege.</span></span> [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)]<span data-ttu-id="18194-136">[Delega e rappresentazione](../../../../docs/framework/wcf/feature-details/delegation-and-impersonation-with-wcf.md).</span><span class="sxs-lookup"><span data-stu-id="18194-136"> [Delegation and Impersonation](../../../../docs/framework/wcf/feature-details/delegation-and-impersonation-with-wcf.md).</span></span>  
  
### <a name="delegation-requires-credential-negotiation"></a><span data-ttu-id="18194-137">Requisito di negoziazione della credenziale in caso di delega</span><span class="sxs-lookup"><span data-stu-id="18194-137">Delegation Requires Credential Negotiation</span></span>  
 <span data-ttu-id="18194-138">Per poter essere utilizzato con la funzionalità di delega, il protocollo di autenticazione Kerberos deve essere implementato con la negoziazione delle credenziali. Questa versione di Kerberos è talvolta nota come Kerberos multifase.</span><span class="sxs-lookup"><span data-stu-id="18194-138">To use the Kerberos authentication protocol with delegation, you must implement the Kerberos protocol with credential negotiation (sometimes called multi-leg or multi-step Kerberos).</span></span> <span data-ttu-id="18194-139">Se si implementa l'autenticazione Kerberos senza negoziazione delle credenziali (ovvero una versione di Kerberos anche nota come monofase o monopassaggio), verrà generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="18194-139">If you implement Kerberos authentication without credential negotiation (sometimes called one-shot or single-leg Kerberos), an exception is thrown.</span></span> [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="18194-140">come implementare la negoziazione delle credenziali, vedere [debug degli errori di autenticazione di Windows](../../../../docs/framework/wcf/feature-details/debugging-windows-authentication-errors.md).</span><span class="sxs-lookup"><span data-stu-id="18194-140"> how to implement credential negotiation, see [Debugging Windows Authentication Errors](../../../../docs/framework/wcf/feature-details/debugging-windows-authentication-errors.md).</span></span>  
  
## <a name="cryptography"></a><span data-ttu-id="18194-141">Crittografia</span><span class="sxs-lookup"><span data-stu-id="18194-141">Cryptography</span></span>  
  
### <a name="sha-256-supported-only-for-symmetric-key-usages"></a><span data-ttu-id="18194-142">Supporto di SHA-256 solo in caso di utilizzo di chiavi simmetriche</span><span class="sxs-lookup"><span data-stu-id="18194-142">SHA-256 Supported Only for Symmetric Key Usages</span></span>  
 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]<span data-ttu-id="18194-143"> supporta diversi algoritmi di crittografia e di creazione di digest di firme che è possibile specificare utilizzando la suite di algoritmi disponibile nelle associazioni fornite dal sistema.</span><span class="sxs-lookup"><span data-stu-id="18194-143"> supports a variety of encryption and signature digest creation algorithms that you can specify using the algorithm suite in the system-provided bindings.</span></span> <span data-ttu-id="18194-144">Per implementare un meccanismo di sicurezza avanzata, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] supporta gli algoritmi Secure Hash Algorithm (SHA) 2, in particolare l'algoritmo SHA-256, per creare hash digest di firme.</span><span class="sxs-lookup"><span data-stu-id="18194-144">For improved security, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] supports Secure Hash Algorithm (SHA) 2 algorithms, specifically SHA-256, for creating signature digest hashes.</span></span> <span data-ttu-id="18194-145">Questa versione supporta l'algoritmo SHA-256 solo nei casi in cui si utilizzano chiavi simmetriche, ad esempio le chiavi Kerberos, e nei casi in cui i messaggi non vengono firmati tramite un certificato X.509.</span><span class="sxs-lookup"><span data-stu-id="18194-145">This release supports SHA-256 only for symmetric key usages, such as Kerberos keys, and where an X.509 certificate is not used to sign the message.</span></span> [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]<span data-ttu-id="18194-146"> non supporta le firme RSA (utilizzate nei certificati X.509) con l'hash SHA-256 in quanto al momento [!INCLUDE[vstecwinfx](../../../../includes/vstecwinfx-md.md)] non supporta l'algoritmo RSA-SHA256.</span><span class="sxs-lookup"><span data-stu-id="18194-146"> does not support RSA signatures (used in X.509 certificates) using SHA-256 hash due to the current lack of support for RSA-SHA256 in the [!INCLUDE[vstecwinfx](../../../../includes/vstecwinfx-md.md)].</span></span>  
  
### <a name="fips-compliant-sha-256-hashes-not-supported"></a><span data-ttu-id="18194-147">Mancanza del supporto per gli hash SHA-256 conformi agli standard FIPS</span><span class="sxs-lookup"><span data-stu-id="18194-147">FIPS-Compliant SHA-256 Hashes not Supported</span></span>  
 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]<span data-ttu-id="18194-148"> non supporta gli hash SHA-256 conformi agli standard FIPS. Pertanto, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] non supporta le suite di algoritmi basate su SHA-256 nei sistemi che richiedono l'utilizzo di algoritmi conformi agli standard FIPS.</span><span class="sxs-lookup"><span data-stu-id="18194-148"> does not support SHA-256 FIPS-compliant hashes, so algorithm suites that use SHA-256 are not supported by [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] on systems where use of FIPS compliant algorithms is required.</span></span>  
  
### <a name="fips-compliant-algorithms-may-fail-if-registry-is-edited"></a><span data-ttu-id="18194-149">Possibilità di esito negativo degli algoritmi conformi agli standard FIPS in caso di modifica del Registro di sistema</span><span class="sxs-lookup"><span data-stu-id="18194-149">FIPS-Compliant Algorithms May Fail if Registry Is Edited</span></span>  
 <span data-ttu-id="18194-150">Lo snap-in Impostazioni protezione locale di Microsoft Management Console (MMC) consente di attivare e disattivare gli algoritmi conformi agli standard FIPS.</span><span class="sxs-lookup"><span data-stu-id="18194-150">You can enable and disable Federal Information Processing Standards (FIPS)-compliant algorithms by using the Local Security Settings Microsoft Management Console (MMC) snap-in.</span></span> <span data-ttu-id="18194-151">Questa impostazione può inoltre essere eseguita nel Registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="18194-151">You can also access the setting in the registry.</span></span> <span data-ttu-id="18194-152">Si noti tuttavia che [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] non supporta l'utilizzo del Registro di sistema per reimpostare l'impostazione.</span><span class="sxs-lookup"><span data-stu-id="18194-152">Note, however, that [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] does not support using the registry to reset the setting.</span></span> <span data-ttu-id="18194-153">Se si esegue questa impostazione utilizzando un valore diverso da 1 oppure 0 è possibile che si verifichino risultati incoerenti tra il runtime CLR e il sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="18194-153">If the value is set to anything other than 1 or 0, inconsistent results can occur between the CLR and the operating system.</span></span>  
  
### <a name="fips-compliant-aes-encryption-limitation"></a><span data-ttu-id="18194-154">Restrizione sulla crittografia AES conforme agli standard FIPS</span><span class="sxs-lookup"><span data-stu-id="18194-154">FIPS-Compliant AES Encryption Limitation</span></span>  
 <span data-ttu-id="18194-155">La crittografia AES conforme agli standard FIPS non funziona nei callback duplex nel contesto di una rappresentazione di livello di identificazione.</span><span class="sxs-lookup"><span data-stu-id="18194-155">FIPS compliant AES encryption does not work in duplex callbacks under identification level impersonation.</span></span>  
  
### <a name="cngksp-certificates"></a><span data-ttu-id="18194-156">Certificati CNG/KSP</span><span class="sxs-lookup"><span data-stu-id="18194-156">CNG/KSP Certificates</span></span>  
 <span data-ttu-id="18194-157">*Cryptography API: Next Generation (CNG)* è la sostituzione a lungo termine di CryptoAPI.</span><span class="sxs-lookup"><span data-stu-id="18194-157">*Cryptography API: Next Generation (CNG)* is the long-term replacement for the CryptoAPI.</span></span> <span data-ttu-id="18194-158">Questa API è disponibile nel codice non gestito in [!INCLUDE[wv](../../../../includes/wv-md.md)], [!INCLUDE[lserver](../../../../includes/lserver-md.md)] e versioni successive di Windows.</span><span class="sxs-lookup"><span data-stu-id="18194-158">This API is available in unmanaged code on [!INCLUDE[wv](../../../../includes/wv-md.md)],  [!INCLUDE[lserver](../../../../includes/lserver-md.md)] and later Windows versions.</span></span>  
  
 <span data-ttu-id="18194-159">.NET framework 4.6.1 e versioni precedenti non supportano i certificati perché usano CryptoAPI legacy per gestire i certificati CNG/KSP.</span><span class="sxs-lookup"><span data-stu-id="18194-159">.NET Framework 4.6.1 and earlier versions do not support these certificates because they use the legacy CryptoAPI to handle CNG/KSP certificates.</span></span> <span data-ttu-id="18194-160">L'utilizzo di tali certificati con .NET Framework 4.6.1 e versioni precedenti genererà un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="18194-160">The use of these certificates with   .NET Framework 4.6.1 and earlier versions will cause an exception.</span></span>  
  
 <span data-ttu-id="18194-161">Esistono due modi possibili per stabilire se un certificato utilizza KSP:</span><span class="sxs-lookup"><span data-stu-id="18194-161">There are two possible ways to tell if a certificate uses KSP:</span></span>  
  
-   <span data-ttu-id="18194-162">Eseguire `p/invoke` di `CertGetCertificateContextProperty` e controllare `dwProvType` sulla proprietà `CertGetCertificateContextProperty` restituita.</span><span class="sxs-lookup"><span data-stu-id="18194-162">Do a `p/invoke` of `CertGetCertificateContextProperty`, and inspect `dwProvType` on the returned `CertGetCertificateContextProperty`.</span></span>  
  
-   <span data-ttu-id="18194-163">Utilizzare il `certutil` comando dalla riga di comando per eseguire query sui certificati.</span><span class="sxs-lookup"><span data-stu-id="18194-163">Use the  `certutil` command from the command line for querying certificates.</span></span> [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)]<span data-ttu-id="18194-164">[Attività di Certutil per la risoluzione dei problemi dei certificati](http://go.microsoft.com/fwlink/?LinkId=120056).</span><span class="sxs-lookup"><span data-stu-id="18194-164"> [Certutil tasks for troubleshooting certificates](http://go.microsoft.com/fwlink/?LinkId=120056).</span></span>  
  
## <a name="message-security-fails-if-using-aspnet-impersonation-and-aspnet-compatibility-is-required"></a><span data-ttu-id="18194-165">Errore di sicurezza a livello di messaggio quando si utilizza la rappresentazione ASP.NET e la compatibilità con ASP.NET è obbligatoria</span><span class="sxs-lookup"><span data-stu-id="18194-165">Message Security Fails if Using ASP.NET Impersonation and ASP.NET Compatibility Is Required</span></span>  
 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]<span data-ttu-id="18194-166"> non supporta la combinazione seguente di condizioni, in quanto può impedire lo svolgimento dell'autenticazione client:</span><span class="sxs-lookup"><span data-stu-id="18194-166"> does not support the following combination of settings because they can prevent client authentication from occurring:</span></span>  
  
-   <span data-ttu-id="18194-167">È stata attivata la rappresentazione [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)].</span><span class="sxs-lookup"><span data-stu-id="18194-167">[!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] Impersonation is enabled.</span></span> <span data-ttu-id="18194-168">Questa operazione viene eseguita nel file Web. config mediante l'impostazione di `impersonate` attributo di <`identity`> elemento `true`.</span><span class="sxs-lookup"><span data-stu-id="18194-168">This is done in the Web.config file by setting the `impersonate` attribute of the <`identity`> element to `true`.</span></span>  
  
-   [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)]<span data-ttu-id="18194-169">modalità di compatibilità viene abilitata impostando il `aspNetCompatibilityEnabled` attributo del [ \<serviceHostingEnvironment >](../../../../docs/framework/configure-apps/file-schema/wcf/servicehostingenvironment.md) a `true`.</span><span class="sxs-lookup"><span data-stu-id="18194-169"> compatibility mode is enabled by setting the `aspNetCompatibilityEnabled` attribute of the [\<serviceHostingEnvironment>](../../../../docs/framework/configure-apps/file-schema/wcf/servicehostingenvironment.md) to `true`.</span></span>  
  
-   <span data-ttu-id="18194-170">Viene utilizzata la protezione a livello di messaggio.</span><span class="sxs-lookup"><span data-stu-id="18194-170">Message mode security is used.</span></span>  
  
 <span data-ttu-id="18194-171">Per risolvere questo problema è sufficiente disattivare la modalità di compatibilità con [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)].</span><span class="sxs-lookup"><span data-stu-id="18194-171">The work-around is to turn off the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] compatibility mode.</span></span> <span data-ttu-id="18194-172">In alternativa, se la modalità di compatibilità con [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] è obbligatoria, è possibile disattivare la funzionalità di rappresentazione [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] e utilizzare invece la rappresentazione fornita in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)].</span><span class="sxs-lookup"><span data-stu-id="18194-172">Or, if the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] compatibility mode is required, disable the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] impersonation feature and use [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]-provided impersonation instead.</span></span> [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)]<span data-ttu-id="18194-173">[Delega e rappresentazione](../../../../docs/framework/wcf/feature-details/delegation-and-impersonation-with-wcf.md).</span><span class="sxs-lookup"><span data-stu-id="18194-173"> [Delegation and Impersonation](../../../../docs/framework/wcf/feature-details/delegation-and-impersonation-with-wcf.md).</span></span>  
  
## <a name="ipv6-literal-address-failure"></a><span data-ttu-id="18194-174">Errore di indirizzo letterale IPv6</span><span class="sxs-lookup"><span data-stu-id="18194-174">IPv6 Literal Address Failure</span></span>  
 <span data-ttu-id="18194-175">Le richieste di sicurezza hanno esito negativo quando il client e il servizio si trovano nello stesso computer e gli indirizzi letterali Ipv6 vengono utilizzati per il servizio. </span><span class="sxs-lookup"><span data-stu-id="18194-175">Security requests fail when the client and service are on the same machine, and IPv6 literal addresses are used for the service.</span></span>  
  
 <span data-ttu-id="18194-176">Gli indirizzi di questo tipo funzionano se il servizio e il client sono sui computer diversi.</span><span class="sxs-lookup"><span data-stu-id="18194-176">Literal IPv6 addresses work if the service and client are on different machines.</span></span>  
  
## <a name="wsdl-retrieval-failures-with-federated-trust"></a><span data-ttu-id="18194-177">Errori di recupero di WSDL con trust federati</span><span class="sxs-lookup"><span data-stu-id="18194-177">WSDL Retrieval Failures with Federated Trust</span></span>  
 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]<span data-ttu-id="18194-178"> richiede esattamente un documento WSDL per ogni nodo nella catena di trust federati.</span><span class="sxs-lookup"><span data-stu-id="18194-178"> requires exactly one WSDL document for each node in the federated trust chain.</span></span> <span data-ttu-id="18194-179">È opportuno prestare attenzione a non impostare un ciclo quando si specificano gli endpoint.</span><span class="sxs-lookup"><span data-stu-id="18194-179">Be careful not to set up a loop when specifying endpoints.</span></span> <span data-ttu-id="18194-180">È possibile che si verifichi un ciclo quando si utilizza un download WSDL di catene di trust federati con due o più collegamenti nello stesso documento WSDL.</span><span class="sxs-lookup"><span data-stu-id="18194-180">One way in which loops can arise is using a WSDL download of federated trust chains with two or more links in the same WSDL document.</span></span> <span data-ttu-id="18194-181">Uno scenario comune in cui può verificarsi questo problema consiste in un servizio federato in cui il server di token di sicurezza e il servizio sono contenuti nello stesso ServiceHost.</span><span class="sxs-lookup"><span data-stu-id="18194-181">A common scenario that can produce this problem is a federated service where the Security Token Server and the service are contained inside the same ServiceHost.</span></span>  
  
 <span data-ttu-id="18194-182">Un esempio di questa situazione è dato da un servizio con i tre indirizzi endpoint seguenti:</span><span class="sxs-lookup"><span data-stu-id="18194-182">An example of this situation is a service with the following three endpoint addresses:</span></span>  
  
-   <span data-ttu-id="18194-183">http://localhost/CalculatorService/service (il servizio)</span><span class="sxs-lookup"><span data-stu-id="18194-183">http://localhost/CalculatorService/service (the service)</span></span>  
  
-   <span data-ttu-id="18194-184">http://localhost/CalculatorService/issue_ticket (STS)</span><span class="sxs-lookup"><span data-stu-id="18194-184">http://localhost/CalculatorService/issue_ticket (the STS)</span></span>  
  
-   <span data-ttu-id="18194-185">http://localhost/CalculatorService/mex (l'endpoint dei metadati)</span><span class="sxs-lookup"><span data-stu-id="18194-185">http://localhost/CalculatorService/mex (the metadata endpoint)</span></span>  
  
 <span data-ttu-id="18194-186">Viene generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="18194-186">This throws an exception.</span></span>  
  
 <span data-ttu-id="18194-187">È possibile risolvere questo scenario collocando l'endpoint `issue_ticket` in un'altra posizione.</span><span class="sxs-lookup"><span data-stu-id="18194-187">You can make this scenario work by putting the `issue_ticket` endpoint elsewhere.</span></span>  
  
## <a name="wsdl-import-attributes-can-be-lost"></a><span data-ttu-id="18194-188">Gli attributi di importazione di WSDL possono andare persi</span><span class="sxs-lookup"><span data-stu-id="18194-188">WSDL Import Attributes can be Lost</span></span>  
 <span data-ttu-id="18194-189">In WCF si perde traccia degli attributi in un elemento `<wst:Claims>`RST in un modello`RST` quando viene eseguita un'importazione WSDL.</span><span class="sxs-lookup"><span data-stu-id="18194-189">WCF loses track of the attributes on a `<wst:Claims>` element in an `RST` template when doing a WSDL import.</span></span> <span data-ttu-id="18194-190">Questa situazione si verifica durante un'importazione WSDL se si specifica `<Claims>`WSFederationHttpBinding.Security.Message.TokenRequestParameters direttamente in`WSFederationHttpBinding.Security.Message.TokenRequestParameters`IssuedSecurityTokenRequestParameters.AdditionalRequestParameters o in`IssuedSecurityTokenRequestParameters.AdditionalRequestParameters` anziché utilizzare direttamente le raccolte dei tipi di attestazione.</span><span class="sxs-lookup"><span data-stu-id="18194-190">This happens during a WSDL import if you specify `<Claims>` directly in `WSFederationHttpBinding.Security.Message.TokenRequestParameters` or `IssuedSecurityTokenRequestParameters.AdditionalRequestParameters` instead of using the claim type collections directly.</span></span>  <span data-ttu-id="18194-191">Poiché l'importazione perde gli attributi, l'associazione non esegue correttamente una sequenza di andata e ritorno attraverso WSDL e quindi risulta errata sul lato client.</span><span class="sxs-lookup"><span data-stu-id="18194-191">Since the import loses the attributes, the binding does not round trip properly through WSDL and hence is incorrect on the client side.</span></span>  
  
 <span data-ttu-id="18194-192">Per risolvere il problema è necessario modificare l'associazione direttamente nel client dopo aver eseguito l'importazione.</span><span class="sxs-lookup"><span data-stu-id="18194-192">The fix is to modify the binding directly on the client after doing the import.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="18194-193">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="18194-193">See Also</span></span>  
 [<span data-ttu-id="18194-194">Considerazioni sulla sicurezza</span><span class="sxs-lookup"><span data-stu-id="18194-194">Security Considerations</span></span>](../../../../docs/framework/wcf/feature-details/security-considerations-in-wcf.md)  
 [<span data-ttu-id="18194-195">Diffusione di informazioni</span><span class="sxs-lookup"><span data-stu-id="18194-195">Information Disclosure</span></span>](../../../../docs/framework/wcf/feature-details/information-disclosure.md)  
 [<span data-ttu-id="18194-196">Elevazione dei privilegi</span><span class="sxs-lookup"><span data-stu-id="18194-196">Elevation of Privilege</span></span>](../../../../docs/framework/wcf/feature-details/elevation-of-privilege.md)  
 [<span data-ttu-id="18194-197">Denial of Service</span><span class="sxs-lookup"><span data-stu-id="18194-197">Denial of Service</span></span>](../../../../docs/framework/wcf/feature-details/denial-of-service.md)  
 [<span data-ttu-id="18194-198">Manomissione</span><span class="sxs-lookup"><span data-stu-id="18194-198">Tampering</span></span>](../../../../docs/framework/wcf/feature-details/tampering.md)  
 [<span data-ttu-id="18194-199">Attacchi di riproduzione</span><span class="sxs-lookup"><span data-stu-id="18194-199">Replay Attacks</span></span>](../../../../docs/framework/wcf/feature-details/replay-attacks.md)
