---
title: Accodamento in WCF
ms.custom: ''
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: ''
ms.suite: ''
ms.technology:
- dotnet-clr
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: e98d76ba-1acf-42cd-b137-0f8214661112
caps.latest.revision: 21
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload:
- dotnet
ms.openlocfilehash: 8bf4a668fe882212da1c6626b66a4f55390a562f
ms.sourcegitcommit: 94d33cadc5ff81d2ac389bf5f26422c227832052
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/30/2018
---
# <a name="queuing-in-wcf"></a><span data-ttu-id="6eef8-102">Accodamento in WCF</span><span class="sxs-lookup"><span data-stu-id="6eef8-102">Queuing in WCF</span></span>
<span data-ttu-id="6eef8-103">Contenuto della sezione viene descritto come usare la comunicazione in coda in [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6eef8-103">This section describes how to use queued communication in [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)].</span></span>  
  
## <a name="queues-as-a-wcf-transport-binding"></a><span data-ttu-id="6eef8-104">Accodamento come associazione di trasporto WCF</span><span class="sxs-lookup"><span data-stu-id="6eef8-104">Queues as a WCF transport binding</span></span>  
 <span data-ttu-id="6eef8-105">In [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], i contratti specificano ciò che viene scambiato.</span><span class="sxs-lookup"><span data-stu-id="6eef8-105">In [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], the contracts specify what is being exchanged.</span></span> <span data-ttu-id="6eef8-106">I contratti sono scambi di messaggi dipendenti dall'azienda o specifici dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="6eef8-106">Contracts are business-dependent or application-specific message exchanges.</span></span> <span data-ttu-id="6eef8-107">Il meccanismo (o la modalità) usato per scambiare messaggi viene specificato nelle associazioni.</span><span class="sxs-lookup"><span data-stu-id="6eef8-107">The mechanism used to exchange messages (or the "how") is specified in the bindings.</span></span> <span data-ttu-id="6eef8-108">Le associazioni in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] incapsulano dettagli dello scambio di messaggi.</span><span class="sxs-lookup"><span data-stu-id="6eef8-108">Bindings in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] encapsulate details of the message exchange.</span></span> <span data-ttu-id="6eef8-109">Espongono funzionalità di configurazione che consentono all'utente di controllare vari aspetti del trasporto o del protocollo rappresentato dall'associazione.</span><span class="sxs-lookup"><span data-stu-id="6eef8-109">They expose configuration knobs for the user to control various aspects of the transport or the protocol that the bindings represent.</span></span> <span data-ttu-id="6eef8-110">L'accodamento in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] viene considerato come qualsiasi altra associazione di trasporto e questo è un grande vantaggio per molte applicazioni di accodamento.</span><span class="sxs-lookup"><span data-stu-id="6eef8-110">Queuing in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] is treated like any other transport binding, which is a big advantage for many queuing applications.</span></span> <span data-ttu-id="6eef8-111">Oggi, molte applicazioni di accodamento vengono scritte in modo diverso dalle applicazioni distribuite in stile chiamata di procedura remota (RPC), rendendone più difficile la gestione.</span><span class="sxs-lookup"><span data-stu-id="6eef8-111">Today, many queuing applications are written differently from other remote procedure call (RPC)-style distributed applications, making it harder to follow and maintain.</span></span> <span data-ttu-id="6eef8-112">Con [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], lo stile di scrittura di un'applicazione distribuita è prevalentemente lo stesso e questo facilita la gestione.</span><span class="sxs-lookup"><span data-stu-id="6eef8-112">With [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], the style of writing a distributed application is much the same, making it easier to follow and maintain.</span></span> <span data-ttu-id="6eef8-113">Inoltre, eseguendo il factoring del meccanismo di scambio separatamente dalla regola business, è più semplice configurare il trasporto o apportarvi modifiche senza incidere sul codice specifico dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="6eef8-113">Moreover, by factoring out the mechanism of exchange separately from the business logic, it is easier to configure the transport or make changes to it without affecting application specific code.</span></span> <span data-ttu-id="6eef8-114">Nella figura seguente viene illustrata la struttura di un servizio e un client WCF usando MSMQ come trasporto.</span><span class="sxs-lookup"><span data-stu-id="6eef8-114">The following figure illustrates the structure of a WCF service and client using MSMQ as a transport.</span></span>  
  
 <span data-ttu-id="6eef8-115">![In coda applicazione diagramma](../../../../docs/framework/wcf/feature-details/media/distributed-queue-figure.jpg "figura coda distribuita")</span><span class="sxs-lookup"><span data-stu-id="6eef8-115">![Queued Application Diagram](../../../../docs/framework/wcf/feature-details/media/distributed-queue-figure.jpg "Distributed-Queue-Figure")</span></span>  
  
 <span data-ttu-id="6eef8-116">Come risulta evidente dalla figura precedente, il client e il servizio devono definire solo la semantica dell'applicazione, ovvero, il contratto e l'implementazione.</span><span class="sxs-lookup"><span data-stu-id="6eef8-116">As you can see from the preceding figure, the client and service must define only the application semantics, that is, the contract and implementation.</span></span> <span data-ttu-id="6eef8-117">Il servizio configura un'associazione in coda con le impostazioni preferite.</span><span class="sxs-lookup"><span data-stu-id="6eef8-117">The service configures a queued binding with preferred settings.</span></span> <span data-ttu-id="6eef8-118">Il client utilizza il [strumento ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) per generare un [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client per il servizio e per generare un file di configurazione che descrive i binding da usare per inviare messaggi al servizio.</span><span class="sxs-lookup"><span data-stu-id="6eef8-118">The client uses the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) to generate a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client to the service and to generate a configuration file that describes the bindings to use to send messages to the service.</span></span> <span data-ttu-id="6eef8-119">Quindi, per inviare un messaggio in coda, il client crea un'istanza di un client [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] e richiama un'operazione su di essa.</span><span class="sxs-lookup"><span data-stu-id="6eef8-119">Thus, to send a queued message, the client instantiates a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client and invokes an operation on it.</span></span> <span data-ttu-id="6eef8-120">Questo fa sì che il messaggio venga inviato alla coda di trasmissione e trasferito alla coda di destinazione.</span><span class="sxs-lookup"><span data-stu-id="6eef8-120">This causes the message to be sent to the transmission queue and transferred to the target queue.</span></span> <span data-ttu-id="6eef8-121">Tutte le complessità della comunicazione in coda vengono nascoste all'applicazione che sta inviando e ricevendo messaggi.</span><span class="sxs-lookup"><span data-stu-id="6eef8-121">All the complexities of queued communication are hidden from the application that is sending and receiving messages.</span></span>  
  
 <span data-ttu-id="6eef8-122">Tra i suggerimenti relativi all'associazione in coda in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] sono inclusi i seguenti:</span><span class="sxs-lookup"><span data-stu-id="6eef8-122">Caveats about queued binding in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] include:</span></span>  
  
-   <span data-ttu-id="6eef8-123">Tutte le operazioni del servizio devono essere unidirezionali, poiché l'associazione in coda predefinita in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] non supporta la comunicazione duplex tramite code.</span><span class="sxs-lookup"><span data-stu-id="6eef8-123">All service operations must be one-way because the default queued binding in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] does not support duplex communication using queues.</span></span> <span data-ttu-id="6eef8-124">Un esempio di comunicazioni bidirezionali ([comunicazione bidirezionale](../../../../docs/framework/wcf/samples/two-way-communication.md)) viene illustrato come utilizzare due contratti unidirezionali per implementare la comunicazione duplex tramite code.</span><span class="sxs-lookup"><span data-stu-id="6eef8-124">A two-way communication sample ([Two-Way Communication](../../../../docs/framework/wcf/samples/two-way-communication.md)) illustrates how to use two one-way contracts to implement duplex communication using queues.</span></span>  
  
-   <span data-ttu-id="6eef8-125">Per generare un client [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] usando lo scambio di metadati è necessario un endpoint HTTP aggiuntivo sul servizio, in modo sia possibile eseguire query dirette su di esso per generare il client [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] e ottenere le informazioni di associazione per configurare adeguatamente la comunicazione in coda.</span><span class="sxs-lookup"><span data-stu-id="6eef8-125">To generate a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client using metadata exchange requires an additional HTTP endpoint on the service so that it can be queried directly to generate the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client and obtain binding information to appropriately configure queued communication.</span></span>  
  
-   <span data-ttu-id="6eef8-126">In base all'associazione in coda, è necessaria una configurazione aggiuntiva all'esterno di [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6eef8-126">Based on the queued binding, extra configuration outside of [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] is required.</span></span> <span data-ttu-id="6eef8-127">Ad esempio, la classe <xref:System.ServiceModel.NetMsmqBinding> fornita con [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] richiede che si configurino le associazioni e si proceda alla configurazione minima dell'accodamento messaggi (MSMQ).</span><span class="sxs-lookup"><span data-stu-id="6eef8-127">For example, the <xref:System.ServiceModel.NetMsmqBinding> class that is shipped with [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] requires you to configure the bindings as well as minimally configure Message Queuing (MSMQ).</span></span>  
  
 <span data-ttu-id="6eef8-128">Nelle sezioni seguenti vengono descritte le associazioni in coda specifiche fornite con [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], basate su MSMQ.</span><span class="sxs-lookup"><span data-stu-id="6eef8-128">The following sections describe the specific queued bindings shipped with [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], which are based on MSMQ.</span></span>  
  
### <a name="msmq"></a><span data-ttu-id="6eef8-129">MSMQ</span><span class="sxs-lookup"><span data-stu-id="6eef8-129">MSMQ</span></span>  
 <span data-ttu-id="6eef8-130">Il trasporto in coda in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] usa MSMQ per la relativa comunicazione in coda.</span><span class="sxs-lookup"><span data-stu-id="6eef8-130">The queued transport in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] uses MSMQ for its queued communication.</span></span>  
  
 <span data-ttu-id="6eef8-131">MSMQ viene fornito con Windows come componente facoltativo e viene eseguito come servizio NT.</span><span class="sxs-lookup"><span data-stu-id="6eef8-131">MSMQ ships as an optional component with Windows and runs as an NT service.</span></span> <span data-ttu-id="6eef8-132">Acquisisce i messaggi per la trasmissione in una coda di trasmissione e per il recapito in una coda di destinazione.</span><span class="sxs-lookup"><span data-stu-id="6eef8-132">It captures messages for transmission in a transmission queue and for delivery in a target queue.</span></span> <span data-ttu-id="6eef8-133">I gestori code MSMQ implementano un protocollo di trasferimento messaggi affidabile, in modo che i messaggi non vengano persi durante la trasmissione.</span><span class="sxs-lookup"><span data-stu-id="6eef8-133">The MSMQ queue managers implement a reliable message-transfer protocol so that messages are not lost in transmission.</span></span> <span data-ttu-id="6eef8-134">Il protocollo può essere nativo o basato su SOAP, ad esempio SRMP (SOAP Reliable Message Protocol).</span><span class="sxs-lookup"><span data-stu-id="6eef8-134">The protocol can be either native or SOAP-based, such as the SOAP Reliable Message Protocol (SRMP).</span></span>  
  
 <span data-ttu-id="6eef8-135">In MSMQ, le code possono essere transazionali o non transazionali.</span><span class="sxs-lookup"><span data-stu-id="6eef8-135">In MSMQ, queues can be transactional or non-transactional.</span></span> <span data-ttu-id="6eef8-136">Una coda transazionale consente di acquisire e recapitare messaggi in una transazione, per poi archiviarli permanentemente nella coda.</span><span class="sxs-lookup"><span data-stu-id="6eef8-136">A transactional queue allows messages to be captured and delivered in a transaction and then stored durably in the queue.</span></span> <span data-ttu-id="6eef8-137">I messaggi inviati a una coda transazionale vengono trasferiti esattamente una volta in ordine.</span><span class="sxs-lookup"><span data-stu-id="6eef8-137">Messages sent to a transactional queue are transferred exactly once in order.</span></span> <span data-ttu-id="6eef8-138">È possibile usare una coda non transazionale per inviare messaggi volatili e durevoli.</span><span class="sxs-lookup"><span data-stu-id="6eef8-138">You can use a non-transactional queue to send both volatile and durable messages.</span></span> <span data-ttu-id="6eef8-139">Un messaggio inviato a una coda non transazionale non offre alcuna assicurazione di trasferimento affidabile e può quindi essere perso.</span><span class="sxs-lookup"><span data-stu-id="6eef8-139">A message sent to a non-transactional queue does not carry any reliable transfer assurances; thus, messages can be lost.</span></span>  
  
 <span data-ttu-id="6eef8-140">Le code MSMQ possono essere protette anche usando un'identità di Windows registrata con il servizio directory Active Directory.</span><span class="sxs-lookup"><span data-stu-id="6eef8-140">MSMQ queues can also be secured using a Windows identity registered with the Active Directory directory service.</span></span> <span data-ttu-id="6eef8-141">Quando si installa MSMQ, è possibile installare l'integrazione di Active Directory, che richiede che il computer faccia parte di una rete di dominio Windows.</span><span class="sxs-lookup"><span data-stu-id="6eef8-141">When installing MSMQ, you can install Active Directory integration, which requires the computer to be part of a Windows domain network.</span></span>  
  
 <span data-ttu-id="6eef8-142">Per ulteriori informazioni su MSMQ, vedere [installazione di Accodamento messaggi (MSMQ)](../../../../docs/framework/wcf/samples/installing-message-queuing-msmq.md).</span><span class="sxs-lookup"><span data-stu-id="6eef8-142">For more information about MSMQ, see [Installing Message Queuing (MSMQ)](../../../../docs/framework/wcf/samples/installing-message-queuing-msmq.md).</span></span>  
  
### <a name="netmsmqbinding"></a><span data-ttu-id="6eef8-143">NetMsmqBinding</span><span class="sxs-lookup"><span data-stu-id="6eef8-143">NetMsmqBinding</span></span>  
 <span data-ttu-id="6eef8-144">Il [ \<netMsmqBinding >](../../../../docs/framework/configure-apps/file-schema/wcf/netmsmqbinding.md) è l'associazione in coda [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] fornisce per due [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] endpoint per comunicare tramite MSMQ.</span><span class="sxs-lookup"><span data-stu-id="6eef8-144">The [\<netMsmqBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/netmsmqbinding.md) is the queued binding [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] provides for two [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] endpoints to communicate using MSMQ.</span></span> <span data-ttu-id="6eef8-145">L'associazione, pertanto, espone proprietà specifiche di MSMQ.</span><span class="sxs-lookup"><span data-stu-id="6eef8-145">The binding, therefore, exposes properties that are specific to MSMQ.</span></span> <span data-ttu-id="6eef8-146">Tuttavia, non tutte le funzionalità e le proprietà di MSMQ vengono esposte in `NetMsmqBinding`.</span><span class="sxs-lookup"><span data-stu-id="6eef8-146">However, not all MSMQ features and properties are exposed in the `NetMsmqBinding`.</span></span> <span data-ttu-id="6eef8-147">La classe compatta `NetMsmqBinding` è progettata con un set ottimale di funzionalità che la maggior parte dei clienti dovrebbe trovare sufficiente.</span><span class="sxs-lookup"><span data-stu-id="6eef8-147">The compact `NetMsmqBinding` is designed with an optimal set of features that most customers should find sufficient.</span></span>  
  
 <span data-ttu-id="6eef8-148">La classe `NetMsmqBinding` manifesta i principali concetti di accodamento descritti fino ad ora nella forma di proprietà sulle associazioni.</span><span class="sxs-lookup"><span data-stu-id="6eef8-148">The `NetMsmqBinding` manifests the core queuing concepts discussed thus far in the form of properties on the bindings.</span></span> <span data-ttu-id="6eef8-149">Queste proprietà, a loro volta, comunicano a MSMQ come trasferire e recapitare i messaggi.</span><span class="sxs-lookup"><span data-stu-id="6eef8-149">These properties, in turn, communicate to MSMQ how to transfer and deliver the messages.</span></span> <span data-ttu-id="6eef8-150">Nelle sezioni seguenti vengono descritte le categorie di proprietà.</span><span class="sxs-lookup"><span data-stu-id="6eef8-150">A discussion of the property categories is in the following sections.</span></span> <span data-ttu-id="6eef8-151">Per altre informazioni, vedere gli argomenti concettuali che descrivono le proprietà specifiche più completo.</span><span class="sxs-lookup"><span data-stu-id="6eef8-151">For more information, see the conceptual topics that describe specific properties more completely.</span></span>  
  
#### <a name="exactlyonce-and-durable-properties"></a><span data-ttu-id="6eef8-152">Proprietà ExactlyOnce e Durable</span><span class="sxs-lookup"><span data-stu-id="6eef8-152">ExactlyOnce and Durable Properties</span></span>  
 <span data-ttu-id="6eef8-153">Le proprietà `ExactlyOnce` e `Durable` incidono sulla modalità di trasferimento dei messaggi tra le code:</span><span class="sxs-lookup"><span data-stu-id="6eef8-153">The `ExactlyOnce` and `Durable` properties affect how messages are transferred between queues:</span></span>  
  
-   <span data-ttu-id="6eef8-154">`ExactlyOnce`: se è impostata su `true` (impostazione predefinita), il canale in coda assicura che il messaggio, se recapitato, non venga duplicato.</span><span class="sxs-lookup"><span data-stu-id="6eef8-154">`ExactlyOnce`: When set to `true` (the default), the queued channel ensures that the message, if delivered, is not duplicated.</span></span> <span data-ttu-id="6eef8-155">Assicura inoltre che il messaggio non venga perso.</span><span class="sxs-lookup"><span data-stu-id="6eef8-155">It also ensures that the message is not lost.</span></span> <span data-ttu-id="6eef8-156">Se il messaggio non può essere recapitato o se la durata del messaggio scade prima che il messaggio possa essere recapitato, il messaggio non riuscito, insieme al motivo dell'errore di recapito, viene registrato in una coda di messaggi non recapitabili.</span><span class="sxs-lookup"><span data-stu-id="6eef8-156">If the message cannot be delivered, or the message Time-To Live expires before the message can be delivered, the failed message along with the delivery failure reason is recorded in a dead-letter queue.</span></span> <span data-ttu-id="6eef8-157">Se la proprietà è impostata su `false`, il canale in coda tenta di trasferire il messaggio.</span><span class="sxs-lookup"><span data-stu-id="6eef8-157">When set to `false`, the queued channel makes an effort to transfer the message.</span></span> <span data-ttu-id="6eef8-158">In questo caso, è possibile scegliere una coda di messaggi non recapitabili.</span><span class="sxs-lookup"><span data-stu-id="6eef8-158">In this case, you can optionally choose a dead-letter queue.</span></span>  
  
-   <span data-ttu-id="6eef8-159">`Durable:` se è impostata su `true` (impostazione predefinita), il canale in coda assicura che MSMQ archivi il messaggio sul disco in modo permanente.</span><span class="sxs-lookup"><span data-stu-id="6eef8-159">`Durable:` When set to `true` (the default), the queued channel ensures that MSMQ stores the message durably on disk.</span></span> <span data-ttu-id="6eef8-160">Così, se il servizio MSMQ viene interrotto e riavviato, il messaggio sul disco viene trasferito alla coda di destinazione o recapitato al servizio.</span><span class="sxs-lookup"><span data-stu-id="6eef8-160">Thus, if the MSMQ service were to stop and restart, the messages on disk is transferred to the target queue or delivered to the service.</span></span> <span data-ttu-id="6eef8-161">Se la proprietà è impostata su `false`, i messaggi vengono memorizzati in un archivio volatile e persi al momento dell'interruzione e del riavvio del servizio MSMQ.</span><span class="sxs-lookup"><span data-stu-id="6eef8-161">When set to `false`, the messages are stored in volatile store and are lost on stopping and restarting the MSMQ service.</span></span>  
  
 <span data-ttu-id="6eef8-162">Per il trasferimento affidabile `ExactlyOnce`, MSMQ richiede che la coda sia transazionale.</span><span class="sxs-lookup"><span data-stu-id="6eef8-162">For `ExactlyOnce` reliable transfer, MSMQ requires the queue to be transactional.</span></span> <span data-ttu-id="6eef8-163">Inoltre, MSMQ richiede una transazione da leggere da una coda transazionale.</span><span class="sxs-lookup"><span data-stu-id="6eef8-163">Also, MSMQ requires a transaction to read from a transactional queue.</span></span> <span data-ttu-id="6eef8-164">Se si usa `NetMsmqBinding` è quindi importante ricordare che è necessaria una transazione per inviare o ricevere messaggi quando la proprietà `ExactlyOnce` è impostata su `true`.</span><span class="sxs-lookup"><span data-stu-id="6eef8-164">As such, when you use the `NetMsmqBinding`, remember that a transaction is required to send or receive messages when `ExactlyOnce` is set to `true`.</span></span> <span data-ttu-id="6eef8-165">Allo stesso modo, MSMQ richiede che la coda sia non transazionale per le situazioni che necessitano del massimo sforzo, come quando `ExactlyOnce` è `false` e per la messaggistica volatile.</span><span class="sxs-lookup"><span data-stu-id="6eef8-165">Similarly, MSMQ requires the queue to be non-transactional for best-effort assurances, such as when `ExactlyOnce` is `false` and for volatile messaging.</span></span> <span data-ttu-id="6eef8-166">Quindi, quando si imposta `ExactlyOnce` su `false` o Durable su `false`, non è possibile inviare o ricevere messaggi usando una transazione.</span><span class="sxs-lookup"><span data-stu-id="6eef8-166">Thus, when setting `ExactlyOnce` to `false` or durable to `false`, you cannot send or receive using a transaction.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6eef8-167">Assicurarsi che venga creata la coda corretta (transazionale o non transazionale) in base alle impostazioni nelle associazioni.</span><span class="sxs-lookup"><span data-stu-id="6eef8-167">Ensure that the correct queue (transactional or non-transactional) is created based on settings in the bindings.</span></span> <span data-ttu-id="6eef8-168">Se `ExactlyOnce` è `true`, usare una coda transazionale; altrimenti, usare una coda non transazionale.</span><span class="sxs-lookup"><span data-stu-id="6eef8-168">If `ExactlyOnce` is `true`, use a transactional queue; otherwise, use a non-transactional queue.</span></span>  
  
#### <a name="dead-letter-queue-properties"></a><span data-ttu-id="6eef8-169">Proprietà della coda di messaggi non recapitabili</span><span class="sxs-lookup"><span data-stu-id="6eef8-169">Dead-Letter Queue Properties</span></span>  
 <span data-ttu-id="6eef8-170">La coda di messaggi non recapitabili viene usata per archiviare i messaggi il cui recapito ha esito negativo.</span><span class="sxs-lookup"><span data-stu-id="6eef8-170">The dead-letter queue is used to store messages that fail delivery.</span></span> <span data-ttu-id="6eef8-171">L'utente può scrivere una logica di compensazione che legga i messaggi dalla coda di messaggi non recapitabili.</span><span class="sxs-lookup"><span data-stu-id="6eef8-171">The user can write compensating logic that reads messages out of the dead-letter queue.</span></span>  
  
 <span data-ttu-id="6eef8-172">Molti sistemi di accodamento prevedono una coda di messaggi non recapitabili a livello di sistema.</span><span class="sxs-lookup"><span data-stu-id="6eef8-172">Many queuing systems provide for a system-wide dead-letter queue.</span></span> <span data-ttu-id="6eef8-173">MSMQ include una coda di messaggi non recapitabili non transazionale a livello di sistema per i messaggi il cui recapito nelle code non transazionali ha esito negativo e una coda di messaggi non recapitabili transazionale a livello di sistema per i messaggi il cui recapito nelle code transazionali ha esito negativo.</span><span class="sxs-lookup"><span data-stu-id="6eef8-173">MSMQ provides a system-wide non-transactional dead-letter queue for messages that fail delivery to non-transactional queues and a system-wide transactional dead-letter queue for messages that fail delivery to transactional queues.</span></span>  
  
 <span data-ttu-id="6eef8-174">Se più client che inviano messaggi a code di destinazione diverse condividono il servizio MSMQ, tutti i messaggi inviati dai client finiranno nella stessa coda di messaggi non recapitabili.</span><span class="sxs-lookup"><span data-stu-id="6eef8-174">If multiple clients sending messages to different target queues share the MSMQ service, all messages sent by the clients go to the same dead-letter queue.</span></span> <span data-ttu-id="6eef8-175">Ciò non è sempre preferibile.</span><span class="sxs-lookup"><span data-stu-id="6eef8-175">This is not always preferable.</span></span> <span data-ttu-id="6eef8-176">Per un migliore isolamento, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] e MSMQ in [!INCLUDE[wv](../../../../includes/wv-md.md)] prevedono una coda di messaggi non recapitabili personalizzata (o specifica dell'applicazione) che l'utente può specificare per l'archiviazione dei messaggi il cui recapito ha esito negativo.</span><span class="sxs-lookup"><span data-stu-id="6eef8-176">For better isolation, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] and MSMQ in [!INCLUDE[wv](../../../../includes/wv-md.md)] provide a custom dead-letter queue (or application-specific dead-letter queue) that the user can specify to store messages that fail delivery.</span></span> <span data-ttu-id="6eef8-177">Pertanto, client diversi non condividono la stessa coda di messaggi non recapitabili.</span><span class="sxs-lookup"><span data-stu-id="6eef8-177">Therefore, different clients do not share the same dead-letter queue.</span></span>  
  
 <span data-ttu-id="6eef8-178">L'associazione dispone di due proprietà interessanti:</span><span class="sxs-lookup"><span data-stu-id="6eef8-178">The binding has two properties of interest:</span></span>  
  
-   <span data-ttu-id="6eef8-179">`DeadLetterQueue`: questa proprietà è un'enumerazione che indica se è necessaria una coda di messaggi non recapitabili.</span><span class="sxs-lookup"><span data-stu-id="6eef8-179">`DeadLetterQueue`: This property is an enumeration that indicates whether a dead-letter queue is requested.</span></span> <span data-ttu-id="6eef8-180">Nel caso sia necessaria, l'enumerazione contiene anche il tipo di coda di messaggi non recapitabili.</span><span class="sxs-lookup"><span data-stu-id="6eef8-180">The enumeration also contains the kind of dead-letter queue, if one is requested.</span></span> <span data-ttu-id="6eef8-181">I valori sono `None`, `System` e `Custom`.</span><span class="sxs-lookup"><span data-stu-id="6eef8-181">The values are `None`, `System`, and `Custom`.</span></span> <span data-ttu-id="6eef8-182">Per ulteriori informazioni sull'interpretazione di queste proprietà, vedere [utilizzando code per gestire gli errori di trasferimento dei messaggi](../../../../docs/framework/wcf/feature-details/using-dead-letter-queues-to-handle-message-transfer-failures.md)</span><span class="sxs-lookup"><span data-stu-id="6eef8-182">For more information about the interpretation of these properties, see [Using Dead-Letter Queues to Handle Message Transfer Failures](../../../../docs/framework/wcf/feature-details/using-dead-letter-queues-to-handle-message-transfer-failures.md)</span></span>  
  
-   <span data-ttu-id="6eef8-183">`CustomDeadLetterQueue`: questa proprietà è l'indirizzo URI (Uniform Resource Identifier) della coda di messaggi non recapitabili specifica dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="6eef8-183">`CustomDeadLetterQueue`: This property is the Uniform Resource Identifier (URI) address of the application-specific dead-letter queue.</span></span> <span data-ttu-id="6eef8-184">Questa operazione è necessaria se `DeadLetterQueue`.`Custom`</span><span class="sxs-lookup"><span data-stu-id="6eef8-184">This is required if `DeadLetterQueue`.`Custom`</span></span> <span data-ttu-id="6eef8-185">viene scelto.</span><span class="sxs-lookup"><span data-stu-id="6eef8-185">is chosen.</span></span>  
  
#### <a name="poison-message-handling-properties"></a><span data-ttu-id="6eef8-186">Proprietà di gestione dei messaggi non elaborabili</span><span class="sxs-lookup"><span data-stu-id="6eef8-186">Poison Message Handling properties</span></span>  
 <span data-ttu-id="6eef8-187">Quando il servizio legge un messaggio dalla coda di destinazione in una transazione, è possibile che non riesca a elaborarlo per vari motivi.</span><span class="sxs-lookup"><span data-stu-id="6eef8-187">When the service reads messages from the target queue under a transaction, the service may fail to process the message for various reasons.</span></span> <span data-ttu-id="6eef8-188">Il messaggio viene quindi reinserito nella coda per essere nuovamente letto.</span><span class="sxs-lookup"><span data-stu-id="6eef8-188">The message is then put back into the queue to be read again.</span></span> <span data-ttu-id="6eef8-189">Per gestire messaggi la cui elaborazione ripetutamente esito negativo, è possibile configurare nell'associazione un set di proprietà di gestione dei messaggi non elaborabili.</span><span class="sxs-lookup"><span data-stu-id="6eef8-189">To deal with messages that fail repeatedly, a set of poison-message handling properties can be configured in the binding.</span></span> <span data-ttu-id="6eef8-190">Sono disponibili quattro proprietà: `ReceiveRetryCount`, `MaxRetryCycles`, `RetryCycleDelay` e `ReceiveErrorHandling`.</span><span class="sxs-lookup"><span data-stu-id="6eef8-190">There are four properties: `ReceiveRetryCount`, `MaxRetryCycles`, `RetryCycleDelay`, and `ReceiveErrorHandling`.</span></span> <span data-ttu-id="6eef8-191">Per ulteriori informazioni su queste proprietà, vedere [messaggi non elaborabili](../../../../docs/framework/wcf/feature-details/poison-message-handling.md).</span><span class="sxs-lookup"><span data-stu-id="6eef8-191">For more information about these properties, see [Poison Message Handling](../../../../docs/framework/wcf/feature-details/poison-message-handling.md).</span></span>  
  
#### <a name="security-properties"></a><span data-ttu-id="6eef8-192">Proprietà di sicurezza</span><span class="sxs-lookup"><span data-stu-id="6eef8-192">Security Properties</span></span>  
 <span data-ttu-id="6eef8-193">MSMQ espone il proprio modello di sicurezza, che prevede ad esempio l'applicazione di elenchi di controllo di accesso (ACL) su una coda o l'invio di messaggi autenticati.</span><span class="sxs-lookup"><span data-stu-id="6eef8-193">MSMQ exposes its own security model, such as access control lists (ACLs) on a queue or sending authenticated messages.</span></span> <span data-ttu-id="6eef8-194">La classe `NetMsmqBinding` espone queste proprietà di sicurezza come parte delle proprie impostazioni di sicurezza del trasporto.</span><span class="sxs-lookup"><span data-stu-id="6eef8-194">The `NetMsmqBinding` exposes these security properties as part of its transport security settings.</span></span> <span data-ttu-id="6eef8-195">Nell'associazione sono presenti due proprietà per la sicurezza del trasporto: `MsmqAuthenticationMode` e `MsmqProtectionLevel`.</span><span class="sxs-lookup"><span data-stu-id="6eef8-195">There are two properties in the binding for transport security: `MsmqAuthenticationMode` and `MsmqProtectionLevel`.</span></span> <span data-ttu-id="6eef8-196">Le impostazioni in queste proprietà dipendono dalla modalità di configurazione di MSMQ.</span><span class="sxs-lookup"><span data-stu-id="6eef8-196">Settings in these properties depend on how MSMQ is configured.</span></span> <span data-ttu-id="6eef8-197">Per altre informazioni, vedere [proteggere i messaggi mediante protezione del trasporto](../../../../docs/framework/wcf/feature-details/securing-messages-using-transport-security.md).</span><span class="sxs-lookup"><span data-stu-id="6eef8-197">For more information, see [Securing Messages Using Transport Security](../../../../docs/framework/wcf/feature-details/securing-messages-using-transport-security.md).</span></span>  
  
 <span data-ttu-id="6eef8-198">Oltre alla sicurezza del trasporto, il messaggio SOAP effettivo stesso può essere protetto usando la sicurezza dei messaggi.</span><span class="sxs-lookup"><span data-stu-id="6eef8-198">In addition to transport security, the actual SOAP message itself can be secured using message security.</span></span> <span data-ttu-id="6eef8-199">Per altre informazioni, vedere [sicurezza la protezione dei messaggi tramite messaggio](../../../../docs/framework/wcf/feature-details/securing-messages-using-message-security.md).</span><span class="sxs-lookup"><span data-stu-id="6eef8-199">For more information, see [Securing Messages Using Message Security](../../../../docs/framework/wcf/feature-details/securing-messages-using-message-security.md).</span></span>  
  
 <span data-ttu-id="6eef8-200">Anche `MsmqTransportSecurity` espone due proprietà, `MsmqEncryptionAlgorithm` e `MsmqHashAlgorithm`.</span><span class="sxs-lookup"><span data-stu-id="6eef8-200">`MsmqTransportSecurity` also exposes two properties, `MsmqEncryptionAlgorithm` and `MsmqHashAlgorithm`.</span></span> <span data-ttu-id="6eef8-201">Si tratta di enumerazioni di algoritmi diversi da scegliere per la crittografia del trasferimento da coda a coda di messaggi e l'hash delle firme.</span><span class="sxs-lookup"><span data-stu-id="6eef8-201">These are enumerations of different algorithms to choose for queue-to-queue transfer encryption of messages and hashing of the signatures.</span></span>  
  
#### <a name="other-properties"></a><span data-ttu-id="6eef8-202">Altre proprietà</span><span class="sxs-lookup"><span data-stu-id="6eef8-202">Other Properties</span></span>  
 <span data-ttu-id="6eef8-203">Oltre alle proprietà precedenti, le altre proprietà specifiche di MSMQ esposte nell'associazione includono:</span><span class="sxs-lookup"><span data-stu-id="6eef8-203">In addition to the preceding properties, other MSMQ-specific properties exposed in the binding include:</span></span>  
  
-   <span data-ttu-id="6eef8-204">`UseSourceJournal`: proprietà che indica che l'inserimento nel journal di origine è attivato.</span><span class="sxs-lookup"><span data-stu-id="6eef8-204">`UseSourceJournal`: A property to indicate that source journaling is turned on.</span></span> <span data-ttu-id="6eef8-205">L'inserimento nel journal di origine è una funzionalità MSMQ che consente di tenere traccia dei messaggi correttamente trasmessi dalla coda di trasmissione.</span><span class="sxs-lookup"><span data-stu-id="6eef8-205">Source journaling is an MSMQ feature that keeps track of messages that have been successfully transmitted from the transmission queue.</span></span>  
  
-   <span data-ttu-id="6eef8-206">`UseMsmqTracing`: proprietà che indica che la traccia MSMQ è attivata.</span><span class="sxs-lookup"><span data-stu-id="6eef8-206">`UseMsmqTracing`: A property to indicate that MSMQ tracing is turned on.</span></span> <span data-ttu-id="6eef8-207">La traccia MSMQ consente di inviare messaggi di rapporto a una coda dei rapporti ogni volta che un messaggio lascia o arriva in un computer che ospita un gestore code MSMQ.</span><span class="sxs-lookup"><span data-stu-id="6eef8-207">MSMQ tracing sends report messages to a report queue each time a message leaves or arrives at a machine hosting an MSMQ queue manager.</span></span>  
  
-   <span data-ttu-id="6eef8-208">`QueueTransferProtocol`: enumerazione del protocollo da usare per i trasferimenti di messaggi da coda a coda.</span><span class="sxs-lookup"><span data-stu-id="6eef8-208">`QueueTransferProtocol`: An enumeration of the protocol to use for queue-to-queue message transfers.</span></span> <span data-ttu-id="6eef8-209">MSMQ implementa un protocollo di trasferimento da coda a coda nativo e un protocollo basato su SOAP denominato SRMP (SOAP Reliable Messaging Protocol).</span><span class="sxs-lookup"><span data-stu-id="6eef8-209">MSMQ implements a native queue-to-queue transfer protocol and a SOAP-based protocol called SOAP Reliable Messaging Protocol (SRMP).</span></span> <span data-ttu-id="6eef8-210">SRMP viene usato quando si usa il trasporto HTTP per i trasferimenti da coda a coda.</span><span class="sxs-lookup"><span data-stu-id="6eef8-210">SRMP is used when using HTTP transport for queue-to-queue transfers.</span></span> <span data-ttu-id="6eef8-211">Viene invece usato il protocollo SRMP protetto quando si usa HTTPS per i trasferimenti da coda a coda.</span><span class="sxs-lookup"><span data-stu-id="6eef8-211">SRMP secure is used when using HTTPS for queue-to-queue transfers.</span></span>  
  
-   <span data-ttu-id="6eef8-212">`UseActiveDirectory`: valore booleano che indica se è necessario usare Active Directory per la risoluzione degli indirizzi delle code.</span><span class="sxs-lookup"><span data-stu-id="6eef8-212">`UseActiveDirectory`: A Boolean value to indicate whether the Active Directory must be used for queue address resolution.</span></span> <span data-ttu-id="6eef8-213">Per impostazione predefinita, questa funzionalità è disattivata.</span><span class="sxs-lookup"><span data-stu-id="6eef8-213">By default, this is off.</span></span> <span data-ttu-id="6eef8-214">Per altre informazioni, vedere [gli endpoint del servizio e l'indirizzamento delle code](../../../../docs/framework/wcf/feature-details/service-endpoints-and-queue-addressing.md).</span><span class="sxs-lookup"><span data-stu-id="6eef8-214">For more information, see [Service Endpoints and Queue Addressing](../../../../docs/framework/wcf/feature-details/service-endpoints-and-queue-addressing.md).</span></span>  
  
### <a name="msmqintegrationbinding"></a><span data-ttu-id="6eef8-215">MsmqIntegrationBinding</span><span class="sxs-lookup"><span data-stu-id="6eef8-215">MsmqIntegrationBinding</span></span>  
 <span data-ttu-id="6eef8-216">La classe `MsmqIntegrationBinding` viene usata quando si desidera che un endpoint [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] comunichi con un'applicazione MSMQ esistente scritta in C, C++, COM o con API System.Messaging.</span><span class="sxs-lookup"><span data-stu-id="6eef8-216">The `MsmqIntegrationBinding` is used when you want a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] endpoint to communicate with an existing MSMQ application written in C, C++, COM, or System.Messaging APIs.</span></span>  
  
 <span data-ttu-id="6eef8-217">Le proprietà dell'associazione sono le stesse di `NetMsmqBinding`.</span><span class="sxs-lookup"><span data-stu-id="6eef8-217">The binding properties are the same as for `NetMsmqBinding`.</span></span> <span data-ttu-id="6eef8-218">Esistono tuttavia le differenze seguenti:</span><span class="sxs-lookup"><span data-stu-id="6eef8-218">However, the following differences apply:</span></span>  
  
-   <span data-ttu-id="6eef8-219">Il contratto dell'operazione per `MsmqIntegrationBinding` si limita ad accettare un solo parametro di tipo <xref:System.ServiceModel.MsmqIntegration.MsmqMessage%601>, in cui il parametro di tipo è il tipo di corpo.</span><span class="sxs-lookup"><span data-stu-id="6eef8-219">The operation contract for `MsmqIntegrationBinding` is restricted to taking a single parameter of type <xref:System.ServiceModel.MsmqIntegration.MsmqMessage%601> where the type parameter is the body type.</span></span>  
  
-   <span data-ttu-id="6eef8-220">Molte delle proprietà dei messaggi native MSMQ vengono esposte in <xref:System.ServiceModel.MsmqIntegration.MsmqMessage%601> per l'uso.</span><span class="sxs-lookup"><span data-stu-id="6eef8-220">Much of MSMQ native message properties are exposed in the <xref:System.ServiceModel.MsmqIntegration.MsmqMessage%601> for use.</span></span>  
  
-   <span data-ttu-id="6eef8-221">Per agevolare la serializzazione e la deserializzazione del corpo del messaggio vengono forniti serializzatori XML e ActiveX.</span><span class="sxs-lookup"><span data-stu-id="6eef8-221">To help with serialization and deserialization of the message body, serializers such as XML and ActiveX are provided.</span></span>  
  
### <a name="sample-code"></a><span data-ttu-id="6eef8-222">Codice di esempio</span><span class="sxs-lookup"><span data-stu-id="6eef8-222">Sample Code</span></span>  
 <span data-ttu-id="6eef8-223">Per istruzioni dettagliate su come scrivere servizi WCF che usano MSMQ, vedere gli argomenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="6eef8-223">For step by step instructions on how to write WCF services that use MSMQ see the following topics:</span></span>  
  
-   [<span data-ttu-id="6eef8-224">Procedura: Scambiare messaggi con endpoint WCF e con applicazioni di accodamento messaggi</span><span class="sxs-lookup"><span data-stu-id="6eef8-224">How to: Exchange Messages with WCF Endpoints and Message Queuing Applications</span></span>](../../../../docs/framework/wcf/feature-details/how-to-exchange-messages-with-wcf-endpoints-and-message-queuing-applications.md)  
  
-   [<span data-ttu-id="6eef8-225">Procedura: Scambiare messaggi in coda con endpoint WCF</span><span class="sxs-lookup"><span data-stu-id="6eef8-225">How to: Exchange Queued Messages with WCF Endpoints</span></span>](../../../../docs/framework/wcf/feature-details/how-to-exchange-queued-messages-with-wcf-endpoints.md)  
  
 <span data-ttu-id="6eef8-226">Per un esempio di codice completo in cui viene illustrato l'uso di MSMQ in WCF, vedere gli argomenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="6eef8-226">For a completed code sample illustrating the use of MSMQ in WCF see the following topics:</span></span>  
  
-   [<span data-ttu-id="6eef8-227">Associazioni MSMQ transazionali</span><span class="sxs-lookup"><span data-stu-id="6eef8-227">Transacted MSMQ Binding</span></span>](../../../../docs/framework/wcf/samples/transacted-msmq-binding.md)  
  
-   [<span data-ttu-id="6eef8-228">Comunicazione volatile in coda</span><span class="sxs-lookup"><span data-stu-id="6eef8-228">Volatile Queued Communication</span></span>](../../../../docs/framework/wcf/samples/volatile-queued-communication.md)  
  
-   [<span data-ttu-id="6eef8-229">Code di messaggi non recapitabili</span><span class="sxs-lookup"><span data-stu-id="6eef8-229">Dead Letter Queues</span></span>](../../../../docs/framework/wcf/samples/dead-letter-queues.md)  
  
-   [<span data-ttu-id="6eef8-230">Sessioni e code</span><span class="sxs-lookup"><span data-stu-id="6eef8-230">Sessions and Queues</span></span>](../../../../docs/framework/wcf/samples/sessions-and-queues.md)  
  
-   [<span data-ttu-id="6eef8-231">Comunicazione bidirezionale</span><span class="sxs-lookup"><span data-stu-id="6eef8-231">Two-Way Communication</span></span>](../../../../docs/framework/wcf/samples/two-way-communication.md)  
  
-   [<span data-ttu-id="6eef8-232">Batch transazionale</span><span class="sxs-lookup"><span data-stu-id="6eef8-232">Transacted Batching</span></span>](../../../../docs/framework/wcf/samples/transacted-batching.md)  
  
-   [<span data-ttu-id="6eef8-233">SRMP</span><span class="sxs-lookup"><span data-stu-id="6eef8-233">SRMP</span></span>](../../../../docs/framework/wcf/samples/srmp.md)  
  
-   [<span data-ttu-id="6eef8-234">Sicurezza dei messaggi nell'accodamento messaggi</span><span class="sxs-lookup"><span data-stu-id="6eef8-234">Message Security over Message Queuing</span></span>](../../../../docs/framework/wcf/samples/message-security-over-message-queuing.md)  
  
## <a name="see-also"></a><span data-ttu-id="6eef8-235">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="6eef8-235">See Also</span></span>  
 [<span data-ttu-id="6eef8-236">Endpoint di servizio e indirizzamento delle code</span><span class="sxs-lookup"><span data-stu-id="6eef8-236">Service Endpoints and Queue Addressing</span></span>](../../../../docs/framework/wcf/feature-details/service-endpoints-and-queue-addressing.md)  
 [<span data-ttu-id="6eef8-237">Hosting Web di un'applicazione in coda</span><span class="sxs-lookup"><span data-stu-id="6eef8-237">Web Hosting a Queued Application</span></span>](../../../../docs/framework/wcf/feature-details/web-hosting-a-queued-application.md)
