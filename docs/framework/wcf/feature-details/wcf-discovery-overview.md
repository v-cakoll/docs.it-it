---
title: Panoramica di WCF Discovery
ms.date: 03/30/2017
ms.assetid: 84fad0e4-23b1-45b5-a2d4-c9cdf90bbb22
ms.openlocfilehash: 46092c3bce87d426f4d465367e99a9ebb6dc37fa
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/24/2020
ms.locfileid: "76737486"
---
# <a name="wcf-discovery-overview"></a><span data-ttu-id="7f212-102">Panoramica di WCF Discovery</span><span class="sxs-lookup"><span data-stu-id="7f212-102">WCF Discovery Overview</span></span>
<span data-ttu-id="7f212-103">Le API di individuazione offrono un modello di programmazione unificato per la pubblicazione dinamica e l'individuazione di servizi Web utilizzando il protocollo WS-Discovery.</span><span class="sxs-lookup"><span data-stu-id="7f212-103">The Discovery APIs provide a unified programming model for the dynamic publication and discovery of Web services using the WS-Discovery protocol.</span></span> <span data-ttu-id="7f212-104">Queste API consentono la pubblicazione dei servizi e l'individuazione di tali servizi da parte dei client.</span><span class="sxs-lookup"><span data-stu-id="7f212-104">These APIs allow services to publish themselves and clients to find published services.</span></span> <span data-ttu-id="7f212-105">Una volta reso individuabile un servizio, quest'ultimo è in grado di inviare messaggi di annuncio nonché di essere in ascolto e di rispondere alle richieste di individuazione.</span><span class="sxs-lookup"><span data-stu-id="7f212-105">Once a service is made discoverable, the service has the ability to send announcement messages as well as listen for and respond to discovery requests.</span></span> <span data-ttu-id="7f212-106">I servizi individuabili possono inviare messaggi Hello per annunciare la propria presenza in rete e messaggi Bye per annunciare la propria uscita dalla rete.</span><span class="sxs-lookup"><span data-stu-id="7f212-106">Discoverable services can send Hello messages to announce their arrival on a network and Bye messages to announce their departure from a network.</span></span> <span data-ttu-id="7f212-107">Per trovare un servizio, i client inviano una richiesta `Probe` contenente criteri specifici quali il tipo di contratto servizio, le parole chiave e l'ambito nella rete.</span><span class="sxs-lookup"><span data-stu-id="7f212-107">To find a service, clients send a `Probe` request that contains specific criteria such as service contract type, keywords, and scope on the network.</span></span> <span data-ttu-id="7f212-108">I servizi ricevono la richiesta `Probe` e determinano se corrisponde ai criteri.</span><span class="sxs-lookup"><span data-stu-id="7f212-108">Services receive the `Probe` request and determine whether they match the criteria.</span></span> <span data-ttu-id="7f212-109">Se un servizio corrisponde, risponde restituendo un messaggio `ProbeMatch` al client con le informazioni necessarie per contattare il servizio.</span><span class="sxs-lookup"><span data-stu-id="7f212-109">If a service matches, it responds by sending a `ProbeMatch` message back to the client with the information necessary to contact the service.</span></span> <span data-ttu-id="7f212-110">I client possono inoltre inviare richieste `Resolve` che consentono loro di individuare i servizi che hanno modificato il relativo indirizzo endpoint.</span><span class="sxs-lookup"><span data-stu-id="7f212-110">Clients can also send `Resolve` requests that allow them to find services that may have changed their endpoint address.</span></span> <span data-ttu-id="7f212-111">I servizi corrispondenti rispondono alle richieste `Resolve` restituendo al client un messaggio `ResolveMatch`.</span><span class="sxs-lookup"><span data-stu-id="7f212-111">Matching services respond to `Resolve` requests by sending a `ResolveMatch` message back to the client.</span></span>  
  
## <a name="ad-hoc-and-managed-modes"></a><span data-ttu-id="7f212-112">Modalità ad hoc e gestita</span><span class="sxs-lookup"><span data-stu-id="7f212-112">Ad-Hoc and Managed Modes</span></span>  
 <span data-ttu-id="7f212-113">L'API di individuazione supporta due diverse modalità, ovvero gestita (Managed) e ad hoc (Adhoc).</span><span class="sxs-lookup"><span data-stu-id="7f212-113">The Discovery API supports two different modes: Managed and Ad-Hoc.</span></span> <span data-ttu-id="7f212-114">Nella modalità gestita è presente un server centralizzato denominato proxy di individuazione che gestisce le informazioni relative ai servizi disponibili.</span><span class="sxs-lookup"><span data-stu-id="7f212-114">In Managed mode there is a centralized server called a discovery proxy that maintains information about available services.</span></span> <span data-ttu-id="7f212-115">Il proxy di individuazione può essere popolato con le informazioni sui servizi in diversi modi.</span><span class="sxs-lookup"><span data-stu-id="7f212-115">The discovery proxy can be populated with information about services in a variety of ways.</span></span> <span data-ttu-id="7f212-116">I servizi possono ad esempio inviare al proxy di individuazione messaggi di annuncio in fase di avvio oppure il proxy può leggere i dati da un database o da un file di configurazione per determinare i servizi disponibili.</span><span class="sxs-lookup"><span data-stu-id="7f212-116">For example, services can send announcement messages during start up to the discovery proxy or the proxy may read data from a database or a configuration file to determine what services are available.</span></span> <span data-ttu-id="7f212-117">La modalità di popolamento di un proxy di individuazione viene scelta dallo sviluppatore.</span><span class="sxs-lookup"><span data-stu-id="7f212-117">How the discovery proxy is populated is completely up to the developer.</span></span> <span data-ttu-id="7f212-118">I client utilizzano il proxy di individuazione per recuperare informazioni sui servizi disponibili.</span><span class="sxs-lookup"><span data-stu-id="7f212-118">Clients use the discovery proxy to retrieve information about available services.</span></span> <span data-ttu-id="7f212-119">Quando un client cerca un servizio, invia un messaggio `Probe` al proxy di individuazione il quale determina se sono disponibili servizi noti corrispondenti a quello richiesto dal client.</span><span class="sxs-lookup"><span data-stu-id="7f212-119">When a client searches for a service it sends a `Probe` message to the discovery proxy and the proxy determines whether any of the services it knows about match the service the client is searching for.</span></span> <span data-ttu-id="7f212-120">Se vengono individuate corrispondente il proxy di individuazione restituisce una risposta `ProbeMatch` al client.</span><span class="sxs-lookup"><span data-stu-id="7f212-120">If there are matches the discovery proxy sends a `ProbeMatch` response back to the client.</span></span> <span data-ttu-id="7f212-121">Il client può quindi contattare il servizio utilizzando direttamente le apposite informazioni restituite dal proxy.</span><span class="sxs-lookup"><span data-stu-id="7f212-121">The client can then contact the service directly using the service information returned from the proxy.</span></span> <span data-ttu-id="7f212-122">Il principio chiave per quanto concerne la modalità gestite consiste nel fatto che le richieste di individuazione vengono inviate in modo unicast a un'autorità, ovvero il proxy di individuazione.</span><span class="sxs-lookup"><span data-stu-id="7f212-122">The key principle behind Managed mode is that the discovery requests are sent in a unicast manner to one authority, the discovery proxy.</span></span> <span data-ttu-id="7f212-123">.NET Framework contiene componenti chiave che consentono di compilare un proxy personalizzato.</span><span class="sxs-lookup"><span data-stu-id="7f212-123">The .NET Framework contains key components that allow you to build your own proxy.</span></span> <span data-ttu-id="7f212-124">I client e i servizi possono individuare il proxy in diversi modi:</span><span class="sxs-lookup"><span data-stu-id="7f212-124">Clients and services can locate the proxy by multiple methods:</span></span>  
  
- <span data-ttu-id="7f212-125">Il proxy può rispondere a messaggi ad hoc.</span><span class="sxs-lookup"><span data-stu-id="7f212-125">The proxy can respond to ad-hoc messages.</span></span>  
  
- <span data-ttu-id="7f212-126">Il proxy può inviare un messaggio di annuncio in fase di avvio.</span><span class="sxs-lookup"><span data-stu-id="7f212-126">The proxy can send an announcement message during start up.</span></span>  
  
- <span data-ttu-id="7f212-127">I client e i servizi possono essere progettati in modo da cercare un endpoint noto specifico.</span><span class="sxs-lookup"><span data-stu-id="7f212-127">Clients and services can be written to look for a specific well-known endpoint.</span></span>  
  
 <span data-ttu-id="7f212-128">Nella modalità ad hoc non è presente alcun server centralizzato.</span><span class="sxs-lookup"><span data-stu-id="7f212-128">In Ad-Hoc mode, there is no centralized server.</span></span> <span data-ttu-id="7f212-129">Tutti i messaggi di individuazione, quali gli annunci dei servizi e le richieste dei client, vengono inviati in modalità multicast.</span><span class="sxs-lookup"><span data-stu-id="7f212-129">All discovery messages such as service announcements and client requests are sent in a multicast fashion.</span></span> <span data-ttu-id="7f212-130">Per impostazione predefinita .NET Framework supporta l'individuazione ad hoc su protocollo UDP.</span><span class="sxs-lookup"><span data-stu-id="7f212-130">By default the .NET Framework contains support for Ad-Hoc discovery over the UDP protocol.</span></span> <span data-ttu-id="7f212-131">Se ad esempio un servizio è configurato per inviare un annuncio Hello all'avvio, il messaggio viene inviato a un indirizzo multicast noto mediante il protocollo UDP.</span><span class="sxs-lookup"><span data-stu-id="7f212-131">For example, if a service is configured to send out a Hello announcement on start up, it sends it out over a well-known, multicast address using the UDP protocol.</span></span> <span data-ttu-id="7f212-132">I client devono essere attivamente in ascolto degli annunci ed elaborarli in modo appropriato.</span><span class="sxs-lookup"><span data-stu-id="7f212-132">Clients have to actively listen for these announcements and process them accordingly.</span></span> <span data-ttu-id="7f212-133">I messaggi `Probe` inviati da un client per un servizio vengono inviati sulla rete mediante il protocollo multicast.</span><span class="sxs-lookup"><span data-stu-id="7f212-133">When a client sends a `Probe` message for a service it is sent over the network using a multicast protocol.</span></span> <span data-ttu-id="7f212-134">Ogni servizio che riceve la richiesta determina se sussiste la corrispondenza con i criteri del messaggio `Probe` e risponde direttamente al client con un messaggio `ProbeMatch` in caso di effettiva corrispondenza con i criteri del messaggio `Probe`.</span><span class="sxs-lookup"><span data-stu-id="7f212-134">Each service that receives the request determines whether it matches the criteria in the `Probe` message and responds directly to the client with a `ProbeMatch` message if the service matches the criteria specified in the `Probe` message.</span></span>  
  
## <a name="benefits-of-using-wcf-discovery"></a><span data-ttu-id="7f212-135">Vantaggi dell'utilizzo WCF Discovery</span><span class="sxs-lookup"><span data-stu-id="7f212-135">Benefits of Using WCF Discovery</span></span>  
 <span data-ttu-id="7f212-136">Poiché WCF Discovery viene implementato mediante il protocollo WS-Discovery è interoperativo con altri client, servizi e proxy che implementano tale protocollo.</span><span class="sxs-lookup"><span data-stu-id="7f212-136">Because WCF Discovery is implemented using the WS-Discovery protocol it is interoperable with other clients, services, and proxies that implement WS-Discovery as well.</span></span> <span data-ttu-id="7f212-137">WCF Discovery si basa sulle API WCF esistenti che semplificano l'aggiunta della funzionalità di individuazione ai servizi e ai client esistenti.</span><span class="sxs-lookup"><span data-stu-id="7f212-137">WCF Discovery is built upon the existing WCF APIs, which makes it easy to add Discovery functionality to your existing services and clients.</span></span> <span data-ttu-id="7f212-138">È possibile rendere i servizi individuabili tramite le impostazioni di configurazione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="7f212-138">Service discoverability can be easily added through the application configuration settings.</span></span> <span data-ttu-id="7f212-139">WCF Discovery supporta inoltre l'utilizzo del protocollo di individuazione su trasporti quali rete peer, sovrapposizione della denominazione e HTTP.</span><span class="sxs-lookup"><span data-stu-id="7f212-139">In addition, WCF Discovery also supports using the discovery protocol over other transports such as peer net, naming overlay, and HTTP.</span></span> <span data-ttu-id="7f212-140">WCF Discovery offre supporto per la modalità di funzionamento gestita in cui viene utilizzato un proxy di individuazione.</span><span class="sxs-lookup"><span data-stu-id="7f212-140">WCF Discovery provides support for a Managed mode of operation where a discovery proxy is used.</span></span> <span data-ttu-id="7f212-141">Ciò consente di ridurre il traffico di rete poiché i messaggi vengono inviati direttamente al proxy di individuazione invece che tramite multicast all'intera rete.</span><span class="sxs-lookup"><span data-stu-id="7f212-141">This can reduce network traffic as messages are sent directly to the discovery proxy instead of sending multicast messages to the entire network.</span></span> <span data-ttu-id="7f212-142">WCF Discovery assicura inoltre maggiore flessibilità per l'utilizzo dei servizi Web.</span><span class="sxs-lookup"><span data-stu-id="7f212-142">WCF Discovery also allows for more flexibility when working with Web services.</span></span> <span data-ttu-id="7f212-143">È ad esempio possibile modificare l'indirizzo di un servizio senza dovere riconfigurare il client o il servizio.</span><span class="sxs-lookup"><span data-stu-id="7f212-143">For example, you can change the address of a service without having to reconfigure the client or the service.</span></span> <span data-ttu-id="7f212-144">Quando un client deve accedere al servizio può inviare un messaggio `Probe` tramite una richiesta `Find` e attendere che il servizio risponda con il relativo indirizzo corrente.</span><span class="sxs-lookup"><span data-stu-id="7f212-144">When a client must access the service it can issue a `Probe` message through a `Find` request and expect the service to respond with its current address.</span></span> <span data-ttu-id="7f212-145">WCF Discovery consente a un client di cercare un servizio in base a diversi criteri tra cui i tipi di contratto, gli elementi di associazione, lo spazio dei nomi, l'ambito, le parole chiave o i numeri di versione.</span><span class="sxs-lookup"><span data-stu-id="7f212-145">WCF Discovery allows a client to search for a service based on different criteria including contract types, binding elements, namespace, scope, and keywords or version numbers.</span></span> <span data-ttu-id="7f212-146">WCF Discovery consente l'individuazione in fase di esecuzione e di progettazione.</span><span class="sxs-lookup"><span data-stu-id="7f212-146">WCF Discovery enables runtime and design time discovery.</span></span> <span data-ttu-id="7f212-147">L'aggiunta della funzionalità di individuazione all'applicazione rende possibili altri scenari quali la tolleranza di errore e la configurazione automatica.</span><span class="sxs-lookup"><span data-stu-id="7f212-147">Adding discovery to your application can be used to enable other scenarios such as fault tolerance and auto configuration.</span></span>  
  
## <a name="service-publication"></a><span data-ttu-id="7f212-148">Pubblicazione di un servizio</span><span class="sxs-lookup"><span data-stu-id="7f212-148">Service Publication</span></span>  
 <span data-ttu-id="7f212-149">Per rendere individuabile un servizio, è necessario aggiungere <xref:System.ServiceModel.Discovery.ServiceDiscoveryBehavior> all'host del servizio nonché un endpoint di individuazione per specificare dove essere in ascolto dei messaggi di individuazione.</span><span class="sxs-lookup"><span data-stu-id="7f212-149">To make a service discoverable, a <xref:System.ServiceModel.Discovery.ServiceDiscoveryBehavior> must be added to the service host and a discovery endpoint must be added to specify where to listen for discovery messages.</span></span> <span data-ttu-id="7f212-150">Nell'esempio di codice seguente viene illustrato come modificare un servizio indipendente per renderlo individuabile.</span><span class="sxs-lookup"><span data-stu-id="7f212-150">The following code example shows how a self-hosted service can be modified to make it discoverable.</span></span>  
  
```csharp  
Uri baseAddress = new Uri($"http://{System.Net.Dns.GetHostName()}:8000/discovery/scenarios/calculatorservice/{Guid.NewGuid().ToString()}/");

// Create a ServiceHost for the CalculatorService type.
using (ServiceHost serviceHost = new ServiceHost(typeof(CalculatorService), baseAddress))
{
    // Add calculator endpoint
    serviceHost.AddServiceEndpoint(typeof(ICalculator), new WSHttpBinding(), string.Empty);

    // ** DISCOVERY ** //
    // Make the service discoverable by adding the discovery behavior
    serviceHost.Description.Behaviors.Add(new ServiceDiscoveryBehavior());

    // ** DISCOVERY ** //
    // Add the discovery endpoint that specifies where to publish the services
    serviceHost.AddServiceEndpoint(new UdpDiscoveryEndpoint());

    // Open the ServiceHost to create listeners and start listening for messages.
    serviceHost.Open();

    // The service can now be accessed.
    Console.WriteLine("Press <ENTER> to terminate service.");
    Console.ReadLine();
}
```  
  
 <span data-ttu-id="7f212-151">È necessario aggiungere un'istanza di <xref:System.ServiceModel.Discovery.ServiceDiscoveryBehavior> a una descrizione del servizio da rendere individuabile.</span><span class="sxs-lookup"><span data-stu-id="7f212-151">A <xref:System.ServiceModel.Discovery.ServiceDiscoveryBehavior> instance must be added to a service description for the service to be discoverable.</span></span> <span data-ttu-id="7f212-152">È necessario aggiungere un'istanza di <xref:System.ServiceModel.Discovery.DiscoveryEndpoint> all'host del servizio per indicare al servizio dove essere in ascolto delle richieste di individuazione.</span><span class="sxs-lookup"><span data-stu-id="7f212-152">A <xref:System.ServiceModel.Discovery.DiscoveryEndpoint> instance must be added to the service host to tell the service where to listen for discovery requests.</span></span> <span data-ttu-id="7f212-153">In questo esempio, viene aggiunto un oggetto <xref:System.ServiceModel.Discovery.UdpDiscoveryEndpoint> (derivato da <xref:System.ServiceModel.Discovery.DiscoveryEndpoint>) per specificare che il servizio deve essere in ascolto delle richieste di individuazione sul trasporto multicast UDP.</span><span class="sxs-lookup"><span data-stu-id="7f212-153">In this example, a <xref:System.ServiceModel.Discovery.UdpDiscoveryEndpoint> (which is derived from <xref:System.ServiceModel.Discovery.DiscoveryEndpoint>) is added to specify that the service should listen for discovery requests over the UDP multicast transport.</span></span> <span data-ttu-id="7f212-154"><xref:System.ServiceModel.Discovery.UdpDiscoveryEndpoint> viene utilizzato per l'individuazione ad hoc poiché tutti i messaggi vengono inviati in modalità multicast.</span><span class="sxs-lookup"><span data-stu-id="7f212-154">The <xref:System.ServiceModel.Discovery.UdpDiscoveryEndpoint> is used for Ad-Hoc discovery because all messages are sent in a multicast fashion.</span></span>  
  
## <a name="announcement"></a><span data-ttu-id="7f212-155">Annuncio</span><span class="sxs-lookup"><span data-stu-id="7f212-155">Announcement</span></span>  
 <span data-ttu-id="7f212-156">Per impostazione predefinita, la pubblicazione del servizio non implica l'invio di messaggi di annuncio.</span><span class="sxs-lookup"><span data-stu-id="7f212-156">By default, service publication does not send out announcement messages.</span></span> <span data-ttu-id="7f212-157">È necessario configurare il servizio affinché invii tali messaggi.</span><span class="sxs-lookup"><span data-stu-id="7f212-157">The service must be configured to send out announcement messages.</span></span> <span data-ttu-id="7f212-158">Ciò assicura ulteriore flessibilità agli sviluppatori dei servizi, in quanto questi ultimi possono essere annunciati separatamente rispetto all'ascolto dei messaggi di individuazione.</span><span class="sxs-lookup"><span data-stu-id="7f212-158">This provides additional flexibility for service writers because they can announce the service separately from listening for discovery messages.</span></span> <span data-ttu-id="7f212-159">L'annuncio del servizio può essere inoltre utilizzato come meccanismo per la registrazione dei servizi in un proxy di individuazione o altri registri di servizi.</span><span class="sxs-lookup"><span data-stu-id="7f212-159">Service announcement can also be used as a mechanism for registering services with a discovery proxy or other service registries.</span></span> <span data-ttu-id="7f212-160">Nel codice seguente viene illustrato come configurare un servizio affinché invii messaggi di annuncio tramite un'associazione UDP.</span><span class="sxs-lookup"><span data-stu-id="7f212-160">The following code shows how to configure a service to send announcement messages over a UDP binding.</span></span>  
  
```csharp  
Uri baseAddress = new Uri($"http://{System.Net.Dns.GetHostName()}:8000/discovery/scenarios/calculatorservice/{Guid.NewGuid().ToString()}/");

// Create a ServiceHost for the CalculatorService type.
using (ServiceHost serviceHost = new ServiceHost(typeof(CalculatorService), baseAddress))
{
    // Add calculator endpoint
    serviceHost.AddServiceEndpoint(typeof(ICalculator), new WSHttpBinding(), string.Empty);

    // ** DISCOVERY ** //
    // Make the service discoverable by adding the discovery behavior
    ServiceDiscoveryBehavior discoveryBehavior = new ServiceDiscoveryBehavior();
    serviceHost.Description.Behaviors.Add(discoveryBehavior);

    // Send announcements on UDP multicast transport
    discoveryBehavior.AnnouncementEndpoints.Add(
      new UdpAnnouncementEndpoint());

    // ** DISCOVERY ** //
    // Add the discovery endpoint that specifies where to publish the services
    serviceHost.Description.Endpoints.Add(new UdpDiscoveryEndpoint());

    // Open the ServiceHost to create listeners and start listening for messages.
    serviceHost.Open();

    // The service can now be accessed.
    Console.WriteLine("Press <ENTER> to terminate service.");
    Console.ReadLine();
}
```  
  
## <a name="service-discovery"></a><span data-ttu-id="7f212-161">Individuazione dei servizi</span><span class="sxs-lookup"><span data-stu-id="7f212-161">Service Discovery</span></span>  
 <span data-ttu-id="7f212-162">Le applicazioni client possono utilizzare la classe <xref:System.ServiceModel.Discovery.DiscoveryClient> per individuare i servizi.</span><span class="sxs-lookup"><span data-stu-id="7f212-162">A client application can use the <xref:System.ServiceModel.Discovery.DiscoveryClient> class to find services.</span></span> <span data-ttu-id="7f212-163">Lo sviluppatore crea un'istanza della classe <xref:System.ServiceModel.Discovery.DiscoveryClient> che passa un endpoint di individuazione che specifica dove inviare messaggi `Probe` o `Resolve`.</span><span class="sxs-lookup"><span data-stu-id="7f212-163">The developer creates an instance of the <xref:System.ServiceModel.Discovery.DiscoveryClient> class that passes in a discovery endpoint that specifies where to send `Probe` or `Resolve` messages.</span></span> <span data-ttu-id="7f212-164">Il client chiama quindi <xref:System.ServiceModel.Discovery.DiscoveryClient.Find%2A> che specifica i criteri di ricerca all'interno di un'istanza di <xref:System.ServiceModel.Discovery.FindCriteria>.</span><span class="sxs-lookup"><span data-stu-id="7f212-164">The client then calls <xref:System.ServiceModel.Discovery.DiscoveryClient.Find%2A> that specifies search criteria within a <xref:System.ServiceModel.Discovery.FindCriteria> instance.</span></span> <span data-ttu-id="7f212-165">Se vengono individuati servizi corrispondenti, <xref:System.ServiceModel.Discovery.DiscoveryClient.Find%2A> restituisce una raccolta di <xref:System.ServiceModel.Discovery.EndpointDiscoveryMetadata>.</span><span class="sxs-lookup"><span data-stu-id="7f212-165">If matching services are found, <xref:System.ServiceModel.Discovery.DiscoveryClient.Find%2A> returns a collection of <xref:System.ServiceModel.Discovery.EndpointDiscoveryMetadata>.</span></span> <span data-ttu-id="7f212-166">Nel codice seguente viene illustrato come chiamare il metodo `Find` e connettersi quindi ad un servizio individuato.</span><span class="sxs-lookup"><span data-stu-id="7f212-166">The following code shows how to call the `Find` method and then connect to a discovered service.</span></span>  
  
```csharp  
class Client
{
    static EndpointAddress serviceAddress;
  
    static void Main()
    {  
        if (FindService()) 
        {
            InvokeService();
        }
    }  
  
    // ** DISCOVERY ** //  
    static bool FindService()  
    {  
        Console.WriteLine("\nFinding Calculator Service ..");  
        DiscoveryClient discoveryClient =   
            new DiscoveryClient(new UdpDiscoveryEndpoint());  
  
        Collection<EndpointDiscoveryMetadata> calculatorServices =   
            (Collection<EndpointDiscoveryMetadata>)discoveryClient.Find(new FindCriteria(typeof(ICalculator))).Endpoints;  
  
        discoveryClient.Close();  
  
        if (calculatorServices.Count == 0)  
        {  
            Console.WriteLine("\nNo services are found.");  
            return false;  
        }  
        else  
        {  
            serviceAddress = calculatorServices[0].Address;  
            return true;  
        }  
    }  
  
    static void InvokeService()  
    {  
        Console.WriteLine("\nInvoking Calculator Service at {0}\n", serviceAddress);  
  
        // Create a client  
        CalculatorClient client = new CalculatorClient();  
        client.Endpoint.Address = serviceAddress;  
        client.Add(10,3);  
    }
}  
```  
  
## <a name="discovery-and-message-level-security"></a><span data-ttu-id="7f212-167">Sicurezza a livello di individuazione e messaggio</span><span class="sxs-lookup"><span data-stu-id="7f212-167">Discovery and Message Level Security</span></span>  
 <span data-ttu-id="7f212-168">Quando si utilizza la sicurezza a livello di messaggio è necessario specificare un oggetto <xref:System.ServiceModel.EndpointIdentity> nell'endpoint di individuazione del servizio e un oggetto <xref:System.ServiceModel.EndpointIdentity> corrispondente nell'endpoint di individuazione del client.</span><span class="sxs-lookup"><span data-stu-id="7f212-168">When using message level security it is necessary to specify an <xref:System.ServiceModel.EndpointIdentity> on the service discovery endpoint and a matching <xref:System.ServiceModel.EndpointIdentity> on the client discovery endpoint.</span></span> <span data-ttu-id="7f212-169">Per ulteriori informazioni sulla sicurezza a livello di messaggio, vedere [sicurezza dei messaggi](../../../../docs/framework/wcf/feature-details/message-security-in-wcf.md).</span><span class="sxs-lookup"><span data-stu-id="7f212-169">For more information about message level security, see [Message Security](../../../../docs/framework/wcf/feature-details/message-security-in-wcf.md).</span></span>  
  
## <a name="discovery-and-web-hosted-services"></a><span data-ttu-id="7f212-170">Individuazione e servizi ospitati su Web</span><span class="sxs-lookup"><span data-stu-id="7f212-170">Discovery and Web Hosted Services</span></span>  
 <span data-ttu-id="7f212-171">I servizi WCF per essere individuabili devono essere in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="7f212-171">In order for WCF services to be discoverable they must be running.</span></span> <span data-ttu-id="7f212-172">I servizi WCF ospitati in IIS o WAS non vengono eseguiti fino a quando IIS/WAS non riceve un messaggio associato per il servizio, quindi non possono essere individuabili per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="7f212-172">WCF services hosted under IIS or WAS do not run until IIS/WAS receives a message bound for the service, so they cannot be discoverable by default.</span></span>  <span data-ttu-id="7f212-173">Per rendere i servizi ospitati su Web individuabili esistono due opzioni:</span><span class="sxs-lookup"><span data-stu-id="7f212-173">There are two options for making Web-Hosted services discoverable:</span></span>  
  
1. <span data-ttu-id="7f212-174">Utilizzare la funzionalità di avvio automatico di Windows Server AppFabric</span><span class="sxs-lookup"><span data-stu-id="7f212-174">Use the Windows Server AppFabric Auto-Start feature</span></span>  
  
2. <span data-ttu-id="7f212-175">Utilizzare un proxy di individuazione per comunicare per conto del servizio</span><span class="sxs-lookup"><span data-stu-id="7f212-175">Use a discovery proxy to communicate on behalf of the service</span></span>  
  
 <span data-ttu-id="7f212-176">Windows Server AppFabric dispone di una funzionalità di avvio automatico che consente al servizio di essere avviato prima di ricevere qualsiasi messaggio.</span><span class="sxs-lookup"><span data-stu-id="7f212-176">Windows Server AppFabric has an Auto-Start feature that will allow a service to be started before receiving any messages.</span></span> <span data-ttu-id="7f212-177">Con l'impostazione della funzionalità di avvio automatico, un servizio ospitato in IIS/WAS può essere configurato per essere individuabile.</span><span class="sxs-lookup"><span data-stu-id="7f212-177">With this Auto-Start set, an IIS/WAS hosted service can be configured to be discoverable.</span></span> <span data-ttu-id="7f212-178">Per ulteriori informazioni sulla funzionalità di avvio automatico, vedere [funzionalità di avvio automatico di Windows Server AppFabric](https://docs.microsoft.com/previous-versions/appfabric/ee677260(v=azure.10)).</span><span class="sxs-lookup"><span data-stu-id="7f212-178">For more information about the Auto-Start feature see, [Windows Server AppFabric Auto-Start Feature](https://docs.microsoft.com/previous-versions/appfabric/ee677260(v=azure.10)).</span></span> <span data-ttu-id="7f212-179">Oltre ad abilitare la funzionalità di avvio automatico, è necessario configurare il servizio per l'individuazione.</span><span class="sxs-lookup"><span data-stu-id="7f212-179">Along with turning on the Auto-Start feature, you must configure the service for discovery.</span></span> <span data-ttu-id="7f212-180">Per ulteriori informazioni, vedere [procedura: aggiungere l'individuazione a un servizio WCF e un client di](../../../../docs/framework/wcf/feature-details/how-to-programmatically-add-discoverability-to-a-wcf-service-and-client.md)[configurazione in un file di configurazione](../../../../docs/framework/wcf/feature-details/configuring-discovery-in-a-configuration-file.md)a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="7f212-180">For more information, see [How to: Programmatically Add Discoverability to a WCF Service and Client](../../../../docs/framework/wcf/feature-details/how-to-programmatically-add-discoverability-to-a-wcf-service-and-client.md)[Configuring Discovery in a Configuration File](../../../../docs/framework/wcf/feature-details/configuring-discovery-in-a-configuration-file.md).</span></span>  
  
 <span data-ttu-id="7f212-181">Un proxy di individuazione può essere utilizzato per comunicare per conto del servizio WCF quando tale servizio non è in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="7f212-181">A discovery proxy can be used to communicate on behalf of the WCF service when the service is not running.</span></span> <span data-ttu-id="7f212-182">Il proxy può mettersi in ascolto del probe o risolvere i messaggi e rispondere al client.</span><span class="sxs-lookup"><span data-stu-id="7f212-182">The proxy can listen for probe or resolve messages and respond to the client.</span></span> <span data-ttu-id="7f212-183">Il client può quindi inviare i messaggi direttamente al servizio.</span><span class="sxs-lookup"><span data-stu-id="7f212-183">The client can then send messages directly to the service.</span></span> <span data-ttu-id="7f212-184">Quando il client invia un messaggio al servizio, verrà creata un'istanza di tale servizio per rispondere al messaggio.</span><span class="sxs-lookup"><span data-stu-id="7f212-184">When the client sends a message to the service it will be instantiated to respond to the message.</span></span> <span data-ttu-id="7f212-185">Per ulteriori informazioni sull'implementazione di un proxy di individuazione, vedere [implementazione di un proxy di individuazione](../../../../docs/framework/wcf/feature-details/implementing-a-discovery-proxy.md).</span><span class="sxs-lookup"><span data-stu-id="7f212-185">For more information about implementing a discovery proxy see, [Implementing a Discovery Proxy](../../../../docs/framework/wcf/feature-details/implementing-a-discovery-proxy.md).</span></span>  
  
> [!NOTE]
> <span data-ttu-id="7f212-186">Affinché WCF Discovery funzioni correttamente, tutte le schede di interfaccia di rete (Network Interface Controller) devono avere un solo indirizzo IP.</span><span class="sxs-lookup"><span data-stu-id="7f212-186">For WCF Discovery to work correctly, all NICs (Network Interface Controller) should only have 1 IP address.</span></span>
