---
title: Configurazione della registrazione dei messaggi
ms.date: 03/30/2017
helpviewer_keywords:
- message logging [WCF]
ms.assetid: 0ff4c857-8f09-4b85-9dc0-89084706e4c9
ms.openlocfilehash: 80d852dd08e935d4c06e9b6d2e52b0a075849ef5
ms.sourcegitcommit: 64f4baed249341e5bf64d1385bf48e3f2e1a0211
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/07/2018
ms.locfileid: "44085154"
---
# <a name="configuring-message-logging"></a><span data-ttu-id="78acb-102">Configurazione della registrazione dei messaggi</span><span class="sxs-lookup"><span data-stu-id="78acb-102">Configuring Message Logging</span></span>
<span data-ttu-id="78acb-103">In questo argomento viene illustrato come configurare la registrazione dei messaggi per scenari differenti.</span><span class="sxs-lookup"><span data-stu-id="78acb-103">This topic describes how you can configure message logging for different scenarios.</span></span>  
  
## <a name="enabling-message-logging"></a><span data-ttu-id="78acb-104">Attivazione della registrazione dei messaggi</span><span class="sxs-lookup"><span data-stu-id="78acb-104">Enabling Message Logging</span></span>  
 <span data-ttu-id="78acb-105">Windows Communication Foundation (WCF) non registra i messaggi per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="78acb-105">Windows Communication Foundation (WCF) does not log messages by default.</span></span> <span data-ttu-id="78acb-106">Per attivarla, è necessario aggiungere un listener di traccia all'origine di traccia `System.ServiceModel.MessageLogging` e impostare gli attributi relativi all'elemento `<messagelogging>` nel file di configurazione.</span><span class="sxs-lookup"><span data-stu-id="78acb-106">To activate message logging, you must add a trace listener to the `System.ServiceModel.MessageLogging` trace source and set attributes for the `<messagelogging>` element in the configuration file.</span></span>  
  
 <span data-ttu-id="78acb-107">Nell'esempio seguente viene illustrato come abilitare la registrazione e specificare opzioni aggiuntive.</span><span class="sxs-lookup"><span data-stu-id="78acb-107">The following example shows how to enable logging and specify additional options.</span></span>  
  
```xml  
<system.diagnostics>  
  <sources>  
    <source name="System.ServiceModel.MessageLogging">  
      <listeners>  
         <add name="messages"  
              type="System.Diagnostics.XmlWriterTraceListener"  
              initializeData="c:\logs\messages.svclog" />  
        </listeners>  
    </source>  
  </sources>  
</system.diagnostics>  
  
<system.serviceModel>  
  <diagnostics>  
    <messageLogging   
         logEntireMessage="true"   
         logMalformedMessages="false"  
         logMessagesAtServiceLevel="true"   
         logMessagesAtTransportLevel="false"  
         maxMessagesToLog="3000"  
         maxSizeOfMessageToLog="2000"/>  
  </diagnostics>  
</system.serviceModel>  
```  
  
 <span data-ttu-id="78acb-108">Per altre informazioni sulle impostazioni di registrazione dei messaggi, vedere [impostazioni consigliate per la traccia e registrazione dei messaggi](../../../../docs/framework/wcf/diagnostics/tracing/recommended-settings-for-tracing-and-message-logging.md).</span><span class="sxs-lookup"><span data-stu-id="78acb-108">For more information about message logging settings, see [Recommended Settings for Tracing and Message Logging](../../../../docs/framework/wcf/diagnostics/tracing/recommended-settings-for-tracing-and-message-logging.md).</span></span>  
  
 <span data-ttu-id="78acb-109">Per specificare il nome e il tipo del listener di traccia che si desidera utilizzare, è possibile utilizzare l'istruzione `add`.</span><span class="sxs-lookup"><span data-stu-id="78acb-109">You can use `add` to specify the name and type of the listener you want to use.</span></span> <span data-ttu-id="78acb-110">Nella configurazione dell'esempio, il listener viene denominato "messages" e come tipo da utilizzare viene aggiunto il listener di traccia standard di .NET Framework, ovvero `System.Diagnostics.XmlWriterTraceListener`.</span><span class="sxs-lookup"><span data-stu-id="78acb-110">In the example configuration, the Listener is named "messages" and adds the standard .NET Framework trace listener (`System.Diagnostics.XmlWriterTraceListener`) as the type to use.</span></span> <span data-ttu-id="78acb-111">Se si utilizza `System.Diagnostics.XmlWriterTraceListener`, è necessario specificare il percorso e il nome del file di output nel file di configurazione.</span><span class="sxs-lookup"><span data-stu-id="78acb-111">If you use `System.Diagnostics.XmlWriterTraceListener`, you must specify the output file location and name in the configuration file.</span></span> <span data-ttu-id="78acb-112">A tal fine impostare `initializeData` sul nome del file di log.</span><span class="sxs-lookup"><span data-stu-id="78acb-112">This is done by setting `initializeData` to the name of the log file.</span></span> <span data-ttu-id="78acb-113">In caso contrario, il sistema genererà un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="78acb-113">Otherwise, the system throws an exception.</span></span> <span data-ttu-id="78acb-114">È inoltre possibile implementare un listener personalizzato che genera log in un file predefinito.</span><span class="sxs-lookup"><span data-stu-id="78acb-114">You can also implement a custom listener that emits logs to a default file.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="78acb-115">Poiché la registrazione dei messaggi occupa spazio su disco, è necessario limitare il numero dei messaggi che vengono scritti su disco per un particolare servizio.</span><span class="sxs-lookup"><span data-stu-id="78acb-115">Because message logging accesses disk space, you should limit the number of messages that are written to disk for a particular service.</span></span> <span data-ttu-id="78acb-116">Una volta raggiunto il limite dei messaggi, viene generata una traccia a livello Informazioni e tutte le attività di registrazione dei messaggi vengono interrotte.</span><span class="sxs-lookup"><span data-stu-id="78acb-116">When the message limit is reached, a trace at the Information level is produced and all message logging activities stop.</span></span>  
  
 <span data-ttu-id="78acb-117">Il livello di registrazione e le opzioni aggiuntive vengono illustrate nella sezione Livelli di registrazione e opzioni.</span><span class="sxs-lookup"><span data-stu-id="78acb-117">The logging level, as well as the additional options, are discussed in the Logging Level and Options section.</span></span>  
  
 <span data-ttu-id="78acb-118">L'attributo `switchValue` di una `source` è valido solo per la traccia.</span><span class="sxs-lookup"><span data-stu-id="78acb-118">The `switchValue` attribute of a `source` is only valid for tracing.</span></span> <span data-ttu-id="78acb-119">Se si specifica un attributo `switchValue` per l'origine di traccia `System.ServiceModel.MessageLogging` come illustrato di seguito, non si ottiene alcun effetto.</span><span class="sxs-lookup"><span data-stu-id="78acb-119">If you specify a `switchValue` attribute for the `System.ServiceModel.MessageLogging` trace source as follows, it has no effect.</span></span>  
  
```xml  
<source name="System.ServiceModel.MessageLogging" switchValue="Verbose">  
```  
  
 <span data-ttu-id="78acb-120">Se si desidera disattivare l'origine di traccia, è invece necessario utilizzare gli attributi `logMessagesAtServiceLevel`, `logMalformedMessages` e `logMessagesAtTransportLevel` dell'elemento `messageLogging`.</span><span class="sxs-lookup"><span data-stu-id="78acb-120">If you want to disable the trace source, you should use the `logMessagesAtServiceLevel`, `logMalformedMessages`, and `logMessagesAtTransportLevel` attributes of the `messageLogging` element instead.</span></span> <span data-ttu-id="78acb-121">Tali attributi devono essere impostati su `false`.</span><span class="sxs-lookup"><span data-stu-id="78acb-121">You should set all these attributes to `false`.</span></span> <span data-ttu-id="78acb-122">È possibile ottenere questo risultato utilizzando il file di configurazione dell'esempio di codice precedente, attraverso l'interfaccia utente dell'Editor di configurazione o utilizzando WMI.</span><span class="sxs-lookup"><span data-stu-id="78acb-122">This can be done by using the configuration file in the previous code example, through the Configuration Editor UI interface, or using WMI.</span></span> <span data-ttu-id="78acb-123">Per altre informazioni sullo strumento Editor di configurazione, vedere [dello strumento Editor di configurazione (SvcConfigEditor.exe)](../../../../docs/framework/wcf/configuration-editor-tool-svcconfigeditor-exe.md).</span><span class="sxs-lookup"><span data-stu-id="78acb-123">For more information about the Configuration Editor tool, see [Configuration Editor Tool (SvcConfigEditor.exe)](../../../../docs/framework/wcf/configuration-editor-tool-svcconfigeditor-exe.md).</span></span> <span data-ttu-id="78acb-124">Per altre informazioni su WMI, vedere [uso di Strumentazione gestione Windows per la diagnostica](../../../../docs/framework/wcf/diagnostics/wmi/index.md).</span><span class="sxs-lookup"><span data-stu-id="78acb-124">For more information about WMI, see [Using Windows Management Instrumentation for Diagnostics](../../../../docs/framework/wcf/diagnostics/wmi/index.md).</span></span>  
  
## <a name="logging-levels-and-options"></a><span data-ttu-id="78acb-125">Livelli di registrazione e opzioni</span><span class="sxs-lookup"><span data-stu-id="78acb-125">Logging Levels and Options</span></span>  
 <span data-ttu-id="78acb-126">Per i messaggi in ingresso, la registrazione avviene immediatamente dopo che il messaggio è stato formato, immediatamente prima che il messaggio raggiunga il codice utente nel livello di servizio e quando vengono rilevati messaggi in formato non valido.</span><span class="sxs-lookup"><span data-stu-id="78acb-126">For incoming messages, logging happens immediately after the message is formed, immediately before the message gets to user code in the service level, and when malformed messages are detected.</span></span>  
  
 <span data-ttu-id="78acb-127">Per i messaggi in uscita, la registrazione avviene immediatamente dopo che il messaggio esce dal codice utente e immediatamente prima che il messaggio vada in transito.</span><span class="sxs-lookup"><span data-stu-id="78acb-127">For outgoing messages, logging happens immediately after the message leaves user code and immediately before the message goes on the wire.</span></span>  
  
 <span data-ttu-id="78acb-128">WCF registra i messaggi a due livelli diversi, servizio e di trasporto.</span><span class="sxs-lookup"><span data-stu-id="78acb-128">WCF logs messages at two different levels, service and transport.</span></span> <span data-ttu-id="78acb-129">Vengono inoltre registrati i messaggi in formato non valido.</span><span class="sxs-lookup"><span data-stu-id="78acb-129">Malformed messages are also logged.</span></span> <span data-ttu-id="78acb-130">Le tre categorie sono indipendenti l'una dall'altra e possono essere attivate separatamente nella configurazione.</span><span class="sxs-lookup"><span data-stu-id="78acb-130">The three categories are independent from each other and can be activated separately in configuration.</span></span>  
  
 <span data-ttu-id="78acb-131">È possibile controllare il livello di registrazione impostando gli attributi `logMessagesAtServiceLevel`, `logMalformedMessages` e `logMessagesAtTransportLevel` dell'elemento `messageLogging`.</span><span class="sxs-lookup"><span data-stu-id="78acb-131">You can control the logging level by setting the `logMessagesAtServiceLevel`, `logMalformedMessages`, and `logMessagesAtTransportLevel` attributes of the `messageLogging` element.</span></span>  
  
### <a name="service-level"></a><span data-ttu-id="78acb-132">Livello di servizio</span><span class="sxs-lookup"><span data-stu-id="78acb-132">Service Level</span></span>  
 <span data-ttu-id="78acb-133">I messaggi registrati a questo livello stanno per entrare (sul lato di ricezione) o per uscire (sul lato di invio) dal codice utente.</span><span class="sxs-lookup"><span data-stu-id="78acb-133">Messages logged at this layer are about to enter (on receiving) or leave (on sending) user code.</span></span> <span data-ttu-id="78acb-134">Se sono stati definiti dei filtri, vengono registrati solo i messaggi che corrispondono a tali filtri.</span><span class="sxs-lookup"><span data-stu-id="78acb-134">If filters have been defined, only messages that match the filters are logged.</span></span> <span data-ttu-id="78acb-135">In caso contrario, vengono registrati tutti i messaggi a livello di servizio.</span><span class="sxs-lookup"><span data-stu-id="78acb-135">Otherwise, all messages at the service level are logged.</span></span> <span data-ttu-id="78acb-136">A questo livello vengono inoltre registrati i messaggi dell'infrastruttura (transazioni, canale peer e protezione), ad eccezione dei messaggi di messaggistica affidabile.</span><span class="sxs-lookup"><span data-stu-id="78acb-136">Infrastructure messages (transactions, peer channel, and security) are also logged at this level, except for Reliable Messaging messages.</span></span> <span data-ttu-id="78acb-137">Per i messaggi trasmessi come flusso, vengono registrate solo le intestazioni.</span><span class="sxs-lookup"><span data-stu-id="78acb-137">On streamed messages, only the headers are logged.</span></span> <span data-ttu-id="78acb-138">Inoltre, a questo livello i messaggi protetti vengono registrati in forma decrittografata.</span><span class="sxs-lookup"><span data-stu-id="78acb-138">In addition, secure messages are logged decrypted at this level.</span></span>  
  
### <a name="transport-level"></a><span data-ttu-id="78acb-139">Livello di trasporto</span><span class="sxs-lookup"><span data-stu-id="78acb-139">Transport Level</span></span>  
 <span data-ttu-id="78acb-140">I messaggi registrati a questo livello sono pronti per essere codificati o decodificati prima o dopo il trasporto in transito.</span><span class="sxs-lookup"><span data-stu-id="78acb-140">Messages logged at this layer are ready to be encoded or decoded for or after transportation on the wire.</span></span> <span data-ttu-id="78acb-141">Se sono stati definiti dei filtri, vengono registrati solo i messaggi che corrispondono a tali filtri.</span><span class="sxs-lookup"><span data-stu-id="78acb-141">If filters have been defined, only messages that match the filters are logged.</span></span> <span data-ttu-id="78acb-142">In caso contrario, vengono registrati tutti i messaggi al livello di trasporto.</span><span class="sxs-lookup"><span data-stu-id="78acb-142">Otherwise, all messages at the transport layer are logged.</span></span> <span data-ttu-id="78acb-143">A questo livello vengono registrati tutti i messaggi dell'infrastruttura, compresi i messaggi di messaggistica affidabile.</span><span class="sxs-lookup"><span data-stu-id="78acb-143">All infrastructure messages are logged at this layer, including reliable messaging messages.</span></span> <span data-ttu-id="78acb-144">Per i messaggi trasmessi come flusso, vengono registrate solo le intestazioni.</span><span class="sxs-lookup"><span data-stu-id="78acb-144">On streamed messages, only the headers are logged.</span></span> <span data-ttu-id="78acb-145">Inoltre, a questo livello i messaggi protetti vengono registrati come crittografati, a meno che non si utilizzi un trasporto protetto come HTTPS.</span><span class="sxs-lookup"><span data-stu-id="78acb-145">In addition, secure messages are logged as encrypted at this level, except if a secure transport such as HTTPS is used.</span></span>  
  
### <a name="malformed-level"></a><span data-ttu-id="78acb-146">Livello dei messaggi in formato non valido</span><span class="sxs-lookup"><span data-stu-id="78acb-146">Malformed Level</span></span>  
 <span data-ttu-id="78acb-147">I messaggi in formato non valido sono messaggi rifiutati dallo stack di WCF in qualsiasi fase di elaborazione.</span><span class="sxs-lookup"><span data-stu-id="78acb-147">Malformed messages are messages that are rejected by the WCF stack at any stage of processing.</span></span> <span data-ttu-id="78acb-148">I messaggi in formato non valido vengono registrati così come sono, vale a dire crittografati se lo sono, con XML non corretto e così via.</span><span class="sxs-lookup"><span data-stu-id="78acb-148">Malformed messages are logged as-is: encrypted if they are so, with non-proper XML, and so on.</span></span> <span data-ttu-id="78acb-149">`maxSizeOfMessageToLog` definisce le dimensioni del messaggio da registrare come CDATA.</span><span class="sxs-lookup"><span data-stu-id="78acb-149">`maxSizeOfMessageToLog` defined the size of the message to be logged as CDATA.</span></span> <span data-ttu-id="78acb-150">Per impostazione predefinita, la proprietà `maxSizeOfMessageToLog` è uguale a 256 K.</span><span class="sxs-lookup"><span data-stu-id="78acb-150">By default, `maxSizeOfMessageToLog` is equal to 256K.</span></span> <span data-ttu-id="78acb-151">Per altre informazioni su questo attributo, vedere la sezione altre opzioni.</span><span class="sxs-lookup"><span data-stu-id="78acb-151">For more information about this attribute, see the Other Options section.</span></span>  
  
### <a name="other-options"></a><span data-ttu-id="78acb-152">Altre opzioni</span><span class="sxs-lookup"><span data-stu-id="78acb-152">Other Options</span></span>  
 <span data-ttu-id="78acb-153">Oltre ai livelli di registrazione, l'utente può specificare le opzioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="78acb-153">In addition to the logging levels, the user can specify the following options:</span></span>  
  
-   <span data-ttu-id="78acb-154">Registrazione dell'intero messaggio (attributo `logEntireMessage`): questo valore specifica se viene registrato l'intero messaggio (intestazione e corpo del messaggio).</span><span class="sxs-lookup"><span data-stu-id="78acb-154">Log Entire Message (`logEntireMessage` attribute): This value specifies whether the entire message (message header and body) is logged.</span></span> <span data-ttu-id="78acb-155">Il valore predefinito è `false`, ovvero viene registrata solo l'intestazione del messaggio.</span><span class="sxs-lookup"><span data-stu-id="78acb-155">The default value is `false`, meaning that only the header is logged.</span></span> <span data-ttu-id="78acb-156">Questa impostazione influisce sui livelli di registrazione dei messaggi di servizio e di trasporto.</span><span class="sxs-lookup"><span data-stu-id="78acb-156">This setting affects service and transport message logging levels..</span></span>  
  
-   <span data-ttu-id="78acb-157">Numero massimo di messaggi da registrare (attributo `maxMessagesToLog`): questo valore specifica il numero massimo di messaggi da registrare.</span><span class="sxs-lookup"><span data-stu-id="78acb-157">Max messages to log (`maxMessagesToLog` attribute): This value specifies the maximum number of messages to log.</span></span> <span data-ttu-id="78acb-158">Tutti i messaggi (servizio, trasporto e messaggi in formato non valido) vengono conteggiati fino a tale quota.</span><span class="sxs-lookup"><span data-stu-id="78acb-158">All messages (service, transport, and malformed messages) are counted towards this quota.</span></span> <span data-ttu-id="78acb-159">Una volta raggiunta la quota, viene generata una traccia e non vengono registrati ulteriori messaggi.</span><span class="sxs-lookup"><span data-stu-id="78acb-159">When the quota is reached, a trace is emitted and no additional message is logged.</span></span> <span data-ttu-id="78acb-160">Il valore predefinito è 10000.</span><span class="sxs-lookup"><span data-stu-id="78acb-160">The default value is 10000.</span></span>  
  
-   <span data-ttu-id="78acb-161">Dimensione massima del messaggio da registrare (attributo `maxSizeOfMessageToLog`): questo valore specifica la dimensione massima, in byte, dei messaggi da registrare.</span><span class="sxs-lookup"><span data-stu-id="78acb-161">Max size of message to log (`maxSizeOfMessageToLog` attribute): This value specifies the maximum size of messages to log in bytes.</span></span> <span data-ttu-id="78acb-162">I messaggi la cui dimensione supera il limite non vengono registrati e per essi non vengono eseguite altre attività.</span><span class="sxs-lookup"><span data-stu-id="78acb-162">Messages that exceed the size limit are not logged, and no other activity is performed for that message.</span></span> <span data-ttu-id="78acb-163">Questa impostazione influisce su tutti i livelli di traccia.</span><span class="sxs-lookup"><span data-stu-id="78acb-163">This setting affects all trace levels.</span></span> <span data-ttu-id="78acb-164">Se la traccia del modello di servizio è attiva, viene generata una traccia a livello Avviso al primo punto di registrazione (ServiceModelSend\* o TransportReceive) per informarne l'utente.</span><span class="sxs-lookup"><span data-stu-id="78acb-164">If ServiceModel tracing is on, a Warning level trace is emitted at the first logging point (ServiceModelSend\* or TransportReceive) to notify the user.</span></span> <span data-ttu-id="78acb-165">Il valore predefinito per i messaggi a livello di servizio e di trasporto è 256 K, mentre il valore predefinito per i messaggi in formato non valido è 4 K.</span><span class="sxs-lookup"><span data-stu-id="78acb-165">The default value for service level and transport level messages is 256K, while the default value for malformed messages is 4K.</span></span>  
  
    > [!CAUTION]
    >  <span data-ttu-id="78acb-166">La dimensione del messaggio calcolata per eseguire il confronto con `maxSizeOfMessageToLog` corrisponde alla dimensione del messaggio in memoria prima della serializzazione.</span><span class="sxs-lookup"><span data-stu-id="78acb-166">The message size that is computed to compare against `maxSizeOfMessageToLog` is the message size in memory before serialization.</span></span> <span data-ttu-id="78acb-167">Questa dimensione può essere diversa dalla lunghezza effettiva della stringa di messaggio da registrare e in molti casi è maggiore della dimensione effettiva.</span><span class="sxs-lookup"><span data-stu-id="78acb-167">This size can differ from the actual length of the message string that is being logged, and in many occasions is bigger than the actual size.</span></span> <span data-ttu-id="78acb-168">Di conseguenza, dei messaggi potrebbero non essere registrati.</span><span class="sxs-lookup"><span data-stu-id="78acb-168">As a result, messages may not be logged.</span></span> <span data-ttu-id="78acb-169">Per intervenire su tale situazione, è possibile specificare per l'attributo `maxSizeOfMessageToLog` un valore del 10% maggiore rispetto alla dimensione prevista dei messaggi.</span><span class="sxs-lookup"><span data-stu-id="78acb-169">You can account for this fact by specifying the `maxSizeOfMessageToLog` attribute to be 10% larger than the expected message size.</span></span> <span data-ttu-id="78acb-170">Inoltre, se si registrano messaggi in formato non valido, lo spazio su disco effettivo utilizzato dai log dei messaggi può essere fino a 5 volte maggiore della dimensione del valore specificato da `maxSizeOfMessageToLog`.</span><span class="sxs-lookup"><span data-stu-id="78acb-170">In addition, if malformed messages are logged, the actual disk space utilized by the message logs can be up to 5 times the size of the value specified by `maxSizeOfMessageToLog`.</span></span>  
  
 <span data-ttu-id="78acb-171">Se non si definisce alcun listener di traccia nel file di configurazione, non viene generato alcun output di registrazione, indipendentemente dal livello di registrazione specificato.</span><span class="sxs-lookup"><span data-stu-id="78acb-171">If no trace listener is defined in the configuration file, no logging output is generated regardless of the specified logging level.</span></span>  
  
 <span data-ttu-id="78acb-172">Le opzioni di registrazione dei messaggi, ad esempio gli attributi descritti in questa sezione, possono essere modificati a runtime utilizzando Strumentazione gestione Windows (WMI, Windows Management Instrumentation).</span><span class="sxs-lookup"><span data-stu-id="78acb-172">Message logging options, such as the attributes described in this section, can be changed at runtime using Windows Management Instrumentation (WMI).</span></span> <span data-ttu-id="78acb-173">Questa operazione può essere eseguita accedendo il [AppDomainInfo](../../../../docs/framework/wcf/diagnostics/wmi/appdomaininfo.md) istanza, che espone le proprietà booleane: `LogMessagesAtServiceLevel`, `LogMessagesAtTransportLevel`, e `LogMalformedMessages`.</span><span class="sxs-lookup"><span data-stu-id="78acb-173">This can be done by accessing the [AppDomainInfo](../../../../docs/framework/wcf/diagnostics/wmi/appdomaininfo.md) instance, which exposes these Boolean properties: `LogMessagesAtServiceLevel`, `LogMessagesAtTransportLevel`, and `LogMalformedMessages`.</span></span> <span data-ttu-id="78acb-174">Pertanto, se si configura un listener di traccia per la registrazione dei messaggi, ma si impostano queste opzioni su `false` nella configurazione, è possibile in seguito modificarle in `true` quando l'applicazione è in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="78acb-174">Therefore, if you configure a trace listener for message logging, but set these options to `false` in configuration, you can later change them to `true` when the application is running.</span></span> <span data-ttu-id="78acb-175">In questo modo viene abilitata la registrazione dei messaggi al runtime.</span><span class="sxs-lookup"><span data-stu-id="78acb-175">This effectively enables message logging at runtime.</span></span> <span data-ttu-id="78acb-176">Analogamente, se si abilita la registrazione dei messaggi nel file di configurazione, è possibile disabilitarla al runtime usando WMI.</span><span class="sxs-lookup"><span data-stu-id="78acb-176">Similarly, if you enable message logging in your configuration file, you can disable it at runtime using WMI.</span></span> <span data-ttu-id="78acb-177">Per altre informazioni, vedere [uso di Strumentazione gestione Windows per la diagnostica](../../../../docs/framework/wcf/diagnostics/wmi/index.md).</span><span class="sxs-lookup"><span data-stu-id="78acb-177">For more information, see [Using Windows Management Instrumentation for Diagnostics](../../../../docs/framework/wcf/diagnostics/wmi/index.md).</span></span>  
  
 <span data-ttu-id="78acb-178">Nel campo `source` di un log di messaggi viene specificato il contesto in cui il messaggio viene registrato: durante l'invio/ricezione di un messaggio di richiesta, per una request-reply o una richiesta unidirezionale, a livello di modello di servizio o di trasporto o in caso di messaggio in formato non valido.</span><span class="sxs-lookup"><span data-stu-id="78acb-178">The `source` field in a message log specifies in which context the message is logged: when sending/receiving a request message, for a request-reply or 1-way request, at service model or transport layer, or in the case of a malformed message.</span></span>  
  
 <span data-ttu-id="78acb-179">Per i messaggi in formato non valido, `source` è uguale a `Malformed`.</span><span class="sxs-lookup"><span data-stu-id="78acb-179">For malformed messages, `source`  is equal to `Malformed`.</span></span> <span data-ttu-id="78acb-180">In caso contrario, l'origine ha i valori seguenti in base al contesto.</span><span class="sxs-lookup"><span data-stu-id="78acb-180">Otherwise, source has the following values based on the context.</span></span>  
  
 <span data-ttu-id="78acb-181">Per request/reply</span><span class="sxs-lookup"><span data-stu-id="78acb-181">For Request/Reply</span></span>  
  
||<span data-ttu-id="78acb-182">Invio richiesta</span><span class="sxs-lookup"><span data-stu-id="78acb-182">Send Request</span></span>|<span data-ttu-id="78acb-183">Ricezione richiesta</span><span class="sxs-lookup"><span data-stu-id="78acb-183">Receive Request</span></span>|<span data-ttu-id="78acb-184">Invio risposta</span><span class="sxs-lookup"><span data-stu-id="78acb-184">Send Reply</span></span>|<span data-ttu-id="78acb-185">Ricezione risposta</span><span class="sxs-lookup"><span data-stu-id="78acb-185">Receive Reply</span></span>|  
|-|------------------|---------------------|----------------|-------------------|  
|<span data-ttu-id="78acb-186">Livello del modello di servizio</span><span class="sxs-lookup"><span data-stu-id="78acb-186">Service Model layer</span></span>|<span data-ttu-id="78acb-187">Service</span><span class="sxs-lookup"><span data-stu-id="78acb-187">Service</span></span><br /><br /> <span data-ttu-id="78acb-188">Livello</span><span class="sxs-lookup"><span data-stu-id="78acb-188">Level</span></span><br /><br /> <span data-ttu-id="78acb-189">Invia</span><span class="sxs-lookup"><span data-stu-id="78acb-189">Send</span></span><br /><br /> <span data-ttu-id="78acb-190">Richiesta</span><span class="sxs-lookup"><span data-stu-id="78acb-190">Request</span></span>|<span data-ttu-id="78acb-191">Service</span><span class="sxs-lookup"><span data-stu-id="78acb-191">Service</span></span><br /><br /> <span data-ttu-id="78acb-192">Livello</span><span class="sxs-lookup"><span data-stu-id="78acb-192">Level</span></span><br /><br /> <span data-ttu-id="78acb-193">Receive</span><span class="sxs-lookup"><span data-stu-id="78acb-193">Receive</span></span><br /><br /> <span data-ttu-id="78acb-194">Richiesta</span><span class="sxs-lookup"><span data-stu-id="78acb-194">Request</span></span>|<span data-ttu-id="78acb-195">Service</span><span class="sxs-lookup"><span data-stu-id="78acb-195">Service</span></span><br /><br /> <span data-ttu-id="78acb-196">Livello</span><span class="sxs-lookup"><span data-stu-id="78acb-196">Level</span></span><br /><br /> <span data-ttu-id="78acb-197">Invia</span><span class="sxs-lookup"><span data-stu-id="78acb-197">Send</span></span><br /><br /> <span data-ttu-id="78acb-198">Reply</span><span class="sxs-lookup"><span data-stu-id="78acb-198">Reply</span></span>|<span data-ttu-id="78acb-199">Service</span><span class="sxs-lookup"><span data-stu-id="78acb-199">Service</span></span><br /><br /> <span data-ttu-id="78acb-200">Livello</span><span class="sxs-lookup"><span data-stu-id="78acb-200">Level</span></span><br /><br /> <span data-ttu-id="78acb-201">Receive</span><span class="sxs-lookup"><span data-stu-id="78acb-201">Receive</span></span><br /><br /> <span data-ttu-id="78acb-202">Reply</span><span class="sxs-lookup"><span data-stu-id="78acb-202">Reply</span></span>|  
|<span data-ttu-id="78acb-203">Livello di trasporto</span><span class="sxs-lookup"><span data-stu-id="78acb-203">Transport layer</span></span>|<span data-ttu-id="78acb-204">Trasporto</span><span class="sxs-lookup"><span data-stu-id="78acb-204">Transport</span></span><br /><br /> <span data-ttu-id="78acb-205">Invia</span><span class="sxs-lookup"><span data-stu-id="78acb-205">Send</span></span>|<span data-ttu-id="78acb-206">Trasporto</span><span class="sxs-lookup"><span data-stu-id="78acb-206">Transport</span></span><br /><br /> <span data-ttu-id="78acb-207">Receive</span><span class="sxs-lookup"><span data-stu-id="78acb-207">Receive</span></span>|<span data-ttu-id="78acb-208">Trasporto</span><span class="sxs-lookup"><span data-stu-id="78acb-208">Transport</span></span><br /><br /> <span data-ttu-id="78acb-209">Invia</span><span class="sxs-lookup"><span data-stu-id="78acb-209">Send</span></span>|<span data-ttu-id="78acb-210">Trasporto</span><span class="sxs-lookup"><span data-stu-id="78acb-210">Transport</span></span><br /><br /> <span data-ttu-id="78acb-211">Receive</span><span class="sxs-lookup"><span data-stu-id="78acb-211">Receive</span></span>|  
  
 <span data-ttu-id="78acb-212">Per richiesta unidirezionale</span><span class="sxs-lookup"><span data-stu-id="78acb-212">For One-way Request</span></span>  
  
||<span data-ttu-id="78acb-213">Invio richiesta</span><span class="sxs-lookup"><span data-stu-id="78acb-213">Send Request</span></span>|<span data-ttu-id="78acb-214">Ricezione richiesta</span><span class="sxs-lookup"><span data-stu-id="78acb-214">Receive Request</span></span>|  
|-|------------------|---------------------|  
|<span data-ttu-id="78acb-215">Livello del modello di servizio</span><span class="sxs-lookup"><span data-stu-id="78acb-215">Service Model layer</span></span>|<span data-ttu-id="78acb-216">Service</span><span class="sxs-lookup"><span data-stu-id="78acb-216">Service</span></span><br /><br /> <span data-ttu-id="78acb-217">Livello</span><span class="sxs-lookup"><span data-stu-id="78acb-217">Level</span></span><br /><br /> <span data-ttu-id="78acb-218">Invia</span><span class="sxs-lookup"><span data-stu-id="78acb-218">Send</span></span><br /><br /> <span data-ttu-id="78acb-219">Datagram</span><span class="sxs-lookup"><span data-stu-id="78acb-219">Datagram</span></span>|<span data-ttu-id="78acb-220">Service</span><span class="sxs-lookup"><span data-stu-id="78acb-220">Service</span></span><br /><br /> <span data-ttu-id="78acb-221">Livello</span><span class="sxs-lookup"><span data-stu-id="78acb-221">Level</span></span><br /><br /> <span data-ttu-id="78acb-222">Receive</span><span class="sxs-lookup"><span data-stu-id="78acb-222">Receive</span></span><br /><br /> <span data-ttu-id="78acb-223">Datagram</span><span class="sxs-lookup"><span data-stu-id="78acb-223">Datagram</span></span>|  
|<span data-ttu-id="78acb-224">Livello di trasporto</span><span class="sxs-lookup"><span data-stu-id="78acb-224">Transport layer</span></span>|<span data-ttu-id="78acb-225">Trasporto</span><span class="sxs-lookup"><span data-stu-id="78acb-225">Transport</span></span><br /><br /> <span data-ttu-id="78acb-226">Invia</span><span class="sxs-lookup"><span data-stu-id="78acb-226">Send</span></span>|<span data-ttu-id="78acb-227">Trasporto</span><span class="sxs-lookup"><span data-stu-id="78acb-227">Transport</span></span><br /><br /> <span data-ttu-id="78acb-228">Receive</span><span class="sxs-lookup"><span data-stu-id="78acb-228">Receive</span></span>|  
  
## <a name="message-filters"></a><span data-ttu-id="78acb-229">Filtri messaggi</span><span class="sxs-lookup"><span data-stu-id="78acb-229">Message Filters</span></span>  
 <span data-ttu-id="78acb-230">I filtri dei messaggi vengono definiti nell'elemento di configurazione `messageLogging` della sezione di configurazione `diagnostics`.</span><span class="sxs-lookup"><span data-stu-id="78acb-230">Message filters are defined in the `messageLogging` configuration element of the `diagnostics` configuration section.</span></span> <span data-ttu-id="78acb-231">Essi vengono applicati a livello di servizio e di trasporto.</span><span class="sxs-lookup"><span data-stu-id="78acb-231">They are applied at the service and transport level.</span></span> <span data-ttu-id="78acb-232">Quando sono definiti uno o più filtri, solo i messaggi che corrispondono almeno a uno dei filtri vengono registrati.</span><span class="sxs-lookup"><span data-stu-id="78acb-232">When one or more filters are defined, only messages that match at least one of the filters are logged.</span></span> <span data-ttu-id="78acb-233">Se non è definito alcun filtro, passeranno tutti i messaggi.</span><span class="sxs-lookup"><span data-stu-id="78acb-233">If no filter is defined, all messages pass through.</span></span>  
  
 <span data-ttu-id="78acb-234">I filtri supportano la sintassi Xpath completa e sono applicati nell'ordine in cui vengono visualizzati nel file di configurazione.</span><span class="sxs-lookup"><span data-stu-id="78acb-234">Filters support the full XPath syntax and are applied in the order they appear in the configuration file.</span></span> <span data-ttu-id="78acb-235">Un filtro sintatticamente errato determina un'eccezione di configurazione.</span><span class="sxs-lookup"><span data-stu-id="78acb-235">A syntactically incorrect filter results in a configuration exception.</span></span>  
  
 <span data-ttu-id="78acb-236">I filtri forniscono anche una funzionalità di sicurezza mediante l'attributo `nodeQuota`, che limita il numero massimo di nodi nel DOM XPath che possono essere esaminati per la corrispondenza al filtro.</span><span class="sxs-lookup"><span data-stu-id="78acb-236">Filters also provide a safety feature using the `nodeQuota` attribute, which limits the maximum number of nodes in the XPath DOM that can be examined to match the filter.</span></span>  
  
 <span data-ttu-id="78acb-237">Nell'esempio seguente viene illustrato come configurare un filtro che registra solo messaggi con una sezione intestazione SOAP.</span><span class="sxs-lookup"><span data-stu-id="78acb-237">The following example shows how to configure a filter that records only messages that have a SOAP header section.</span></span>  
  
```xml  
<messageLogging logEntireMessage="true"  
    logMalformedMessages="true"   
    logMessagesAtServiceLevel="true"  
    logMessagesAtTransportLevel="true"  
    maxMessagesToLog="420">  
    <filters>  
        <add nodeQuota="10" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">  
                 /soap:Envelope/soap:Header  
        </add>  
     </filters>  
</messageLogging>  
```  
  
 <span data-ttu-id="78acb-238">Non è possibile applicare filtri al corpo di un messaggio.</span><span class="sxs-lookup"><span data-stu-id="78acb-238">Filters cannot be applied to the body of a message.</span></span> <span data-ttu-id="78acb-239">I filtri che tentano di manipolare il corpo di un messaggio vengono rimossi dall'elenco dei filtri.</span><span class="sxs-lookup"><span data-stu-id="78acb-239">Filters that attempt to manipulate the body of a message are removed from the list of filters.</span></span> <span data-ttu-id="78acb-240">In questo caso verrà anche generato un evento.</span><span class="sxs-lookup"><span data-stu-id="78acb-240">An event is also emitted that indicates this.</span></span> <span data-ttu-id="78acb-241">Ad esempio, il filtro seguente verrebbe rimosso dalla tabella dei filtri.</span><span class="sxs-lookup"><span data-stu-id="78acb-241">For example, the following filter would be removed from the filter table.</span></span>  
  
```xml  
<add xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">/s:Envelope/s:Body[contains(text(), "Hello")]</add>  
```  
  
## <a name="configuring-a-custom-listener"></a><span data-ttu-id="78acb-242">Configurazione di un listener personalizzato</span><span class="sxs-lookup"><span data-stu-id="78acb-242">Configuring a Custom Listener</span></span>  
 <span data-ttu-id="78acb-243">È possibile configurare un listener personalizzato con opzioni aggiuntive.</span><span class="sxs-lookup"><span data-stu-id="78acb-243">You can also configure a custom listener with additional options.</span></span> <span data-ttu-id="78acb-244">Un listener personalizzato può essere utile per filtrare informazioni personali specifiche dell'applicazione dai messaggi prima della registrazione.</span><span class="sxs-lookup"><span data-stu-id="78acb-244">A custom listener can be useful in filtering application-specific PII elements from messages before logging.</span></span> <span data-ttu-id="78acb-245">Nell'esempio seguente viene illustrata la configurazione di un listener personalizzato.</span><span class="sxs-lookup"><span data-stu-id="78acb-245">The following example demonstrates a custom listener configuration.</span></span>  
  
```xml  
<system.diagnostics>  
   <sources>  
     <source name="System.ServiceModel.MessageLogging">  
           <listeners>  
             <add name="MyListener"   
                    type="YourCustomListener"  
                    initializeData="c:\logs\messages.svclog"  
                    maxDiskSpace="1000"/>  
           </listeners>  
     </source>  
   </sources>  
</system.diagnostics>  
```  
  
 <span data-ttu-id="78acb-246">È necessario tenere presente che l'attributo `type` deve essere impostato su un nome di assembly completo del tipo.</span><span class="sxs-lookup"><span data-stu-id="78acb-246">You should be aware that the `type` attribute should be set to a qualified assembly name of the type.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="78acb-247">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="78acb-247">See Also</span></span>  
 [<span data-ttu-id="78acb-248">\<messageLogging ></span><span class="sxs-lookup"><span data-stu-id="78acb-248">\<messageLogging></span></span>](../../../../docs/framework/configure-apps/file-schema/wcf/messagelogging.md)  
 [<span data-ttu-id="78acb-249">Registrazione messaggi</span><span class="sxs-lookup"><span data-stu-id="78acb-249">Message Logging</span></span>](../../../../docs/framework/wcf/diagnostics/message-logging.md)  
 [<span data-ttu-id="78acb-250">Impostazioni consigliate per la traccia e la registrazione dei messaggi</span><span class="sxs-lookup"><span data-stu-id="78acb-250">Recommended Settings for Tracing and Message Logging</span></span>](../../../../docs/framework/wcf/diagnostics/tracing/recommended-settings-for-tracing-and-message-logging.md)
