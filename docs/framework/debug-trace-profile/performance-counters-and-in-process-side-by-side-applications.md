---
title: Contatori delle prestazioni e applicazioni affiancate in-process
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
helpviewer_keywords:
- performance counters
- performance counters,and in-process side-by-side applications
- performance,.NET Framework applications
- performance monitoring,counters
ms.assetid: 6888f9be-c65b-4b03-a07b-df7ebdee2436
caps.latest.revision: "26"
author: rpetrusha
ms.author: ronpet
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: acbdf1ff1f2827bf607c2f838685d5161af61fd0
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/22/2017
---
# <a name="performance-counters-and-in-process-side-by-side-applications"></a><span data-ttu-id="c61ba-102">Contatori delle prestazioni e applicazioni affiancate in-process</span><span class="sxs-lookup"><span data-stu-id="c61ba-102">Performance Counters and In-Process Side-By-Side Applications</span></span>
<span data-ttu-id="c61ba-103">Con Performance Monitor (Perfmon.exe) è possibile distinguere i contatori delle prestazioni in base al runtime.</span><span class="sxs-lookup"><span data-stu-id="c61ba-103">Using the Performance Monitor (Perfmon.exe), it is possible to differentiate the performance counters on a per-runtime basis.</span></span> <span data-ttu-id="c61ba-104">Questo argomento descrive la modifica del Registro di sistema necessaria per abilitare questa funzionalità.</span><span class="sxs-lookup"><span data-stu-id="c61ba-104">This topic describes the registry change needed to enable this functionality.</span></span>  
  
## <a name="the-default-behavior"></a><span data-ttu-id="c61ba-105">Comportamento predefinito</span><span class="sxs-lookup"><span data-stu-id="c61ba-105">The Default Behavior</span></span>  
 <span data-ttu-id="c61ba-106">Per impostazione predefinita, Performance Monitor visualizza i contatori delle prestazioni in base all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c61ba-106">By default, the Performance Monitor displays performance counters on a per-application basis.</span></span> <span data-ttu-id="c61ba-107">In due scenari, tuttavia, ciò può rappresentare un problema:</span><span class="sxs-lookup"><span data-stu-id="c61ba-107">However, there are two scenarios in which this is problematic:</span></span>  
  
-   <span data-ttu-id="c61ba-108">Quando viene eseguito il monitoraggio di due applicazioni con lo stesso nome.</span><span class="sxs-lookup"><span data-stu-id="c61ba-108">When you monitor two applications that have the same name.</span></span> <span data-ttu-id="c61ba-109">Ad esempio, se entrambe le applicazioni sono denominate app.exe, una verrà visualizzata come **app** e l'altra come **app#1** nella colonna **Istanza**.</span><span class="sxs-lookup"><span data-stu-id="c61ba-109">For example, if both applications are named myapp.exe, one will be displayed as **myapp** and the other as **myapp#1** in the **Instance** column.</span></span> <span data-ttu-id="c61ba-110">In questo caso, è difficile associare un contatore delle prestazioni a un'applicazione specifica.</span><span class="sxs-lookup"><span data-stu-id="c61ba-110">In this case, it is difficult to match a performance counter to a particular application.</span></span> <span data-ttu-id="c61ba-111">Non è chiaro se i dati raccolti per **app #1** fanno riferimento alla prima o alla seconda app.exe.</span><span class="sxs-lookup"><span data-stu-id="c61ba-111">It is not clear whether the data collected for **myapp#1** refers to the first myapp.exe or the second myapp.exe.</span></span>  
  
-   <span data-ttu-id="c61ba-112">Quando un'applicazione usa più istanze di Common Language Runtime.</span><span class="sxs-lookup"><span data-stu-id="c61ba-112">When an application uses multiple instances of the common language runtime.</span></span> <span data-ttu-id="c61ba-113">[!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)] supporta scenari di hosting side-by-side, ovvero un singolo processo o una singola applicazione può caricare più istanze di Common Language Runtime.</span><span class="sxs-lookup"><span data-stu-id="c61ba-113">The [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)] supports in-process side-by-side hosting scenarios; that is, a single process or application can load multiple instances of the common language runtime.</span></span> <span data-ttu-id="c61ba-114">Se una singola applicazione denominata app.exe carica due istanze di runtime, per impostazione predefinita verranno designate come **app** e **app#1** nella colonna **Istanza**.</span><span class="sxs-lookup"><span data-stu-id="c61ba-114">If a single application named myapp.exe loads two runtime instances, by default, they will be designated in the **Instance** column as **myapp** and **myapp#1**.</span></span> <span data-ttu-id="c61ba-115">In questo caso, non è chiaro se **app** e **app#1** fanno riferimento a due applicazioni con lo stesso nome o alla stessa applicazione con due runtime.</span><span class="sxs-lookup"><span data-stu-id="c61ba-115">In this case, it is not clear whether **myapp** and **myapp#1** refer to two applications with the same name, or to the same application with two runtimes.</span></span> <span data-ttu-id="c61ba-116">Se più applicazioni con lo stesso nome caricano più runtime, l'ambiguità è ancora maggiore.</span><span class="sxs-lookup"><span data-stu-id="c61ba-116">If multiple applications with the same name load multiple runtimes, the ambiguity is even greater.</span></span>  
  
 <span data-ttu-id="c61ba-117">È possibile impostare una chiave del Registro di sistema per evitare questa ambiguità.</span><span class="sxs-lookup"><span data-stu-id="c61ba-117">You can set a registry key to eliminate this ambiguity.</span></span> <span data-ttu-id="c61ba-118">Per le applicazioni sviluppate con [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)], questa modifica del Registro di sistema aggiunge un identificatore di processo seguito da un identificatore dell'istanza di runtime al nome dell'applicazione nella colonna **Istanza**.</span><span class="sxs-lookup"><span data-stu-id="c61ba-118">For applications developed using the [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)], this registry change adds a process identifier followed by a runtime instance identifier to the application name in the **Instance** column.</span></span> <span data-ttu-id="c61ba-119">Anziché come *applicazione* o *applicazione*#1, l'applicazione è ora identificata come *applicazione*_`p`*IDprocesso*\_`r`*IDruntime* nella colonna **Istanza**.</span><span class="sxs-lookup"><span data-stu-id="c61ba-119">Instead of *application* or *application*#1, the application is now identified as *application*_`p`*processID*\_`r`*runtimeID* in the **Instance** column.</span></span> <span data-ttu-id="c61ba-120">Se un'applicazione è stata sviluppata con una versione precedente di Common Language Runtime, questa istanza viene rappresentata come *applicazione\_*`p`*IDprocesso*, purché sia stato installato [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c61ba-120">If an application was developed using a previous version of the common language runtime, that instance is represented as *application\_*`p`*processID* provided that the [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)] is installed.</span></span>  
  
## <a name="performance-counters-for-in-process-side-by-side-applications"></a><span data-ttu-id="c61ba-121">Contatori delle prestazioni per applicazioni affiancate in-process</span><span class="sxs-lookup"><span data-stu-id="c61ba-121">Performance Counters for In-Process Side-by-Side Applications</span></span>  
 <span data-ttu-id="c61ba-122">Per gestire i contatori delle prestazioni per più versioni di Common Language Runtime ospitate in una singola applicazione, è necessario modificare una chiave del Registro di sistema, come illustrato nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="c61ba-122">To handle performance counters for multiple common language runtime versions that are hosted in a single application, you must change a single registry key setting, as shown in the following table.</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="c61ba-123">Nome della chiave</span><span class="sxs-lookup"><span data-stu-id="c61ba-123">Key name</span></span>|<span data-ttu-id="c61ba-124">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\\.NETFramework\Performance</span><span class="sxs-lookup"><span data-stu-id="c61ba-124">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\\.NETFramework\Performance</span></span>|  
|<span data-ttu-id="c61ba-125">Nome valore</span><span class="sxs-lookup"><span data-stu-id="c61ba-125">Value name</span></span>|<span data-ttu-id="c61ba-126">ProcessNameFormat</span><span class="sxs-lookup"><span data-stu-id="c61ba-126">ProcessNameFormat</span></span>|  
|<span data-ttu-id="c61ba-127">Tipo valore</span><span class="sxs-lookup"><span data-stu-id="c61ba-127">Value type</span></span>|<span data-ttu-id="c61ba-128">REG_DWORD</span><span class="sxs-lookup"><span data-stu-id="c61ba-128">REG_DWORD</span></span>|  
|<span data-ttu-id="c61ba-129">Valore</span><span class="sxs-lookup"><span data-stu-id="c61ba-129">Value</span></span>|<span data-ttu-id="c61ba-130">1 (0x00000001)</span><span class="sxs-lookup"><span data-stu-id="c61ba-130">1 (0x00000001)</span></span>|  
  
 <span data-ttu-id="c61ba-131">Il valore 0 per `ProcessNameFormat` indica che è abilitato il comportamento predefinito, ovvero Perfmon.exe visualizza i contatori delle prestazioni in base alle singole applicazioni.</span><span class="sxs-lookup"><span data-stu-id="c61ba-131">A value of 0 for `ProcessNameFormat` indicates that the default behavior is enabled; that is, Perfmon.exe displays performance counters on a per-application basis.</span></span> <span data-ttu-id="c61ba-132">Quando si imposta questo valore su 1, Perfmon.exe risolve l'ambiguità per più versioni di un'applicazione e fornisce i contatori delle prestazioni in base al runtime.</span><span class="sxs-lookup"><span data-stu-id="c61ba-132">When you set this value to 1, Perfmon.exe disambiguates multiple versions of an application and provides performance counters on a per-runtime basis.</span></span> <span data-ttu-id="c61ba-133">Qualsiasi altro valore per l'impostazione della chiave del Registro di sistema `ProcessNameFormat` non è supportato ed è riservato per usi futuri.</span><span class="sxs-lookup"><span data-stu-id="c61ba-133">Any other value for the `ProcessNameFormat` registry key setting is unsupported and reserved for future use.</span></span>  
  
 <span data-ttu-id="c61ba-134">Dopo aver aggiornato l'impostazione della chiave del Registro di sistema `ProcessNameFormat`, è necessario riavviare Perfmon.exe o qualsiasi altro consumer di contatori delle prestazioni, in modo che la nuova funzionalità di denominazione delle istanze funzioni correttamente.</span><span class="sxs-lookup"><span data-stu-id="c61ba-134">After you update the `ProcessNameFormat` registry key setting, you must restart Perfmon.exe or any other consumers of performance counters so that the new instance naming feature works correctly.</span></span>  
  
 <span data-ttu-id="c61ba-135">L'esempio seguente mostra come modificare il valore `ProcessNameFormat` a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="c61ba-135">The following example shows how to change the `ProcessNameFormat` value programmatically.</span></span>  
  
 [!code-csharp[Conceptual.PerfCounters.InProSxS#1](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.perfcounters.inprosxs/cs/regsetting1.cs#1)]
 [!code-vb[Conceptual.PerfCounters.InProSxS#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.perfcounters.inprosxs/vb/regsetting1.vb#1)]  
  
 <span data-ttu-id="c61ba-136">Quando si apporta questa modifica al Registro di sistema, Perfmon.exe visualizza i nomi delle applicazioni destinate a [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)] come *applicazione*_`p`*IDprocesso*\_`r`*IDruntime*, dove *applicazione* è il nome dell'applicazione, *IDprocesso* è l'identificatore del processo dell'applicazione e *IDruntime* è un identificatore di Common Language Runtime.</span><span class="sxs-lookup"><span data-stu-id="c61ba-136">When you make this registry change, Perfmon.exe displays the names of applications that target the [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)] as *application*_`p`*processID*\_`r`*runtimeID*, where *application* is the name of the application, *processID* is the application's process identifier, and *runtimeID* is a common language runtime identifier.</span></span> <span data-ttu-id="c61ba-137">Ad esempio, se un'applicazione denominata app.exe carica due istanze di Common Language Runtime, Perfmon.exe può identificare un'istanza come app_p1416_r10 e la seconda come app_p3160_r10.</span><span class="sxs-lookup"><span data-stu-id="c61ba-137">For example, if an application named myapp.exe loads two instances of the common language runtime, Perfmon.exe may identify one instance as myapp_p1416_r10 and the second as myapp_p3160_r10.</span></span> <span data-ttu-id="c61ba-138">L'identificatore di runtime risolve solo eventuali ambiguità per i runtime all'interno di un processo e non fornisce informazioni sul runtime.</span><span class="sxs-lookup"><span data-stu-id="c61ba-138">The runtime identifier only disambiguates the runtimes within a process; it does not provide any other information about the runtime.</span></span> <span data-ttu-id="c61ba-139">(Ad esempio, l'ID di runtime non ha alcuna relazione con la versione o lo SKU del runtime.)</span><span class="sxs-lookup"><span data-stu-id="c61ba-139">(For example, the runtime ID has no relation to the version or the SKU of the runtime.)</span></span>  
  
 <span data-ttu-id="c61ba-140">Se è installato [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)], la modifica del Registro di sistema interessa anche le applicazioni sviluppate con le versioni precedenti di .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="c61ba-140">If the [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)] is installed, the registry change also affects applications that were developed using earlier versions of the .NET Framework.</span></span> <span data-ttu-id="c61ba-141">Questi elementi vengono visualizzati in Perfmon.exe come *applicazione_*`p`*IDprocesso*, dove *applicazione* è il nome dell'applicazione e *IDprocesso* è l'identificatore di processo.</span><span class="sxs-lookup"><span data-stu-id="c61ba-141">These appear in Perfmon.exe as *application_*`p`*processID*, where *application* is the application name and *processID* is the process identifier.</span></span> <span data-ttu-id="c61ba-142">Ad esempio, se vengono monitorati i contatori delle prestazioni di due applicazioni denominate app.exe, una potrebbe essere visualizzata come app_p23900 e l'altra come app_p24908.</span><span class="sxs-lookup"><span data-stu-id="c61ba-142">For example, if the performance counters of two applications named myapp.exe are monitored, one might appear as myapp_p23900 and the other as myapp_p24908.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c61ba-143">L'identificatore di processo elimina l'ambiguità per la risoluzione di due applicazioni con lo stesso nome che usano versioni precedenti del runtime.</span><span class="sxs-lookup"><span data-stu-id="c61ba-143">The process identifier eliminates the ambiguity of resolving two applications with the same name that use earlier versions of the runtime.</span></span> <span data-ttu-id="c61ba-144">Un identificatore di runtime non è obbligatorio per le versioni precedenti, perché le versioni precedenti di Common Language Runtime non supportano gli scenari affiancati.</span><span class="sxs-lookup"><span data-stu-id="c61ba-144">A runtime identifier is not required for previous versions, because previous versions of the common language runtime do not support side-by-side scenarios.</span></span>  
  
 <span data-ttu-id="c61ba-145">Se [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)] non è presente o è stato disinstallato, l'impostazione della chiave del Registro di sistema non ha alcun effetto.</span><span class="sxs-lookup"><span data-stu-id="c61ba-145">If the [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)] is not present or was uninstalled, setting the registry key has no effect.</span></span> <span data-ttu-id="c61ba-146">Questo significa che due applicazioni con lo stesso nome continueranno a essere visualizzate in Perfmon.exe come *applicazione* e *applicazione#1* (ad esempio, come **app** e **app#1**).</span><span class="sxs-lookup"><span data-stu-id="c61ba-146">This means that two applications with the same name will continue to appear in Perfmon.exe as *application* and *application#1* (for example, as **myapp** and **myapp#1**).</span></span>
