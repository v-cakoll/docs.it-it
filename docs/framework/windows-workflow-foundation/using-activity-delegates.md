---
title: Uso di delegati di attività
ms.date: 03/30/2017
ms.assetid: e33cf876-8979-440b-9b23-4a12d1139960
ms.openlocfilehash: cbcc8f8e498be4f79f8fed5af7cd3557d7c55981
ms.sourcegitcommit: a4f9b754059f0210e29ae0578363a27b9ba84b64
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/05/2019
ms.locfileid: "74837571"
---
# <a name="using-activity-delegates"></a><span data-ttu-id="8c813-102">Uso di delegati di attività</span><span class="sxs-lookup"><span data-stu-id="8c813-102">Using Activity Delegates</span></span>
<span data-ttu-id="8c813-103">I delegati di attività consentono agli autori di attività di esporre callback con firme specifiche, per cui gli utenti dell'attività possono fornire gestori in base all'attività.</span><span class="sxs-lookup"><span data-stu-id="8c813-103">Activity delegates enable activity authors to expose callbacks with specific signatures, for which users of the activity can provide activity-based handlers.</span></span> <span data-ttu-id="8c813-104">Sono disponibili due tipi di delegati di attività: <xref:System.Activities.ActivityAction%601>, usato per definire i delegati di attività senza un valore restituito, e <xref:System.Activities.ActivityFunc%601>, usato per definire i delegati di attività con un valore restituito.</span><span class="sxs-lookup"><span data-stu-id="8c813-104">Two types of activity delegates are available: <xref:System.Activities.ActivityAction%601> is used to define activity delegates that do not have a return value, and <xref:System.Activities.ActivityFunc%601> is used to define activity delegates that do have a return value.</span></span>

<span data-ttu-id="8c813-105">I delegati di attività sono utili in scenari in cui un'attività figlio deve disporre di una determinata firma.</span><span class="sxs-lookup"><span data-stu-id="8c813-105">Activity delegates are useful in scenarios where a child activity must be constrained to having a certain signature.</span></span> <span data-ttu-id="8c813-106">Ad esempio, un'attività <xref:System.Activities.Statements.While> può contenere qualsiasi tipo di attività figlio senza vincoli, ma il corpo di un'attività <xref:System.Activities.Statements.ForEach%601> è un oggetto <xref:System.Activities.ActivityAction%601> e l'attività figlio che viene eseguita alla fine dall'oggetto <xref:System.Activities.Statements.ForEach%601> deve disporre di un oggetto <xref:System.Activities.InArgument%601> dello stesso tipo dei membri della raccolta enumerata dall'oggetto <xref:System.Activities.Statements.ForEach%601>.</span><span class="sxs-lookup"><span data-stu-id="8c813-106">For example, a <xref:System.Activities.Statements.While> activity can contain any type of child activity with no constraints, but the body of a <xref:System.Activities.Statements.ForEach%601> activity is an <xref:System.Activities.ActivityAction%601>, and the child activity that is ultimately executed by <xref:System.Activities.Statements.ForEach%601> must have an <xref:System.Activities.InArgument%601> that is the same type of the members of the collection that the <xref:System.Activities.Statements.ForEach%601> enumerates.</span></span>

## <a name="using-activityaction"></a><span data-ttu-id="8c813-107">Uso di ActivityAction</span><span class="sxs-lookup"><span data-stu-id="8c813-107">Using ActivityAction</span></span>

<span data-ttu-id="8c813-108">Diverse attività [!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)] usano le azioni di attività, ad esempio le attività <xref:System.Activities.Statements.Catch> e <xref:System.Activities.Statements.ForEach%601>.</span><span class="sxs-lookup"><span data-stu-id="8c813-108">Several [!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)] activities use activity actions, such as the <xref:System.Activities.Statements.Catch> activity and the <xref:System.Activities.Statements.ForEach%601> activity.</span></span> <span data-ttu-id="8c813-109">In ogni caso, l'azione di attività rappresenta un percorso in cui l'autore del flusso di lavoro specifica un'attività per fornire il comportamento desiderato quando si crea un flusso di lavoro usando una di queste attività.</span><span class="sxs-lookup"><span data-stu-id="8c813-109">In each case, the activity action represents a location where the workflow author specifies an activity to provide the desired behavior when composing a workflow using one of these activities.</span></span> <span data-ttu-id="8c813-110">Nell'esempio seguente, si usa un'attività <xref:System.Activities.Statements.ForEach%601> per visualizzare il testo nella finestra della console.</span><span class="sxs-lookup"><span data-stu-id="8c813-110">In the following example, a <xref:System.Activities.Statements.ForEach%601> activity is used to display text to the console window.</span></span> <span data-ttu-id="8c813-111">Il corpo dell'oggetto <xref:System.Activities.Statements.ForEach%601> viene specificato tramite un oggetto <xref:System.Activities.ActivityAction%601> che corrisponde al tipo dell'oggetto <xref:System.Activities.Statements.ForEach%601> che è una stringa.</span><span class="sxs-lookup"><span data-stu-id="8c813-111">The body of the <xref:System.Activities.Statements.ForEach%601> is specified by using an <xref:System.Activities.ActivityAction%601> that matches the type of the <xref:System.Activities.Statements.ForEach%601> which is string.</span></span> <span data-ttu-id="8c813-112">L'argomento <xref:System.Activities.Statements.WriteLine> dell'attività <xref:System.Activities.ActivityDelegate.Handler%2A> specificata nell'oggetto <xref:System.Activities.Statements.WriteLine.Text%2A> è associato ai valori stringa della raccolta scorsa dall'attività <xref:System.Activities.Statements.ForEach%601>.</span><span class="sxs-lookup"><span data-stu-id="8c813-112">The <xref:System.Activities.Statements.WriteLine> activity specified in the <xref:System.Activities.ActivityDelegate.Handler%2A> has its <xref:System.Activities.Statements.WriteLine.Text%2A> argument bound to the string values in the collection that the <xref:System.Activities.Statements.ForEach%601> activity iterates.</span></span>

[!code-csharp[CFX_ActivityExample#6](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_ActivityExample/cs/Program.cs#6)]

<span data-ttu-id="8c813-113">L'oggetto ActionArgument è usato per propagare i singoli elementi della raccolta in WriteLine.</span><span class="sxs-lookup"><span data-stu-id="8c813-113">The actionArgument is used to flow the individual items in the collection to the WriteLine.</span></span> <span data-ttu-id="8c813-114">Quando il flusso di lavoro viene richiamato, l'output seguente viene visualizzato nella console.</span><span class="sxs-lookup"><span data-stu-id="8c813-114">When the workflow is invoked, the following output is displayed to the console.</span></span>

```console
HelloWorld.
```

<span data-ttu-id="8c813-115">Negli esempi di questo argomento viene usata la sintassi di inizializzazione oggetti</span><span class="sxs-lookup"><span data-stu-id="8c813-115">The examples in this topic use object initialization syntax.</span></span> <span data-ttu-id="8c813-116">che può essere utile per creare definizioni del flusso di lavoro in codice in quanto fornisce una visualizzazione gerarchica delle attività nel flusso di lavoro e consente di illustrare la relazione tra le attività.</span><span class="sxs-lookup"><span data-stu-id="8c813-116">Object initialization syntax can be a useful way to create workflow definitions in code because it provides a hierarchical view of the activities in the workflow and shows the relationship between the activities.</span></span> <span data-ttu-id="8c813-117">Non è previsto alcun requisito per usare la sintassi di inizializzazione oggetti quando si creano flussi di lavoro a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="8c813-117">There is no requirement to use object initialization syntax when you programmatically create workflows.</span></span> <span data-ttu-id="8c813-118">L'esempio seguente rappresenta l'equivalente funzionale dell'esempio precedente.</span><span class="sxs-lookup"><span data-stu-id="8c813-118">The following example is functionally equivalent to the previous example.</span></span>

[!code-csharp[CFX_ActivityExample#7](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_ActivityExample/cs/Program.cs#7)]

<span data-ttu-id="8c813-119">Per ulteriori informazioni sugli inizializzatori di oggetto, vedere [procedura: inizializzare oggetti senza chiamare un costruttoreC# (Guida per programmatori)](../../csharp/programming-guide/classes-and-structs/how-to-initialize-objects-by-using-an-object-initializer.md) e [procedura: dichiarare un oggetto utilizzando un inizializzatore di oggetto (Visual Basic)](../../visual-basic/programming-guide/language-features/objects-and-classes/how-to-declare-an-object-by-using-an-object-initializer.md).</span><span class="sxs-lookup"><span data-stu-id="8c813-119">For more information about object initializers, see [How to: Initialize Objects without Calling a Constructor (C# Programming Guide)](../../csharp/programming-guide/classes-and-structs/how-to-initialize-objects-by-using-an-object-initializer.md) and [How to: Declare an Object by Using an Object Initializer (Visual Basic)](../../visual-basic/programming-guide/language-features/objects-and-classes/how-to-declare-an-object-by-using-an-object-initializer.md).</span></span>

<span data-ttu-id="8c813-120">Nell'esempio seguente, un'attività <xref:System.Activities.Statements.TryCatch> è usata in un flusso di lavoro.</span><span class="sxs-lookup"><span data-stu-id="8c813-120">In the following example, a <xref:System.Activities.Statements.TryCatch> activity is used in a workflow.</span></span> <span data-ttu-id="8c813-121">Un'eccezione <xref:System.ApplicationException> viene generata dal flusso di lavoro e gestita da un'attività <xref:System.Activities.Statements.Catch%601>.</span><span class="sxs-lookup"><span data-stu-id="8c813-121">An <xref:System.ApplicationException> is thrown by the workflow, and is handled by a <xref:System.Activities.Statements.Catch%601> activity.</span></span> <span data-ttu-id="8c813-122">Il gestore per l'azione dell'attività dell'attività <xref:System.Activities.Statements.Catch%601> è un'attività <xref:System.Activities.Statements.WriteLine> e il dettaglio dell'eccezione viene propagato tramite il <xref:System.Activities.DelegateInArgument%601>di `ex`.</span><span class="sxs-lookup"><span data-stu-id="8c813-122">The handler for the <xref:System.Activities.Statements.Catch%601> activity's activity action is a <xref:System.Activities.Statements.WriteLine> activity, and the exception detail is flowed through to it using the `ex` <xref:System.Activities.DelegateInArgument%601>.</span></span>

[!code-csharp[CFX_WorkflowApplicationExample#33](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#33)]

<span data-ttu-id="8c813-123">Quando si crea un'attività personalizzata che definisce un oggetto <xref:System.Activities.ActivityAction%601>, usare un oggetto <xref:System.Activities.Statements.InvokeAction%601> per modellare la chiamata di tale oggetto <xref:System.Activities.ActivityAction%601>.</span><span class="sxs-lookup"><span data-stu-id="8c813-123">When creating a custom activity that defines an <xref:System.Activities.ActivityAction%601>, use an <xref:System.Activities.Statements.InvokeAction%601> to model the invocation of that <xref:System.Activities.ActivityAction%601>.</span></span> <span data-ttu-id="8c813-124">In questo esempio viene definita un'attività `WriteLineWithNotification` personalizzata.</span><span class="sxs-lookup"><span data-stu-id="8c813-124">In this example, a custom `WriteLineWithNotification` activity is defined.</span></span> <span data-ttu-id="8c813-125">Questa attività è costituita da un oggetto <xref:System.Activities.Statements.Sequence> che contiene un'attività <xref:System.Activities.Statements.WriteLine> seguita da un oggetto <xref:System.Activities.Statements.InvokeAction%601> che richiama un oggetto <xref:System.Activities.ActivityAction%601> che accetta un argomento di tipo stringa.</span><span class="sxs-lookup"><span data-stu-id="8c813-125">This activity is composed of a <xref:System.Activities.Statements.Sequence> that contains a <xref:System.Activities.Statements.WriteLine> activity followed by an <xref:System.Activities.Statements.InvokeAction%601> that invokes an <xref:System.Activities.ActivityAction%601> that takes one string argument.</span></span>

[!code-csharp[CFX_ActivityExample#1](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_ActivityExample/cs/Program.cs#1)]

<span data-ttu-id="8c813-126">Quando un flusso di lavoro viene creato usando l'attività `WriteLineWithNotification`, l'autore del flusso di lavoro specifica la logica personalizzata desiderata nella proprietà <xref:System.Activities.ActivityDelegate.Handler%2A> dell'azione dell'attività.</span><span class="sxs-lookup"><span data-stu-id="8c813-126">When a workflow is created by using the `WriteLineWithNotification` activity, the workflow author specifies the desired custom logic in the activity action’s <xref:System.Activities.ActivityDelegate.Handler%2A>.</span></span> <span data-ttu-id="8c813-127">In questo esempio viene creato un flusso di lavoro che usa l'attività `WriteLineWithNotification` e un'attività <xref:System.Activities.Statements.WriteLine> viene usata come proprietà <xref:System.Activities.ActivityDelegate.Handler%2A>.</span><span class="sxs-lookup"><span data-stu-id="8c813-127">In this example, a workflow is created that use the `WriteLineWithNotification` activity, and a <xref:System.Activities.Statements.WriteLine> activity is used as the <xref:System.Activities.ActivityDelegate.Handler%2A>.</span></span>

[!code-csharp[CFX_ActivityExample#2](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_ActivityExample/cs/Program.cs#2)]

<span data-ttu-id="8c813-128">Sono disponibili più versioni generiche degli oggetti <xref:System.Activities.Statements.InvokeAction%601> e <xref:System.Activities.ActivityAction%601> forniti per passare uno o più argomenti.</span><span class="sxs-lookup"><span data-stu-id="8c813-128">There are multiple generic versions of <xref:System.Activities.Statements.InvokeAction%601> and <xref:System.Activities.ActivityAction%601> provided for passing one or more arguments.</span></span>

## <a name="using-activityfunc"></a><span data-ttu-id="8c813-129">Uso di ActivityFunc</span><span class="sxs-lookup"><span data-stu-id="8c813-129">Using ActivityFunc</span></span>

<span data-ttu-id="8c813-130">L'oggetto <xref:System.Activities.ActivityAction%601> è utile quando l'attività non restituisce alcun valore di risultato, mentre l'oggetto <xref:System.Activities.ActivityFunc%601> è usato quando viene restituito un valore di risultato.</span><span class="sxs-lookup"><span data-stu-id="8c813-130"><xref:System.Activities.ActivityAction%601> is useful when there is no result value from the activity, and <xref:System.Activities.ActivityFunc%601> is used when a result value is returned.</span></span> <span data-ttu-id="8c813-131">Quando si crea un'attività personalizzata che definisce un oggetto <xref:System.Activities.ActivityFunc%601>, usare un oggetto <xref:System.Activities.Expressions.InvokeFunc%601> per modellare la chiamata di tale oggetto <xref:System.Activities.ActivityFunc%601>.</span><span class="sxs-lookup"><span data-stu-id="8c813-131">When creating a custom activity that defines an <xref:System.Activities.ActivityFunc%601>, use an <xref:System.Activities.Expressions.InvokeFunc%601> to model the invocation of that <xref:System.Activities.ActivityFunc%601>.</span></span> <span data-ttu-id="8c813-132">Nell'esempio seguente viene definita un'attività `WriteFillerText` .</span><span class="sxs-lookup"><span data-stu-id="8c813-132">In the following example, a `WriteFillerText` activity is defined.</span></span> <span data-ttu-id="8c813-133">Per fornire il testo di riempimento, viene specificato un oggetto <xref:System.Activities.Expressions.InvokeFunc%601> che accetta un argomento Integer e dispone di un risultato di stringa.</span><span class="sxs-lookup"><span data-stu-id="8c813-133">To supply the filler text, an <xref:System.Activities.Expressions.InvokeFunc%601> is specified that takes an integer argument and has a string result.</span></span> <span data-ttu-id="8c813-134">Una volta recuperato il testo di riempimento, viene visualizzato nella console tramite un'attività <xref:System.Activities.Statements.WriteLine>.</span><span class="sxs-lookup"><span data-stu-id="8c813-134">Once the filler text is retrieved, it is displayed to the console using a <xref:System.Activities.Statements.WriteLine> activity.</span></span>

[!code-csharp[CFX_ActivityExample#3](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_ActivityExample/cs/Program.cs#3)]

<span data-ttu-id="8c813-135">Per fornire il testo, è necessario usare un'attività che accetta un argomento `int` e dispone di un risultato di stringa.</span><span class="sxs-lookup"><span data-stu-id="8c813-135">To supply the text, an activity must be used that takes one `int` argument and has a string result.</span></span> <span data-ttu-id="8c813-136">In questo esempio viene mostrata un'attività `TextGenerator` che soddisfa questi requisiti.</span><span class="sxs-lookup"><span data-stu-id="8c813-136">This example shows a `TextGenerator` activity that meets these requirements.</span></span>

[!code-csharp[CFX_ActivityExample#4](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_ActivityExample/cs/Program.cs#4)]

<span data-ttu-id="8c813-137">Per usare l'attività `TextGenerator` con l'attività `WriteFillerText`, specificarla come proprietà <xref:System.Activities.ActivityDelegate.Handler%2A>.</span><span class="sxs-lookup"><span data-stu-id="8c813-137">To use the `TextGenerator` activity with the `WriteFillerText` activity, specify it as the <xref:System.Activities.ActivityDelegate.Handler%2A>.</span></span>

[!code-csharp[CFX_ActivityExample#5](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_ActivityExample/cs/Program.cs#5)]
