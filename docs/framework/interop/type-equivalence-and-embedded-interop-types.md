---
title: Equivalenza del tipo e tipi di interoperabilità incorporati
description: Comprendere l'equivalenza del tipo tra i tipi .NET e i membri con un assembly gestito e i tipi COM incorporati in tale assembly. Per .NET 4 e versioni successive.
ms.date: 03/30/2017
helpviewer_keywords:
- type equivalence
- embedded interop types
- primary interop assemblies,not necessary in CLR version 4
- NoPIA
ms.assetid: 78892eba-2a58-4165-b4b1-0250ee2f41dc
ms.openlocfilehash: 2d572133c42f01af7d50f6f771588f5173853f9a
ms.sourcegitcommit: 97ce5363efa88179dd76e09de0103a500ca9b659
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/13/2020
ms.locfileid: "86282008"
---
# <a name="type-equivalence-and-embedded-interop-types"></a><span data-ttu-id="7855e-104">Equivalenza del tipo e tipi di interoperabilità incorporati</span><span class="sxs-lookup"><span data-stu-id="7855e-104">Type equivalence and embedded interop types</span></span>

<span data-ttu-id="7855e-105">A partire da .NET Framework 4, Common Language Runtime supporta l'incorporamento di informazioni sui tipi COM direttamente negli assembly gestiti, anziché richiedere agli assembly gestiti di ottenere informazioni sui tipi COM dagli assembly di interoperabilità.</span><span class="sxs-lookup"><span data-stu-id="7855e-105">Beginning with the .NET Framework 4, the common language runtime supports embedding type information for COM types directly into managed assemblies, instead of requiring the managed assemblies to obtain type information for COM types from interop assemblies.</span></span> <span data-ttu-id="7855e-106">Dato che le informazioni sui tipi incorporate includono solo i tipi e membri che vengono effettivamente usati da un assembly gestito, due assembly gestiti potrebbero avere viste diverse dello stesso tipo COM.</span><span class="sxs-lookup"><span data-stu-id="7855e-106">Because the embedded type information includes only the types and members that are actually used by a managed assembly, two managed assemblies might have very different views of the same COM type.</span></span> <span data-ttu-id="7855e-107">Ogni assembly gestito a un oggetto <xref:System.Type> diverso per rappresentare la vista specifica del tipo COM.</span><span class="sxs-lookup"><span data-stu-id="7855e-107">Each managed assembly has a different <xref:System.Type> object to represent its view of the COM type.</span></span> <span data-ttu-id="7855e-108">Common Language Runtime supporta l'equivalenza del tipo tra queste viste diverse per interfacce, strutture, enumerazioni e delegati.</span><span class="sxs-lookup"><span data-stu-id="7855e-108">The common language runtime supports type equivalence between these different views for interfaces, structures, enumerations, and delegates.</span></span>

<span data-ttu-id="7855e-109">Equivalenza del tipo significa che è possibile eseguire il cast di un oggetto COM passato da un assembly gestito a un altro sul tipo gestito appropriato nell'assembly ricevente.</span><span class="sxs-lookup"><span data-stu-id="7855e-109">Type equivalence means that a COM object that is passed from one managed assembly to another can be cast to the appropriate managed type in the receiving assembly.</span></span>

> [!NOTE]
> <span data-ttu-id="7855e-110">L'equivalenza del tipo e i tipi di interoperabilità incorporati semplificano la distribuzione delle applicazioni e dei componenti aggiuntivi che usano componenti COM, perché non è necessario distribuire gli assembly di interoperabilità con le applicazioni.</span><span class="sxs-lookup"><span data-stu-id="7855e-110">Type equivalence and embedded interop types simplify the deployment of applications and add-ins that use COM components, because it is not necessary to deploy interop assemblies with the applications.</span></span> <span data-ttu-id="7855e-111">Gli sviluppatori di componenti COM condivisi devono ancora creare gli assembly di interoperabilità primari, se vogliono che i componenti possano essere usati da versioni precedenti di .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="7855e-111">Developers of shared COM components still have to create primary interop assemblies (PIAs) if they want their components to be used by earlier versions of the .NET Framework.</span></span>

## <a name="type-equivalence"></a><span data-ttu-id="7855e-112">Equivalenza del tipo</span><span class="sxs-lookup"><span data-stu-id="7855e-112">Type equivalence</span></span>

 <span data-ttu-id="7855e-113">L'equivalenza dei tipi COM è supportata per interfacce, strutture, enumerazioni e delegati.</span><span class="sxs-lookup"><span data-stu-id="7855e-113">Equivalence of COM types is supported for interfaces, structures, enumerations, and delegates.</span></span> <span data-ttu-id="7855e-114">I tipi COM sono considerati equivalenti se vengono soddisfatte tutte le condizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="7855e-114">COM types qualify as equivalent if all of the following are true:</span></span>

- <span data-ttu-id="7855e-115">I tipi sono entrambi interfacce o entrambi strutture o entrambi enumerazioni o entrambi delegati.</span><span class="sxs-lookup"><span data-stu-id="7855e-115">The types are both interfaces, or both structures, or both enumerations, or both delegates.</span></span>

- <span data-ttu-id="7855e-116">I tipi hanno la stessa identità, come descritto nella sezione successiva.</span><span class="sxs-lookup"><span data-stu-id="7855e-116">The types have the same identity, as described in the next section.</span></span>

- <span data-ttu-id="7855e-117">Entrambi i tipi sono idonei per l'equivalenza del tipo, come descritto nella sezione [contrassegno dei tipi com per l'equivalenza del tipo](#marking-com-types-for-type-equivalence) .</span><span class="sxs-lookup"><span data-stu-id="7855e-117">Both types are eligible for type equivalence, as described in the [Marking COM types for type equivalence](#marking-com-types-for-type-equivalence) section.</span></span>

### <a name="type-identity"></a><span data-ttu-id="7855e-118">Identità dei tipi</span><span class="sxs-lookup"><span data-stu-id="7855e-118">Type identity</span></span>

<span data-ttu-id="7855e-119">Due tipi vengono considerati aventi la stessa identità quando i relativi ambiti e identità corrispondono, in altre parole, se ognuno ha l'attributo <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> e i due attributi hanno proprietà <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> e <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A> corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="7855e-119">Two types are determined to have the same identity when their scopes and identities match, in other words, if they each have the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> attribute, and the two attributes have matching <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> and <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A> properties.</span></span> <span data-ttu-id="7855e-120">Il confronto per <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> non applica la distinzione tra maiuscole e minuscole.</span><span class="sxs-lookup"><span data-stu-id="7855e-120">The comparison for <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> is case-insensitive.</span></span>

<span data-ttu-id="7855e-121">Se un tipo non ha l'attributo <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> oppure ha un attributo <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> che non specifica l'ambito e l'identificatore, il tipo può ancora essere considerato per l'equivalenza, come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="7855e-121">If a type does not have the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> attribute, or if it has a <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> attribute that does not specify scope and identifier, the type can still be considered for equivalence as follows:</span></span>

- <span data-ttu-id="7855e-122">Per le interfacce viene usato il valore di <xref:System.Runtime.InteropServices.GuidAttribute> invece della proprietà <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A?displayProperty=nameWithType> e viene usata la proprietà <xref:System.Type.FullName%2A?displayProperty=nameWithType> (vale a dire il nome di tipo, incluso lo spazio dei nomi) invece della proprietà <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="7855e-122">For interfaces, the value of the <xref:System.Runtime.InteropServices.GuidAttribute> is used instead of the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A?displayProperty=nameWithType> property, and the <xref:System.Type.FullName%2A?displayProperty=nameWithType> property (that is, the type name, including the namespace) is used instead of the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A?displayProperty=nameWithType> property.</span></span>

- <span data-ttu-id="7855e-123">Per le strutture, le enumerazioni e i delegati, viene usato l'attributo <xref:System.Runtime.InteropServices.GuidAttribute> dell'assembly contenitore invece della proprietà <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> e viene usata la proprietà <xref:System.Type.FullName%2A?displayProperty=nameWithType> al posto della proprietà <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A>.</span><span class="sxs-lookup"><span data-stu-id="7855e-123">For structures, enumerations, and delegates, the <xref:System.Runtime.InteropServices.GuidAttribute> of the containing assembly is used instead of the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> property, and the <xref:System.Type.FullName%2A?displayProperty=nameWithType> property is used instead of the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A> property.</span></span>

### <a name="marking-com-types-for-type-equivalence"></a><span data-ttu-id="7855e-124">Contrassegno dei tipi COM per l'equivalenza del tipo</span><span class="sxs-lookup"><span data-stu-id="7855e-124">Marking COM types for type equivalence</span></span>

 <span data-ttu-id="7855e-125">È possibile contrassegnare un tipo come idoneo per l'equivalenza del tipo in due modi:</span><span class="sxs-lookup"><span data-stu-id="7855e-125">You can mark a type as eligible for type equivalence in two ways:</span></span>

- <span data-ttu-id="7855e-126">Applicare l'attributo <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> al tipo.</span><span class="sxs-lookup"><span data-stu-id="7855e-126">Apply the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> attribute to the type.</span></span>

- <span data-ttu-id="7855e-127">Impostare il tipo come tipo di importazione COM.</span><span class="sxs-lookup"><span data-stu-id="7855e-127">Make the type a COM import type.</span></span> <span data-ttu-id="7855e-128">Un'interfaccia è un tipo di importazione COM se ha l'attributo <xref:System.Runtime.InteropServices.ComImportAttribute>.</span><span class="sxs-lookup"><span data-stu-id="7855e-128">An interface is a COM import type if it has the <xref:System.Runtime.InteropServices.ComImportAttribute> attribute.</span></span> <span data-ttu-id="7855e-129">Un'interfaccia, una struttura, un'enumerazione o un delegato è un tipo di importazione COM se l'assembly in cui è definito ha l'attributo <xref:System.Runtime.InteropServices.ImportedFromTypeLibAttribute>.</span><span class="sxs-lookup"><span data-stu-id="7855e-129">An interface, structure, enumeration, or delegate is a COM import type if the assembly in which it is defined has the <xref:System.Runtime.InteropServices.ImportedFromTypeLibAttribute> attribute.</span></span>

## <a name="see-also"></a><span data-ttu-id="7855e-130">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="7855e-130">See also</span></span>

- <xref:System.Type.IsEquivalentTo%2A>
- <span data-ttu-id="7855e-131">[Uso dei tipi COM nel codice gestito](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="7855e-131">[Using COM Types in Managed Code](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span></span>
- [<span data-ttu-id="7855e-132">Importazione di una libreria dei tipi come assembly</span><span class="sxs-lookup"><span data-stu-id="7855e-132">Importing a Type Library as an Assembly</span></span>](importing-a-type-library-as-an-assembly.md)
