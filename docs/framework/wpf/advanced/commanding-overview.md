---
title: Cenni preliminari sull'esecuzione di comandi
description: Informazioni sul comando, un meccanismo di input in Windows Presentation Foundation che consente la gestione dell'input a un livello più semantico rispetto all'input del dispositivo.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- interfaces [WPF], ICommandSource
- command library [WPF]
- commands [WPF], definition of
- CommandBindings [WPF]
- ICommandSource interfaces [WPF]
- commanding [WPF]
- CommandManager [WPF]
ms.assetid: bc208dfe-367d-426a-99de-52b7e7511e81
ms.openlocfilehash: 4f7d12fbf0de9b1546f15061ab7eb1318378bbbb
ms.sourcegitcommit: 87cfeb69226fef01acb17c56c86f978f4f4a13db
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/24/2020
ms.locfileid: "87168125"
---
# <a name="commanding-overview"></a><span data-ttu-id="4a441-103">Cenni preliminari sull'esecuzione di comandi</span><span class="sxs-lookup"><span data-stu-id="4a441-103">Commanding Overview</span></span>
<a name="introduction"></a> <span data-ttu-id="4a441-104">I comandi sono un meccanismo di input in [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] che consente la gestione dell'input a un livello più semantico rispetto all'input dei dispositivi.</span><span class="sxs-lookup"><span data-stu-id="4a441-104">Commanding is an input mechanism in [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] which provides input handling at a more semantic level than device input.</span></span> <span data-ttu-id="4a441-105">Sono esempi di comandi le operazioni **Copia**, **Taglia** e **Incolla** disponibili in molte applicazioni.</span><span class="sxs-lookup"><span data-stu-id="4a441-105">Examples of commands are the **Copy**, **Cut**, and **Paste** operations found on many applications.</span></span>  
  
 <span data-ttu-id="4a441-106">Questa panoramica presenta i comandi disponibili in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], le classi che fanno parte del modello di esecuzione dei comandi e le procedure per usare e creare comandi nelle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="4a441-106">This overview defines what commands are in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], which classes are part of the commanding model, and how to use and create commands in your applications.</span></span>  
  
 <span data-ttu-id="4a441-107">In questo argomento sono incluse le sezioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="4a441-107">This topic contains the following sections:</span></span>  
  
- [<span data-ttu-id="4a441-108">Cosa sono i comandi?</span><span class="sxs-lookup"><span data-stu-id="4a441-108">What Are Commands?</span></span>](#commands_at_10000_feet)  
  
- [<span data-ttu-id="4a441-109">Esempio di comando semplice in WPF</span><span class="sxs-lookup"><span data-stu-id="4a441-109">Simple Command Example in WPF</span></span>](#simple_command)  
  
- [<span data-ttu-id="4a441-110">Quattro concetti principali dell'esecuzione dei comandi WPF</span><span class="sxs-lookup"><span data-stu-id="4a441-110">Four Main Concepts in WPF Commanding</span></span>](#Four_main_Concepts)  
  
- [<span data-ttu-id="4a441-111">Libreria dei comandi</span><span class="sxs-lookup"><span data-stu-id="4a441-111">Command Library</span></span>](#Command_Library)  
  
- [<span data-ttu-id="4a441-112">Creazione di comandi personalizzati</span><span class="sxs-lookup"><span data-stu-id="4a441-112">Creating Custom Commands</span></span>](#creating_commands)  
  
<a name="commands_at_10000_feet"></a>
## <a name="what-are-commands"></a><span data-ttu-id="4a441-113">Cosa sono i comandi?</span><span class="sxs-lookup"><span data-stu-id="4a441-113">What Are Commands?</span></span>  
 <span data-ttu-id="4a441-114">I comandi hanno diversi scopi.</span><span class="sxs-lookup"><span data-stu-id="4a441-114">Commands have several purposes.</span></span> <span data-ttu-id="4a441-115">Il primo scopo è di separare la semantica e l'oggetto che richiama un comando dalla logica che esegue il comando.</span><span class="sxs-lookup"><span data-stu-id="4a441-115">The first purpose is to separate the semantics and the object that invokes a command from the logic that executes the command.</span></span> <span data-ttu-id="4a441-116">In questo modo, più codici sorgente diversi possono richiamare la stessa logica di comando che può quindi essere personalizzata per obiettivi differenti.</span><span class="sxs-lookup"><span data-stu-id="4a441-116">This allows for multiple and disparate sources to invoke the same command logic, and it allows the command logic to be customized for different targets.</span></span> <span data-ttu-id="4a441-117">Le operazioni di modifica **Copia**, **Taglia** e **Incolla**, ad esempio, disponibili in molte applicazioni, possono essere richiamate usando azioni dell'utente diverse se vengono implementate tramite i comandi.</span><span class="sxs-lookup"><span data-stu-id="4a441-117">For example, the editing operations **Copy**, **Cut**, and **Paste**, which are found in many applications, can be invoked by using different user actions if they are implemented by using commands.</span></span> <span data-ttu-id="4a441-118">Un'applicazione potrebbe consentire a un utente di tagliare gli oggetti o il testo selezionati facendo clic su un pulsante, scegliendo una voce da un menu o usando una combinazione di tasti, ad esempio CTRL+X.</span><span class="sxs-lookup"><span data-stu-id="4a441-118">An application might allow a user to cut selected objects or text by either clicking a button, choosing an item in a menu, or using a key combination, such as CTRL+X.</span></span> <span data-ttu-id="4a441-119">Usando i comandi è possibile associare ogni tipo di azione utente alla stessa logica.</span><span class="sxs-lookup"><span data-stu-id="4a441-119">By using commands, you can bind each type of user action to the same logic.</span></span>  
  
 <span data-ttu-id="4a441-120">Un altro scopo dei comandi è di indicare se un'azione è disponibile.</span><span class="sxs-lookup"><span data-stu-id="4a441-120">Another purpose of commands is to indicate whether an action is available.</span></span> <span data-ttu-id="4a441-121">Per continuare con l'esempio in cui viene tagliato un oggetto o un testo, l'azione ha senso solo quando viene selezionato un elemento.</span><span class="sxs-lookup"><span data-stu-id="4a441-121">To continue the example of cutting an object or text, the action only makes sense when something is selected.</span></span> <span data-ttu-id="4a441-122">Se un utente tenta di tagliare un oggetto o un testo senza avere selezionato alcun elemento, non viene eseguita alcuna operazione.</span><span class="sxs-lookup"><span data-stu-id="4a441-122">If a user tries to cut an object or text without having anything selected, nothing would happen.</span></span> <span data-ttu-id="4a441-123">Per indicarlo all'utente, in molte applicazioni vengono disabilitati i pulsanti e le voci di menu in modo che l'utente sappia se è possibile eseguire un'azione.</span><span class="sxs-lookup"><span data-stu-id="4a441-123">To indicate this to the user, many applications disable buttons and menu items so that the user knows whether it is possible to perform an action.</span></span> <span data-ttu-id="4a441-124">Un comando può indicare se un'azione è possibile implementando il metodo <xref:System.Windows.Input.ICommand.CanExecute%2A>.</span><span class="sxs-lookup"><span data-stu-id="4a441-124">A command can indicate whether an action is possible by implementing the <xref:System.Windows.Input.ICommand.CanExecute%2A> method.</span></span> <span data-ttu-id="4a441-125">Un pulsante può sottoscrivere l'evento <xref:System.Windows.Input.ICommand.CanExecuteChanged> ed essere disabilitato se <xref:System.Windows.Input.ICommand.CanExecute%2A> restituisce `false` oppure essere abilitato se <xref:System.Windows.Input.ICommand.CanExecute%2A> restituisce `true`.</span><span class="sxs-lookup"><span data-stu-id="4a441-125">A button can subscribe to the <xref:System.Windows.Input.ICommand.CanExecuteChanged> event and be disabled if <xref:System.Windows.Input.ICommand.CanExecute%2A> returns `false` or be enabled if <xref:System.Windows.Input.ICommand.CanExecute%2A> returns `true`.</span></span>  
  
 <span data-ttu-id="4a441-126">La semantica di un comando può essere coerente tra le applicazioni e le classi, tuttavia la logica dell'azione è specifica dell'oggetto particolare su cui si agisce.</span><span class="sxs-lookup"><span data-stu-id="4a441-126">The semantics of a command can be consistent across applications and classes, but the logic of the action is specific to the particular object acted upon.</span></span> <span data-ttu-id="4a441-127">La combinazione di tasti CTRL+X richiama il comando **Taglia** nelle classi di testo, nelle classi di immagine e nei Web browser, tuttavia la logica effettiva per l'esecuzione dell'operazione **Taglia** viene definita dall'applicazione in cui si esegue l'operazione di taglio.</span><span class="sxs-lookup"><span data-stu-id="4a441-127">The key combination CTRL+X invokes the **Cut** command in text classes, image classes, and Web browsers, but the actual logic for performing the **Cut** operation is defined by the application that performs the cut.</span></span> <span data-ttu-id="4a441-128"><xref:System.Windows.Input.RoutedCommand> consente ai client di implementare la logica.</span><span class="sxs-lookup"><span data-stu-id="4a441-128">A <xref:System.Windows.Input.RoutedCommand> enables clients to implement the logic.</span></span> <span data-ttu-id="4a441-129">Un oggetto testo può tagliare il testo selezionato negli Appunti, mentre un oggetto immagine può tagliare l'immagine selezionata.</span><span class="sxs-lookup"><span data-stu-id="4a441-129">A text object may cut the selected text into the clipboard, while an image object may cut the selected image.</span></span> <span data-ttu-id="4a441-130">Quando un'applicazione gestisce l'evento <xref:System.Windows.Input.CommandManager.Executed>, può accedere alla destinazione del comando ed eseguire l'azione appropriata in base al tipo della destinazione.</span><span class="sxs-lookup"><span data-stu-id="4a441-130">When an application handles the <xref:System.Windows.Input.CommandManager.Executed> event, it has access to the target of the command and can take appropriate action depending on the target's type.</span></span>  
  
<a name="simple_command"></a>
## <a name="simple-command-example-in-wpf"></a><span data-ttu-id="4a441-131">Esempio di comando semplice in WPF</span><span class="sxs-lookup"><span data-stu-id="4a441-131">Simple Command Example in WPF</span></span>  
 <span data-ttu-id="4a441-132">Il modo più semplice per usare un comando in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] consiste nell'uso di un oggetto <xref:System.Windows.Input.RoutedCommand> predefinito di una delle classi della libreria dei comandi, nell'uso di un controllo con supporto nativo per gestire il comando e nell'uso di un controllo con supporto nativo per richiamare un comando.</span><span class="sxs-lookup"><span data-stu-id="4a441-132">The simplest way to use a command in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is to use a predefined <xref:System.Windows.Input.RoutedCommand> from one of the command library classes; use a control that has native support for handling the command; and use a control that has native support for invoking a command.</span></span>  <span data-ttu-id="4a441-133">Il comando <xref:System.Windows.Input.ApplicationCommands.Paste%2A> è uno dei comandi predefiniti della classe <xref:System.Windows.Input.ApplicationCommands>.</span><span class="sxs-lookup"><span data-stu-id="4a441-133">The <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command is one of the predefined commands in the <xref:System.Windows.Input.ApplicationCommands> class.</span></span>  <span data-ttu-id="4a441-134">Il controllo <xref:System.Windows.Controls.TextBox> è dotato di logica incorporata per la gestione del comando <xref:System.Windows.Input.ApplicationCommands.Paste%2A>.</span><span class="sxs-lookup"><span data-stu-id="4a441-134">The <xref:System.Windows.Controls.TextBox> control has built in logic for handling the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command.</span></span>  <span data-ttu-id="4a441-135">E la classe <xref:System.Windows.Controls.MenuItem> è dotata del supporto nativo per la chiamata di comandi.</span><span class="sxs-lookup"><span data-stu-id="4a441-135">And the <xref:System.Windows.Controls.MenuItem> class has native support for invoking commands.</span></span>  
  
 <span data-ttu-id="4a441-136">L'esempio seguente illustra come impostare un oggetto <xref:System.Windows.Controls.MenuItem> in modo che quando si fa clic su di esso, richiami il comando <xref:System.Windows.Input.ApplicationCommands.Paste%2A> in un <xref:System.Windows.Controls.TextBox>, supponendo che <xref:System.Windows.Controls.TextBox> abbia lo stato attivo della tastiera.</span><span class="sxs-lookup"><span data-stu-id="4a441-136">The following example shows how to set up a <xref:System.Windows.Controls.MenuItem> so that when it is clicked it will invoke the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command on a <xref:System.Windows.Controls.TextBox>, assuming the <xref:System.Windows.Controls.TextBox> has keyboard focus.</span></span>  
  
 [!code-xaml[CommandingOverviewSnippets#CommandingOverviewSimpleCommand](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewsimplecommand)]  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewcommandtargetcodebehind)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewcommandtargetcodebehind)]  
  
<a name="Four_main_Concepts"></a>
## <a name="four-main-concepts-in-wpf-commanding"></a><span data-ttu-id="4a441-137">Quattro concetti principali dell'esecuzione dei comandi WPF</span><span class="sxs-lookup"><span data-stu-id="4a441-137">Four Main Concepts in WPF Commanding</span></span>  
 <span data-ttu-id="4a441-138">Il modello di comando indirizzato di [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] può essere suddiviso in quattro concetti principali: il comando, l'origine del comando, la destinazione del comando e l'associazione del comando:</span><span class="sxs-lookup"><span data-stu-id="4a441-138">The routed command model in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] can be broken up into four main concepts: the command, the command source, the command target, and the command binding:</span></span>  
  
- <span data-ttu-id="4a441-139">Il *comando* è l'azione da eseguire.</span><span class="sxs-lookup"><span data-stu-id="4a441-139">The *command* is the action to be executed.</span></span>  
  
- <span data-ttu-id="4a441-140">L'*origine del comando* è l'oggetto che richiama il comando.</span><span class="sxs-lookup"><span data-stu-id="4a441-140">The *command source* is the object which invokes the command.</span></span>  
  
- <span data-ttu-id="4a441-141">La *destinazione del comando* è l'oggetto su cui viene eseguito il comando.</span><span class="sxs-lookup"><span data-stu-id="4a441-141">The *command target* is the object that the command is being executed on.</span></span>  
  
- <span data-ttu-id="4a441-142">L'*associazione del comando* è l'oggetto che esegue il mapping della logica di comando al comando.</span><span class="sxs-lookup"><span data-stu-id="4a441-142">The *command binding* is the object which maps the command logic to the command.</span></span>  
  
 <span data-ttu-id="4a441-143">Nell'esempio precedente, il comando <xref:System.Windows.Input.ApplicationCommands.Paste%2A> corrisponde al comando, <xref:System.Windows.Controls.MenuItem> è l'origine del comando, <xref:System.Windows.Controls.TextBox> è la destinazione del comando e l'associazione del comando viene fornita dal controllo <xref:System.Windows.Controls.TextBox>.</span><span class="sxs-lookup"><span data-stu-id="4a441-143">In the previous example, the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command is the command, the <xref:System.Windows.Controls.MenuItem> is the command source, the <xref:System.Windows.Controls.TextBox> is the command target, and the command binding is supplied by the <xref:System.Windows.Controls.TextBox> control.</span></span>  <span data-ttu-id="4a441-144">È importante notare che non sempre l'oggetto <xref:System.Windows.Input.CommandBinding> viene fornito dal controllo che rappresenta la classe di destinazione del comando.</span><span class="sxs-lookup"><span data-stu-id="4a441-144">It is worth noting that it is not always the case that the <xref:System.Windows.Input.CommandBinding> is supplied by the control that is the command target class.</span></span>  <span data-ttu-id="4a441-145">Molto spesso è lo sviluppatore dell'applicazione che deve creare <xref:System.Windows.Input.CommandBinding>. In altri casi, può esistere un collegamento tra <xref:System.Windows.Input.CommandBinding> e un predecessore della destinazione del comando.</span><span class="sxs-lookup"><span data-stu-id="4a441-145">Quite often the <xref:System.Windows.Input.CommandBinding> must be created by the application developer, or the <xref:System.Windows.Input.CommandBinding> might be attached to an ancestor of the command target.</span></span>  
  
<a name="Commands"></a>
### <a name="commands"></a><span data-ttu-id="4a441-146">Comandi</span><span class="sxs-lookup"><span data-stu-id="4a441-146">Commands</span></span>  
 <span data-ttu-id="4a441-147">I comandi in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] vengono creati tramite l'implementazione dell'interfaccia <xref:System.Windows.Input.ICommand>.</span><span class="sxs-lookup"><span data-stu-id="4a441-147">Commands in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] are created by implementing the <xref:System.Windows.Input.ICommand> interface.</span></span>  <span data-ttu-id="4a441-148"><xref:System.Windows.Input.ICommand> espone due metodi, <xref:System.Windows.Input.ICommand.Execute%2A> e <xref:System.Windows.Input.ICommand.CanExecute%2A>, e un evento, <xref:System.Windows.Input.ICommand.CanExecuteChanged>.</span><span class="sxs-lookup"><span data-stu-id="4a441-148"><xref:System.Windows.Input.ICommand> exposes two methods, <xref:System.Windows.Input.ICommand.Execute%2A>, and <xref:System.Windows.Input.ICommand.CanExecute%2A>, and an event, <xref:System.Windows.Input.ICommand.CanExecuteChanged>.</span></span> <span data-ttu-id="4a441-149"><xref:System.Windows.Input.ICommand.Execute%2A> esegue le azioni associate al comando.</span><span class="sxs-lookup"><span data-stu-id="4a441-149"><xref:System.Windows.Input.ICommand.Execute%2A> performs the actions that are associated with the command.</span></span> <span data-ttu-id="4a441-150"><xref:System.Windows.Input.ICommand.CanExecute%2A> determina se il comando può essere eseguito nella destinazione corrente del comando stesso.</span><span class="sxs-lookup"><span data-stu-id="4a441-150"><xref:System.Windows.Input.ICommand.CanExecute%2A> determines whether the command can execute on the current command target.</span></span> <span data-ttu-id="4a441-151"><xref:System.Windows.Input.ICommand.CanExecuteChanged> viene generato se il gestore che centralizza le operazioni di comando rileva una modifica nell'origine del comando che potrebbe invalidare un comando generato ma non ancora eseguito dall'associazione del comando.</span><span class="sxs-lookup"><span data-stu-id="4a441-151"><xref:System.Windows.Input.ICommand.CanExecuteChanged> is raised if the command manager that centralizes the commanding operations detects a change in the command source that might invalidate a command that has been raised but not yet executed by the command binding.</span></span>  <span data-ttu-id="4a441-152">L'implementazione [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] di <xref:System.Windows.Input.ICommand> è la classe <xref:System.Windows.Input.RoutedCommand> e costituisce l'obiettivo di questa panoramica.</span><span class="sxs-lookup"><span data-stu-id="4a441-152">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] implementation of <xref:System.Windows.Input.ICommand> is the <xref:System.Windows.Input.RoutedCommand> class and is the focus of this overview.</span></span>  
  
 <span data-ttu-id="4a441-153">Le origini di input principali di [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] sono il mouse, la tastiera, l'input penna e i comandi indirizzati.</span><span class="sxs-lookup"><span data-stu-id="4a441-153">The main sources of input in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] are the mouse, the keyboard, ink, and routed commands.</span></span>  <span data-ttu-id="4a441-154">La maggior parte degli input orientati al dispositivo usano un oggetto <xref:System.Windows.RoutedEvent> per notificare agli oggetti di una pagina dell'applicazione che si è verificato un evento di input.</span><span class="sxs-lookup"><span data-stu-id="4a441-154">The more device-oriented inputs use a <xref:System.Windows.RoutedEvent> to notify objects in an application page that an input event has occurred.</span></span>  <span data-ttu-id="4a441-155"><xref:System.Windows.Input.RoutedCommand> non è diverso.</span><span class="sxs-lookup"><span data-stu-id="4a441-155">A <xref:System.Windows.Input.RoutedCommand> is no different.</span></span>  <span data-ttu-id="4a441-156">I metodi <xref:System.Windows.Input.RoutedCommand.Execute%2A> e <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> di <xref:System.Windows.Input.RoutedCommand> non contengono la logica dell'applicazione per il comando, ma generano eventi indirizzati che effettuano il tunneling e il bubbling attraverso la struttura ad albero degli elementi finché non rilevano un oggetto con <xref:System.Windows.Input.CommandBinding>.</span><span class="sxs-lookup"><span data-stu-id="4a441-156">The <xref:System.Windows.Input.RoutedCommand.Execute%2A> and <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> methods of a <xref:System.Windows.Input.RoutedCommand> do not contain the application logic for the command, but rather they raise routed events that tunnel and bubble through the element tree until they encounter an object with a <xref:System.Windows.Input.CommandBinding>.</span></span>  <span data-ttu-id="4a441-157"><xref:System.Windows.Input.CommandBinding> contiene i gestori per questi eventi e sono i gestori a eseguire il comando.</span><span class="sxs-lookup"><span data-stu-id="4a441-157">The <xref:System.Windows.Input.CommandBinding> contains the handlers for these events and it is the handlers that perform the command.</span></span>  <span data-ttu-id="4a441-158">Per altre informazioni sul routing di eventi in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], vedere [Cenni preliminari sugli eventi indirizzati](routed-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="4a441-158">For more information on event routing in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [Routed Events Overview](routed-events-overview.md).</span></span>  
  
 <span data-ttu-id="4a441-159">Il metodo <xref:System.Windows.Input.RoutedCommand.Execute%2A> in un <xref:System.Windows.Input.RoutedCommand> genera gli eventi <xref:System.Windows.Input.CommandManager.PreviewExecuted> e <xref:System.Windows.Input.CommandManager.Executed> nella destinazione del comando.</span><span class="sxs-lookup"><span data-stu-id="4a441-159">The <xref:System.Windows.Input.RoutedCommand.Execute%2A> method on a <xref:System.Windows.Input.RoutedCommand> raises the <xref:System.Windows.Input.CommandManager.PreviewExecuted> and the <xref:System.Windows.Input.CommandManager.Executed> events on the command target.</span></span>  <span data-ttu-id="4a441-160">Il metodo <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> in un <xref:System.Windows.Input.RoutedCommand> genera gli eventi <xref:System.Windows.Input.CommandManager.CanExecute> e <xref:System.Windows.Input.CommandManager.PreviewCanExecute> nella destinazione del comando.</span><span class="sxs-lookup"><span data-stu-id="4a441-160">The <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> method on a <xref:System.Windows.Input.RoutedCommand> raises the <xref:System.Windows.Input.CommandManager.CanExecute> and <xref:System.Windows.Input.CommandManager.PreviewCanExecute> events on the command target.</span></span>  <span data-ttu-id="4a441-161">Questi eventi eseguono il tunneling e il bubbling nell'albero degli elementi finché non incontrano un oggetto con un <xref:System.Windows.Input.CommandBinding> per quel particolare comando.</span><span class="sxs-lookup"><span data-stu-id="4a441-161">These events tunnel and bubble through the element tree until they encounter an object which has a <xref:System.Windows.Input.CommandBinding> for that particular command.</span></span>  
  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="4a441-162">fornisce un set di comandi indirizzati comuni distribuito in diverse classi: <xref:System.Windows.Input.MediaCommands>, <xref:System.Windows.Input.ApplicationCommands>, <xref:System.Windows.Input.NavigationCommands>, <xref:System.Windows.Input.ComponentCommands> e <xref:System.Windows.Documents.EditingCommands>.</span><span class="sxs-lookup"><span data-stu-id="4a441-162">supplies a set of common routed commands spread across several classes: <xref:System.Windows.Input.MediaCommands>, <xref:System.Windows.Input.ApplicationCommands>, <xref:System.Windows.Input.NavigationCommands>, <xref:System.Windows.Input.ComponentCommands>, and <xref:System.Windows.Documents.EditingCommands>.</span></span>  <span data-ttu-id="4a441-163">Queste classi sono costituite solo da oggetti <xref:System.Windows.Input.RoutedCommand> e non dalla logica di implementazione del comando.</span><span class="sxs-lookup"><span data-stu-id="4a441-163">These classes consist only of the <xref:System.Windows.Input.RoutedCommand> objects and not the implementation logic of the command.</span></span>  <span data-ttu-id="4a441-164">La logica di implementazione è responsabilità dell'oggetto sul quale viene eseguito il comando.</span><span class="sxs-lookup"><span data-stu-id="4a441-164">The implementation logic is the responsibility of the object on which the command is being executed on.</span></span>  
  
<a name="Command_Sources"></a>
### <a name="command-sources"></a><span data-ttu-id="4a441-165">Origini dei comandi</span><span class="sxs-lookup"><span data-stu-id="4a441-165">Command Sources</span></span>  
 <span data-ttu-id="4a441-166">Un'origine del comando è l'oggetto che richiama il comando.</span><span class="sxs-lookup"><span data-stu-id="4a441-166">A command source is the object which invokes the command.</span></span>  <span data-ttu-id="4a441-167"><xref:System.Windows.Controls.MenuItem>, <xref:System.Windows.Controls.Button> e <xref:System.Windows.Input.KeyGesture> sono esempi di origini del comando.</span><span class="sxs-lookup"><span data-stu-id="4a441-167">Examples of command sources are <xref:System.Windows.Controls.MenuItem>, <xref:System.Windows.Controls.Button>, and <xref:System.Windows.Input.KeyGesture>.</span></span>  
  
 <span data-ttu-id="4a441-168">Le origini del comando in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in genere implementano l'interfaccia <xref:System.Windows.Input.ICommandSource>.</span><span class="sxs-lookup"><span data-stu-id="4a441-168">Command sources in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] generally implement the <xref:System.Windows.Input.ICommandSource> interface.</span></span>  
  
 <span data-ttu-id="4a441-169"><xref:System.Windows.Input.ICommandSource> espone tre proprietà: <xref:System.Windows.Input.ICommandSource.Command%2A>, <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> e <xref:System.Windows.Input.ICommandSource.CommandParameter%2A>:</span><span class="sxs-lookup"><span data-stu-id="4a441-169"><xref:System.Windows.Input.ICommandSource> exposes three properties: <xref:System.Windows.Input.ICommandSource.Command%2A>, <xref:System.Windows.Input.ICommandSource.CommandTarget%2A>, and <xref:System.Windows.Input.ICommandSource.CommandParameter%2A>:</span></span>  
  
- <span data-ttu-id="4a441-170"><xref:System.Windows.Input.ICommandSource.Command%2A> è il comando da eseguire quando viene richiamata l'origine del comando.</span><span class="sxs-lookup"><span data-stu-id="4a441-170"><xref:System.Windows.Input.ICommandSource.Command%2A> is the command to execute when the command source is invoked.</span></span>  
  
- <span data-ttu-id="4a441-171"><xref:System.Windows.Input.ICommandSource.CommandTarget%2A> è l'oggetto su cui eseguire il comando.</span><span class="sxs-lookup"><span data-stu-id="4a441-171"><xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is the object on which to execute the command.</span></span>  <span data-ttu-id="4a441-172">Si noti che in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] la proprietà <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> in <xref:System.Windows.Input.ICommandSource> è applicabile solo quando <xref:System.Windows.Input.ICommand> è <xref:System.Windows.Input.RoutedCommand>.</span><span class="sxs-lookup"><span data-stu-id="4a441-172">It is worth noting that in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> property on <xref:System.Windows.Input.ICommandSource> is only applicable when the <xref:System.Windows.Input.ICommand> is a <xref:System.Windows.Input.RoutedCommand>.</span></span>  <span data-ttu-id="4a441-173">Se <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> è impostato su un <xref:System.Windows.Input.ICommandSource> e il comando corrispondente non è un <xref:System.Windows.Input.RoutedCommand>, la destinazione del comando viene ignorata.</span><span class="sxs-lookup"><span data-stu-id="4a441-173">If the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is set on an <xref:System.Windows.Input.ICommandSource> and the corresponding command is not a <xref:System.Windows.Input.RoutedCommand>, the command target is ignored.</span></span> <span data-ttu-id="4a441-174">Se <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> non è impostato, viene rappresentato dall'elemento con lo stato attivo della tastiera.</span><span class="sxs-lookup"><span data-stu-id="4a441-174">If the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is not set, the element with keyboard focus will be the command target.</span></span>  
  
- <span data-ttu-id="4a441-175"><xref:System.Windows.Input.ICommandSource.CommandParameter%2A> è un tipo di dati definito dall'utente usato per passare informazioni ai gestori che implementano il comando.</span><span class="sxs-lookup"><span data-stu-id="4a441-175"><xref:System.Windows.Input.ICommandSource.CommandParameter%2A> is a user-defined data type used to pass information to the handlers implementing the command.</span></span>  
  
 <span data-ttu-id="4a441-176">Le classi [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] che implementano <xref:System.Windows.Input.ICommandSource> sono <xref:System.Windows.Controls.Primitives.ButtonBase>, <xref:System.Windows.Controls.MenuItem>, <xref:System.Windows.Documents.Hyperlink> e <xref:System.Windows.Input.InputBinding>.</span><span class="sxs-lookup"><span data-stu-id="4a441-176">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] classes that implement <xref:System.Windows.Input.ICommandSource> are <xref:System.Windows.Controls.Primitives.ButtonBase>, <xref:System.Windows.Controls.MenuItem>, <xref:System.Windows.Documents.Hyperlink>, and <xref:System.Windows.Input.InputBinding>.</span></span>  <span data-ttu-id="4a441-177"><xref:System.Windows.Controls.Primitives.ButtonBase>, <xref:System.Windows.Controls.MenuItem> e <xref:System.Windows.Documents.Hyperlink> richiamano un comando quando ricevono un clic e <xref:System.Windows.Input.InputBinding> richiama un comando quando l'oggetto <xref:System.Windows.Input.InputGesture> associato viene eseguito.</span><span class="sxs-lookup"><span data-stu-id="4a441-177"><xref:System.Windows.Controls.Primitives.ButtonBase>, <xref:System.Windows.Controls.MenuItem>, and <xref:System.Windows.Documents.Hyperlink> invoke a command when they are clicked, and an <xref:System.Windows.Input.InputBinding> invokes a command when the <xref:System.Windows.Input.InputGesture> associated with it is performed.</span></span>  
  
 <span data-ttu-id="4a441-178">L'esempio seguente illustra come usare un oggetto <xref:System.Windows.Controls.MenuItem> in un oggetto <xref:System.Windows.Controls.ContextMenu> come origine del comando <xref:System.Windows.Input.ApplicationCommands.Properties%2A>.</span><span class="sxs-lookup"><span data-stu-id="4a441-178">The following example shows how to use a <xref:System.Windows.Controls.MenuItem> in a <xref:System.Windows.Controls.ContextMenu> as a command source for the <xref:System.Windows.Input.ApplicationCommands.Properties%2A> command.</span></span>  
  
 [!code-xaml[CommandingOverviewSnippets#CommandingOverviewCmdSourceXAML](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewcmdsourcexaml)]  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewCmdSource](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewcmdsource)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewCmdSource](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewcmdsource)]  
  
 <span data-ttu-id="4a441-179">Un'origine del comando è in genere in ascolto dell'evento <xref:System.Windows.Input.RoutedCommand.CanExecuteChanged>.</span><span class="sxs-lookup"><span data-stu-id="4a441-179">Typically, a command source will listen to the <xref:System.Windows.Input.RoutedCommand.CanExecuteChanged> event.</span></span>  <span data-ttu-id="4a441-180">Questo evento informa l'origine del comando relativamente alla probabile modifica della capacità del comando di essere eseguito sulla destinazione del comando corrente.</span><span class="sxs-lookup"><span data-stu-id="4a441-180">This event informs the command source that the ability of the command to execute on the current command target may have changed.</span></span>  <span data-ttu-id="4a441-181">L'origine del comando può eseguire una query dello stato corrente dell'oggetto <xref:System.Windows.Input.RoutedCommand> tramite il metodo <xref:System.Windows.Input.RoutedCommand.CanExecute%2A>.</span><span class="sxs-lookup"><span data-stu-id="4a441-181">The command source can query the current status of the <xref:System.Windows.Input.RoutedCommand> by using the <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> method.</span></span>  <span data-ttu-id="4a441-182">L'origine comando può quindi disabilitarsi, se l'esecuzione del comando non riesce.</span><span class="sxs-lookup"><span data-stu-id="4a441-182">The command source can then disable itself if the command cannot execute.</span></span>  <span data-ttu-id="4a441-183">Un esempio è un oggetto <xref:System.Windows.Controls.MenuItem> che si disattiva quando non è possibile eseguire il comando corrispondente.</span><span class="sxs-lookup"><span data-stu-id="4a441-183">An example of this is a <xref:System.Windows.Controls.MenuItem> graying itself out when a command cannot execute.</span></span>  
  
 <span data-ttu-id="4a441-184">Un oggetto <xref:System.Windows.Input.InputGesture> può essere usato come origine del comando.</span><span class="sxs-lookup"><span data-stu-id="4a441-184">An <xref:System.Windows.Input.InputGesture> can be used as a command source.</span></span>  <span data-ttu-id="4a441-185">Due tipi di movimento di input in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] sono <xref:System.Windows.Input.KeyGesture> e <xref:System.Windows.Input.MouseGesture>.</span><span class="sxs-lookup"><span data-stu-id="4a441-185">Two types of input gestures in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] are the <xref:System.Windows.Input.KeyGesture> and <xref:System.Windows.Input.MouseGesture>.</span></span>  <span data-ttu-id="4a441-186">È possibile considerare un oggetto <xref:System.Windows.Input.KeyGesture> come tasto di scelta rapida, ad esempio CTRL + C.</span><span class="sxs-lookup"><span data-stu-id="4a441-186">You can think of a <xref:System.Windows.Input.KeyGesture> as a keyboard shortcut, such as CTRL+C.</span></span>  <span data-ttu-id="4a441-187">Un <xref:System.Windows.Input.KeyGesture> è costituito da un <xref:System.Windows.Input.Key> e da un set di <xref:System.Windows.Input.ModifierKeys>.</span><span class="sxs-lookup"><span data-stu-id="4a441-187">A <xref:System.Windows.Input.KeyGesture> is comprised of a <xref:System.Windows.Input.Key> and a set of <xref:System.Windows.Input.ModifierKeys>.</span></span>  <span data-ttu-id="4a441-188">Un <xref:System.Windows.Input.MouseGesture> è costituito da un <xref:System.Windows.Input.MouseAction> e da un set di <xref:System.Windows.Input.ModifierKeys> facoltativo.</span><span class="sxs-lookup"><span data-stu-id="4a441-188">A <xref:System.Windows.Input.MouseGesture> is comprised of a <xref:System.Windows.Input.MouseAction> and an optional set of <xref:System.Windows.Input.ModifierKeys>.</span></span>  
  
 <span data-ttu-id="4a441-189">Affinché un oggetto <xref:System.Windows.Input.InputGesture> funzioni come origine del comando, deve essere associato a un comando.</span><span class="sxs-lookup"><span data-stu-id="4a441-189">In order for an <xref:System.Windows.Input.InputGesture> to act as a command source, it must be associated with a command.</span></span> <span data-ttu-id="4a441-190">Questa operazione può essere eseguita in diversi modi.</span><span class="sxs-lookup"><span data-stu-id="4a441-190">There are a few ways to accomplish this.</span></span>  <span data-ttu-id="4a441-191">Un modo consiste nell'uso di un oggetto <xref:System.Windows.Input.InputBinding>.</span><span class="sxs-lookup"><span data-stu-id="4a441-191">One way is to use an <xref:System.Windows.Input.InputBinding>.</span></span>  
  
 <span data-ttu-id="4a441-192">L'esempio seguente illustra come creare un <xref:System.Windows.Input.KeyBinding> tra un <xref:System.Windows.Input.KeyGesture> e un <xref:System.Windows.Input.RoutedCommand>.</span><span class="sxs-lookup"><span data-stu-id="4a441-192">The following example shows how to create a <xref:System.Windows.Input.KeyBinding> between a <xref:System.Windows.Input.KeyGesture> and a <xref:System.Windows.Input.RoutedCommand>.</span></span>  
  
 [!code-xaml[CommandingOverviewSnippets#CommandingOverviewXAMLKeyBinding](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewxamlkeybinding)]  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewKeyBinding](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewkeybinding)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewKeyBinding](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewkeybinding)]  
  
 <span data-ttu-id="4a441-193">Un altro modo per associare un <xref:System.Windows.Input.InputGesture> a un <xref:System.Windows.Input.RoutedCommand> consiste nell'aggiungere l'oggetto <xref:System.Windows.Input.InputGesture> a <xref:System.Windows.Input.InputGestureCollection> per <xref:System.Windows.Input.RoutedCommand>.</span><span class="sxs-lookup"><span data-stu-id="4a441-193">Another way to associate an <xref:System.Windows.Input.InputGesture> to a <xref:System.Windows.Input.RoutedCommand> is to add the <xref:System.Windows.Input.InputGesture> to the <xref:System.Windows.Input.InputGestureCollection> on the <xref:System.Windows.Input.RoutedCommand>.</span></span>  
  
 <span data-ttu-id="4a441-194">L'esempio seguente illustra come aggiungere un <xref:System.Windows.Input.KeyGesture> alla raccolta <xref:System.Windows.Input.InputGestureCollection> di un <xref:System.Windows.Input.RoutedCommand>.</span><span class="sxs-lookup"><span data-stu-id="4a441-194">The following example shows how to add a <xref:System.Windows.Input.KeyGesture> to the <xref:System.Windows.Input.InputGestureCollection> of a <xref:System.Windows.Input.RoutedCommand>.</span></span>  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewKeyGestureOnCmd](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewkeygestureoncmd)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewKeyGestureOnCmd](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewkeygestureoncmd)]  
  
<a name="Command_Binding"></a>
### <a name="commandbinding"></a><span data-ttu-id="4a441-195">CommandBinding</span><span class="sxs-lookup"><span data-stu-id="4a441-195">CommandBinding</span></span>  
 <span data-ttu-id="4a441-196">Una classe <xref:System.Windows.Input.CommandBinding> associa un comando ai gestori degli eventi che implementano il comando.</span><span class="sxs-lookup"><span data-stu-id="4a441-196">A <xref:System.Windows.Input.CommandBinding> associates a command with the event handlers that implement the command.</span></span>  
  
 <span data-ttu-id="4a441-197">La classe <xref:System.Windows.Input.CommandBinding> contiene la proprietà <xref:System.Windows.Input.CommandBinding.Command%2A> e gli eventi <xref:System.Windows.Input.CommandBinding.PreviewExecuted>, <xref:System.Windows.Input.CommandBinding.Executed>, <xref:System.Windows.Input.CommandBinding.PreviewCanExecute> e <xref:System.Windows.Input.CommandBinding.CanExecute>.</span><span class="sxs-lookup"><span data-stu-id="4a441-197">The <xref:System.Windows.Input.CommandBinding> class contains a <xref:System.Windows.Input.CommandBinding.Command%2A> property, and <xref:System.Windows.Input.CommandBinding.PreviewExecuted>, <xref:System.Windows.Input.CommandBinding.Executed>, <xref:System.Windows.Input.CommandBinding.PreviewCanExecute>, and <xref:System.Windows.Input.CommandBinding.CanExecute> events.</span></span>  
  
 <span data-ttu-id="4a441-198"><xref:System.Windows.Input.CommandBinding.Command%2A> è il comando a cui <xref:System.Windows.Input.CommandBinding> è associato.</span><span class="sxs-lookup"><span data-stu-id="4a441-198"><xref:System.Windows.Input.CommandBinding.Command%2A> is the command that the <xref:System.Windows.Input.CommandBinding> is being associated with.</span></span>  <span data-ttu-id="4a441-199">I gestori degli eventi associati agli eventi <xref:System.Windows.Input.CommandBinding.PreviewExecuted> e <xref:System.Windows.Input.CommandBinding.Executed> implementano la logica di comando.</span><span class="sxs-lookup"><span data-stu-id="4a441-199">The event handlers which are attached to the <xref:System.Windows.Input.CommandBinding.PreviewExecuted> and <xref:System.Windows.Input.CommandBinding.Executed> events implement the command logic.</span></span>  <span data-ttu-id="4a441-200">I gestori eventi associati agli eventi <xref:System.Windows.Input.CommandBinding.PreviewCanExecute> e <xref:System.Windows.Input.CommandBinding.CanExecute> determinano se il comando può essere eseguito nella destinazione corrente.</span><span class="sxs-lookup"><span data-stu-id="4a441-200">The event handlers attached to the <xref:System.Windows.Input.CommandBinding.PreviewCanExecute> and <xref:System.Windows.Input.CommandBinding.CanExecute> events determine if the command can execute on the current command target.</span></span>  
  
 <span data-ttu-id="4a441-201">L'esempio seguente illustra come creare un <xref:System.Windows.Input.CommandBinding> in <xref:System.Windows.Window> radice di un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="4a441-201">The following example shows how to create a <xref:System.Windows.Input.CommandBinding> on the root <xref:System.Windows.Window> of an application.</span></span>  <span data-ttu-id="4a441-202"><xref:System.Windows.Input.CommandBinding> associa il comando <xref:System.Windows.Input.ApplicationCommands.Open%2A> ai gestori <xref:System.Windows.Input.CommandManager.Executed> e <xref:System.Windows.Input.CommandBinding.CanExecute>.</span><span class="sxs-lookup"><span data-stu-id="4a441-202">The <xref:System.Windows.Input.CommandBinding> associates the <xref:System.Windows.Input.ApplicationCommands.Open%2A> command with <xref:System.Windows.Input.CommandManager.Executed> and <xref:System.Windows.Input.CommandBinding.CanExecute> handlers.</span></span>  
  
 [!code-xaml[commandwithhandler#CommandHandlerCommandBinding](~/samples/snippets/csharp/VS_Snippets_Wpf/commandWithHandler/CSharp/Window1.xaml#commandhandlercommandbinding)]  
  
 [!code-csharp[CommandHandlerProcedural#CommandHandlerBindingInit](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandHandlerProcedural/CSharp/Window1.xaml.cs#commandhandlerbindinginit)]
 [!code-vb[CommandHandlerProcedural#CommandHandlerBindingInit](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CommandHandlerProcedural/visualbasic/window1.xaml.vb#commandhandlerbindinginit)]  
  
 <span data-ttu-id="4a441-203">Successivamente vengono creati <xref:System.Windows.Input.ExecutedRoutedEventHandler> e <xref:System.Windows.Input.CanExecuteRoutedEventHandler>.</span><span class="sxs-lookup"><span data-stu-id="4a441-203">Next, the <xref:System.Windows.Input.ExecutedRoutedEventHandler> and a <xref:System.Windows.Input.CanExecuteRoutedEventHandler> are created.</span></span>  <span data-ttu-id="4a441-204"><xref:System.Windows.Input.ExecutedRoutedEventHandler> apre un oggetto <xref:System.Windows.MessageBox> che visualizza una stringa che indica che il comando è stato eseguito.</span><span class="sxs-lookup"><span data-stu-id="4a441-204">The <xref:System.Windows.Input.ExecutedRoutedEventHandler> opens a <xref:System.Windows.MessageBox> that displays a string saying the command has been executed.</span></span>  <span data-ttu-id="4a441-205">Il metodo <xref:System.Windows.Input.CanExecuteRoutedEventHandler> imposta la proprietà <xref:System.Windows.Input.CanExecuteRoutedEventArgs.CanExecute%2A> su `true`.</span><span class="sxs-lookup"><span data-stu-id="4a441-205">The <xref:System.Windows.Input.CanExecuteRoutedEventHandler> sets the <xref:System.Windows.Input.CanExecuteRoutedEventArgs.CanExecute%2A> property to `true`.</span></span>  
  
 [!code-csharp[commandwithhandler#CommandHandlerExecutedHandler](~/samples/snippets/csharp/VS_Snippets_Wpf/commandWithHandler/CSharp/Window1.xaml.cs#commandhandlerexecutedhandler)]
 [!code-vb[commandwithhandler#CommandHandlerExecutedHandler](~/samples/snippets/visualbasic/VS_Snippets_Wpf/commandWithHandler/VisualBasic/Window1.xaml.vb#commandhandlerexecutedhandler)]  
  
 [!code-csharp[commandwithhandler#CommandHandlerCanExecuteHandler](~/samples/snippets/csharp/VS_Snippets_Wpf/commandWithHandler/CSharp/Window1.xaml.cs#commandhandlercanexecutehandler)]
 [!code-vb[commandwithhandler#CommandHandlerCanExecuteHandler](~/samples/snippets/visualbasic/VS_Snippets_Wpf/commandWithHandler/VisualBasic/Window1.xaml.vb#commandhandlercanexecutehandler)]  
  
 <span data-ttu-id="4a441-206">Un oggetto <xref:System.Windows.Input.CommandBinding> viene collegato a un oggetto specifico, ad esempio all'oggetto <xref:System.Windows.Window> radice dell'applicazione o di un controllo.</span><span class="sxs-lookup"><span data-stu-id="4a441-206">A <xref:System.Windows.Input.CommandBinding> is attached to a specific object, such as the root <xref:System.Windows.Window> of the application or a control.</span></span>  <span data-ttu-id="4a441-207">L'oggetto a cui è collegato l'oggetto <xref:System.Windows.Input.CommandBinding> definisce l'ambito dell'associazione.</span><span class="sxs-lookup"><span data-stu-id="4a441-207">The object that the <xref:System.Windows.Input.CommandBinding> is attached to defines the scope of the binding.</span></span>  <span data-ttu-id="4a441-208">È ad esempio possibile raggiungere un oggetto <xref:System.Windows.Input.CommandBinding> collegato a un predecessore della destinazione del comando tramite l'evento <xref:System.Windows.Input.CommandBinding.Executed>, ma un oggetto <xref:System.Windows.Input.CommandBinding> collegato a un discendente della destinazione del comando non è raggiungibile.</span><span class="sxs-lookup"><span data-stu-id="4a441-208">For example, a <xref:System.Windows.Input.CommandBinding> attached to an ancestor of the command target can be reached by the <xref:System.Windows.Input.CommandBinding.Executed> event, but a <xref:System.Windows.Input.CommandBinding> attached to a descendant of the command target cannot be reached.</span></span>  <span data-ttu-id="4a441-209">Si tratta di una conseguenza diretta del modo in cui un oggetto <xref:System.Windows.RoutedEvent> effettua il tunneling e il bubbling dall'oggetto che genera l'evento.</span><span class="sxs-lookup"><span data-stu-id="4a441-209">This is a direct consequence of the way a <xref:System.Windows.RoutedEvent> tunnels and bubbles from the object that raises the event.</span></span>  
  
 <span data-ttu-id="4a441-210">In alcune situazioni l'oggetto <xref:System.Windows.Input.CommandBinding> è collegato alla destinazione del comando stessa, ad esempio con la classe <xref:System.Windows.Controls.TextBox> e i comandi <xref:System.Windows.Input.ApplicationCommands.Cut%2A>, <xref:System.Windows.Input.ApplicationCommands.Copy%2A> e <xref:System.Windows.Input.ApplicationCommands.Paste%2A>.</span><span class="sxs-lookup"><span data-stu-id="4a441-210">In some situations the <xref:System.Windows.Input.CommandBinding> is attached to the command target itself, such as with the <xref:System.Windows.Controls.TextBox> class and the <xref:System.Windows.Input.ApplicationCommands.Cut%2A>, <xref:System.Windows.Input.ApplicationCommands.Copy%2A>, and <xref:System.Windows.Input.ApplicationCommands.Paste%2A> commands.</span></span> <span data-ttu-id="4a441-211">Tuttavia, spesso è consigliabile associare l'oggetto <xref:System.Windows.Input.CommandBinding> a un predecessore della destinazione del comando, ad esempio l'oggetto <xref:System.Windows.Window> principale o l'oggetto Application, specialmente se lo stesso oggetto <xref:System.Windows.Input.CommandBinding> può essere usato per più destinazioni di comandi.</span><span class="sxs-lookup"><span data-stu-id="4a441-211">Quite often though, it is more convenient to attach the <xref:System.Windows.Input.CommandBinding> to an ancestor of the command target, such as the main <xref:System.Windows.Window> or the Application object, especially if the same <xref:System.Windows.Input.CommandBinding> can be used for multiple command targets.</span></span>  <span data-ttu-id="4a441-212">Si tratta di decisioni di progettazione di cui tenere conto quando si crea l'infrastruttura di esecuzione dei comandi.</span><span class="sxs-lookup"><span data-stu-id="4a441-212">These are design decisions you will want to consider when you are creating your commanding infrastructure.</span></span>  
  
<a name="Commane_Target"></a>
### <a name="command-target"></a><span data-ttu-id="4a441-213">Destinazione del comando</span><span class="sxs-lookup"><span data-stu-id="4a441-213">Command Target</span></span>  
 <span data-ttu-id="4a441-214">La destinazione del comando è l'elemento su cui viene eseguito il comando.</span><span class="sxs-lookup"><span data-stu-id="4a441-214">The command target is the element on which the command is executed.</span></span>  <span data-ttu-id="4a441-215">Per quanto riguarda <xref:System.Windows.Input.RoutedCommand>, la destinazione del comando è l'elemento in corrispondenza del quale inizia il routing di <xref:System.Windows.Input.CommandManager.Executed> e <xref:System.Windows.Input.CommandManager.CanExecute>.</span><span class="sxs-lookup"><span data-stu-id="4a441-215">With regards to a <xref:System.Windows.Input.RoutedCommand>, the command target is the element at which routing of the <xref:System.Windows.Input.CommandManager.Executed> and <xref:System.Windows.Input.CommandManager.CanExecute> starts.</span></span>  <span data-ttu-id="4a441-216">Come notato in precedenza, in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] la proprietà <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> in <xref:System.Windows.Input.ICommandSource> è applicabile solo quando <xref:System.Windows.Input.ICommand> è un oggetto <xref:System.Windows.Input.RoutedCommand>.</span><span class="sxs-lookup"><span data-stu-id="4a441-216">As noted previously, in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> property on <xref:System.Windows.Input.ICommandSource> is only applicable when the <xref:System.Windows.Input.ICommand> is a <xref:System.Windows.Input.RoutedCommand>.</span></span>  <span data-ttu-id="4a441-217">Se <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> è impostato su un <xref:System.Windows.Input.ICommandSource> e il comando corrispondente non è un <xref:System.Windows.Input.RoutedCommand>, la destinazione del comando viene ignorata.</span><span class="sxs-lookup"><span data-stu-id="4a441-217">If the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is set on an <xref:System.Windows.Input.ICommandSource> and the corresponding command is not a <xref:System.Windows.Input.RoutedCommand>, the command target is ignored.</span></span>  
  
 <span data-ttu-id="4a441-218">L'origine del comando può impostare in modo esplicito la destinazione del comando.</span><span class="sxs-lookup"><span data-stu-id="4a441-218">The command source can explicitly set the command target.</span></span>  <span data-ttu-id="4a441-219">Se la destinazione del comando non viene definita, l'elemento con lo stato attivo verrà usato come destinazione del comando.</span><span class="sxs-lookup"><span data-stu-id="4a441-219">If the command target is not defined, the element with keyboard focus will be used as the command target.</span></span>  <span data-ttu-id="4a441-220">Uno dei vantaggi dell'uso dell'elemento con lo stato attivo come destinazione del comando consiste nel fatto che consente allo sviluppatore di applicazioni di usare la stessa origine del comando per richiamare un comando su più destinazioni senza tenere traccia della destinazione del comando.</span><span class="sxs-lookup"><span data-stu-id="4a441-220">One of the benefits of using the element with keyboard focus as the command target is that it allows the application developer to use the same command source to invoke a command on multiple targets without having to keep track of the command target.</span></span>  <span data-ttu-id="4a441-221">Se, ad esempio, un oggetto <xref:System.Windows.Controls.MenuItem> richiama il comando **Incolla** in un'applicazione che ha un controllo <xref:System.Windows.Controls.TextBox> e un controllo <xref:System.Windows.Controls.PasswordBox>, la destinazione può essere l'oggetto <xref:System.Windows.Controls.TextBox> o l'oggetto <xref:System.Windows.Controls.PasswordBox> a seconda del controllo con stato attivo.</span><span class="sxs-lookup"><span data-stu-id="4a441-221">For example, if a <xref:System.Windows.Controls.MenuItem> invokes the **Paste** command in an application that has a <xref:System.Windows.Controls.TextBox> control and a <xref:System.Windows.Controls.PasswordBox> control, the target can be either the <xref:System.Windows.Controls.TextBox> or <xref:System.Windows.Controls.PasswordBox> depending on which control has keyboard focus.</span></span>  
  
 <span data-ttu-id="4a441-222">L'esempio seguente mostra come impostare in modo esplicito la destinazione del comando nel markup e nel code-behind.</span><span class="sxs-lookup"><span data-stu-id="4a441-222">The following example shows how to explicitly set the command target in markup and in code behind.</span></span>  
  
 [!code-xaml[CommandingOverviewSnippets#CommandingOverviewXAMLCommandTarget](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewxamlcommandtarget)]  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewcommandtargetcodebehind)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewcommandtargetcodebehind)]  
  
<a name="Command_Manager"></a>
### <a name="the-commandmanager"></a><span data-ttu-id="4a441-223">CommandManager</span><span class="sxs-lookup"><span data-stu-id="4a441-223">The CommandManager</span></span>  
 <span data-ttu-id="4a441-224"><xref:System.Windows.Input.CommandManager> svolge un certo numero di funzioni correlate a comandi.</span><span class="sxs-lookup"><span data-stu-id="4a441-224">The <xref:System.Windows.Input.CommandManager> serves a number of command related functions.</span></span>  <span data-ttu-id="4a441-225">Rende disponibile un set di metodi statici per l'aggiunta e la rimozione di gestori degli eventi <xref:System.Windows.Input.CommandManager.PreviewExecuted>, <xref:System.Windows.Input.CommandManager.Executed>, <xref:System.Windows.Input.CommandManager.PreviewCanExecute> e <xref:System.Windows.Input.CommandManager.CanExecute> da e verso un elemento specifico.</span><span class="sxs-lookup"><span data-stu-id="4a441-225">It provides a set of static methods for adding and removing <xref:System.Windows.Input.CommandManager.PreviewExecuted>, <xref:System.Windows.Input.CommandManager.Executed>, <xref:System.Windows.Input.CommandManager.PreviewCanExecute>, and <xref:System.Windows.Input.CommandManager.CanExecute> event handlers to and from a specific element.</span></span>  <span data-ttu-id="4a441-226">Rappresenta un modo per registrare oggetti <xref:System.Windows.Input.CommandBinding> e <xref:System.Windows.Input.InputBinding> in una classe specifica.</span><span class="sxs-lookup"><span data-stu-id="4a441-226">It provides a means to register <xref:System.Windows.Input.CommandBinding> and <xref:System.Windows.Input.InputBinding> objects onto a specific class.</span></span>  <span data-ttu-id="4a441-227"><xref:System.Windows.Input.CommandManager> consente anche, tramite l'evento <xref:System.Windows.Input.CommandManager.RequerySuggested>, di notificare a un comando quando deve essere generato l'evento <xref:System.Windows.Input.ICommand.CanExecuteChanged>.</span><span class="sxs-lookup"><span data-stu-id="4a441-227">The <xref:System.Windows.Input.CommandManager> also provides a means, through the <xref:System.Windows.Input.CommandManager.RequerySuggested> event, to notify a command when it should raise the <xref:System.Windows.Input.ICommand.CanExecuteChanged> event.</span></span>  
  
 <span data-ttu-id="4a441-228">Il metodo <xref:System.Windows.Input.CommandManager.InvalidateRequerySuggested%2A> impone a <xref:System.Windows.Input.CommandManager> di generare l'evento <xref:System.Windows.Input.CommandManager.RequerySuggested>.</span><span class="sxs-lookup"><span data-stu-id="4a441-228">The <xref:System.Windows.Input.CommandManager.InvalidateRequerySuggested%2A> method forces the <xref:System.Windows.Input.CommandManager> to raise the <xref:System.Windows.Input.CommandManager.RequerySuggested> event.</span></span>  <span data-ttu-id="4a441-229">Ciò è utile per le condizioni che richiedono l'abilitazione o la disabilitazione di un comando ma che l'oggetto <xref:System.Windows.Input.CommandManager> non è in grado di rilevare.</span><span class="sxs-lookup"><span data-stu-id="4a441-229">This is useful for conditions that should disable/enable a command but are not conditions that the <xref:System.Windows.Input.CommandManager> is aware of.</span></span>  
  
<a name="Command_Library"></a>
## <a name="command-library"></a><span data-ttu-id="4a441-230">Libreria dei comandi</span><span class="sxs-lookup"><span data-stu-id="4a441-230">Command Library</span></span>  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="4a441-231">offre un set di comandi predefiniti.</span><span class="sxs-lookup"><span data-stu-id="4a441-231">provides a set of predefined commands.</span></span>  <span data-ttu-id="4a441-232">La libreria dei comandi è costituita dalle classi seguenti: <xref:System.Windows.Input.ApplicationCommands>, <xref:System.Windows.Input.NavigationCommands>, <xref:System.Windows.Input.MediaCommands>, <xref:System.Windows.Documents.EditingCommands> e <xref:System.Windows.Input.ComponentCommands>.</span><span class="sxs-lookup"><span data-stu-id="4a441-232">The command library consists of the following classes: <xref:System.Windows.Input.ApplicationCommands>, <xref:System.Windows.Input.NavigationCommands>, <xref:System.Windows.Input.MediaCommands>, <xref:System.Windows.Documents.EditingCommands>, and the <xref:System.Windows.Input.ComponentCommands>.</span></span>  <span data-ttu-id="4a441-233">Queste classi forniscono comandi quali <xref:System.Windows.Input.ApplicationCommands.Cut%2A>, <xref:System.Windows.Input.NavigationCommands.BrowseBack%2A> e <xref:System.Windows.Input.NavigationCommands.BrowseForward%2A>, <xref:System.Windows.Input.MediaCommands.Play%2A>, <xref:System.Windows.Input.MediaCommands.Stop%2A> e <xref:System.Windows.Input.MediaCommands.Pause%2A>.</span><span class="sxs-lookup"><span data-stu-id="4a441-233">These classes provide commands such as <xref:System.Windows.Input.ApplicationCommands.Cut%2A>, <xref:System.Windows.Input.NavigationCommands.BrowseBack%2A> and <xref:System.Windows.Input.NavigationCommands.BrowseForward%2A>, <xref:System.Windows.Input.MediaCommands.Play%2A>, <xref:System.Windows.Input.MediaCommands.Stop%2A>, and <xref:System.Windows.Input.MediaCommands.Pause%2A>.</span></span>  
  
 <span data-ttu-id="4a441-234">Molti di questi comandi includono un set di associazioni di input predefinite.</span><span class="sxs-lookup"><span data-stu-id="4a441-234">Many of these commands include a set of default input bindings.</span></span>  <span data-ttu-id="4a441-235">Se ad esempio si specifica che l'applicazione gestisce il comando copy, si ottiene automaticamente il tasto di scelta rapida "CTRL + C". si ottengono anche binding per altri dispositivi di input, ad esempio i movimenti di penna di Tablet PC e le informazioni vocali.</span><span class="sxs-lookup"><span data-stu-id="4a441-235">For example, if you specify that your application handles the copy command, you automatically get the keyboard binding "CTRL+C" You also get bindings for other input devices, such as Tablet PC pen gestures and speech information.</span></span>  
  
 <span data-ttu-id="4a441-236">Quando si fa riferimento ai comandi delle diverse librerie dei comandi usando [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], in genere è possibile omettere il nome della classe di libreria che espone la proprietà del comando statico.</span><span class="sxs-lookup"><span data-stu-id="4a441-236">When you reference commands in the various command libraries using [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], you can usually omit the class name of the library class that exposes the static command property.</span></span> <span data-ttu-id="4a441-237">Di solito i nomi dei comandi sono stringhe non ambigue ed esistono tipi proprietari che forniscono un raggruppamento logico di comandi, ma che non sono necessari per la risoluzione dell'ambiguità.</span><span class="sxs-lookup"><span data-stu-id="4a441-237">Generally, the command names are unambiguous as strings, and the owning types exist to provide a logical grouping of commands but are not necessary for disambiguation.</span></span> <span data-ttu-id="4a441-238">Ad esempio, è possibile specificare `Command="Cut"` anziché il più dettagliato `Command="ApplicationCommands.Cut"`.</span><span class="sxs-lookup"><span data-stu-id="4a441-238">For instance, you can specify `Command="Cut"` rather than the more verbose `Command="ApplicationCommands.Cut"`.</span></span> <span data-ttu-id="4a441-239">Si tratta di un meccanismo pratico incorporato nel [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processore per i comandi (più precisamente, si tratta di un comportamento del convertitore di tipi di <xref:System.Windows.Input.ICommand> , a cui il [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processore fa riferimento in fase di caricamento).</span><span class="sxs-lookup"><span data-stu-id="4a441-239">This is a convenience mechanism that is built in to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processor for commands (more precisely, it is a type converter behavior of <xref:System.Windows.Input.ICommand>, which the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processor references at load time).</span></span>  
  
<a name="creating_commands"></a>
## <a name="creating-custom-commands"></a><span data-ttu-id="4a441-240">Creazione di comandi personalizzati</span><span class="sxs-lookup"><span data-stu-id="4a441-240">Creating Custom Commands</span></span>  
 <span data-ttu-id="4a441-241">Se i comandi delle classi della libreria dei comandi non soddisfano le proprie esigenze, è possibile creare comandi personalizzati.</span><span class="sxs-lookup"><span data-stu-id="4a441-241">If the commands in the command library classes do not meet your needs, then you can create your own commands.</span></span>  <span data-ttu-id="4a441-242">Questa operazione può essere eseguita in due modi.</span><span class="sxs-lookup"><span data-stu-id="4a441-242">There are two ways to create a custom command.</span></span>  <span data-ttu-id="4a441-243">Il primo prevede la progettazione da zero e l'implementazione dell'interfaccia <xref:System.Windows.Input.ICommand>.</span><span class="sxs-lookup"><span data-stu-id="4a441-243">The first is to start from the ground up and implement the <xref:System.Windows.Input.ICommand> interface.</span></span>  <span data-ttu-id="4a441-244">L'altro, che rappresenta l'approccio più comune, consiste nel creare un oggetto <xref:System.Windows.Input.RoutedCommand> o <xref:System.Windows.Input.RoutedUICommand>.</span><span class="sxs-lookup"><span data-stu-id="4a441-244">The other way, and the more common approach, is to create a <xref:System.Windows.Input.RoutedCommand> or a <xref:System.Windows.Input.RoutedUICommand>.</span></span>  
  
 <span data-ttu-id="4a441-245">Per un esempio di creazione di un oggetto <xref:System.Windows.Input.RoutedCommand> personalizzato, vedere [Create a Custom RoutedCommand Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Input%20and%20Commands/CustomRoutedCommand) (Creare un esempio di oggetto RoutedCommand personalizzato).</span><span class="sxs-lookup"><span data-stu-id="4a441-245">For an example of creating a custom <xref:System.Windows.Input.RoutedCommand>, see [Create a Custom RoutedCommand Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Input%20and%20Commands/CustomRoutedCommand).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="4a441-246">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="4a441-246">See also</span></span>

- <xref:System.Windows.Input.RoutedCommand>
- <xref:System.Windows.Input.CommandBinding>
- <xref:System.Windows.Input.InputBinding>
- <xref:System.Windows.Input.CommandManager>
- [<span data-ttu-id="4a441-247">Cenni preliminari sull'input</span><span class="sxs-lookup"><span data-stu-id="4a441-247">Input Overview</span></span>](input-overview.md)
- [<span data-ttu-id="4a441-248">Cenni preliminari sugli eventi indirizzati</span><span class="sxs-lookup"><span data-stu-id="4a441-248">Routed Events Overview</span></span>](routed-events-overview.md)
- [<span data-ttu-id="4a441-249">Implementare ICommandSource</span><span class="sxs-lookup"><span data-stu-id="4a441-249">Implement ICommandSource</span></span>](how-to-implement-icommandsource.md)
- <span data-ttu-id="4a441-250">[How to: Add a Command to a MenuItem (Procedura: Aggiungere un comando a un MenuItem)](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms741839(v=vs.90))</span><span class="sxs-lookup"><span data-stu-id="4a441-250">[How to: Add a Command to a MenuItem](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms741839(v=vs.90))</span></span>
- [<span data-ttu-id="4a441-251">Create a Custom RoutedCommand Sample (Creare un esempio di oggetto RoutedCommand personalizzato)</span><span class="sxs-lookup"><span data-stu-id="4a441-251">Create a Custom RoutedCommand Sample</span></span>](https://github.com/Microsoft/WPF-Samples/tree/master/Input%20and%20Commands/CustomRoutedCommand)
