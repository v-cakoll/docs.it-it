---
title: 'Procedura dettagliata: hosting di contenuto WPF in Win32'
ms.date: 03/30/2017
dev_langs:
- cpp
helpviewer_keywords:
- hosting WPF content in Win32 window [WPF]
ms.assetid: 38ce284a-4303-46dd-b699-c9365b22a7dc
ms.openlocfilehash: 692105d464c005109cbf1ff704045efa7d1e9173
ms.sourcegitcommit: 586dbdcaef9767642436b1e4efbe88fb15473d6f
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2018
ms.locfileid: "48842801"
---
# <a name="walkthrough-hosting-wpf-content-in-win32"></a><span data-ttu-id="3d014-102">Procedura dettagliata: hosting di contenuto WPF in Win32</span><span class="sxs-lookup"><span data-stu-id="3d014-102">Walkthrough: Hosting WPF Content in Win32</span></span>
[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] <span data-ttu-id="3d014-103">fornisce un ambiente completo per la creazione di applicazioni.</span><span class="sxs-lookup"><span data-stu-id="3d014-103"> provides a rich environment for creating applications.</span></span> <span data-ttu-id="3d014-104">Tuttavia, se si dispone di una grande quantità di codice [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)], può essere più efficace aggiungere funzionalità [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] all'applicazione anziché riscrivere il codice originale.</span><span class="sxs-lookup"><span data-stu-id="3d014-104">However, when you have a substantial investment in [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] code, it might be more effective to add [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] functionality to your application rather than rewriting your original code.</span></span> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="3d014-105">fornisce un meccanismo semplice per l'hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenuto in un [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] finestra.</span><span class="sxs-lookup"><span data-stu-id="3d014-105"> provides a straightforward mechanism for hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span>  
  
 <span data-ttu-id="3d014-106">Questa esercitazione descrive come scrivere un'applicazione di esempio, [di Hosting di contenuto WPF in un esempio di finestra Win32](https://go.microsoft.com/fwlink/?LinkID=160004), che gli host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenuto in un [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] finestra.</span><span class="sxs-lookup"><span data-stu-id="3d014-106">This tutorial describes how to write a sample application, [Hosting WPF Content in a Win32 Window Sample](https://go.microsoft.com/fwlink/?LinkID=160004), that hosts [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="3d014-107">L'esempio può essere esteso a qualsiasi finestra [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3d014-107">You can extend this sample to host any [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="3d014-108">Dal momento che implica l'uso combinato di codice gestito e non gestito, l'applicazione viene scritta in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3d014-108">Because it involves mixing managed and unmanaged code, the application is written in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span></span>  
  
 
  
<a name="requirements"></a>   
## <a name="requirements"></a><span data-ttu-id="3d014-109">Requisiti</span><span class="sxs-lookup"><span data-stu-id="3d014-109">Requirements</span></span>  
 <span data-ttu-id="3d014-110">Questa esercitazione presuppone una conoscenza di base della programmazione [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] e [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3d014-110">This tutorial assumes a basic familiarity with both [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programming.</span></span> <span data-ttu-id="3d014-111">Per un'introduzione di base [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programmazione, vedere [introduttiva](../../../../docs/framework/wpf/getting-started/index.md).</span><span class="sxs-lookup"><span data-stu-id="3d014-111">For a basic introduction to [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming, see [Getting Started](../../../../docs/framework/wpf/getting-started/index.md).</span></span> <span data-ttu-id="3d014-112">Per un'introduzione al [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programmazione, è necessario fare riferimento a uno qualsiasi dei numerosi manuali sull'argomento, in particolare *programmazione Windows* di Charles Petzold.</span><span class="sxs-lookup"><span data-stu-id="3d014-112">For an introduction to [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programming, you should reference any of the numerous books on the subject, in particular *Programming Windows* by Charles Petzold.</span></span>  
  
 <span data-ttu-id="3d014-113">Poiché l'esempio che accompagna questa esercitazione è implementato in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)], questa esercitazione presuppone una familiarità con l'uso di [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] al programma il [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] oltre alla conoscenza della programmazione in codice gestito.</span><span class="sxs-lookup"><span data-stu-id="3d014-113">Because the sample that accompanies this tutorial is implemented in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)], this tutorial assumes familiarity with the use of [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] to program the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)][!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] plus an understanding of managed code programming.</span></span> <span data-ttu-id="3d014-114">La conoscenza di [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] è utile, ma non essenziale.</span><span class="sxs-lookup"><span data-stu-id="3d014-114">Familiarity with [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] is helpful but not essential.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="3d014-115">Questa esercitazione include numerosi esempi di codice relativi all'esempio associato.</span><span class="sxs-lookup"><span data-stu-id="3d014-115">This tutorial includes a number of code examples from the associated sample.</span></span> <span data-ttu-id="3d014-116">Tuttavia, per una questione di leggibilità, il codice di esempio completo non è compreso.</span><span class="sxs-lookup"><span data-stu-id="3d014-116">However, for readability, it does not include the complete sample code.</span></span> <span data-ttu-id="3d014-117">Per il codice di esempio completo, vedere [Hosting di contenuto WPF in un esempio di finestra Win32](https://go.microsoft.com/fwlink/?LinkID=160004).</span><span class="sxs-lookup"><span data-stu-id="3d014-117">For the complete sample code, see [Hosting WPF Content in a Win32 Window Sample](https://go.microsoft.com/fwlink/?LinkID=160004).</span></span>  
  
<a name="basic_procedure"></a>   
## <a name="the-basic-procedure"></a><span data-ttu-id="3d014-118">Procedura di base</span><span class="sxs-lookup"><span data-stu-id="3d014-118">The Basic Procedure</span></span>  
 <span data-ttu-id="3d014-119">In questa sezione illustra la procedura di base che consente di host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenuto in un [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] finestra.</span><span class="sxs-lookup"><span data-stu-id="3d014-119">This section outlines the basic procedure you use to host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="3d014-120">Le sezioni rimanenti illustrano in dettaglio i vari passaggi.</span><span class="sxs-lookup"><span data-stu-id="3d014-120">The remaining sections explain the details of each step.</span></span>  
  
 <span data-ttu-id="3d014-121">La chiave per ospitare [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenuto in un [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] finestra è il <xref:System.Windows.Interop.HwndSource> classe.</span><span class="sxs-lookup"><span data-stu-id="3d014-121">The key to hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content on a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window is the <xref:System.Windows.Interop.HwndSource> class.</span></span> <span data-ttu-id="3d014-122">Questa classe esegue il wrapping di [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenuto in un [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] finestra, in modo che possa essere incorporate nel [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] come finestra figlio.</span><span class="sxs-lookup"><span data-stu-id="3d014-122">This class wraps the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window, allowing it to be incorporated into your [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] as a child window.</span></span> <span data-ttu-id="3d014-123">Nell'approccio che segue, [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] e [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] sono combinati in un'unica applicazione.</span><span class="sxs-lookup"><span data-stu-id="3d014-123">The following approach combines the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in a single application.</span></span>  
  
1.  <span data-ttu-id="3d014-124">Implementare il [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenuto come classe gestita.</span><span class="sxs-lookup"><span data-stu-id="3d014-124">Implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content as a managed class.</span></span>  
  
2.  <span data-ttu-id="3d014-125">Implementare un'applicazione [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] con [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3d014-125">Implement a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application with [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span></span> <span data-ttu-id="3d014-126">Se si parte da un'applicazione esistente e da codice [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] non gestito, in genere è possibile abilitarla a chiamare codice gestito modificando le impostazioni del progetto e includendo il flag del compilatore `/clr`.</span><span class="sxs-lookup"><span data-stu-id="3d014-126">If you are starting with an existing application and unmanaged [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] code, you can usually enable it to call managed code by changing your project settings to include the `/clr` compiler flag.</span></span>  
  
3.  <span data-ttu-id="3d014-127">Impostare il modello di threading su apartment a thread singolo (STA).</span><span class="sxs-lookup"><span data-stu-id="3d014-127">Set the threading model to single-threaded apartment (STA).</span></span>  
  
4.  <span data-ttu-id="3d014-128">Gestire le [WM_CREATE](/windows/desktop/winmsg/wm-create)notifica nella routine della finestra ed eseguire le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="3d014-128">Handle the [WM_CREATE](/windows/desktop/winmsg/wm-create)notification in your window procedure and do the following:</span></span>  
  
    1.  <span data-ttu-id="3d014-129">Creare un nuovo oggetto <xref:System.Windows.Interop.HwndSource> con la finestra padre come parametro `parent`.</span><span class="sxs-lookup"><span data-stu-id="3d014-129">Create a new <xref:System.Windows.Interop.HwndSource> object with the parent window as its `parent` parameter.</span></span>  
  
    2.  <span data-ttu-id="3d014-130">Creare un'istanza della classe contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3d014-130">Create an instance of your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class.</span></span>  
  
    3.  <span data-ttu-id="3d014-131">Assegnare un riferimento al [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] oggetto contenuto per il <xref:System.Windows.Interop.HwndSource.RootVisual%2A> proprietà del <xref:System.Windows.Interop.HwndSource>.</span><span class="sxs-lookup"><span data-stu-id="3d014-131">Assign a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object to the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource>.</span></span>  
  
    4.  <span data-ttu-id="3d014-132">Ottenere HWND per il contenuto.</span><span class="sxs-lookup"><span data-stu-id="3d014-132">Get the HWND for the content.</span></span> <span data-ttu-id="3d014-133">La proprietà <xref:System.Windows.Interop.HwndSource.Handle%2A> dell'oggetto <xref:System.Windows.Interop.HwndSource> contiene l'handle di finestra (HWND).</span><span class="sxs-lookup"><span data-stu-id="3d014-133">The <xref:System.Windows.Interop.HwndSource.Handle%2A> property of the <xref:System.Windows.Interop.HwndSource> object contains the window handle (HWND).</span></span> <span data-ttu-id="3d014-134">Per ottenere un HWND utilizzabile nella parte non gestita dell'applicazione, eseguire il cast di `Handle.ToPointer()` a un HWND.</span><span class="sxs-lookup"><span data-stu-id="3d014-134">To get an HWND that you can use in the unmanaged part of your application, cast `Handle.ToPointer()` to an HWND.</span></span>  
  
5.  <span data-ttu-id="3d014-135">Implementare una classe gestita contenente un campo statico con un riferimento al contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3d014-135">Implement a managed class that contains a static field to hold a reference to your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="3d014-136">Questa classe consente di ottenere un riferimento al contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] dal codice [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3d014-136">This class allows you to get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code.</span></span>  
  
6.  <span data-ttu-id="3d014-137">Assegnare il contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] al campo statico.</span><span class="sxs-lookup"><span data-stu-id="3d014-137">Assign the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to the static field.</span></span>  
  
7.  <span data-ttu-id="3d014-138">Ricevere notifiche dal [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenuto associando un gestore a uno o più i [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] gli eventi.</span><span class="sxs-lookup"><span data-stu-id="3d014-138">Receive notifications from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content by attaching a handler to one or more of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] events.</span></span>  
  
8.  <span data-ttu-id="3d014-139">Comunicare con il contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] usando il riferimento archiviato nel campo statico per impostare le proprietà ed eseguire altre operazioni.</span><span class="sxs-lookup"><span data-stu-id="3d014-139">Communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content by using the reference that you stored in the static field to set properties, and so on.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="3d014-140">È anche possibile usare [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] per implementare il [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenuto.</span><span class="sxs-lookup"><span data-stu-id="3d014-140">You can also use [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] to implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="3d014-141">Tuttavia, sarà necessario compilarlo separatamente come [!INCLUDE[TLA#tla_dll](../../../../includes/tlasharptla-dll-md.md)] e fare riferimento a tale [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] dall'applicazione [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3d014-141">However, you will have to compile it separately as a [!INCLUDE[TLA#tla_dll](../../../../includes/tlasharptla-dll-md.md)] and reference that [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application.</span></span> <span data-ttu-id="3d014-142">La parte restante della procedura è simile a quella appena descritta.</span><span class="sxs-lookup"><span data-stu-id="3d014-142">The remainder of the procedure is similar to that outlined above.</span></span>

<a name="implementing_the_application"></a>
## <a name="implementing-the-host-application"></a><span data-ttu-id="3d014-143">Implementazione dell'applicazione host</span><span class="sxs-lookup"><span data-stu-id="3d014-143">Implementing the Host Application</span></span>
 <span data-ttu-id="3d014-144">Questa sezione viene descritto come ospitare [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenuto in una semplice [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="3d014-144">This section describes how to host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a basic [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application.</span></span> <span data-ttu-id="3d014-145">Il contenuto viene implementato in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] come classe gestita.</span><span class="sxs-lookup"><span data-stu-id="3d014-145">The content itself is implemented in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] as a managed class.</span></span> <span data-ttu-id="3d014-146">In gran parte si tratta di semplice programmazione [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3d014-146">For the most part, it is straightforward [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming.</span></span> <span data-ttu-id="3d014-147">Vengono illustrati gli aspetti principali dell'implementazione del contenuto [implementazione del contenuto WPF](#implementing_the_wpf_page).</span><span class="sxs-lookup"><span data-stu-id="3d014-147">The key aspects of the content implementation are discussed in [Implementing the WPF Content](#implementing_the_wpf_page).</span></span>

<a name="autoNestedSectionsOUTLINE1"></a>
-   [<span data-ttu-id="3d014-148">Applicazione di base</span><span class="sxs-lookup"><span data-stu-id="3d014-148">The Basic Application</span></span>](#the_basic_application)

-   [<span data-ttu-id="3d014-149">Hosting del contenuto WPF</span><span class="sxs-lookup"><span data-stu-id="3d014-149">Hosting the WPF Content</span></span>](#hosting_the_wpf_page)

-   [<span data-ttu-id="3d014-150">Riferimento al contenuto WPF</span><span class="sxs-lookup"><span data-stu-id="3d014-150">Holding a Reference to the WPF Content</span></span>](#holding_a_reference)

-   [<span data-ttu-id="3d014-151">Comunicazione con il contenuto WPF</span><span class="sxs-lookup"><span data-stu-id="3d014-151">Communicating with the WPF Content</span></span>](#communicating_with_the_page)

<a name="the_basic_application"></a>
### <a name="the-basic-application"></a><span data-ttu-id="3d014-152">Applicazione di base</span><span class="sxs-lookup"><span data-stu-id="3d014-152">The Basic Application</span></span>
 <span data-ttu-id="3d014-153">Il punto di partenza per l'applicazione host consisteva per creare un modello di Visual Studio 2005.</span><span class="sxs-lookup"><span data-stu-id="3d014-153">The starting point for the host application was to create a Visual Studio 2005 template.</span></span>

1.  <span data-ttu-id="3d014-154">Aprire Visual Studio 2005 e selezionare **nuovo progetto** dalle **File** menu.</span><span class="sxs-lookup"><span data-stu-id="3d014-154">Open Visual Studio 2005, and select **New Project** from the **File** menu.</span></span>

2.  <span data-ttu-id="3d014-155">Selezionare **Win32** dall'elenco di [!INCLUDE[TLA2#tla_visualcpp](../../../../includes/tla2sharptla-visualcpp-md.md)] tipi di progetto.</span><span class="sxs-lookup"><span data-stu-id="3d014-155">Select **Win32** from the list of [!INCLUDE[TLA2#tla_visualcpp](../../../../includes/tla2sharptla-visualcpp-md.md)] project types.</span></span> <span data-ttu-id="3d014-156">Se il linguaggio predefinito non è [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)], si noterà che questi tipi di progetto in **altri linguaggi**.</span><span class="sxs-lookup"><span data-stu-id="3d014-156">If your default language is not [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)], you will find these project types under **Other Languages**.</span></span>

3.  <span data-ttu-id="3d014-157">Selezionare una **progetto Win32** modello, assegnare un nome al progetto e fare clic su **OK** per avviare la **Creazione guidata applicazione Win32**.</span><span class="sxs-lookup"><span data-stu-id="3d014-157">Select a **Win32 Project** template, assign a name to the project and click **OK** to launch the **Win32 Application Wizard**.</span></span>

4.  <span data-ttu-id="3d014-158">Accettare impostazioni predefinite della procedura guidata e fare clic su **fine** per avviare il progetto.</span><span class="sxs-lookup"><span data-stu-id="3d014-158">Accept the wizard's default settings and click **Finish** to start the project.</span></span>

 <span data-ttu-id="3d014-159">Il modello crea un'applicazione [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] di base, che include:</span><span class="sxs-lookup"><span data-stu-id="3d014-159">The template creates a basic [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application, including:</span></span>

-   <span data-ttu-id="3d014-160">Un punto di ingresso per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="3d014-160">An entry point for the application.</span></span>

-   <span data-ttu-id="3d014-161">Una finestra, con una procedura di finestra associata (WndProc).</span><span class="sxs-lookup"><span data-stu-id="3d014-161">A window, with an associated window procedure (WndProc).</span></span>

-   <span data-ttu-id="3d014-162">Un menu dotato **File** e **Guida** intestazioni.</span><span class="sxs-lookup"><span data-stu-id="3d014-162">A menu with **File** and **Help** headings.</span></span> <span data-ttu-id="3d014-163">Il **File** menu sono disponibili una **uscita** elemento che consente di chiudere l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="3d014-163">The **File** menu has an **Exit** item that closes the application.</span></span> <span data-ttu-id="3d014-164">Il **aiutare** menu ha un' **sulle** elemento che consente di avviare una finestra di dialogo semplice.</span><span class="sxs-lookup"><span data-stu-id="3d014-164">The **Help** menu has an **About** item that launches a simple dialog box.</span></span>

 <span data-ttu-id="3d014-165">Prima di iniziare a scrivere codice per ospitare il [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenuto, è necessario apportare due modifiche al modello di base.</span><span class="sxs-lookup"><span data-stu-id="3d014-165">Before you start writing code to host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, you need to make two modifications to the basic template.</span></span>

 <span data-ttu-id="3d014-166">La prima consiste nel compilare il progetto come codice gestito.</span><span class="sxs-lookup"><span data-stu-id="3d014-166">The first is to compile the project as managed code.</span></span> <span data-ttu-id="3d014-167">Per impostazione predefinita, il progetto viene compilato come codice non gestito.</span><span class="sxs-lookup"><span data-stu-id="3d014-167">By default, the project compiles as unmanaged code.</span></span> <span data-ttu-id="3d014-168">Tuttavia, dal momento che [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] è implementato in codice gestito, il progetto deve essere compilato di conseguenza.</span><span class="sxs-lookup"><span data-stu-id="3d014-168">However, because [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is implemented in managed code, the project must be compiled accordingly.</span></span>

1.  <span data-ttu-id="3d014-169">Fare clic sul nome del progetto in **Esplora soluzioni** e selezionare **delle proprietà** dal menu di scelta rapida per avviare la **pagine delle proprietà** nella finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="3d014-169">Right-click the project name in **Solution Explorer** and select **Properties** from the context menu to launch the **Property Pages** dialog box.</span></span>

2.  <span data-ttu-id="3d014-170">Selezionare **le proprietà di configurazione** dalla visualizzazione albero nel riquadro sinistro.</span><span class="sxs-lookup"><span data-stu-id="3d014-170">Select **Configuration Properties** from the tree view in the left pane.</span></span>

3.  <span data-ttu-id="3d014-171">Selezionare **Common Language Runtime** supportare dalle **impostazioni predefinite progetto** elenco nel riquadro di destra.</span><span class="sxs-lookup"><span data-stu-id="3d014-171">Select **Common Language Runtime** support from the **Project Defaults** list in the right pane.</span></span>

4.  <span data-ttu-id="3d014-172">Selezionare **supporto Common Language Runtime (/ Common Language Runtime)** dall'elenco a discesa.</span><span class="sxs-lookup"><span data-stu-id="3d014-172">Select **Common Language Runtime Support (/clr)** from the drop-down list box.</span></span>

> [!NOTE]
>  <span data-ttu-id="3d014-173">Questo flag del compilatore consente di usare codice gestito nell'applicazione, ma il codice non gestito verrà comunque compilato come in precedenza.</span><span class="sxs-lookup"><span data-stu-id="3d014-173">This compiler flag allows you to use managed code in your application, but your unmanaged code will still compile as before.</span></span>

 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="3d014-174">usa il modello di threading STA (apartment a thread singolo).</span><span class="sxs-lookup"><span data-stu-id="3d014-174"> uses the single-threaded apartment (STA) threading model.</span></span> <span data-ttu-id="3d014-175">Per poter funzionare correttamente con il [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] codice contenuto, è necessario impostare modello di threading dell'applicazione su STA applicando un attributo al punto di ingresso.</span><span class="sxs-lookup"><span data-stu-id="3d014-175">In order to work properly with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content code, you must set the application's threading model to STA by applying an attribute to the entry point.</span></span>

 [!code-cpp[Win32HostingWPFPage#WinMain](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#winmain)]

<a name="hosting_the_wpf_page"></a>
### <a name="hosting-the-wpf-content"></a><span data-ttu-id="3d014-176">Hosting del contenuto WPF</span><span class="sxs-lookup"><span data-stu-id="3d014-176">Hosting the WPF Content</span></span>
 <span data-ttu-id="3d014-177">Il [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenuto è un'applicazione di immissione dell'indirizzo semplice.</span><span class="sxs-lookup"><span data-stu-id="3d014-177">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is a simple address entry application.</span></span> <span data-ttu-id="3d014-178">È costituito da diversi controlli <xref:System.Windows.Controls.TextBox> nei quali immettere nome utente, indirizzo e così via.</span><span class="sxs-lookup"><span data-stu-id="3d014-178">It consists of several <xref:System.Windows.Controls.TextBox> controls to take user name, address, and so on.</span></span> <span data-ttu-id="3d014-179">Esistono inoltre due <xref:System.Windows.Controls.Button> controlli **OK** e **Annulla**.</span><span class="sxs-lookup"><span data-stu-id="3d014-179">There are also two <xref:System.Windows.Controls.Button> controls, **OK** and **Cancel**.</span></span> <span data-ttu-id="3d014-180">Quando l'utente fa clic **OK**, il pulsante <xref:System.Windows.Controls.Primitives.ButtonBase.Click> gestore evento raccoglie i dati dal <xref:System.Windows.Controls.TextBox> controlla, lo assegna alle proprietà corrispondenti e genera un evento personalizzato, `OnButtonClicked`.</span><span class="sxs-lookup"><span data-stu-id="3d014-180">When the user clicks **OK**, the button's <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler collects the data from the <xref:System.Windows.Controls.TextBox> controls, assigns it to corresponding properties, and raises a custom event, `OnButtonClicked`.</span></span> <span data-ttu-id="3d014-181">Quando l'utente sceglie **annullare**, il gestore genera semplicemente `OnButtonClicked`.</span><span class="sxs-lookup"><span data-stu-id="3d014-181">When the user clicks **Cancel**, the handler simply raises `OnButtonClicked`.</span></span> <span data-ttu-id="3d014-182">L'oggetto argomento dell'evento per `OnButtonClicked` contiene un campo booleano che indica il pulsante scelto.</span><span class="sxs-lookup"><span data-stu-id="3d014-182">The event argument object for `OnButtonClicked` contains a Boolean field that indicates which button was clicked.</span></span>

 <span data-ttu-id="3d014-183">Il codice per ospitare le [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenuto viene implementato in un gestore per il [WM_CREATE](/windows/desktop/winmsg/wm-create) notifica nella finestra host.</span><span class="sxs-lookup"><span data-stu-id="3d014-183">The code to host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented in a handler for the [WM_CREATE](/windows/desktop/winmsg/wm-create) notification on the host window.</span></span>

 [!code-cpp[Win32HostingWPFPage#WMCreate](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wmcreate)]

 <span data-ttu-id="3d014-184">Il `GetHwnd` metodo acquisisce informazioni sulle dimensioni e posizione oltre l'elemento padre handle di finestra e restituisce l'handle della finestra di hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenuto.</span><span class="sxs-lookup"><span data-stu-id="3d014-184">The `GetHwnd` method takes size and position information plus the parent window handle and returns the window handle of the hosted [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span>

> [!NOTE]
>  <span data-ttu-id="3d014-185">Non è possibile usare una direttiva `#using` per lo spazio dei nomi `System::Windows::Interop`,</span><span class="sxs-lookup"><span data-stu-id="3d014-185">You cannot use a `#using` directive for the `System::Windows::Interop` namespace.</span></span> <span data-ttu-id="3d014-186">in quanto si creerebbe un conflitto di nomi tra la struttura <xref:System.Windows.Interop.MSG> nello spazio dei nomi e la struttura MSG dichiarata in winuser.h.</span><span class="sxs-lookup"><span data-stu-id="3d014-186">Doing so creates a name collision between the <xref:System.Windows.Interop.MSG> structure in that namespace and the MSG structure declared in winuser.h.</span></span> <span data-ttu-id="3d014-187">Al contrario, occorre usare nomi completi per accedere al contenuto dello spazio dei nomi.</span><span class="sxs-lookup"><span data-stu-id="3d014-187">You must instead use fully-qualified names to access the contents of that namespace.</span></span>

 [!code-cpp[Win32HostingWPFPage#GetHwnd](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#gethwnd)]

 <span data-ttu-id="3d014-188">Non è possibile ospitare il [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenuti direttamente nella finestra dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="3d014-188">You cannot host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content directly in your application window.</span></span> <span data-ttu-id="3d014-189">Al contrario, occorre prima creare un oggetto <xref:System.Windows.Interop.HwndSource> per eseguire il wrapping del contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3d014-189">Instead, you first create an <xref:System.Windows.Interop.HwndSource> object to wrap the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="3d014-190">Questo oggetto è fondamentalmente una finestra progettata per ospitare un [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenuto.</span><span class="sxs-lookup"><span data-stu-id="3d014-190">This object is basically a window that is designed to host a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="3d014-191">Si ospita il <xref:System.Windows.Interop.HwndSource> oggetto nella finestra padre, occorre crearlo come figlio di un [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] finestra che fa parte dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="3d014-191">You host the <xref:System.Windows.Interop.HwndSource> object in the parent window by creating it as a child of a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window that is part of your application.</span></span> <span data-ttu-id="3d014-192">I parametri del costruttore <xref:System.Windows.Interop.HwndSource> contengono pressappoco le stesse informazioni che verrebbero passate a CreateWindow durante la creazione di una finestra figlio [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3d014-192">The <xref:System.Windows.Interop.HwndSource> constructor parameters contain much the same information that you would pass to CreateWindow when you create a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] child window.</span></span>

 <span data-ttu-id="3d014-193">Si crea quindi un'istanza del [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] oggetto contenuto.</span><span class="sxs-lookup"><span data-stu-id="3d014-193">You next create an instance of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object.</span></span> <span data-ttu-id="3d014-194">In questo caso, il contenuto[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] viene implementato come classe separata, `WPFPage`, usando [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3d014-194">In this case, the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented as a separate class, `WPFPage`, using [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span></span> <span data-ttu-id="3d014-195">È anche possibile implementare il contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] mediante [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3d014-195">You could also implement the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content with [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span> <span data-ttu-id="3d014-196">Tuttavia, a tale scopo è necessario configurare un progetto separato e compilare il [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenuto come un [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3d014-196">However, to do so you need to set up a separate project and build the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content as a [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)].</span></span> <span data-ttu-id="3d014-197">È possibile aggiungere un riferimento alla [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] nel progetto e usarlo per creare un'istanza del contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3d014-197">You can add a reference to that [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] to your project, and use that reference to create an instance of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span>

 <span data-ttu-id="3d014-198">Visualizzare il [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenuto nella finestra figlio tramite l'assegnazione di un riferimento al [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenuto per il <xref:System.Windows.Interop.HwndSource.RootVisual%2A> proprietà del <xref:System.Windows.Interop.HwndSource>.</span><span class="sxs-lookup"><span data-stu-id="3d014-198">You display the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in your child window by assigning a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource>.</span></span>

 <span data-ttu-id="3d014-199">La riga di codice successiva associa un gestore eventi, `WPFButtonClicked`, all'evento [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] del contenuto `OnButtonClicked`.</span><span class="sxs-lookup"><span data-stu-id="3d014-199">The next line of code attaches an event handler, `WPFButtonClicked`, to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content `OnButtonClicked` event.</span></span> <span data-ttu-id="3d014-200">Questo gestore viene chiamato quando l'utente sceglie il **OK** oppure **Annulla** pulsante.</span><span class="sxs-lookup"><span data-stu-id="3d014-200">This handler is called when the user clicks the **OK** or **Cancel** button.</span></span> <span data-ttu-id="3d014-201">Visualizzare [con il contenuto WPF](#communicating_with_the_page) per un'ulteriore discussione di questo gestore dell'evento.</span><span class="sxs-lookup"><span data-stu-id="3d014-201">See [communicating_with_the_WPF content](#communicating_with_the_page) for further discussion of this event handler.</span></span>

 <span data-ttu-id="3d014-202">La riga finale del codice illustrata restituisce l'handle della finestra (HWND) associato all'oggetto <xref:System.Windows.Interop.HwndSource>.</span><span class="sxs-lookup"><span data-stu-id="3d014-202">The final line of code shown returns the window handle (HWND) that is associated with the <xref:System.Windows.Interop.HwndSource> object.</span></span> <span data-ttu-id="3d014-203">È possibile usare questo handle dal codice [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] per inviare messaggi alla finestra ospitata, benché questo non avvenga nell'esempio.</span><span class="sxs-lookup"><span data-stu-id="3d014-203">You can use this handle from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code to send messages to the hosted window, although the sample does not do so.</span></span> <span data-ttu-id="3d014-204">L'oggetto <xref:System.Windows.Interop.HwndSource> genera un evento ogni volta che riceve un messaggio.</span><span class="sxs-lookup"><span data-stu-id="3d014-204">The <xref:System.Windows.Interop.HwndSource> object raises an event every time it receives a message.</span></span> <span data-ttu-id="3d014-205">Per elaborare i messaggi, chiamare il metodo <xref:System.Windows.Interop.HwndSource.AddHook%2A> per associare un gestore di messaggi, quindi elaborare i messaggi in tale gestore.</span><span class="sxs-lookup"><span data-stu-id="3d014-205">To process the messages, call the <xref:System.Windows.Interop.HwndSource.AddHook%2A> method to attach a message handler and then process the messages in that handler.</span></span>

<a name="holding_a_reference"></a>
### <a name="holding-a-reference-to-the-wpf-content"></a><span data-ttu-id="3d014-206">Riferimento al contenuto WPF</span><span class="sxs-lookup"><span data-stu-id="3d014-206">Holding a Reference to the WPF Content</span></span>
 <span data-ttu-id="3d014-207">Per molte applicazioni si vorrà comunicare con il contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in un secondo momento.</span><span class="sxs-lookup"><span data-stu-id="3d014-207">For many applications, you will want to communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content later.</span></span> <span data-ttu-id="3d014-208">Ad esempio, sarà possibile modificare le proprietà del contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] o fare in modo che l'oggetto <xref:System.Windows.Interop.HwndSource> ospiti un contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] diverso.</span><span class="sxs-lookup"><span data-stu-id="3d014-208">For example, you might want to modify the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties, or perhaps have the <xref:System.Windows.Interop.HwndSource> object host different [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="3d014-209">A tale scopo, è necessario un riferimento all'oggetto <xref:System.Windows.Interop.HwndSource> o al contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3d014-209">To do this, you need a reference to the <xref:System.Windows.Interop.HwndSource> object or the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="3d014-210">L'oggetto <xref:System.Windows.Interop.HwndSource> e il contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] associato restano in memoria fino all'eliminazione dell'handle della finestra.</span><span class="sxs-lookup"><span data-stu-id="3d014-210">The <xref:System.Windows.Interop.HwndSource> object and its associated [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content remain in memory until you destroy the window handle.</span></span> <span data-ttu-id="3d014-211">Tuttavia, la variabile assegnata all'oggetto <xref:System.Windows.Interop.HwndSource> uscirà dall'ambito non appena si esce dalla procedura di finestra.</span><span class="sxs-lookup"><span data-stu-id="3d014-211">However, the variable you assign to the <xref:System.Windows.Interop.HwndSource> object will go out of scope as soon as you return from the window procedure.</span></span> <span data-ttu-id="3d014-212">Per gestire questo problema con le applicazioni [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] si usa in genere una variabile statica o globale.</span><span class="sxs-lookup"><span data-stu-id="3d014-212">The customary way to handle this issue with [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] applications is to use a static or global variable.</span></span> <span data-ttu-id="3d014-213">Sfortunatamente, non è possibile assegnare un oggetto gestito ai suddetti tipi di variabili.</span><span class="sxs-lookup"><span data-stu-id="3d014-213">Unfortunately, you cannot assign a managed object to those types of variables.</span></span> <span data-ttu-id="3d014-214">È possibile assegnare l'handle della finestra associato all'oggetto <xref:System.Windows.Interop.HwndSource> a una variabile globale o statica, ma ciò non consentirà di accedere all'oggetto in questione.</span><span class="sxs-lookup"><span data-stu-id="3d014-214">You can assign the window handle associated with <xref:System.Windows.Interop.HwndSource> object to a global or static variable, but that doe not provide access to the object itself.</span></span>

 <span data-ttu-id="3d014-215">La soluzione più semplice a questo problema consiste nell'implementare una classe gestita contenente un insieme di campi statici che a loro volta contengono i riferimenti agli oggetti gestiti ai quali si vuole accedere.</span><span class="sxs-lookup"><span data-stu-id="3d014-215">The simplest solution to this issue is to implement a managed class that contains a set of static fields to hold references to any managed objects that you need access to.</span></span> <span data-ttu-id="3d014-216">Nell'esempio viene usata la classe `WPFPageHost`, che contiene un riferimento al contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] oltre ai valori iniziali di diverse proprietà, modificabili in un secondo momento dall'utente.</span><span class="sxs-lookup"><span data-stu-id="3d014-216">The sample uses the `WPFPageHost` class to hold a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, plus the initial values of a number of its properties that might be changed later by the user.</span></span> <span data-ttu-id="3d014-217">La classe viene definita nell'intestazione.</span><span class="sxs-lookup"><span data-stu-id="3d014-217">This is defined in the header.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageHost](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.h#wpfpagehost)]

 <span data-ttu-id="3d014-218">La seconda parte della funzione `GetHwnd` assegna valori ai suddetti campi che verranno usati in un secondo momento, con `myPage` ancora nell'ambito.</span><span class="sxs-lookup"><span data-stu-id="3d014-218">The latter part of the `GetHwnd` function assigns values to those fields for later use while `myPage` is still in scope.</span></span>

<a name="communicating_with_the_page"></a>
### <a name="communicating-with-the-wpf-content"></a><span data-ttu-id="3d014-219">Comunicazione con il contenuto WPF</span><span class="sxs-lookup"><span data-stu-id="3d014-219">Communicating with the WPF Content</span></span>
 <span data-ttu-id="3d014-220">Esistono due tipi di comunicazione con il contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3d014-220">There are two types of communication with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="3d014-221">L'applicazione riceve informazioni dal [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] del contenuto quando l'utente fa clic il **OK** o **Annulla** pulsanti.</span><span class="sxs-lookup"><span data-stu-id="3d014-221">The application receives information from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content when the user clicks the **OK** or **Cancel** buttons.</span></span> <span data-ttu-id="3d014-222">L'applicazione dispone anche di un'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] che consente di modificare diverse proprietà del contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], ad esempio il colore di sfondo o le dimensioni predefinite del carattere.</span><span class="sxs-lookup"><span data-stu-id="3d014-222">The application also has a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that allows the user to change various [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties, such as the background color or default font size.</span></span>

 <span data-ttu-id="3d014-223">Come indicato in precedenza, quando l'utente fa clic su uno dei pulsanti il contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] genera un evento `OnButtonClicked`.</span><span class="sxs-lookup"><span data-stu-id="3d014-223">As mentioned above, when the user clicks either button the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content raises an `OnButtonClicked` event.</span></span> <span data-ttu-id="3d014-224">L'applicazione associa un gestore a questo evento per ricevere le notifiche.</span><span class="sxs-lookup"><span data-stu-id="3d014-224">The application attaches a handler to this event to receive these notifications.</span></span> <span data-ttu-id="3d014-225">Se il **OK** è stato fatto clic sul pulsante, il gestore ottiene le informazioni utente di [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] del contenuto e lo visualizza in un set di controlli statici.</span><span class="sxs-lookup"><span data-stu-id="3d014-225">If the **OK** button was clicked, the handler gets the user information from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content and displays it in a set of static controls.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFButtonClicked](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wpfbuttonclicked)]

 <span data-ttu-id="3d014-226">Il gestore riceve un oggetto argomento dell'evento personalizzato dal contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], `MyPageEventArgs`.</span><span class="sxs-lookup"><span data-stu-id="3d014-226">The handler receives a custom event argument object from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, `MyPageEventArgs`.</span></span> <span data-ttu-id="3d014-227">L'oggetto `IsOK` è impostata su `true` se il **OK** è stato fatto clic sul pulsante, e `false` se il **Annulla** è stato fatto clic sul pulsante.</span><span class="sxs-lookup"><span data-stu-id="3d014-227">The object's `IsOK` property is set to `true` if the **OK** button was clicked, and `false` if the **Cancel** button was clicked.</span></span>

 <span data-ttu-id="3d014-228">Se il **OK** è stato fatto clic sul pulsante, il gestore ottiene un riferimento al [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenuto dalla classe dei contenitori.</span><span class="sxs-lookup"><span data-stu-id="3d014-228">If the **OK** button was clicked, the handler gets a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content from the container class.</span></span> <span data-ttu-id="3d014-229">Raccoglie quindi le informazioni utente contenute nelle proprietà del contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] associate e sa i controlli statici per visualizzare le informazioni nella finestra padre.</span><span class="sxs-lookup"><span data-stu-id="3d014-229">It then collects the user information that is held by the associated [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties and uses the static controls to display the information on the parent window.</span></span> <span data-ttu-id="3d014-230">Essendo i dati del contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] sotto forma di stringa gestita, devono essere sottoposti a marshalling per l'uso da parte di un controllo [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3d014-230">Because the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content data is in the form of a managed string, it has to be marshaled for use by a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] control.</span></span> <span data-ttu-id="3d014-231">Se il **annullare** è stato fatto clic sul pulsante, il gestore cancella i dati dai controlli statici.</span><span class="sxs-lookup"><span data-stu-id="3d014-231">If the **Cancel** button was clicked, the handler clears the data from the static controls.</span></span>

 <span data-ttu-id="3d014-232">L'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] dell'applicazione fornisce un set di pulsanti di opzione che consentono di modificare il colore di sfondo del contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] e diverse proprietà correlate al tipo di carattere.</span><span class="sxs-lookup"><span data-stu-id="3d014-232">The application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] provides a set of radio buttons that allow the user to modify the background color of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and several font-related properties.</span></span> <span data-ttu-id="3d014-233">Nell'esempio seguente viene illustrato un estratto della procedura di finestra (WndProc) dell'applicazione, nonché la gestione dei messaggi tramite la quale è possibile impostare varie proprietà in messaggi diversi, incluso il colore di sfondo.</span><span class="sxs-lookup"><span data-stu-id="3d014-233">The following example is an excerpt from the application's window procedure (WndProc) and its message handling that sets various properties on different messages, including the background color.</span></span> <span data-ttu-id="3d014-234">La parte restante è simile, pertanto non viene illustrata.</span><span class="sxs-lookup"><span data-stu-id="3d014-234">The others are similar, and are not shown.</span></span> <span data-ttu-id="3d014-235">Vedere l'esempio completo per i dettagli e il contesto.</span><span class="sxs-lookup"><span data-stu-id="3d014-235">See the complete sample for details and context.</span></span>

 [!code-cpp[Win32HostingWPFPage#WMCommandToBG](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wmcommandtobg)]

 <span data-ttu-id="3d014-236">Per impostare il colore di sfondo, ottenere un riferimento al contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] (`hostedPage`) da `WPFPageHost` e impostare la proprietà del colore di sfondo sul colore appropriato.</span><span class="sxs-lookup"><span data-stu-id="3d014-236">To set the background color, get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content (`hostedPage`) from `WPFPageHost` and set the background color property to the appropriate color.</span></span> <span data-ttu-id="3d014-237">Nell'esempio vengono usate tre opzioni di colore: il colore originale, verde chiaro o salmone chiaro.</span><span class="sxs-lookup"><span data-stu-id="3d014-237">The sample uses three color options: the original color, light green, or light salmon.</span></span> <span data-ttu-id="3d014-238">Il colore di sfondo originale viene archiviato come campo statico nella classe `WPFPageHost`.</span><span class="sxs-lookup"><span data-stu-id="3d014-238">The original background color is stored as a static field in the `WPFPageHost` class.</span></span> <span data-ttu-id="3d014-239">Per impostare gli altri due colori, creare un nuovo oggetto <xref:System.Windows.Media.SolidColorBrush> e passare al costruttore un valore di colore statico dall'oggetto <xref:System.Windows.Media.Colors>.</span><span class="sxs-lookup"><span data-stu-id="3d014-239">To set the other two, you create a new <xref:System.Windows.Media.SolidColorBrush> object and pass the constructor a static colors value from the <xref:System.Windows.Media.Colors> object.</span></span>

<a name="implementing_the_wpf_page"></a>
## <a name="implementing-the-wpf-page"></a><span data-ttu-id="3d014-240">Implementazione della pagina WPF</span><span class="sxs-lookup"><span data-stu-id="3d014-240">Implementing the WPF Page</span></span>
 <span data-ttu-id="3d014-241">È possibile ospitare e usare il [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenuto senza alcuna conoscenza dell'implementazione effettiva.</span><span class="sxs-lookup"><span data-stu-id="3d014-241">You can host and use the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content without any knowledge of the actual implementation.</span></span> <span data-ttu-id="3d014-242">Se il [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] era stato incluso nel pacchetto di contenuto in una [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)], compilazione sarebbe potuta avvenire in qualsiasi [!INCLUDE[TLA#tla_clr](../../../../includes/tlasharptla-clr-md.md)] language.</span><span class="sxs-lookup"><span data-stu-id="3d014-242">If the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content had been packaged in a separate [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)], it could have been built in any [!INCLUDE[TLA#tla_clr](../../../../includes/tlasharptla-clr-md.md)] language.</span></span> <span data-ttu-id="3d014-243">Di seguito viene riportata una breve procedura dettagliata relativa all'implementazione [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] usata nell'esempio.</span><span class="sxs-lookup"><span data-stu-id="3d014-243">Following is a brief walkthrough of the [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] implementation that is used in the sample.</span></span> <span data-ttu-id="3d014-244">Questa sezione contiene le sottosezioni seguenti.</span><span class="sxs-lookup"><span data-stu-id="3d014-244">This section contains the following subsections.</span></span>

<a name="autoNestedSectionsOUTLINE2"></a>
-   [<span data-ttu-id="3d014-245">Layout</span><span class="sxs-lookup"><span data-stu-id="3d014-245">Layout</span></span>](#page_layout)

-   [<span data-ttu-id="3d014-246">Restituzione dei dati alla finestra host</span><span class="sxs-lookup"><span data-stu-id="3d014-246">Returning the Data to the Host Window</span></span>](#returning_data_to_window)

-   [<span data-ttu-id="3d014-247">Impostazione delle proprietà WPF</span><span class="sxs-lookup"><span data-stu-id="3d014-247">Setting the WPF Properties</span></span>](#set_page_properties)

<a name="page_layout"></a>
### <a name="layout"></a><span data-ttu-id="3d014-248">Layout</span><span class="sxs-lookup"><span data-stu-id="3d014-248">Layout</span></span>
 <span data-ttu-id="3d014-249">Il [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elementi nel [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenuti sono costituiti da cinque <xref:System.Windows.Controls.TextBox> controlli, a associati <xref:System.Windows.Controls.Label> controlli: nome, indirizzo, City, State e Zip.</span><span class="sxs-lookup"><span data-stu-id="3d014-249">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elements in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content consist of five <xref:System.Windows.Controls.TextBox> controls, with associated <xref:System.Windows.Controls.Label> controls: Name, Address, City, State, and Zip.</span></span> <span data-ttu-id="3d014-250">Esistono inoltre due <xref:System.Windows.Controls.Button> controlli **OK** e **Annulla**</span><span class="sxs-lookup"><span data-stu-id="3d014-250">There are also two <xref:System.Windows.Controls.Button> controls, **OK** and **Cancel**</span></span>

 <span data-ttu-id="3d014-251">Il contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] è implementato nella classe `WPFPage`.</span><span class="sxs-lookup"><span data-stu-id="3d014-251">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented in the `WPFPage` class.</span></span> <span data-ttu-id="3d014-252">Il layout viene gestito mediante un apposito elemento <xref:System.Windows.Controls.Grid>.</span><span class="sxs-lookup"><span data-stu-id="3d014-252">Layout is handled with a <xref:System.Windows.Controls.Grid> layout element.</span></span> <span data-ttu-id="3d014-253">La classe eredita da <xref:System.Windows.Controls.Grid>, il che la rende effettivamente l'elemento radice del contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3d014-253">The class inherits from <xref:System.Windows.Controls.Grid>, which effectively makes it the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content root element.</span></span>

 <span data-ttu-id="3d014-254">Il [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenuto costruttore accetta la larghezza e altezza e dimensioni di <xref:System.Windows.Controls.Grid> conseguenza.</span><span class="sxs-lookup"><span data-stu-id="3d014-254">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content constructor takes the required width and height, and sizes the <xref:System.Windows.Controls.Grid> accordingly.</span></span> <span data-ttu-id="3d014-255">Definisce quindi il layout di base tramite la creazione di un set di <xref:System.Windows.Controls.ColumnDefinition> e <xref:System.Windows.Controls.RowDefinition> gli oggetti e ad aggiungerle nel <xref:System.Windows.Controls.Grid> base dell'oggetto <xref:System.Windows.Controls.Grid.ColumnDefinitions%2A> e <xref:System.Windows.Controls.Grid.RowDefinitions%2A> raccolte, rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="3d014-255">It then defines the basic layout by creating a set of <xref:System.Windows.Controls.ColumnDefinition> and <xref:System.Windows.Controls.RowDefinition> objects and adding them to the <xref:System.Windows.Controls.Grid> object base <xref:System.Windows.Controls.Grid.ColumnDefinitions%2A> and <xref:System.Windows.Controls.Grid.RowDefinitions%2A> collections, respectively.</span></span> <span data-ttu-id="3d014-256">Viene così definita una griglia di cinque righe e sette colonne, le cui dimensioni sono determinate dal contenuto delle celle.</span><span class="sxs-lookup"><span data-stu-id="3d014-256">This defines a grid of five rows and seven columns, with the dimensions determined by the contents of the cells.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCtorToGridDef](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectortogriddef)]

 <span data-ttu-id="3d014-257">Successivamente il costruttore aggiunge gli elementi dell'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] a <xref:System.Windows.Controls.Grid>.</span><span class="sxs-lookup"><span data-stu-id="3d014-257">Next, the constructor adds the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elements to the <xref:System.Windows.Controls.Grid>.</span></span> <span data-ttu-id="3d014-258">Il primo elemento è il testo del titolo, ovvero un controllo <xref:System.Windows.Controls.Label> centrato nella prima riga della griglia.</span><span class="sxs-lookup"><span data-stu-id="3d014-258">The first element is the title text, which is a <xref:System.Windows.Controls.Label> control that is centered in the first row of the grid.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCtorTitle](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectortitle)]

 <span data-ttu-id="3d014-259">La riga successiva contiene il controllo <xref:System.Windows.Controls.Label> Name e il controllo <xref:System.Windows.Controls.TextBox> associato.</span><span class="sxs-lookup"><span data-stu-id="3d014-259">The next row contains the Name <xref:System.Windows.Controls.Label> control and its associated <xref:System.Windows.Controls.TextBox> control.</span></span> <span data-ttu-id="3d014-260">Dal momento che per ogni coppia etichetta/casella di testo viene usato lo stesso codice, questo viene collocato in una coppia di metodi privati e usato per tutte e cinque le coppie etichetta/casella di testo.</span><span class="sxs-lookup"><span data-stu-id="3d014-260">Because the same code is used for each label/textbox pair, it is placed in a pair of private methods and used for all five label/textbox pairs.</span></span> <span data-ttu-id="3d014-261">I metodi creano il controllo appropriato e chiamano i metodi <xref:System.Windows.Controls.Grid> e <xref:System.Windows.Controls.Grid.SetColumn%2A> statici della classe <xref:System.Windows.Controls.Grid.SetRow%2A> per posizionare i controlli nella cella appropriata.</span><span class="sxs-lookup"><span data-stu-id="3d014-261">The methods create the appropriate control, and call the <xref:System.Windows.Controls.Grid> class static <xref:System.Windows.Controls.Grid.SetColumn%2A> and <xref:System.Windows.Controls.Grid.SetRow%2A> methods to place the controls in the appropriate cell.</span></span> <span data-ttu-id="3d014-262">Una volta creato il controllo, nell'esempio viene chiamato il metodo <xref:System.Windows.Controls.UIElementCollection.Add%2A> sulla proprietà <xref:System.Windows.Controls.Panel.Children%2A> di <xref:System.Windows.Controls.Grid> per aggiungere il controllo alla griglia.</span><span class="sxs-lookup"><span data-stu-id="3d014-262">After the control is created, the sample calls the <xref:System.Windows.Controls.UIElementCollection.Add%2A> method on the <xref:System.Windows.Controls.Panel.Children%2A> property of the <xref:System.Windows.Controls.Grid> to add the control to the grid.</span></span> <span data-ttu-id="3d014-263">Il codice usato per aggiungere le coppie etichetta/casella di testo restanti è simile.</span><span class="sxs-lookup"><span data-stu-id="3d014-263">The code to add the remaining label/textbox pairs is similar.</span></span> <span data-ttu-id="3d014-264">Vedere il codice di esempio per i dettagli.</span><span class="sxs-lookup"><span data-stu-id="3d014-264">See the sample code for details.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCtorName](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectorname)]

 <span data-ttu-id="3d014-265">D seguito viene riportata l'implementazione dei due metodi:</span><span class="sxs-lookup"><span data-stu-id="3d014-265">The implementation of the two methods is as follows:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCreateHelpers](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagecreatehelpers)]

 <span data-ttu-id="3d014-266">Infine, l'esempio aggiunge il **OK** e **Annulla** pulsanti e associa un gestore eventi per loro <xref:System.Windows.Controls.Primitives.ButtonBase.Click> gli eventi.</span><span class="sxs-lookup"><span data-stu-id="3d014-266">Finally, the sample adds the **OK** and **Cancel** buttons and attaches an event handler to their <xref:System.Windows.Controls.Primitives.ButtonBase.Click> events.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCtorButtonsEvents](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectorbuttonsevents)]

<a name="returning_data_to_window"></a>
### <a name="returning-the-data-to-the-host-window"></a><span data-ttu-id="3d014-267">Restituzione dei dati alla finestra host</span><span class="sxs-lookup"><span data-stu-id="3d014-267">Returning the Data to the Host Window</span></span>
 <span data-ttu-id="3d014-268">Facendo clic su un pulsante, viene generato il rispettivo evento <xref:System.Windows.Controls.Primitives.ButtonBase.Click>.</span><span class="sxs-lookup"><span data-stu-id="3d014-268">When either button is clicked, its <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event is raised.</span></span> <span data-ttu-id="3d014-269">La finestra host potrebbe semplicemente associare i gestori a questi eventi e ottenere i dati direttamente dai controlli <xref:System.Windows.Controls.TextBox>.</span><span class="sxs-lookup"><span data-stu-id="3d014-269">The host window could simply attach handlers to these events and get the data directly from the <xref:System.Windows.Controls.TextBox> controls.</span></span> <span data-ttu-id="3d014-270">Nell'esempio viene usato un approccio meno diretto.</span><span class="sxs-lookup"><span data-stu-id="3d014-270">The sample uses a somewhat less direct approach.</span></span> <span data-ttu-id="3d014-271">Gestisce il <xref:System.Windows.Controls.Primitives.ButtonBase.Click> all'interno di [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] del contenuto e quindi genera un evento personalizzato `OnButtonClicked`per notificare il [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenuto.</span><span class="sxs-lookup"><span data-stu-id="3d014-271">It handles the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> within the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and then raises a custom event `OnButtonClicked`, to notify the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="3d014-272">In questo modo il [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] ritiene sufficiente eseguire la convalida dei parametri prima di notificare l'host.</span><span class="sxs-lookup"><span data-stu-id="3d014-272">This allows the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to do some parameter validation before notifying the host.</span></span> <span data-ttu-id="3d014-273">Il gestore ottiene il testo dai controlli <xref:System.Windows.Controls.TextBox> e lo assegna a proprietà pubbliche, dalle quali l'host può recuperare le informazioni.</span><span class="sxs-lookup"><span data-stu-id="3d014-273">The handler gets the text from the <xref:System.Windows.Controls.TextBox> controls and assigns it to public properties, from which the host can retrieve the information.</span></span>

 <span data-ttu-id="3d014-274">Dichiarazione di evento in WPFPage.h:</span><span class="sxs-lookup"><span data-stu-id="3d014-274">The event declaration, in WPFPage.h:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageEventDecl](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.h#wpfpageeventdecl)]

 <span data-ttu-id="3d014-275">Gestore eventi <xref:System.Windows.Controls.Primitives.ButtonBase.Click> in WPFPage.cpp:</span><span class="sxs-lookup"><span data-stu-id="3d014-275">The <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler, in WPFPage.cpp:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageButtonClicked](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagebuttonclicked)]

<a name="set_page_properties"></a>
### <a name="setting-the-wpf-properties"></a><span data-ttu-id="3d014-276">Impostazione delle proprietà WPF</span><span class="sxs-lookup"><span data-stu-id="3d014-276">Setting the WPF Properties</span></span>
 <span data-ttu-id="3d014-277">Il [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] host consente all'utente di modificare diverse [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] proprietà del contenuto.</span><span class="sxs-lookup"><span data-stu-id="3d014-277">The [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] host allows the user to change several [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties.</span></span> <span data-ttu-id="3d014-278">Dal lato di [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)], si tratta semplicemente di modificare le proprietà.</span><span class="sxs-lookup"><span data-stu-id="3d014-278">From the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] side, it is simply a matter of changing the properties.</span></span> <span data-ttu-id="3d014-279">L'implementazione nella classe del contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] è leggermente più complessa, poiché non esiste un'unica proprietà globale che controlla i tipi di carattere per tutti i controlli.</span><span class="sxs-lookup"><span data-stu-id="3d014-279">The implementation in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class is somewhat more complicated, because there is no single global property that controls the fonts for all controls.</span></span> <span data-ttu-id="3d014-280">La proprietà adatta per ogni controllo viene modificata nelle funzioni di accesso dell'insieme di proprietà.</span><span class="sxs-lookup"><span data-stu-id="3d014-280">Instead, the appropriate property for each control is changed in the properties' set accessors.</span></span> <span data-ttu-id="3d014-281">L'esempio seguente mostra il codice per il `DefaultFontFamily` proprietà.</span><span class="sxs-lookup"><span data-stu-id="3d014-281">The following example shows the code for the `DefaultFontFamily` property.</span></span> <span data-ttu-id="3d014-282">Impostando la proprietà, viene chiamato un metodo privato che a sua volta imposta le proprietà <xref:System.Windows.Controls.Control.FontFamily%2A> per i vari controlli.</span><span class="sxs-lookup"><span data-stu-id="3d014-282">Setting the property calls a private method that in turn sets the <xref:System.Windows.Controls.Control.FontFamily%2A> properties for the various controls.</span></span>

 <span data-ttu-id="3d014-283">Da WPFPage.h:</span><span class="sxs-lookup"><span data-stu-id="3d014-283">From WPFPage.h:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageFontFamilyProperty](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.h#wpfpagefontfamilyproperty)]

 <span data-ttu-id="3d014-284">Da WPFPage.cpp:</span><span class="sxs-lookup"><span data-stu-id="3d014-284">From WPFPage.cpp:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageSetFontFamily](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagesetfontfamily)]

## <a name="see-also"></a><span data-ttu-id="3d014-285">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="3d014-285">See Also</span></span>

- <xref:System.Windows.Interop.HwndSource>
- [<span data-ttu-id="3d014-286">Interoperatività di WPF e Win32</span><span class="sxs-lookup"><span data-stu-id="3d014-286">WPF and Win32 Interoperation</span></span>](../../../../docs/framework/wpf/advanced/wpf-and-win32-interoperation.md)