---
title: Cenni preliminari sugli eventi indirizzati
description: Informazioni sugli eventi indirizzati in Windows Presentation Foundation, tra cui il modo in cui vengono instradati tramite un albero degli elementi e come creare eventi indirizzati personalizzati.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- attached events [WPF]
- grouped button set [WPF]
- routed events [WPF]
- events [WPF], routed
- tunneling [WPF]
- events [WPF], attached
- routing strategies for events [WPF]
- button set [WPF], grouped
- bubbling [WPF]
ms.assetid: 1a2189ae-13b4-45b0-b12c-8de2e49c29d2
ms.openlocfilehash: d18b511a4886c68922cccac14942eb54e5735a71
ms.sourcegitcommit: 87cfeb69226fef01acb17c56c86f978f4f4a13db
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/24/2020
ms.locfileid: "87164807"
---
# <a name="routed-events-overview"></a><span data-ttu-id="4dad3-103">Cenni preliminari sugli eventi indirizzati</span><span class="sxs-lookup"><span data-stu-id="4dad3-103">Routed Events Overview</span></span>

<span data-ttu-id="4dad3-104">Questo argomento descrive il concetto di eventi indirizzati in [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4dad3-104">This topic describes the concept of routed events in [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)].</span></span> <span data-ttu-id="4dad3-105">L'argomento definisce la terminologia correlata agli eventi indirizzati, descrive in che modo questi eventi sono indirizzati lungo un albero di elementi, riepiloga le modalità di gestione degli eventi indirizzati e spiega come creare eventi indirizzati personalizzati.</span><span class="sxs-lookup"><span data-stu-id="4dad3-105">The topic defines routed events terminology, describes how routed events are routed through a tree of elements, summarizes how you handle routed events, and introduces how to create your own custom routed events.</span></span>

<a name="prerequisites"></a>

## <a name="prerequisites"></a><span data-ttu-id="4dad3-106">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="4dad3-106">Prerequisites</span></span>

<span data-ttu-id="4dad3-107">In questo argomento si presuppone la conoscenza di base del Common Language Runtime (CLR) e della programmazione orientata a oggetti, nonché il concetto di come le relazioni tra [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] gli elementi possano essere concettuali come albero.</span><span class="sxs-lookup"><span data-stu-id="4dad3-107">This topic assumes that you have basic knowledge of the common language runtime (CLR) and object-oriented programming, as well as the concept of how the relationships between [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elements can be conceptualized as a tree.</span></span> <span data-ttu-id="4dad3-108">Per seguire gli esempi illustrati in questo argomento, è anche necessario conoscere [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] e saper scrivere applicazioni o pagine [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] di base.</span><span class="sxs-lookup"><span data-stu-id="4dad3-108">In order to follow the examples in this topic, you should also understand [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] and know how to write very basic [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] applications or pages.</span></span> <span data-ttu-id="4dad3-109">Per ulteriori informazioni, vedere [procedura dettagliata: applicazione desktop WPF](../getting-started/walkthrough-my-first-wpf-desktop-application.md) e [Cenni preliminari su XAML (WPF)](../../../desktop-wpf/fundamentals/xaml.md).</span><span class="sxs-lookup"><span data-stu-id="4dad3-109">For more information, see [Walkthrough: My first WPF desktop application](../getting-started/walkthrough-my-first-wpf-desktop-application.md) and [XAML Overview (WPF)](../../../desktop-wpf/fundamentals/xaml.md).</span></span>

<a name="routing"></a>

## <a name="what-is-a-routed-event"></a><span data-ttu-id="4dad3-110">Definizione di evento indirizzato</span><span class="sxs-lookup"><span data-stu-id="4dad3-110">What Is a Routed Event?</span></span>

<span data-ttu-id="4dad3-111">È possibile considerare gli eventi indirizzati da un punto di vista funzionale o da una prospettiva di implementazione.</span><span class="sxs-lookup"><span data-stu-id="4dad3-111">You can think about routed events either from a functional or implementation perspective.</span></span> <span data-ttu-id="4dad3-112">In questo argomento sono illustrati entrambi i concetti, perché alcuni utenti trovano più utile il primo e altri il secondo.</span><span class="sxs-lookup"><span data-stu-id="4dad3-112">Both definitions are presented here, because some people find one or the other definition more useful.</span></span>

<span data-ttu-id="4dad3-113">Definizione funzionale: un evento indirizzato è un tipo di evento che può richiamare gestori su più listener in un albero degli elementi invece che solo sull'oggetto che ha generato l'evento.</span><span class="sxs-lookup"><span data-stu-id="4dad3-113">Functional definition: A routed event is a type of event that can invoke handlers on multiple listeners in an element tree, rather than just on the object that raised the event.</span></span>

<span data-ttu-id="4dad3-114">Definizione di implementazione: un evento indirizzato è un evento CLR supportato da un'istanza della <xref:System.Windows.RoutedEvent> classe e viene elaborato dal [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] sistema di eventi.</span><span class="sxs-lookup"><span data-stu-id="4dad3-114">Implementation definition: A routed event is a CLR event that is backed by an instance of the <xref:System.Windows.RoutedEvent> class and is processed by the [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] event system.</span></span>

<span data-ttu-id="4dad3-115">Un'applicazione [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] tipica contiene molti elementi.</span><span class="sxs-lookup"><span data-stu-id="4dad3-115">A typical [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application contains many elements.</span></span> <span data-ttu-id="4dad3-116">Indipendentemente dal fatto che vengano creati nel codice o dichiarati in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], questi elementi sono legati tra loro da una relazione di albero degli elementi.</span><span class="sxs-lookup"><span data-stu-id="4dad3-116">Whether created in code or declared in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], these elements exist in an element tree relationship to each other.</span></span> <span data-ttu-id="4dad3-117">La route dell'evento può procedere in una di due direzioni, in base alla definizione dell'evento, ma generalmente parte dall'elemento di origine e sale (bubbling) lungo l'albero degli elementi fino a raggiunge la radice dell'albero (in genere una pagina o una finestra).</span><span class="sxs-lookup"><span data-stu-id="4dad3-117">The event route can travel in one of two directions depending on the event definition, but generally the route travels from the source element and then "bubbles" upward through the element tree until it reaches the element tree root (typically a page or a window).</span></span> <span data-ttu-id="4dad3-118">Questo concetto di bubbling può risultare familiare a chi in precedenza ha già usato il modello a oggetti DHTML.</span><span class="sxs-lookup"><span data-stu-id="4dad3-118">This bubbling concept might be familiar to you if you have worked with the DHTML object model previously.</span></span>

<span data-ttu-id="4dad3-119">Considerare il semplice albero degli elementi seguente:</span><span class="sxs-lookup"><span data-stu-id="4dad3-119">Consider the following simple element tree:</span></span>

[!code-xaml[EventOvwSupport#GroupButton](~/samples/snippets/csharp/VS_Snippets_Wpf/EventOvwSupport/CSharp/default.xaml#groupbutton)]

<span data-ttu-id="4dad3-120">Questo albero degli elementi produce un risultato analogo al seguente:</span><span class="sxs-lookup"><span data-stu-id="4dad3-120">This element tree produces something like the following:</span></span>

<span data-ttu-id="4dad3-121">![Pulsanti Sì, no e Annulla](./media/routedevent-ovw-1.gif "RoutedEvent_ovw_1")</span><span class="sxs-lookup"><span data-stu-id="4dad3-121">![Yes, No, and Cancel buttons](./media/routedevent-ovw-1.gif "RoutedEvent_ovw_1")</span></span>

<span data-ttu-id="4dad3-122">In questo albero di elementi semplificato, l'origine di un <xref:System.Windows.Controls.Primitives.ButtonBase.Click> evento è uno degli <xref:System.Windows.Controls.Button> elementi e qualunque sia <xref:System.Windows.Controls.Button> stato selezionato è il primo elemento che ha la possibilità di gestire l'evento.</span><span class="sxs-lookup"><span data-stu-id="4dad3-122">In this simplified element tree, the source of a <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event is one of the <xref:System.Windows.Controls.Button> elements, and whichever <xref:System.Windows.Controls.Button> was clicked is the first element that has the opportunity to handle the event.</span></span> <span data-ttu-id="4dad3-123">Tuttavia, se nessun gestore associato a <xref:System.Windows.Controls.Button> agisce sull'evento, l'evento verrà ribolle verso l'alto nell'albero degli <xref:System.Windows.Controls.Button> elementi, che è l'oggetto <xref:System.Windows.Controls.StackPanel> .</span><span class="sxs-lookup"><span data-stu-id="4dad3-123">But if no handler attached to the <xref:System.Windows.Controls.Button> acts on the event, then the event will bubble upwards to the <xref:System.Windows.Controls.Button> parent in the element tree, which is the <xref:System.Windows.Controls.StackPanel>.</span></span> <span data-ttu-id="4dad3-124">Potenzialmente, l'evento viene sottoposta a bubbling <xref:System.Windows.Controls.Border> e quindi oltre alla radice della pagina dell'albero degli elementi (non mostrato).</span><span class="sxs-lookup"><span data-stu-id="4dad3-124">Potentially, the event bubbles to <xref:System.Windows.Controls.Border>, and then beyond to the page root of the element tree (not shown).</span></span>

<span data-ttu-id="4dad3-125">In altre parole, la route dell'evento per questo <xref:System.Windows.Controls.Primitives.ButtonBase.Click> evento è:</span><span class="sxs-lookup"><span data-stu-id="4dad3-125">In other words, the event route for this <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event is:</span></span>

<span data-ttu-id="4dad3-126">Button-->StackPanel-->Border-->...</span><span class="sxs-lookup"><span data-stu-id="4dad3-126">Button-->StackPanel-->Border-->...</span></span>

### <a name="top-level-scenarios-for-routed-events"></a><span data-ttu-id="4dad3-127">Scenari principali per gli eventi indirizzati</span><span class="sxs-lookup"><span data-stu-id="4dad3-127">Top-level Scenarios for Routed Events</span></span>

<span data-ttu-id="4dad3-128">Di seguito è riportato un breve riepilogo degli scenari in cui è stato motivato il concetto di evento indirizzato e il motivo per cui un tipico evento CLR non era adatto a questi scenari:</span><span class="sxs-lookup"><span data-stu-id="4dad3-128">The following is a brief summary of the scenarios that motivated the routed event concept, and why a typical CLR event was not adequate for these scenarios:</span></span>

<span data-ttu-id="4dad3-129">**Composizione e incapsulamento di controlli**: diversi controlli di [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] hanno un modello di contenuto avanzato.</span><span class="sxs-lookup"><span data-stu-id="4dad3-129">**Control composition and encapsulation:** Various controls in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] have a rich content model.</span></span> <span data-ttu-id="4dad3-130">Ad esempio, è possibile inserire un'immagine all'interno di un oggetto <xref:System.Windows.Controls.Button> , che estende efficacemente la struttura ad albero visuale del pulsante.</span><span class="sxs-lookup"><span data-stu-id="4dad3-130">For example, you can place an image inside of a <xref:System.Windows.Controls.Button>, which effectively extends the visual tree of the button.</span></span> <span data-ttu-id="4dad3-131">Tuttavia, l'immagine aggiunta non deve interrompere il comportamento di hit testing che fa in modo che un pulsante risponda a un <xref:System.Windows.Controls.Primitives.ButtonBase.Click> del contenuto, anche se l'utente fa clic su pixel che fanno tecnicamente parte dell'immagine.</span><span class="sxs-lookup"><span data-stu-id="4dad3-131">However, the added image must not break the hit-testing behavior that causes a button to respond to a <xref:System.Windows.Controls.Primitives.ButtonBase.Click> of its content, even if the user clicks on pixels that are technically part of the image.</span></span>

<span data-ttu-id="4dad3-132">**Punti di collegamento del gestore singolari:** In Windows Forms, è necessario alleghi più volte lo stesso gestore per elaborare gli eventi che possono essere generati da più elementi.</span><span class="sxs-lookup"><span data-stu-id="4dad3-132">**Singular handler attachment points:** In Windows Forms, you would have to attach the same handler multiple times to process events that could be raised from multiple elements.</span></span> <span data-ttu-id="4dad3-133">Gli eventi indirizzati consentono di associare il gestore una sola volta, come illustrato nell'esempio precedente, e di usare la logica del gestore per determinare da dove proviene l'evento, se necessario.</span><span class="sxs-lookup"><span data-stu-id="4dad3-133">Routed events enable you to attach that handler only once, as was shown in the previous example, and use handler logic to determine where the event came from if necessary.</span></span> <span data-ttu-id="4dad3-134">Ad esempio, questo potrebbe essere il gestore per il codice [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] illustrato in precedenza:</span><span class="sxs-lookup"><span data-stu-id="4dad3-134">For instance, this might be the handler for the previously shown [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]:</span></span>

[!code-csharp[EventOvwSupport#GroupButtonCodeBehind](~/samples/snippets/csharp/VS_Snippets_Wpf/EventOvwSupport/CSharp/default.xaml.cs#groupbuttoncodebehind)]
[!code-vb[EventOvwSupport#GroupButtonCodeBehind](~/samples/snippets/visualbasic/VS_Snippets_Wpf/EventOvwSupport/visualbasic/default.xaml.vb#groupbuttoncodebehind)]

<span data-ttu-id="4dad3-135">**Gestione delle classi**: gli eventi indirizzati consentono un gestore statico definito dalla classe.</span><span class="sxs-lookup"><span data-stu-id="4dad3-135">**Class handling:** Routed events permit a static handler that is defined by the class.</span></span> <span data-ttu-id="4dad3-136">Questo gestore di classi ha la possibilità di gestire un evento prima di qualsiasi gestore di istanze associato.</span><span class="sxs-lookup"><span data-stu-id="4dad3-136">This class handler has the opportunity to handle an event before any attached instance handlers can.</span></span>

<span data-ttu-id="4dad3-137">**Riferimento a un evento senza reflection**: alcune tecniche di codice e di markup richiedono un modo per identificare un evento specifico.</span><span class="sxs-lookup"><span data-stu-id="4dad3-137">**Referencing an event without reflection:** Certain code and markup techniques require a way to identify a specific event.</span></span> <span data-ttu-id="4dad3-138">Un evento indirizzato crea un <xref:System.Windows.RoutedEvent> campo come identificatore, che fornisce una tecnica di identificazione degli eventi affidabile che non richiede la reflection statica o in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="4dad3-138">A routed event creates a <xref:System.Windows.RoutedEvent> field as an identifier, which provides a robust event identification technique that does not require static or run-time reflection.</span></span>

### <a name="how-routed-events-are-implemented"></a><span data-ttu-id="4dad3-139">Modalità di implementazione degli eventi indirizzati</span><span class="sxs-lookup"><span data-stu-id="4dad3-139">How Routed Events Are Implemented</span></span>

<span data-ttu-id="4dad3-140">Un evento indirizzato è un evento CLR supportato da un'istanza della <xref:System.Windows.RoutedEvent> classe e registrato con il [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] sistema di eventi.</span><span class="sxs-lookup"><span data-stu-id="4dad3-140">A routed event is a CLR event that is backed by an instance of the <xref:System.Windows.RoutedEvent> class and registered with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] event system.</span></span> <span data-ttu-id="4dad3-141">L' <xref:System.Windows.RoutedEvent> istanza ottenuta dalla registrazione viene in genere mantenuta come `public` `static` `readonly` membro del campo della classe che esegue la registrazione e quindi "proprietario" dell'evento indirizzato.</span><span class="sxs-lookup"><span data-stu-id="4dad3-141">The <xref:System.Windows.RoutedEvent> instance obtained from registration is typically retained as a `public` `static` `readonly` field member of the class that registers and thus "owns" the routed event.</span></span> <span data-ttu-id="4dad3-142">La connessione all'evento CLR con nome identico (a volte definito evento "wrapper") viene eseguita eseguendo l'override delle `add` `remove` implementazioni e per l'evento CLR.</span><span class="sxs-lookup"><span data-stu-id="4dad3-142">The connection to the identically named CLR event (which is sometimes termed the "wrapper" event) is accomplished by overriding the `add` and `remove` implementations for the CLR event.</span></span> <span data-ttu-id="4dad3-143">Normalmente, `add` e `remove` vengono lasciati come impostazione predefinita implicita che usa la sintassi di evento specifica del linguaggio per aggiungere e rimuovere i gestori dell'evento.</span><span class="sxs-lookup"><span data-stu-id="4dad3-143">Ordinarily, the `add` and `remove` are left as an implicit default that uses the appropriate language-specific event syntax for adding and removing handlers of that event.</span></span> <span data-ttu-id="4dad3-144">Il meccanismo di backup e di connessione degli eventi indirizzati è concettualmente simile al modo in cui una proprietà di dipendenza è una proprietà CLR supportata dalla <xref:System.Windows.DependencyProperty> classe e registrata con il [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] sistema di proprietà.</span><span class="sxs-lookup"><span data-stu-id="4dad3-144">The routed event backing and connection mechanism is conceptually similar to how a dependency property is a CLR property that is backed by the <xref:System.Windows.DependencyProperty> class and registered with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] property system.</span></span>

<span data-ttu-id="4dad3-145">Nell'esempio seguente viene illustrata la dichiarazione per un `Tap` evento indirizzato personalizzato, incluse la registrazione e l'esposizione del <xref:System.Windows.RoutedEvent> campo identificatore e le `add` `remove` implementazioni e per l' `Tap` evento CLR.</span><span class="sxs-lookup"><span data-stu-id="4dad3-145">The following example shows the declaration for a custom `Tap` routed event, including the registration and exposure of the <xref:System.Windows.RoutedEvent> identifier field and the `add` and `remove` implementations for the `Tap` CLR event.</span></span>

[!code-csharp[RoutedEventCustom#AddRemoveHandler](~/samples/snippets/csharp/VS_Snippets_Wpf/RoutedEventCustom/CSharp/SDKSampleLibrary/class1.cs#addremovehandler)]
[!code-vb[RoutedEventCustom#AddRemoveHandler](~/samples/snippets/visualbasic/VS_Snippets_Wpf/RoutedEventCustom/VB/SDKSampleLibrary/Class1.vb#addremovehandler)]

### <a name="routed-event-handlers-and-xaml"></a><span data-ttu-id="4dad3-146">Gestori di eventi indirizzati e XAML</span><span class="sxs-lookup"><span data-stu-id="4dad3-146">Routed Event Handlers and XAML</span></span>

<span data-ttu-id="4dad3-147">Per aggiungere un gestore per un evento usando [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], il nome dell'evento deve essere dichiarato come attributo dell'elemento che è un listener di eventi.</span><span class="sxs-lookup"><span data-stu-id="4dad3-147">To add a handler for an event using [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], you declare the event name as an attribute on the element that is an event listener.</span></span> <span data-ttu-id="4dad3-148">Il valore dell'attributo è il nome del metodo del gestore implementato, che deve trovarsi nella classe parziale del file code-behind.</span><span class="sxs-lookup"><span data-stu-id="4dad3-148">The value of the attribute is the name of your implemented handler method, which must exist in the partial class of the code-behind file.</span></span>

[!code-xaml[EventOvwSupport#SimplestSyntax](~/samples/snippets/csharp/VS_Snippets_Wpf/EventOvwSupport/CSharp/default.xaml#simplestsyntax)]

<span data-ttu-id="4dad3-149">La [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] sintassi per l'aggiunta di gestori eventi CLR standard è la stessa per l'aggiunta di gestori di eventi indirizzati, perché si aggiungono effettivamente gestori al wrapper di eventi CLR, che include un'implementazione di eventi indirizzati sotto.</span><span class="sxs-lookup"><span data-stu-id="4dad3-149">The [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] syntax for adding standard CLR event handlers is the same for adding routed event handlers, because you are really adding handlers to the CLR event wrapper, which has a routed event implementation underneath.</span></span> <span data-ttu-id="4dad3-150">Per altre informazioni sull'aggiunta di gestori eventi in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], vedere [Cenni preliminari su XAML (WPF)](../../../desktop-wpf/fundamentals/xaml.md).</span><span class="sxs-lookup"><span data-stu-id="4dad3-150">For more information about adding event handlers in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], see [XAML Overview (WPF)](../../../desktop-wpf/fundamentals/xaml.md).</span></span>

<a name="routing_strategies"></a>

## <a name="routing-strategies"></a><span data-ttu-id="4dad3-151">Strategie di routing</span><span class="sxs-lookup"><span data-stu-id="4dad3-151">Routing Strategies</span></span>

<span data-ttu-id="4dad3-152">Gli eventi indirizzati usano una delle tre strategie di routing illustrate di seguito:</span><span class="sxs-lookup"><span data-stu-id="4dad3-152">Routed events use one of three routing strategies:</span></span>

- <span data-ttu-id="4dad3-153">**Bubbling**: vengono richiamati i gestori eventi sull'origine dell'evento.</span><span class="sxs-lookup"><span data-stu-id="4dad3-153">**Bubbling:** Event handlers on the event source are invoked.</span></span> <span data-ttu-id="4dad3-154">L'evento indirizzato viene quindi indirizzato agli elementi padre successivi fino a raggiungere la radice dell'albero degli elementi.</span><span class="sxs-lookup"><span data-stu-id="4dad3-154">The routed event then routes to successive parent elements until reaching the element tree root.</span></span> <span data-ttu-id="4dad3-155">La maggior parte degli eventi indirizzati usa la strategia di bubbling.</span><span class="sxs-lookup"><span data-stu-id="4dad3-155">Most routed events use the bubbling routing strategy.</span></span> <span data-ttu-id="4dad3-156">Gli eventi indirizzati di bubbling vengono in genere usati per segnalare l'input o le modifiche dello stato da controlli distinti o altri elementi dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="4dad3-156">Bubbling routed events are generally used to report input or state changes from distinct controls or other UI elements.</span></span>

- <span data-ttu-id="4dad3-157">**Diretto**: solo l'elemento di origine può richiamare i gestori in risposta.</span><span class="sxs-lookup"><span data-stu-id="4dad3-157">**Direct:** Only the source element itself is given the opportunity to invoke handlers in response.</span></span> <span data-ttu-id="4dad3-158">Questo è analogo al "routing" usato Windows Forms per gli eventi.</span><span class="sxs-lookup"><span data-stu-id="4dad3-158">This is analogous to the "routing" that Windows Forms uses for events.</span></span> <span data-ttu-id="4dad3-159">Tuttavia, a differenza di un evento CLR standard, gli eventi indirizzati diretti supportano la gestione delle classi (la gestione delle classi viene illustrata in una sezione imminente) e può essere usata da <xref:System.Windows.EventSetter> e <xref:System.Windows.EventTrigger> .</span><span class="sxs-lookup"><span data-stu-id="4dad3-159">However, unlike a standard CLR event, direct routed events support class handling (class handling is explained in an upcoming section) and can be used by <xref:System.Windows.EventSetter> and <xref:System.Windows.EventTrigger>.</span></span>

- <span data-ttu-id="4dad3-160">**Tunneling**: inizialmente vengono richiamati i gestori eventi alla radice dell'albero degli elementi.</span><span class="sxs-lookup"><span data-stu-id="4dad3-160">**Tunneling:** Initially, event handlers at the element tree root are invoked.</span></span> <span data-ttu-id="4dad3-161">L'evento indirizzato percorre quindi una route attraverso elementi figlio successivi, verso l'elemento nodo che rappresenta l'origine dell'evento indirizzato (l'elemento che ha generato l'evento indirizzato).</span><span class="sxs-lookup"><span data-stu-id="4dad3-161">The routed event then travels a route through successive child elements along the route, towards the node element that is the routed event source (the element that raised the routed event).</span></span> <span data-ttu-id="4dad3-162">Gli eventi indirizzati di tunneling vengono spesso usati o gestiti come parte della composizione di un controllo, in modo che gli eventi di parti composite possano essere deliberatamente eliminati o sostituiti da eventi specifici del controllo completo.</span><span class="sxs-lookup"><span data-stu-id="4dad3-162">Tunneling routed events are often used or handled as part of the compositing for a control, such that events from composite parts can be deliberately suppressed or replaced by events that are specific to the complete control.</span></span> <span data-ttu-id="4dad3-163">Gli eventi di input forniti in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] vengono spesso implementati come coppia di tunneling/bubbling.</span><span class="sxs-lookup"><span data-stu-id="4dad3-163">Input events provided in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] often come implemented as a tunneling/bubbling pair.</span></span> <span data-ttu-id="4dad3-164">Gli eventi di tunneling sono talvolta anche detti eventi di anteprima, per una convenzione di denominazione usata per le coppie.</span><span class="sxs-lookup"><span data-stu-id="4dad3-164">Tunneling events are also sometimes referred to as Preview events, because of a naming convention that is used for the pairs.</span></span>

<a name="why_use"></a>

## <a name="why-use-routed-events"></a><span data-ttu-id="4dad3-165">Vantaggi offerti dall'uso degli eventi indirizzati</span><span class="sxs-lookup"><span data-stu-id="4dad3-165">Why Use Routed Events?</span></span>

<span data-ttu-id="4dad3-166">Per gli sviluppatori di applicazioni non è sempre necessario o importante sapere se l'evento gestito è implementato come evento indirizzato.</span><span class="sxs-lookup"><span data-stu-id="4dad3-166">As an application developer, you do not always need to know or care that the event you are handling is implemented as a routed event.</span></span> <span data-ttu-id="4dad3-167">Gli eventi indirizzati hanno un comportamento speciale, che però è per lo più invisibile se l'evento viene gestito sull'elemento in cui è stato generato.</span><span class="sxs-lookup"><span data-stu-id="4dad3-167">Routed events have special behavior, but that behavior is largely invisible if you are handling an event on the element where it is raised.</span></span>

<span data-ttu-id="4dad3-168">Gli eventi indirizzati diventano particolarmente efficaci se si usa uno degli scenari suggeriti: definizione di gestori comuni in una radice comune, composizione di un controllo personalizzato o definizione di una classe di controlli personalizzata.</span><span class="sxs-lookup"><span data-stu-id="4dad3-168">Where routed events become powerful is if you use any of the suggested scenarios: defining common handlers at a common root, compositing your own control, or defining your own custom control class.</span></span>

<span data-ttu-id="4dad3-169">Non è necessario che i listener e le origini degli eventi indirizzati condividano un evento comune nella gerarchia.</span><span class="sxs-lookup"><span data-stu-id="4dad3-169">Routed event listeners and routed event sources do not need to share a common event in their hierarchy.</span></span> <span data-ttu-id="4dad3-170">Any <xref:System.Windows.UIElement> o <xref:System.Windows.ContentElement> può essere un listener di eventi per qualsiasi evento indirizzato.</span><span class="sxs-lookup"><span data-stu-id="4dad3-170">Any <xref:System.Windows.UIElement> or <xref:System.Windows.ContentElement> can be an event listener for any routed event.</span></span> <span data-ttu-id="4dad3-171">È quindi possibile usare il set completo di eventi indirizzati disponibili nell'API di lavoro come "interfaccia" concettuale, in cui gli elementi diversi dell'applicazione possono scambiare informazioni sugli eventi.</span><span class="sxs-lookup"><span data-stu-id="4dad3-171">Therefore, you can use the full set of routed events available throughout the working API set as a conceptual "interface" whereby disparate elements in the application can exchange event information.</span></span> <span data-ttu-id="4dad3-172">Questo concetto di "interfaccia" per gli eventi indirizzati è applicabile in particolar modo agli eventi di input.</span><span class="sxs-lookup"><span data-stu-id="4dad3-172">This "interface" concept for routed events is particularly applicable for input events.</span></span>

<span data-ttu-id="4dad3-173">Gli eventi indirizzati possono anche essere usati per comunicare nell'albero degli elementi, poiché i dati di un evento vengono trasmessi a ogni elemento nella route.</span><span class="sxs-lookup"><span data-stu-id="4dad3-173">Routed events can also be used to communicate through the element tree, because the event data for the event is perpetuated to each element in the route.</span></span> <span data-ttu-id="4dad3-174">Se un elemento modifica in qualche modo i dati dell'evento, tale modifica risulta disponibile per l'elemento successivo nella route.</span><span class="sxs-lookup"><span data-stu-id="4dad3-174">One element could change something in the event data, and that change would be available to the next element in the route.</span></span>

<span data-ttu-id="4dad3-175">Oltre all'aspetto del routing, esistono altri due motivi per cui un determinato [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] evento può essere implementato come un evento indirizzato anziché un evento CLR standard.</span><span class="sxs-lookup"><span data-stu-id="4dad3-175">Other than the routing aspect, there are two other reasons that any given [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] event might be implemented as a routed event instead of a standard CLR event.</span></span> <span data-ttu-id="4dad3-176">Se si implementano eventi personalizzati, considerare anche questi principi:</span><span class="sxs-lookup"><span data-stu-id="4dad3-176">If you are implementing your own events, you might also consider these principles:</span></span>

- <span data-ttu-id="4dad3-177">Alcune [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] funzionalità di applicazione di stili e modelli, ad esempio <xref:System.Windows.EventSetter> e, <xref:System.Windows.EventTrigger> richiedono che l'evento a cui si fa riferimento sia un evento indirizzato.</span><span class="sxs-lookup"><span data-stu-id="4dad3-177">Certain [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] styling and templating features such as <xref:System.Windows.EventSetter> and <xref:System.Windows.EventTrigger> require the referenced event to be a routed event.</span></span> <span data-ttu-id="4dad3-178">Si tratta dello scenario di identificatore dell'evento citato in precedenza.</span><span class="sxs-lookup"><span data-stu-id="4dad3-178">This is the event identifier scenario mentioned earlier.</span></span>

- <span data-ttu-id="4dad3-179">Gli eventi indirizzati supportano un meccanismo di gestione delle classi in base al quale la classe può specificare metodi statici che hanno la possibilità di gestire gli eventi indirizzati prima che qualsiasi gestore di istanze registrato possa accedervi.</span><span class="sxs-lookup"><span data-stu-id="4dad3-179">Routed events support a class handling mechanism whereby the class can specify static methods that have the opportunity to handle routed events before any registered instance handlers can access them.</span></span> <span data-ttu-id="4dad3-180">Questa funzionalità è molto utile nella progettazione di controlli, perché la classe può imporre comportamenti di classe basati su eventi che non possono essere eliminati accidentalmente mediante la gestione di un evento su un'istanza.</span><span class="sxs-lookup"><span data-stu-id="4dad3-180">This is very useful in control design, because your class can enforce event-driven class behaviors that cannot be accidentally suppressed by handling an event on an instance.</span></span>

<span data-ttu-id="4dad3-181">Ognuna delle considerazioni precedenti viene discussa in una sezione separata di questo argomento.</span><span class="sxs-lookup"><span data-stu-id="4dad3-181">Each of the above considerations is discussed in a separate section of this topic.</span></span>

<a name="event_handing"></a>

## <a name="adding-and-implementing-an-event-handler-for-a-routed-event"></a><span data-ttu-id="4dad3-182">Aggiunta e implementazione di un gestore eventi per un evento indirizzato</span><span class="sxs-lookup"><span data-stu-id="4dad3-182">Adding and Implementing an Event Handler for a Routed Event</span></span>

<span data-ttu-id="4dad3-183">Per aggiungere un gestore eventi in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], è sufficiente aggiungere il nome dell'evento a un elemento come attributo e impostare il valore dell'attributo come nome del gestore eventi che implementa un delegato appropriato, come nell'esempio seguente.</span><span class="sxs-lookup"><span data-stu-id="4dad3-183">To add an event handler in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], you simply add the event name to an element as an attribute and set the attribute value as the name of the event handler that implements an appropriate delegate, as in the following example.</span></span>

[!code-xaml[EventOvwSupport#SimplestSyntax](~/samples/snippets/csharp/VS_Snippets_Wpf/EventOvwSupport/CSharp/default.xaml#simplestsyntax)]

<span data-ttu-id="4dad3-184">`b1SetColor`nome del gestore implementato che contiene il codice che gestisce l' <xref:System.Windows.Controls.Primitives.ButtonBase.Click> evento.</span><span class="sxs-lookup"><span data-stu-id="4dad3-184">`b1SetColor` is the name of the implemented handler that contains the code that handles the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event.</span></span> <span data-ttu-id="4dad3-185">`b1SetColor`deve avere la stessa firma del <xref:System.Windows.RoutedEventHandler> delegato, che è il delegato del gestore eventi per l' <xref:System.Windows.Controls.Primitives.ButtonBase.Click> evento.</span><span class="sxs-lookup"><span data-stu-id="4dad3-185">`b1SetColor` must have the same signature as the <xref:System.Windows.RoutedEventHandler> delegate, which is the event handler delegate for the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event.</span></span> <span data-ttu-id="4dad3-186">Il primo parametro di tutti i delegati dei gestori di eventi indirizzati specifica l'elemento a cui viene aggiunto il gestore eventi, mentre il secondo parametro specifica i dati per l'evento.</span><span class="sxs-lookup"><span data-stu-id="4dad3-186">The first parameter of all routed event handler delegates specifies the element to which the event handler is added, and the second parameter specifies the data for the event.</span></span>

[!code-csharp[EventOvwSupport#SimpleHandlerA](~/samples/snippets/csharp/VS_Snippets_Wpf/EventOvwSupport/CSharp/default.xaml.cs#simplehandlera)]
[!code-vb[EventOvwSupport#SimpleHandlerA](~/samples/snippets/visualbasic/VS_Snippets_Wpf/EventOvwSupport/visualbasic/default.xaml.vb#simplehandlera)]

<span data-ttu-id="4dad3-187"><xref:System.Windows.RoutedEventHandler>è il delegato del gestore dell'evento indirizzato di base.</span><span class="sxs-lookup"><span data-stu-id="4dad3-187"><xref:System.Windows.RoutedEventHandler> is the basic routed event handler delegate.</span></span> <span data-ttu-id="4dad3-188">Per gli eventi indirizzati specializzati per determinati controlli o scenari, i delegati da usare per i gestori di eventi indirizzati possono anche essere più specializzati, in modo da poter trasmettere dati di eventi specializzati.</span><span class="sxs-lookup"><span data-stu-id="4dad3-188">For routed events that are specialized for certain controls or scenarios, the delegates to use for the routed event handlers also might become more specialized, so that they can transmit specialized event data.</span></span> <span data-ttu-id="4dad3-189">In uno scenario di input comune, ad esempio, è possibile gestire un <xref:System.Windows.UIElement.DragEnter> evento indirizzato.</span><span class="sxs-lookup"><span data-stu-id="4dad3-189">For instance, in a common input scenario, you might handle a <xref:System.Windows.UIElement.DragEnter> routed event.</span></span> <span data-ttu-id="4dad3-190">Il gestore deve implementare il <xref:System.Windows.DragEventHandler> delegato.</span><span class="sxs-lookup"><span data-stu-id="4dad3-190">Your handler should implement the <xref:System.Windows.DragEventHandler> delegate.</span></span> <span data-ttu-id="4dad3-191">Usando il delegato più specifico, è possibile elaborare l'oggetto <xref:System.Windows.DragEventArgs> nel gestore e leggere la <xref:System.Windows.DragEventArgs.Data%2A> proprietà, che contiene il payload degli Appunti dell'operazione di trascinamento.</span><span class="sxs-lookup"><span data-stu-id="4dad3-191">By using the most specific delegate, you can process the <xref:System.Windows.DragEventArgs> in the handler and read the <xref:System.Windows.DragEventArgs.Data%2A> property, which contains the clipboard payload of the drag operation.</span></span>

<span data-ttu-id="4dad3-192">Per un esempio completo di come aggiungere un gestore eventi a un elemento usando [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], vedere [Gestire un evento indirizzato](how-to-handle-a-routed-event.md).</span><span class="sxs-lookup"><span data-stu-id="4dad3-192">For a complete example of how to add an event handler to an element using [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], see [Handle a Routed Event](how-to-handle-a-routed-event.md).</span></span>

<span data-ttu-id="4dad3-193">L'aggiunta di un gestore per un evento indirizzato in un'applicazione creata nel codice è semplice.</span><span class="sxs-lookup"><span data-stu-id="4dad3-193">Adding a handler for a routed event in an application that is created in code is straightforward.</span></span> <span data-ttu-id="4dad3-194">I gestori di eventi indirizzati possono sempre essere aggiunti tramite un metodo helper <xref:System.Windows.UIElement.AddHandler%2A> , ovvero lo stesso metodo che il backup esistente chiama per `add` . Tuttavia, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] gli eventi indirizzati esistenti in genere includono implementazioni di backup `add` e `remove` logica che consentono di aggiungere i gestori per gli eventi indirizzati tramite una sintassi di evento specifica del linguaggio, che è una sintassi più intuitiva rispetto al metodo helper.</span><span class="sxs-lookup"><span data-stu-id="4dad3-194">Routed event handlers can always be added through a helper method <xref:System.Windows.UIElement.AddHandler%2A> (which is the same method that the existing backing calls for `add`.) However, existing [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] routed events generally have backing implementations of `add` and `remove` logic that allow the handlers for routed events to be added by a language-specific event syntax, which is more intuitive syntax than the helper method.</span></span> <span data-ttu-id="4dad3-195">Di seguito è illustrato un esempio di utilizzo del metodo helper:</span><span class="sxs-lookup"><span data-stu-id="4dad3-195">The following is an example usage of the helper method:</span></span>

[!code-csharp[EventOvwSupport#AddHandlerCode](~/samples/snippets/csharp/VS_Snippets_Wpf/EventOvwSupport/CSharp/default.xaml.cs#addhandlercode)]
[!code-vb[EventOvwSupport#AddHandlerCode](~/samples/snippets/visualbasic/VS_Snippets_Wpf/EventOvwSupport/visualbasic/default.xaml.vb#addhandlercode)]

<span data-ttu-id="4dad3-196">Nell'esempio seguente viene illustrata la sintassi dell'operatore C# (Visual Basic presenta una sintassi di operatore leggermente diversa a causa della relativa gestione della dereferenziazione):</span><span class="sxs-lookup"><span data-stu-id="4dad3-196">The next example shows the C# operator syntax (Visual Basic has slightly different operator syntax because of its handling of dereferencing):</span></span>

[!code-csharp[EventOvwSupport#AddHandlerPlusEquals](~/samples/snippets/csharp/VS_Snippets_Wpf/EventOvwSupport/CSharp/default.xaml.cs#addhandlerplusequals)]
[!code-vb[EventOvwSupport#AddHandlerPlusEquals](~/samples/snippets/visualbasic/VS_Snippets_Wpf/EventOvwSupport/visualbasic/default.xaml.vb#addhandlerplusequals)]

<span data-ttu-id="4dad3-197">Per un esempio di come aggiungere un gestore eventi nel codice, vedere [Aggiungere un gestore eventi mediante codice](how-to-add-an-event-handler-using-code.md).</span><span class="sxs-lookup"><span data-stu-id="4dad3-197">For an example of how to add an event handler in code, see [Add an Event Handler Using Code](how-to-add-an-event-handler-using-code.md).</span></span>

<span data-ttu-id="4dad3-198">Se si utilizza Visual Basic, è inoltre possibile utilizzare la `Handles` parola chiave per aggiungere gestori come parte delle dichiarazioni del gestore.</span><span class="sxs-lookup"><span data-stu-id="4dad3-198">If you are using Visual Basic, you can also use the `Handles` keyword to add handlers as part of the handler declarations.</span></span> <span data-ttu-id="4dad3-199">Per altre informazioni, vedere [Visual Basic e la gestione degli eventi WPF](visual-basic-and-wpf-event-handling.md).</span><span class="sxs-lookup"><span data-stu-id="4dad3-199">For more information, see [Visual Basic and WPF Event Handling](visual-basic-and-wpf-event-handling.md).</span></span>

<a name="concept_handled"></a>

### <a name="the-concept-of-handled"></a><span data-ttu-id="4dad3-200">Concetto di gestito</span><span class="sxs-lookup"><span data-stu-id="4dad3-200">The Concept of Handled</span></span>

<span data-ttu-id="4dad3-201">Tutti gli eventi indirizzati condividono una classe di base dei dati di evento comuni, <xref:System.Windows.RoutedEventArgs> .</span><span class="sxs-lookup"><span data-stu-id="4dad3-201">All routed events share a common event data base class, <xref:System.Windows.RoutedEventArgs>.</span></span> <span data-ttu-id="4dad3-202"><xref:System.Windows.RoutedEventArgs>definisce la <xref:System.Windows.RoutedEventArgs.Handled%2A> proprietà, che accetta un valore booleano.</span><span class="sxs-lookup"><span data-stu-id="4dad3-202"><xref:System.Windows.RoutedEventArgs> defines the <xref:System.Windows.RoutedEventArgs.Handled%2A> property, which takes a Boolean value.</span></span> <span data-ttu-id="4dad3-203">Lo scopo della <xref:System.Windows.RoutedEventArgs.Handled%2A> proprietà è quello di abilitare qualsiasi gestore eventi lungo la route per contrassegnare l'evento indirizzato come *gestito*, impostando il valore di <xref:System.Windows.RoutedEventArgs.Handled%2A> su `true` .</span><span class="sxs-lookup"><span data-stu-id="4dad3-203">The purpose of the <xref:System.Windows.RoutedEventArgs.Handled%2A> property is to enable any event handler along the route to mark the routed event as *handled*, by setting the value of <xref:System.Windows.RoutedEventArgs.Handled%2A> to `true`.</span></span> <span data-ttu-id="4dad3-204">Dopo essere stati elaborati dal gestore in corrispondenza di un elemento lungo la route, i dati di evento condivisi vengono nuovamente segnalati a ogni listener lungo la route.</span><span class="sxs-lookup"><span data-stu-id="4dad3-204">After being processed by the handler at one element along the route, the shared event data is again reported to each listener along the route.</span></span>

<span data-ttu-id="4dad3-205">Il valore di <xref:System.Windows.RoutedEventArgs.Handled%2A> influiscono sul modo in cui un evento indirizzato viene segnalato o elaborato mentre si sposta ulteriormente lungo la route.</span><span class="sxs-lookup"><span data-stu-id="4dad3-205">The value of <xref:System.Windows.RoutedEventArgs.Handled%2A> affects how a routed event is reported or processed as it travels further along the route.</span></span> <span data-ttu-id="4dad3-206">Se <xref:System.Windows.RoutedEventArgs.Handled%2A> è `true` nei dati dell'evento per un evento indirizzato, i gestori che restano in attesa di tale evento indirizzato su altri elementi in genere non vengono più richiamati per quella particolare istanza di evento.</span><span class="sxs-lookup"><span data-stu-id="4dad3-206">If <xref:System.Windows.RoutedEventArgs.Handled%2A> is `true` in the event data for a routed event, then handlers that listen for that routed event on other elements are generally no longer invoked for that particular event instance.</span></span> <span data-ttu-id="4dad3-207">Ciò vale sia per i gestori associati in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] che per i gestori aggiunti da sintassi di associazione dei gestori eventi specifiche del linguaggio, come `+=` o `Handles`.</span><span class="sxs-lookup"><span data-stu-id="4dad3-207">This is true both for handlers attached in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] and for handlers added by language-specific event handler attachment syntaxes such as `+=` or `Handles`.</span></span> <span data-ttu-id="4dad3-208">Per gli scenari di gestione più comuni, contrassegnare un evento come gestito impostando <xref:System.Windows.RoutedEventArgs.Handled%2A> su `true` verrà interrotto il routing per una route di tunneling o una route di bubbling e anche per qualsiasi evento gestito in un punto della route da un gestore di classe.</span><span class="sxs-lookup"><span data-stu-id="4dad3-208">For most common handler scenarios, marking an event as handled by setting <xref:System.Windows.RoutedEventArgs.Handled%2A> to `true` will "stop" routing for either a tunneling route or a bubbling route, and also for any event that is handled at a point in the route by a class handler.</span></span>

<span data-ttu-id="4dad3-209">Tuttavia, esiste un meccanismo "handledEventsToo" in cui i listener possono comunque eseguire i gestori in risposta agli eventi indirizzati in cui <xref:System.Windows.RoutedEventArgs.Handled%2A> si trova `true` nei dati dell'evento.</span><span class="sxs-lookup"><span data-stu-id="4dad3-209">However, there is a "handledEventsToo" mechanism whereby listeners can still run handlers in response to routed events where <xref:System.Windows.RoutedEventArgs.Handled%2A> is `true` in the event data.</span></span> <span data-ttu-id="4dad3-210">In altre parole, la route dell'evento non viene effettivamente interrotta contrassegnando i dati di evento come gestiti.</span><span class="sxs-lookup"><span data-stu-id="4dad3-210">In other words, the event route is not truly stopped by marking the event data as handled.</span></span> <span data-ttu-id="4dad3-211">È possibile usare il meccanismo handledEventsToo solo nel codice o in un <xref:System.Windows.EventSetter> :</span><span class="sxs-lookup"><span data-stu-id="4dad3-211">You can only use the handledEventsToo mechanism in code, or in an <xref:System.Windows.EventSetter>:</span></span>

- <span data-ttu-id="4dad3-212">Nel codice, anziché usare una sintassi di evento specifica del linguaggio che funzioni per gli eventi CLR generali, chiamare il [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] metodo <xref:System.Windows.UIElement.AddHandler%28System.Windows.RoutedEvent%2CSystem.Delegate%2CSystem.Boolean%29> per aggiungere il gestore.</span><span class="sxs-lookup"><span data-stu-id="4dad3-212">In code, instead of using a language-specific event syntax that works for general CLR events, call the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] method <xref:System.Windows.UIElement.AddHandler%28System.Windows.RoutedEvent%2CSystem.Delegate%2CSystem.Boolean%29> to add your handler.</span></span> <span data-ttu-id="4dad3-213">Specificare il valore di `handledEventsToo` come `true`.</span><span class="sxs-lookup"><span data-stu-id="4dad3-213">Specify the value of `handledEventsToo` as `true`.</span></span>

- <span data-ttu-id="4dad3-214">In un <xref:System.Windows.EventSetter> impostare l' <xref:System.Windows.EventSetter.HandledEventsToo%2A> attributo su `true` .</span><span class="sxs-lookup"><span data-stu-id="4dad3-214">In an <xref:System.Windows.EventSetter>, set the <xref:System.Windows.EventSetter.HandledEventsToo%2A> attribute to be `true`.</span></span>

<span data-ttu-id="4dad3-215">Oltre al comportamento che <xref:System.Windows.RoutedEventArgs.Handled%2A> lo stato produce negli eventi indirizzati, il concetto di <xref:System.Windows.RoutedEventArgs.Handled%2A> presenta implicazioni per la progettazione dell'applicazione e la scrittura del codice del gestore eventi.</span><span class="sxs-lookup"><span data-stu-id="4dad3-215">In addition to the behavior that <xref:System.Windows.RoutedEventArgs.Handled%2A> state produces in routed events, the concept of <xref:System.Windows.RoutedEventArgs.Handled%2A> has implications for how you should design your application and write the event handler code.</span></span> <span data-ttu-id="4dad3-216">È possibile concettualizzare <xref:System.Windows.RoutedEventArgs.Handled%2A> come un semplice protocollo esposto dagli eventi indirizzati.</span><span class="sxs-lookup"><span data-stu-id="4dad3-216">You can conceptualize <xref:System.Windows.RoutedEventArgs.Handled%2A> as being a simple protocol that is exposed by routed events.</span></span> <span data-ttu-id="4dad3-217">Il modo in cui si usa questo protocollo dipende dall'utente, ma la progettazione concettuale per la modalità di utilizzo del valore di è la <xref:System.Windows.RoutedEventArgs.Handled%2A> seguente:</span><span class="sxs-lookup"><span data-stu-id="4dad3-217">Exactly how you use this protocol is up to you, but the conceptual design for how the value of <xref:System.Windows.RoutedEventArgs.Handled%2A> is intended to be used is as follows:</span></span>

- <span data-ttu-id="4dad3-218">Se un evento indirizzato è contrassegnato come gestito, non è necessario che venga gestito nuovamente da altri elementi lungo la route.</span><span class="sxs-lookup"><span data-stu-id="4dad3-218">If a routed event is marked as handled, then it does not need to be handled again by other elements along that route.</span></span>

- <span data-ttu-id="4dad3-219">Se un evento indirizzato non è contrassegnato come gestito, altri listener precedenti lungo la Route hanno scelto di non registrare un gestore o i gestori registrati hanno scelto di non modificare i dati dell'evento e impostare <xref:System.Windows.RoutedEventArgs.Handled%2A> su `true` .</span><span class="sxs-lookup"><span data-stu-id="4dad3-219">If a routed event is not marked as handled, then other listeners that were earlier along the route have chosen either not to register a handler, or the handlers that were registered chose not to manipulate the event data and set <xref:System.Windows.RoutedEventArgs.Handled%2A> to `true`.</span></span> <span data-ttu-id="4dad3-220">In alternativa, è ovviamente possibile che il listener corrente sia il primo punto della route. I gestori del listener corrente hanno ora tre possibili corsi di azione:</span><span class="sxs-lookup"><span data-stu-id="4dad3-220">(Or, it is of course possible that the current listener is the first point in the route.) Handlers on the current listener now have three possible courses of action:</span></span>

  - <span data-ttu-id="4dad3-221">Non eseguire alcuna azione. L'evento rimane non gestito e viene indirizzato al listener successivo.</span><span class="sxs-lookup"><span data-stu-id="4dad3-221">Take no action at all; the event remains unhandled, and the event routes to the next listener.</span></span>

  - <span data-ttu-id="4dad3-222">Eseguire il codice in risposta all'evento, ma stabilire che l'azione eseguita non è sufficiente per contrassegnare l'evento come gestito.</span><span class="sxs-lookup"><span data-stu-id="4dad3-222">Execute code in response to the event, but make the determination that the action taken was not substantial enough to warrant marking the event as handled.</span></span> <span data-ttu-id="4dad3-223">L'evento viene indirizzato al listener successivo.</span><span class="sxs-lookup"><span data-stu-id="4dad3-223">The event routes to the next listener.</span></span>

  - <span data-ttu-id="4dad3-224">Eseguire il codice in risposta all'evento.</span><span class="sxs-lookup"><span data-stu-id="4dad3-224">Execute code in response to the event.</span></span> <span data-ttu-id="4dad3-225">Contrassegnare l'evento come gestito nei dati di evento passati al gestore, perché l'azione eseguita viene ritenuta sufficiente per contrassegnare l'evento come gestito.</span><span class="sxs-lookup"><span data-stu-id="4dad3-225">Mark the event as handled in the event data passed to the handler, because the action taken was deemed substantial enough to warrant marking as handled.</span></span> <span data-ttu-id="4dad3-226">L'evento viene ancora indirizzato al listener successivo, ma con <xref:System.Windows.RoutedEventArgs.Handled%2A> = `true` nei dati degli eventi, quindi solo `handledEventsToo` i listener hanno la possibilità di richiamare ulteriori gestori.</span><span class="sxs-lookup"><span data-stu-id="4dad3-226">The event still routes to the next listener, but with <xref:System.Windows.RoutedEventArgs.Handled%2A>=`true` in its event data, so only `handledEventsToo` listeners have the opportunity to invoke further handlers.</span></span>

<span data-ttu-id="4dad3-227">Questa progettazione concettuale è rafforzata dal comportamento del routing indicato in precedenza: è più difficile (anche se ancora possibile nel codice o negli stili) allineare i gestori per gli eventi indirizzati che vengono richiamati anche se un gestore precedente lungo la route è già impostato <xref:System.Windows.RoutedEventArgs.Handled%2A> su `true` .</span><span class="sxs-lookup"><span data-stu-id="4dad3-227">This conceptual design is reinforced by the routing behavior mentioned earlier: it is more difficult (although still possible in code or styles) to attach handlers for routed events that are invoked even if a previous handler along the route has already set <xref:System.Windows.RoutedEventArgs.Handled%2A> to `true`.</span></span>

<span data-ttu-id="4dad3-228">Per ulteriori informazioni su <xref:System.Windows.RoutedEventArgs.Handled%2A> , gestione delle classi degli eventi indirizzati e indicazioni su quando è opportuno contrassegnare un evento indirizzato come <xref:System.Windows.RoutedEventArgs.Handled%2A> , vedere [contrassegno degli eventi indirizzati come gestiti e gestione delle classi](marking-routed-events-as-handled-and-class-handling.md).</span><span class="sxs-lookup"><span data-stu-id="4dad3-228">For more information about <xref:System.Windows.RoutedEventArgs.Handled%2A>, class handling of routed events, and recommendations about when it is appropriate to mark a routed event as <xref:System.Windows.RoutedEventArgs.Handled%2A>, see [Marking Routed Events as Handled, and Class Handling](marking-routed-events-as-handled-and-class-handling.md).</span></span>

<span data-ttu-id="4dad3-229">Nelle applicazioni, è piuttosto comune gestire un evento indirizzato di bubbling solo sull'oggetto che lo ha generato, senza preoccuparsi delle caratteristiche di routing dell'evento.</span><span class="sxs-lookup"><span data-stu-id="4dad3-229">In applications, it is quite common to just handle a bubbling routed event on the object that raised it, and not be concerned with the event's routing characteristics at all.</span></span> <span data-ttu-id="4dad3-230">È tuttavia comunque consigliabile contrassegnare l'evento indirizzato come gestito nei dati di evento, per evitare effetti collaterali imprevisti nel caso in cui un elemento più in alto nell'albero degli elementi abbia un gestore associato per lo stesso evento indirizzato.</span><span class="sxs-lookup"><span data-stu-id="4dad3-230">However, it is still a good practice to mark the routed event as handled in the event data, to prevent unanticipated side effects just in case an element that is further up the element tree also has a handler attached for that same routed event.</span></span>

<a name="class_handlers"></a>

## <a name="class-handlers"></a><span data-ttu-id="4dad3-231">Gestori di classi</span><span class="sxs-lookup"><span data-stu-id="4dad3-231">Class Handlers</span></span>

<span data-ttu-id="4dad3-232">Se si definisce una classe che deriva in qualche modo da <xref:System.Windows.DependencyObject> , è anche possibile definire e allineare un gestore di classi per un evento indirizzato che è un membro di evento dichiarato o ereditato della classe.</span><span class="sxs-lookup"><span data-stu-id="4dad3-232">If you are defining a class that derives in some way from <xref:System.Windows.DependencyObject>, you can also define and attach a class handler for a routed event that is a declared or inherited event member of your class.</span></span> <span data-ttu-id="4dad3-233">I gestori di classi vengono richiamati prima dei gestori di listener di istanze associati a un'istanza di tale classe, ogni volta che un evento indirizzato raggiunge un'istanza dell'elemento nella relativa route.</span><span class="sxs-lookup"><span data-stu-id="4dad3-233">Class handlers are invoked before any instance listener handlers that are attached to an instance of that class, whenever a routed event reaches an element instance in its route.</span></span>

<span data-ttu-id="4dad3-234">Alcuni controlli [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] hanno una gestione intrinseca delle classi per determinati eventi indirizzati.</span><span class="sxs-lookup"><span data-stu-id="4dad3-234">Some [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] controls have inherent class handling for certain routed events.</span></span> <span data-ttu-id="4dad3-235">In questo modo potrebbe sembrare che l'evento indirizzato non venga mai generato, ma in realtà viene gestito tramite classi e, usando determinate tecniche, può essere ancora gestito dai gestori di istanze.</span><span class="sxs-lookup"><span data-stu-id="4dad3-235">This might give the outward appearance that the routed event is not ever raised, but in reality it is being class handled, and the routed event can potentially still be handled by your instance handlers if you use certain techniques.</span></span> <span data-ttu-id="4dad3-236">Molti controlli e classi di base, inoltre, espongono metodi virtuali che possono essere usati per eseguire l'override del comportamento di gestione delle classi.</span><span class="sxs-lookup"><span data-stu-id="4dad3-236">Also, many base classes and controls expose virtual methods that can be used to override class handling behavior.</span></span> <span data-ttu-id="4dad3-237">Per altre informazioni su come evitare un comportamento di gestione delle classi non desiderato e su come definire la gestione delle classi in una classe personalizzata, vedere [Contrassegno degli eventi indirizzati come gestiti e gestione delle classi](marking-routed-events-as-handled-and-class-handling.md).</span><span class="sxs-lookup"><span data-stu-id="4dad3-237">For more information both on how to work around undesired class handling and on defining your own class handling in a custom class, see [Marking Routed Events as Handled, and Class Handling](marking-routed-events-as-handled-and-class-handling.md).</span></span>

<a name="attached_events"></a>

## <a name="attached-events-in-wpf"></a><span data-ttu-id="4dad3-238">Eventi associati in WPF</span><span class="sxs-lookup"><span data-stu-id="4dad3-238">Attached Events in WPF</span></span>

<span data-ttu-id="4dad3-239">Il linguaggio [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] definisce anche un tipo di evento speciale noto come *evento associato*.</span><span class="sxs-lookup"><span data-stu-id="4dad3-239">The [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] language also defines a special type of event called an *attached event*.</span></span> <span data-ttu-id="4dad3-240">Un evento associato consente di aggiungere un gestore per un determinato evento a un elemento arbitrario.</span><span class="sxs-lookup"><span data-stu-id="4dad3-240">An attached event enables you to add a handler for a particular event to an arbitrary element.</span></span> <span data-ttu-id="4dad3-241">L'elemento che gestisce l'evento non deve necessariamente definire o ereditare l'evento associato, né l'oggetto che genera potenzialmente l'evento o l'istanza di gestione di destinazione deve necessariamente definire o "possedere" in altro modo tale evento come membro della classe.</span><span class="sxs-lookup"><span data-stu-id="4dad3-241">The element handling the event need not define or inherit the attached event, and neither the object potentially raising the event nor the destination handling instance must define or otherwise "own" that event as a class member.</span></span>

<span data-ttu-id="4dad3-242">Il sistema di input di [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] fa largo uso degli eventi associati.</span><span class="sxs-lookup"><span data-stu-id="4dad3-242">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] input system uses attached events extensively.</span></span> <span data-ttu-id="4dad3-243">Tuttavia, quasi tutti questi eventi associati vengono inoltrati tramite elementi di base.</span><span class="sxs-lookup"><span data-stu-id="4dad3-243">However, nearly all of these attached events are forwarded through base elements.</span></span> <span data-ttu-id="4dad3-244">Gli eventi di input appaiono quindi come eventi indirizzati non associati equivalenti, membri della classe di elementi di base.</span><span class="sxs-lookup"><span data-stu-id="4dad3-244">The input events then appear as equivalent non-attached routed events that are members of the base element class.</span></span> <span data-ttu-id="4dad3-245">Ad esempio, l'evento associato sottostante <xref:System.Windows.Input.Mouse.MouseDown?displayProperty=nameWithType> può essere gestito in modo più semplice in qualsiasi dato <xref:System.Windows.UIElement> usando <xref:System.Windows.UIElement.MouseDown> su, <xref:System.Windows.UIElement> invece di gestire la sintassi degli eventi collegati in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] o nel codice.</span><span class="sxs-lookup"><span data-stu-id="4dad3-245">For instance, the underlying attached event <xref:System.Windows.Input.Mouse.MouseDown?displayProperty=nameWithType> can more easily be handled on any given <xref:System.Windows.UIElement> by using <xref:System.Windows.UIElement.MouseDown> on that <xref:System.Windows.UIElement> rather than dealing with attached event syntax either in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] or code.</span></span>

<span data-ttu-id="4dad3-246">Per altre informazioni sugli eventi associati in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], vedere [Cenni preliminari sugli eventi associati](attached-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="4dad3-246">For more information about attached events in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [Attached Events Overview](attached-events-overview.md).</span></span>

<a name="Qualifying_Event_Names_in_XAML_for_Anticipated_Routing"></a>

## <a name="qualified-event-names-in-xaml"></a><span data-ttu-id="4dad3-247">Nomi di evento completi in XAML</span><span class="sxs-lookup"><span data-stu-id="4dad3-247">Qualified Event Names in XAML</span></span>

<span data-ttu-id="4dad3-248">Un altro utilizzo della sintassi simile alla sintassi dell'evento associato *nometipo*.*nomeevento*, che però non è esattamente un utilizzo di un evento associato, è rappresentato dall'associazione di gestori per eventi indirizzati generati da elementi figlio.</span><span class="sxs-lookup"><span data-stu-id="4dad3-248">Another syntax usage that resembles *typename*.*eventname* attached event syntax but is not strictly speaking an attached event usage is when you attach handlers for routed events that are raised by child elements.</span></span> <span data-ttu-id="4dad3-249">I gestori vengono associati a un elemento padre comune, per sfruttare il routing degli eventi, anche se l'evento indirizzato rilevante potrebbe non essere membro dell'elemento padre comune.</span><span class="sxs-lookup"><span data-stu-id="4dad3-249">You attach the handlers to a common parent, to take advantage of event routing, even though the common parent might not have the relevant routed event as a member.</span></span> <span data-ttu-id="4dad3-250">Si consideri di nuovo questo esempio:</span><span class="sxs-lookup"><span data-stu-id="4dad3-250">Consider this example again:</span></span>

[!code-xaml[EventOvwSupport#GroupButton](~/samples/snippets/csharp/VS_Snippets_Wpf/EventOvwSupport/CSharp/default.xaml#groupbutton)]

<span data-ttu-id="4dad3-251">Qui, il listener dell'elemento padre in cui viene aggiunto il gestore è <xref:System.Windows.Controls.StackPanel> .</span><span class="sxs-lookup"><span data-stu-id="4dad3-251">Here, the parent element listener where the handler is added is a <xref:System.Windows.Controls.StackPanel>.</span></span> <span data-ttu-id="4dad3-252">Tuttavia, viene aggiunto un gestore per un evento indirizzato che è stato dichiarato e che verrà generato dalla <xref:System.Windows.Controls.Button> classe ( <xref:System.Windows.Controls.Primitives.ButtonBase> effettivamente, ma disponibile a <xref:System.Windows.Controls.Button> tramite ereditarietà).</span><span class="sxs-lookup"><span data-stu-id="4dad3-252">However, it is adding a handler for a routed event that was declared and will be raised by the <xref:System.Windows.Controls.Button> class (<xref:System.Windows.Controls.Primitives.ButtonBase> actually, but available to <xref:System.Windows.Controls.Button> through inheritance).</span></span> <span data-ttu-id="4dad3-253"><xref:System.Windows.Controls.Button>"proprietario" dell'evento, ma il sistema di eventi indirizzati consente ai gestori per qualsiasi evento indirizzato di essere collegato a <xref:System.Windows.UIElement> qualsiasi <xref:System.Windows.ContentElement> listener di istanze o che potrebbe altrimenti collegare listener per un evento Common Language Runtime (CLR).</span><span class="sxs-lookup"><span data-stu-id="4dad3-253"><xref:System.Windows.Controls.Button> "owns" the event, but the routed event system permits handlers for any routed event to be attached to any <xref:System.Windows.UIElement> or <xref:System.Windows.ContentElement> instance listener that could otherwise attach listeners for a common language runtime (CLR) event.</span></span> <span data-ttu-id="4dad3-254">Lo spazio dei nomi xmlns predefinito per questi nomi completi di attributo di evento è in genere lo spazio dei nomi xmlns [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] predefinito, ma è anche possibile specificare spazi dei nomi con prefisso per eventi indirizzati personalizzati.</span><span class="sxs-lookup"><span data-stu-id="4dad3-254">The default xmlns namespace for these qualified event attribute names is typically the default [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] xmlns namespace, but you can also specify prefixed namespaces for custom routed events.</span></span> <span data-ttu-id="4dad3-255">Per altre informazioni su xmlns, vedere [Spazi dei nomi XAML e mapping dello spazio dei nomi per XAML WPF](xaml-namespaces-and-namespace-mapping-for-wpf-xaml.md).</span><span class="sxs-lookup"><span data-stu-id="4dad3-255">For more information about xmlns, see [XAML Namespaces and Namespace Mapping for WPF XAML](xaml-namespaces-and-namespace-mapping-for-wpf-xaml.md).</span></span>

<a name="how_event_processing_works"></a>

## <a name="wpf-input-events"></a><span data-ttu-id="4dad3-256">Eventi di input WPF</span><span class="sxs-lookup"><span data-stu-id="4dad3-256">WPF Input Events</span></span>

<span data-ttu-id="4dad3-257">Un'applicazione frequente degli eventi indirizzati nella piattaforma [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] riguarda gli eventi di input.</span><span class="sxs-lookup"><span data-stu-id="4dad3-257">One frequent application of routed events within the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] platform is for input events.</span></span> <span data-ttu-id="4dad3-258">In [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] i nomi degli eventi indirizzati di tunneling sono preceduti dalla parola "Preview" per convenzione.</span><span class="sxs-lookup"><span data-stu-id="4dad3-258">In [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], tunneling routed events names are prefixed with the word "Preview" by convention.</span></span> <span data-ttu-id="4dad3-259">Gli eventi di input sono spesso in coppia, con un evento che rappresenta l'evento di bubbling e l'altro quello di tunneling.</span><span class="sxs-lookup"><span data-stu-id="4dad3-259">Input events often come in pairs, with one being the bubbling event and the other being the tunneling event.</span></span> <span data-ttu-id="4dad3-260">Ad esempio, l'evento <xref:System.Windows.ContentElement.KeyDown> e l' <xref:System.Windows.ContentElement.PreviewKeyDown> evento hanno la stessa firma, il primo è l'evento di input di bubbling e il secondo è l'evento di input di tunneling.</span><span class="sxs-lookup"><span data-stu-id="4dad3-260">For example, the <xref:System.Windows.ContentElement.KeyDown> event and the <xref:System.Windows.ContentElement.PreviewKeyDown> event have the same signature, with the former being the bubbling input event and the latter being the tunneling input event.</span></span> <span data-ttu-id="4dad3-261">In alcuni casi, gli eventi di input hanno solo una versione di bubbling o solo una versione indirizzata diretta.</span><span class="sxs-lookup"><span data-stu-id="4dad3-261">Occasionally, input events only have a bubbling version, or perhaps only a direct routed version.</span></span> <span data-ttu-id="4dad3-262">Nella documentazione, gli argomenti relativi agli eventi indirizzati contengono riferimenti incrociati a eventi indirizzati simili con strategie di routing alternative, se disponibili, e le sezioni nelle pagine di riferimenti gestiti chiariscono la strategia di routing per ogni evento indirizzato.</span><span class="sxs-lookup"><span data-stu-id="4dad3-262">In the documentation, routed event topics cross-reference similar routed events with alternative routing strategies if such routed events exist, and sections in the managed reference pages clarify the routing strategy of each routed event.</span></span>

<span data-ttu-id="4dad3-263">Gli eventi di input [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in coppia vengono implementati in modo che una singola azione di input dell'utente, ad esempio la pressione di un pulsante del mouse, generi entrambi gli eventi indirizzati della coppia in sequenza.</span><span class="sxs-lookup"><span data-stu-id="4dad3-263">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] input events that come in pairs are implemented so that a single user action from input, such as a mouse button press, will raise both routed events of the pair in sequence.</span></span> <span data-ttu-id="4dad3-264">Per prima cosa, viene generato l'evento di tunneling, che avanza nella route.</span><span class="sxs-lookup"><span data-stu-id="4dad3-264">First, the tunneling event is raised and travels its route.</span></span> <span data-ttu-id="4dad3-265">Successivamente, viene generato l'evento di bubbling, che avanza nella route.</span><span class="sxs-lookup"><span data-stu-id="4dad3-265">Then the bubbling event is raised and travels its route.</span></span> <span data-ttu-id="4dad3-266">I due eventi condividono letteralmente la stessa istanza di dati evento, perché la <xref:System.Windows.UIElement.RaiseEvent%2A> chiamata al metodo nella classe di implementazione che genera l'evento di bubbling resta in attesa dei dati dell'evento dell'evento di tunneling e la riutilizza nel nuovo evento generato.</span><span class="sxs-lookup"><span data-stu-id="4dad3-266">The two events literally share the same event data instance, because the <xref:System.Windows.UIElement.RaiseEvent%2A> method call in the implementing class that raises the bubbling event listens for the event data from the tunneling event and reuses it in the new raised event.</span></span> <span data-ttu-id="4dad3-267">I listener con gestori per l'evento di tunneling hanno l'opportunità di contrassegnare per primi l'evento indirizzato come gestito (prima i gestori di classi, quindi i gestori di istanze).</span><span class="sxs-lookup"><span data-stu-id="4dad3-267">Listeners with handlers for the tunneling event have the first opportunity to mark the routed event handled (class handlers first, then instance handlers).</span></span> <span data-ttu-id="4dad3-268">Se un elemento nella route di tunneling ha contrassegnato l'evento indirizzato come gestito, i dati dell'evento già gestito vengono inviati per l'evento di bubbling e i gestori tipici associati per gli eventi di input di bubbling equivalenti non vengono richiamati.</span><span class="sxs-lookup"><span data-stu-id="4dad3-268">If an element along the tunneling route marked the routed event as handled, the already-handled event data is sent on for the bubbling event, and typical handlers attached for the equivalent bubbling input events will not be invoked.</span></span> <span data-ttu-id="4dad3-269">Dall'esterno, potrebbe sembrare che l'evento di bubbling gestito non sia mai stato generato.</span><span class="sxs-lookup"><span data-stu-id="4dad3-269">To outward appearances it will be as if the handled bubbling event has not even been raised.</span></span> <span data-ttu-id="4dad3-270">Questo comportamento di gestione è utile per la composizione di controlli in cui si vuole che tutti gli eventi di input basati su hit test o gli eventi di input basati su stato attivo vengano segnalati dal controllo finale, invece che dalle relative parti composite.</span><span class="sxs-lookup"><span data-stu-id="4dad3-270">This handling behavior is useful for control compositing, where you might want all hit-test based input events or focus-based input events to be reported by your final control, rather than its composite parts.</span></span> <span data-ttu-id="4dad3-271">L'elemento del controllo finale è più vicino alla radice nella composizione e quindi ha la possibilità di gestire tramite classi prima l'evento di tunneling ed eventualmente di "sostituire" tale evento indirizzato con un evento più specifico del controllo, come parte del codice sottostante la classe del controllo.</span><span class="sxs-lookup"><span data-stu-id="4dad3-271">The final control element is closer to the root in the compositing, and therefore has the opportunity to class handle the tunneling event first and perhaps to "replace" that routed event with a more control-specific event, as part of the code that backs the control class.</span></span>

<span data-ttu-id="4dad3-272">Come dimostrazione del funzionamento dell'elaborazione degli eventi di input, considerare l'esempio di evento di input seguente.</span><span class="sxs-lookup"><span data-stu-id="4dad3-272">As an illustration of how input event processing works, consider the following input event example.</span></span> <span data-ttu-id="4dad3-273">Nell'illustrazione dell'albero seguente `leaf element #2` è l'origine di un oggetto `PreviewMouseDown` e quindi di un `MouseDown` evento:</span><span class="sxs-lookup"><span data-stu-id="4dad3-273">In the following tree illustration, `leaf element #2` is the source of both a `PreviewMouseDown` and then a `MouseDown` event:</span></span>

![Diagramma del routing degli eventi](./media/routed-events-overview/input-event-routing.png)

<span data-ttu-id="4dad3-275">L'ordine di elaborazione degli eventi è il seguente:</span><span class="sxs-lookup"><span data-stu-id="4dad3-275">The order of event processing is as follows:</span></span>

1. <span data-ttu-id="4dad3-276">`PreviewMouseDown` (tunneling) sull'elemento radice.</span><span class="sxs-lookup"><span data-stu-id="4dad3-276">`PreviewMouseDown` (tunnel) on root element.</span></span>

2. <span data-ttu-id="4dad3-277">`PreviewMouseDown` (tunneling) sull'elemento intermedio 1.</span><span class="sxs-lookup"><span data-stu-id="4dad3-277">`PreviewMouseDown` (tunnel) on intermediate element #1.</span></span>

3. <span data-ttu-id="4dad3-278">`PreviewMouseDown` (tunneling) sull'elemento di origine 2.</span><span class="sxs-lookup"><span data-stu-id="4dad3-278">`PreviewMouseDown` (tunnel) on source element #2.</span></span>

4. <span data-ttu-id="4dad3-279">`MouseDown` (bubbling) sull'elemento di origine 2.</span><span class="sxs-lookup"><span data-stu-id="4dad3-279">`MouseDown` (bubble) on source element #2.</span></span>

5. <span data-ttu-id="4dad3-280">`MouseDown` (bubbling) sull'elemento intermedio 1.</span><span class="sxs-lookup"><span data-stu-id="4dad3-280">`MouseDown` (bubble) on intermediate element #1.</span></span>

6. <span data-ttu-id="4dad3-281">`MouseDown` (bubbling) sull'elemento radice.</span><span class="sxs-lookup"><span data-stu-id="4dad3-281">`MouseDown` (bubble) on root element.</span></span>

<span data-ttu-id="4dad3-282">Un delegato di un gestore di eventi indirizzati fornisce riferimenti a due oggetti: l'oggetto che ha generato l'evento e quello su cui è stato richiamato il gestore.</span><span class="sxs-lookup"><span data-stu-id="4dad3-282">A routed event handler delegate provides references to two objects: the object that raised the event and the object where the handler was invoked.</span></span> <span data-ttu-id="4dad3-283">L'oggetto in cui è stato richiamato il gestore è quello indicato dal parametro `sender`.</span><span class="sxs-lookup"><span data-stu-id="4dad3-283">The object where the handler was invoked is the object reported by the `sender` parameter.</span></span> <span data-ttu-id="4dad3-284">L'oggetto in cui l'evento è stato generato per la prima volta viene segnalato dalla <xref:System.Windows.RoutedEventArgs.Source%2A> proprietà nei dati dell'evento.</span><span class="sxs-lookup"><span data-stu-id="4dad3-284">The object where the event was first raised is reported by the <xref:System.Windows.RoutedEventArgs.Source%2A> property in the event data.</span></span> <span data-ttu-id="4dad3-285">Un evento indirizzato può comunque essere generato e gestito dallo stesso oggetto, nel qual caso `sender` e <xref:System.Windows.RoutedEventArgs.Source%2A> sono identici (questo è il caso dei passaggi 3 e 4 nell'elenco di esempio di elaborazione degli eventi).</span><span class="sxs-lookup"><span data-stu-id="4dad3-285">A routed event can still be raised and handled by the same object, in which case `sender` and <xref:System.Windows.RoutedEventArgs.Source%2A> are identical (this is the case with Steps 3 and 4 in the event processing example list).</span></span>

<span data-ttu-id="4dad3-286">A causa del tunneling e del bubbling, gli elementi padre ricevono gli eventi di input in cui <xref:System.Windows.RoutedEventArgs.Source%2A> è uno dei rispettivi elementi figlio.</span><span class="sxs-lookup"><span data-stu-id="4dad3-286">Because of tunneling and bubbling, parent elements receive input events where the <xref:System.Windows.RoutedEventArgs.Source%2A> is one of their child elements.</span></span> <span data-ttu-id="4dad3-287">Quando è importante conoscere l'elemento di origine, è possibile identificare l'elemento di origine accedendo alla <xref:System.Windows.RoutedEventArgs.Source%2A> Proprietà.</span><span class="sxs-lookup"><span data-stu-id="4dad3-287">When it is important to know what the source element is, you can identify the source element by accessing the <xref:System.Windows.RoutedEventArgs.Source%2A> property.</span></span>

<span data-ttu-id="4dad3-288">In genere, una volta contrassegnato l'evento di input <xref:System.Windows.RoutedEventArgs.Handled%2A> , non vengono richiamati altri gestori.</span><span class="sxs-lookup"><span data-stu-id="4dad3-288">Usually, once the input event is marked <xref:System.Windows.RoutedEventArgs.Handled%2A>, further handlers are not invoked.</span></span> <span data-ttu-id="4dad3-289">Solitamente è consigliabile contrassegnare gli eventi di input come gestiti non appena viene richiamato un gestore che applica la gestione logica specifica dell'applicazione al significato dell'evento di input.</span><span class="sxs-lookup"><span data-stu-id="4dad3-289">Typically, you should mark input events as handled as soon as a handler is invoked that addresses your application-specific logical handling of the meaning of the input event.</span></span>

<span data-ttu-id="4dad3-290">L'eccezione a questa istruzione generale sullo <xref:System.Windows.RoutedEventArgs.Handled%2A> stato è che i gestori di eventi di input registrati per ignorare intenzionalmente <xref:System.Windows.RoutedEventArgs.Handled%2A> lo stato dei dati dell'evento verrebbero comunque richiamati lungo entrambe le route.</span><span class="sxs-lookup"><span data-stu-id="4dad3-290">The exception to this general statement about <xref:System.Windows.RoutedEventArgs.Handled%2A> state is that input event handlers that are registered to deliberately ignore <xref:System.Windows.RoutedEventArgs.Handled%2A> state of the event data would still be invoked along either route.</span></span> <span data-ttu-id="4dad3-291">Per altre informazioni, vedere [Eventi di anteprima](preview-events.md) e [Contrassegno degli eventi indirizzati come gestiti e gestione delle classi](marking-routed-events-as-handled-and-class-handling.md).</span><span class="sxs-lookup"><span data-stu-id="4dad3-291">For more information, see [Preview Events](preview-events.md) or [Marking Routed Events as Handled, and Class Handling](marking-routed-events-as-handled-and-class-handling.md).</span></span>

<span data-ttu-id="4dad3-292">Il modello di dati di evento condivisi tra eventi di tunneling e di bubbling e la generazione sequenziale di eventi prima di tunneling e quindi di bubbling non sono concetti generalmente veri per tutti gli eventi indirizzati.</span><span class="sxs-lookup"><span data-stu-id="4dad3-292">The shared event data model between tunneling and bubbling events, and the sequential raising of first tunneling then bubbling events, is not a concept that is generally true for all routed events.</span></span> <span data-ttu-id="4dad3-293">Questo comportamento viene implementato specificamente dal modo in cui i dispositivi di input [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] scelgono di generare e connettere le coppie di eventi di input.</span><span class="sxs-lookup"><span data-stu-id="4dad3-293">That behavior is specifically implemented by how [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] input devices choose to raise and connect the input event pairs.</span></span> <span data-ttu-id="4dad3-294">L'implementazione di eventi di input personalizzati è un scenario avanzato, ma si può scegliere di seguire tale modello anche per gli eventi di input personalizzati.</span><span class="sxs-lookup"><span data-stu-id="4dad3-294">Implementing your own input events is an advanced scenario, but you might choose to follow that model for your own input events also.</span></span>

<span data-ttu-id="4dad3-295">Alcune classi scelgono di gestire tramite classi determinati eventi di input, di solito con lo scopo di ridefinire il significato di un determinato evento di input generato dall'utente all'interno del controllo e di generare un nuovo evento.</span><span class="sxs-lookup"><span data-stu-id="4dad3-295">Certain classes choose to class-handle certain input events, usually with the intent of redefining what a particular user-driven input event means within that control and raising a new event.</span></span> <span data-ttu-id="4dad3-296">Per altre informazioni, vedere [Contrassegno degli eventi indirizzati come gestiti e gestione delle classi](marking-routed-events-as-handled-and-class-handling.md).</span><span class="sxs-lookup"><span data-stu-id="4dad3-296">For more information, see [Marking Routed Events as Handled, and Class Handling](marking-routed-events-as-handled-and-class-handling.md).</span></span>

<span data-ttu-id="4dad3-297">Per altre informazioni sull'input e su come input ed eventi interagiscono in scenari di applicazioni tipici, vedere [Cenni preliminari sull'input](input-overview.md).</span><span class="sxs-lookup"><span data-stu-id="4dad3-297">For more information on input and how input and events interact in typical application scenarios, see [Input Overview](input-overview.md).</span></span>

<a name="events_styles"></a>

## <a name="eventsetters-and-eventtriggers"></a><span data-ttu-id="4dad3-298">EventSetters ed EventTriggers</span><span class="sxs-lookup"><span data-stu-id="4dad3-298">EventSetters and EventTriggers</span></span>

<span data-ttu-id="4dad3-299">Negli stili è possibile includere una sintassi di gestione degli eventi pre-dichiarata [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] nel markup usando un oggetto <xref:System.Windows.EventSetter> .</span><span class="sxs-lookup"><span data-stu-id="4dad3-299">In styles, you can include some pre-declared [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] event handling syntax in the markup by using an <xref:System.Windows.EventSetter>.</span></span> <span data-ttu-id="4dad3-300">Quando lo stile viene applicato, il gestore a cui si fa riferimento viene aggiunto all'istanza a cui è stato applicato lo stile.</span><span class="sxs-lookup"><span data-stu-id="4dad3-300">When the style is applied, the referenced handler is added to the styled instance.</span></span> <span data-ttu-id="4dad3-301">È possibile dichiarare un <xref:System.Windows.EventSetter> solo per un evento indirizzato.</span><span class="sxs-lookup"><span data-stu-id="4dad3-301">You can declare an <xref:System.Windows.EventSetter> only for a routed event.</span></span> <span data-ttu-id="4dad3-302">Di seguito è riportato un esempio.</span><span class="sxs-lookup"><span data-stu-id="4dad3-302">The following is an example.</span></span> <span data-ttu-id="4dad3-303">Si noti che il metodo `b1SetColor` a cui si fa riferimento qui si trova in un file code-behind.</span><span class="sxs-lookup"><span data-stu-id="4dad3-303">Note that the `b1SetColor` method referenced here is in a code-behind file.</span></span>

[!code-xaml[EventOvwSupport#XAML2](~/samples/snippets/csharp/VS_Snippets_Wpf/EventOvwSupport/CSharp/page2.xaml#xaml2)]

<span data-ttu-id="4dad3-304">Il vantaggio ottenuto è che è probabile che lo stile contenga una grande quantità di informazioni che possono essere applicate a qualsiasi pulsante nell'applicazione e che la <xref:System.Windows.EventSetter> parte di tale stile promuova il riutilizzo del codice anche a livello di markup.</span><span class="sxs-lookup"><span data-stu-id="4dad3-304">The advantage gained here is that the style is likely to contain a great deal of other information that could apply to any button in your application, and having the <xref:System.Windows.EventSetter> be part of that style promotes code reuse even at the markup level.</span></span> <span data-ttu-id="4dad3-305">Inoltre, un <xref:System.Windows.EventSetter> Metodo astrae i nomi dei metodi per i gestori un passo dopo l'altro rispetto al markup generale dell'applicazione e della pagina.</span><span class="sxs-lookup"><span data-stu-id="4dad3-305">Also, an <xref:System.Windows.EventSetter> abstracts method names for handlers one step further away from the general application and page markup.</span></span>

<span data-ttu-id="4dad3-306">Un'altra sintassi specializzata che combina gli eventi indirizzati e le funzionalità di animazione di [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] è un <xref:System.Windows.EventTrigger> .</span><span class="sxs-lookup"><span data-stu-id="4dad3-306">Another specialized syntax that combines the routed event and animation features of [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is an <xref:System.Windows.EventTrigger>.</span></span> <span data-ttu-id="4dad3-307">Come con <xref:System.Windows.EventSetter> , solo gli eventi indirizzati possono essere utilizzati per un oggetto <xref:System.Windows.EventTrigger> .</span><span class="sxs-lookup"><span data-stu-id="4dad3-307">As with <xref:System.Windows.EventSetter>, only routed events may be used for an <xref:System.Windows.EventTrigger>.</span></span> <span data-ttu-id="4dad3-308">In genere, un oggetto <xref:System.Windows.EventTrigger> viene dichiarato come parte di uno stile, ma un oggetto <xref:System.Windows.EventTrigger> può anche essere dichiarato in elementi a livello di pagina come parte della <xref:System.Windows.FrameworkElement.Triggers%2A> raccolta o in un oggetto <xref:System.Windows.Controls.ControlTemplate> .</span><span class="sxs-lookup"><span data-stu-id="4dad3-308">Typically, an <xref:System.Windows.EventTrigger> is declared as part of a style, but an <xref:System.Windows.EventTrigger> can also be declared on page-level elements as part of the <xref:System.Windows.FrameworkElement.Triggers%2A> collection, or in a <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="4dad3-309">Un oggetto <xref:System.Windows.EventTrigger> consente di specificare un oggetto <xref:System.Windows.Media.Animation.Storyboard> che viene eseguito ogni volta che un evento indirizzato raggiunge un elemento nella relativa route che dichiara un oggetto <xref:System.Windows.EventTrigger> per l'evento.</span><span class="sxs-lookup"><span data-stu-id="4dad3-309">An <xref:System.Windows.EventTrigger> enables you to specify a <xref:System.Windows.Media.Animation.Storyboard> that runs whenever a routed event reaches an element in its route that declares an <xref:System.Windows.EventTrigger> for that event.</span></span> <span data-ttu-id="4dad3-310">Il vantaggio di un <xref:System.Windows.EventTrigger> rispetto alla gestione dell'evento e l'avvio di uno storyboard esistente consiste nel fatto che un oggetto <xref:System.Windows.EventTrigger> fornisce un controllo migliore sullo storyboard e sul comportamento in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="4dad3-310">The advantage of an <xref:System.Windows.EventTrigger> over just handling the event and causing it to start an existing storyboard is that an <xref:System.Windows.EventTrigger> provides better control over the storyboard and its run-time behavior.</span></span> <span data-ttu-id="4dad3-311">Per altre informazioni, vedere [Usare i trigger di evento per controllare uno storyboard dopo il relativo avvio](../graphics-multimedia/how-to-use-event-triggers-to-control-a-storyboard-after-it-starts.md).</span><span class="sxs-lookup"><span data-stu-id="4dad3-311">For more information, see [Use Event Triggers to Control a Storyboard After It Starts](../graphics-multimedia/how-to-use-event-triggers-to-control-a-storyboard-after-it-starts.md).</span></span>

<a name="more_about"></a>

## <a name="more-about-routed-events"></a><span data-ttu-id="4dad3-312">Altre informazioni sugli eventi indirizzati</span><span class="sxs-lookup"><span data-stu-id="4dad3-312">More About Routed Events</span></span>

<span data-ttu-id="4dad3-313">Questo argomento illustra gli eventi indirizzati principalmente con lo scopo di descrivere i concetti di base e di fornire istruzioni su come e quando rispondere agli eventi indirizzati già presenti nei vari controlli ed elementi di base.</span><span class="sxs-lookup"><span data-stu-id="4dad3-313">This topic mainly discusses routed events from the perspective of describing the basic concepts and offering guidance on how and when to respond to the routed events that are already present in the various base elements and controls.</span></span> <span data-ttu-id="4dad3-314">È tuttavia possibile creare un evento indirizzato personalizzato in una classe personalizzata insieme a tutto il supporto necessario, come delegati e classi di dati di evento specializzati.</span><span class="sxs-lookup"><span data-stu-id="4dad3-314">However, you can create your own routed event on your custom class along with all the necessary support, such as specialized event data classes and delegates.</span></span> <span data-ttu-id="4dad3-315">Il proprietario dell'evento indirizzato può essere qualsiasi classe, ma gli eventi indirizzati devono essere generati da e gestiti da <xref:System.Windows.UIElement> <xref:System.Windows.ContentElement> classi derivate o per essere utili.</span><span class="sxs-lookup"><span data-stu-id="4dad3-315">The routed event owner can be any class, but routed events must be raised by and handled by <xref:System.Windows.UIElement> or <xref:System.Windows.ContentElement> derived classes in order to be useful.</span></span> <span data-ttu-id="4dad3-316">Per altre informazioni sugli eventi personalizzati, vedere [Creare un evento indirizzato personalizzato](how-to-create-a-custom-routed-event.md).</span><span class="sxs-lookup"><span data-stu-id="4dad3-316">For more information about custom events, see [Create a Custom Routed Event](how-to-create-a-custom-routed-event.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="4dad3-317">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="4dad3-317">See also</span></span>

- <xref:System.Windows.EventManager>
- <xref:System.Windows.RoutedEvent>
- <xref:System.Windows.RoutedEventArgs>
- [<span data-ttu-id="4dad3-318">Impostazione degli eventi indirizzati come gestiti e gestione delle classi</span><span class="sxs-lookup"><span data-stu-id="4dad3-318">Marking Routed Events as Handled, and Class Handling</span></span>](marking-routed-events-as-handled-and-class-handling.md)
- [<span data-ttu-id="4dad3-319">Cenni preliminari sull'input</span><span class="sxs-lookup"><span data-stu-id="4dad3-319">Input Overview</span></span>](input-overview.md)
- [<span data-ttu-id="4dad3-320">Cenni preliminari sull'esecuzione di comandi</span><span class="sxs-lookup"><span data-stu-id="4dad3-320">Commanding Overview</span></span>](commanding-overview.md)
- [<span data-ttu-id="4dad3-321">Proprietà di dipendenza personalizzate</span><span class="sxs-lookup"><span data-stu-id="4dad3-321">Custom Dependency Properties</span></span>](custom-dependency-properties.md)
- [<span data-ttu-id="4dad3-322">Strutture ad albero in WPF</span><span class="sxs-lookup"><span data-stu-id="4dad3-322">Trees in WPF</span></span>](trees-in-wpf.md)
- [<span data-ttu-id="4dad3-323">Modelli di eventi deboli</span><span class="sxs-lookup"><span data-stu-id="4dad3-323">Weak Event Patterns</span></span>](weak-event-patterns.md)
