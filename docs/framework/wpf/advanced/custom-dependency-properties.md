---
title: Proprietà di dipendenza personalizzate
description: Informazioni sui passaggi per implementare una proprietà in Windows Presentation Foundation e sulle opzioni per migliorare le prestazioni, l'usabilità o la versatilità della proprietà.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- implementing [WPF], wrappers
- registering properties [WPF]
- properties [WPF], metadata
- metadata [WPF], for properties
- custom dependency properties [WPF]
- properties [WPF], registering
- wrappers [WPF], implementing
- dependency properties [WPF], custom
ms.assetid: e6bfcfac-b10d-4f58-9f77-a864c2a2938f
ms.openlocfilehash: b082340afb8b1a814fc5923126aa58183d43bc01
ms.sourcegitcommit: 87cfeb69226fef01acb17c56c86f978f4f4a13db
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/24/2020
ms.locfileid: "87168146"
---
# <a name="custom-dependency-properties"></a><span data-ttu-id="028ce-103">Proprietà di dipendenza personalizzate</span><span class="sxs-lookup"><span data-stu-id="028ce-103">Custom Dependency Properties</span></span>

<span data-ttu-id="028ce-104">Questo argomento descrive le ragioni per cui sviluppatori di applicazioni [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] e autori di componenti potrebbero decidere di creare una proprietà di dipendenza personalizzata e illustra i passaggi dell'implementazione oltre ad alcune opzioni di implementazione in grado di migliorare le prestazioni, l'usabilità o la versatilità della proprietà.</span><span class="sxs-lookup"><span data-stu-id="028ce-104">This topic describes the reasons that [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] application developers and component authors might want to create custom dependency property, and describes the implementation steps as well as some implementation options that can improve performance, usability, or versatility of the property.</span></span>

<a name="prerequisites"></a>

## <a name="prerequisites"></a><span data-ttu-id="028ce-105">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="028ce-105">Prerequisites</span></span>

<span data-ttu-id="028ce-106">In questo argomento si presuppongono la conoscenza delle proprietà di dipendenza dal punto di vista di un consumer di proprietà di dipendenza esistenti nelle classi [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], nonché la lettura dell'argomento [Panoramica sulle proprietà di dipendenza](dependency-properties-overview.md).</span><span class="sxs-lookup"><span data-stu-id="028ce-106">This topic assumes that you understand dependency properties from the perspective of a consumer of existing dependency properties on [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] classes, and have read the [Dependency Properties Overview](dependency-properties-overview.md) topic.</span></span> <span data-ttu-id="028ce-107">Per seguire gli esempi illustrati in questo argomento, è anche necessario conoscere [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] e saper scrivere applicazioni [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="028ce-107">In order to follow the examples in this topic, you should also understand [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] and know how to write [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] applications.</span></span>

<a name="whatis"></a>

## <a name="what-is-a-dependency-property"></a><span data-ttu-id="028ce-108">Che cos'è una proprietà di dipendenza?</span><span class="sxs-lookup"><span data-stu-id="028ce-108">What Is a Dependency Property?</span></span>

<span data-ttu-id="028ce-109">È possibile abilitare ciò che altrimenti sarebbe una proprietà Common Language Runtime (CLR) per supportare lo stile, la data binding, l'ereditarietà, le animazioni e i valori predefiniti implementando tale proprietà come proprietà di dipendenza.</span><span class="sxs-lookup"><span data-stu-id="028ce-109">You can enable what would otherwise be a common language runtime (CLR) property to support styling, data binding, inheritance, animations, and default values by implementing it as a dependency property.</span></span> <span data-ttu-id="028ce-110">Le proprietà di dipendenza sono proprietà registrate con il [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] sistema di proprietà chiamando il <xref:System.Windows.DependencyProperty.Register%2A> Metodo (o <xref:System.Windows.DependencyProperty.RegisterReadOnly%2A> ) e supportate da un <xref:System.Windows.DependencyProperty> campo dell'identificatore.</span><span class="sxs-lookup"><span data-stu-id="028ce-110">Dependency properties are properties that are registered with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] property system by calling the <xref:System.Windows.DependencyProperty.Register%2A> method (or <xref:System.Windows.DependencyProperty.RegisterReadOnly%2A>), and that are backed by a <xref:System.Windows.DependencyProperty> identifier field.</span></span> <span data-ttu-id="028ce-111">Le proprietà di dipendenza possono essere utilizzate solo dai <xref:System.Windows.DependencyObject> tipi, ma <xref:System.Windows.DependencyObject> sono piuttosto elevate nella [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] gerarchia di classi, quindi la maggior parte delle classi disponibili in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] può supportare le proprietà di dipendenza.</span><span class="sxs-lookup"><span data-stu-id="028ce-111">Dependency properties can be used only by <xref:System.Windows.DependencyObject> types, but <xref:System.Windows.DependencyObject> is quite high in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] class hierarchy, so the majority of classes available in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] can support dependency properties.</span></span> <span data-ttu-id="028ce-112">Per altre informazioni sulle proprietà di dipendenza e alcune delle terminologie e delle convenzioni usate per descriverle in questo SDK, vedere [Cenni preliminari sulle proprietà di dipendenza](dependency-properties-overview.md).</span><span class="sxs-lookup"><span data-stu-id="028ce-112">For more information about dependency properties and some of the terminology and conventions used for describing them in this SDK, see [Dependency Properties Overview](dependency-properties-overview.md).</span></span>

<a name="example_dp"></a>

## <a name="examples-of-dependency-properties"></a><span data-ttu-id="028ce-113">Esempio di proprietà di dipendenza</span><span class="sxs-lookup"><span data-stu-id="028ce-113">Examples of Dependency Properties</span></span>

<span data-ttu-id="028ce-114">Tra molti altri esempi di proprietà di dipendenza implementate nelle [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] classi sono incluse la <xref:System.Windows.Controls.Control.Background%2A> proprietà, la proprietà <xref:System.Windows.FrameworkElement.Width%2A> e la <xref:System.Windows.Controls.TextBox.Text%2A> Proprietà.</span><span class="sxs-lookup"><span data-stu-id="028ce-114">Examples of dependency properties that are implemented on [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] classes include the <xref:System.Windows.Controls.Control.Background%2A> property, the <xref:System.Windows.FrameworkElement.Width%2A> property, and the <xref:System.Windows.Controls.TextBox.Text%2A> property, among many others.</span></span> <span data-ttu-id="028ce-115">Ogni proprietà di dipendenza esposta da una classe dispone di un campo statico pubblico corrispondente di tipo <xref:System.Windows.DependencyProperty> esposto nella stessa classe.</span><span class="sxs-lookup"><span data-stu-id="028ce-115">Each dependency property exposed by a class has a corresponding public static field of type <xref:System.Windows.DependencyProperty> exposed on that same class.</span></span> <span data-ttu-id="028ce-116">Si tratta dell'identificatore per la proprietà di dipendenza.</span><span class="sxs-lookup"><span data-stu-id="028ce-116">This is the identifier for the dependency property.</span></span> <span data-ttu-id="028ce-117">L'identificatore viene denominato mediante la seguente convenzione: nome della proprietà di dipendenza seguito dalla stringa `Property`.</span><span class="sxs-lookup"><span data-stu-id="028ce-117">The identifier is named using a convention: the name of the dependency property with the string `Property` appended to it.</span></span> <span data-ttu-id="028ce-118">Ad esempio, il <xref:System.Windows.DependencyProperty> campo identificatore corrispondente per la <xref:System.Windows.Controls.Control.Background%2A> proprietà è <xref:System.Windows.Controls.Control.BackgroundProperty> .</span><span class="sxs-lookup"><span data-stu-id="028ce-118">For example, the corresponding <xref:System.Windows.DependencyProperty> identifier field for the <xref:System.Windows.Controls.Control.Background%2A> property is <xref:System.Windows.Controls.Control.BackgroundProperty>.</span></span> <span data-ttu-id="028ce-119">L'identificatore archivia le informazioni sulla proprietà di dipendenza mentre è stata registrata e l'identificatore viene quindi usato in un secondo momento per altre operazioni che coinvolgono la proprietà di dipendenza, ad esempio la chiamata a <xref:System.Windows.DependencyObject.SetValue%2A> .</span><span class="sxs-lookup"><span data-stu-id="028ce-119">The identifier stores the information about the dependency property as it was registered, and the identifier is then used later for other operations involving the dependency property, such as calling <xref:System.Windows.DependencyObject.SetValue%2A>.</span></span>

<span data-ttu-id="028ce-120">Come indicato nella [Panoramica sulle proprietà di dipendenza](dependency-properties-overview.md), tutte le proprietà di dipendenza in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] (eccetto la maggior parte delle proprietà associate) sono anche proprietà CLR a causa dell'implementazione "wrapper".</span><span class="sxs-lookup"><span data-stu-id="028ce-120">As mentioned in the [Dependency Properties Overview](dependency-properties-overview.md), all dependency properties in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] (except most attached properties) are also CLR properties because of the "wrapper" implementation.</span></span> <span data-ttu-id="028ce-121">Pertanto, dal codice, è possibile ottenere o impostare le proprietà di dipendenza chiamando funzioni di accesso CLR che definiscono i wrapper nello stesso modo in cui si utilizzeranno altre proprietà CLR.</span><span class="sxs-lookup"><span data-stu-id="028ce-121">Therefore, from code, you can get or set dependency properties by calling CLR accessors that define the wrappers in the same manner that you would use other CLR properties.</span></span> <span data-ttu-id="028ce-122">In qualità di consumer di proprietà di dipendenza stabilite, in genere non si utilizzano i <xref:System.Windows.DependencyObject> metodi <xref:System.Windows.DependencyObject.GetValue%2A> e <xref:System.Windows.DependencyObject.SetValue%2A> , che rappresentano il punto di connessione al sistema di proprietà sottostante.</span><span class="sxs-lookup"><span data-stu-id="028ce-122">As a consumer of established dependency properties, you do not typically use the <xref:System.Windows.DependencyObject> methods <xref:System.Windows.DependencyObject.GetValue%2A> and <xref:System.Windows.DependencyObject.SetValue%2A>, which are the connection point to the underlying property system.</span></span> <span data-ttu-id="028ce-123">Piuttosto, l'implementazione esistente delle proprietà CLR avrà già chiamato <xref:System.Windows.DependencyObject.GetValue%2A> e <xref:System.Windows.DependencyObject.SetValue%2A> all'interno delle `get` `set` implementazioni del wrapper e della proprietà, usando il campo dell'identificatore in modo appropriato.</span><span class="sxs-lookup"><span data-stu-id="028ce-123">Rather, the existing implementation of the CLR properties will have already called <xref:System.Windows.DependencyObject.GetValue%2A> and <xref:System.Windows.DependencyObject.SetValue%2A> within the `get` and `set` wrapper implementations of the property, using the identifier field appropriately.</span></span> <span data-ttu-id="028ce-124">Se l'implementazione di una proprietà di dipendenza personalizzata viene eseguita in modo autonomo, il wrapper verrà definito in modo simile.</span><span class="sxs-lookup"><span data-stu-id="028ce-124">If you are implementing a custom dependency property yourself, then you will be defining the wrapper in a similar way.</span></span>

<a name="backing_with_dp"></a>

## <a name="when-should-you-implement-a-dependency-property"></a><span data-ttu-id="028ce-125">Quando implementare una proprietà di dipendenza</span><span class="sxs-lookup"><span data-stu-id="028ce-125">When Should You Implement a Dependency Property?</span></span>

<span data-ttu-id="028ce-126">Quando si implementa una proprietà in una classe, purché la classe derivi da <xref:System.Windows.DependencyObject> , è possibile eseguire il backup della proprietà con un <xref:System.Windows.DependencyProperty> identificatore e quindi impostarla come proprietà di dipendenza.</span><span class="sxs-lookup"><span data-stu-id="028ce-126">When you implement a property on a class, so long as your class derives from <xref:System.Windows.DependencyObject>, you have the option to back your property with a <xref:System.Windows.DependencyProperty> identifier and thus to make it a dependency property.</span></span> <span data-ttu-id="028ce-127">Trasformare una proprietà in una proprietà di dipendenza non sempre è necessario o appropriato e dipende dalle esigenze dello scenario.</span><span class="sxs-lookup"><span data-stu-id="028ce-127">Having your property be a dependency property is not always necessary or appropriate, and will depend on your scenario needs.</span></span> <span data-ttu-id="028ce-128">Talvolta è opportuno usare la tecnica normale che consiste nel supportare la proprietà con un campo privato.</span><span class="sxs-lookup"><span data-stu-id="028ce-128">Sometimes, the typical technique of backing your property with a private field is adequate.</span></span> <span data-ttu-id="028ce-129">Tuttavia, se si vuole che la proprietà supporti una o più delle seguenti funzionalità [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], è necessario implementarla come proprietà di dipendenza:</span><span class="sxs-lookup"><span data-stu-id="028ce-129">However, you should implement your property as a dependency property whenever you want your property to support one or more of the following [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] capabilities:</span></span>

- <span data-ttu-id="028ce-130">Si vuole che la proprietà possa essere impostata in uno stile.</span><span class="sxs-lookup"><span data-stu-id="028ce-130">You want your property to be settable in a style.</span></span> <span data-ttu-id="028ce-131">Per altre informazioni, vedere [Applicazione di stili e modelli](../../../desktop-wpf/fundamentals/styles-templates-overview.md).</span><span class="sxs-lookup"><span data-stu-id="028ce-131">For more information, see [Styling and Templating](../../../desktop-wpf/fundamentals/styles-templates-overview.md).</span></span>

- <span data-ttu-id="028ce-132">Si vuole che la proprietà supporti il data binding.</span><span class="sxs-lookup"><span data-stu-id="028ce-132">You want your property to support data binding.</span></span> <span data-ttu-id="028ce-133">Per altre informazioni sulle proprietà di dipendenza di data binding, vedere [Eseguire l'associazione delle proprietà di due controlli](../data/how-to-bind-the-properties-of-two-controls.md).</span><span class="sxs-lookup"><span data-stu-id="028ce-133">For more information about data binding dependency properties, see [Bind the Properties of Two Controls](../data/how-to-bind-the-properties-of-two-controls.md).</span></span>

- <span data-ttu-id="028ce-134">Si vuole che la proprietà possa essere impostata con un riferimento di risorsa dinamica.</span><span class="sxs-lookup"><span data-stu-id="028ce-134">You want your property to be settable with a dynamic resource reference.</span></span> <span data-ttu-id="028ce-135">Per altre informazioni, vedere [Risorse XAML](../../../desktop-wpf/fundamentals/xaml-resources-define.md).</span><span class="sxs-lookup"><span data-stu-id="028ce-135">For more information, see [XAML Resources](../../../desktop-wpf/fundamentals/xaml-resources-define.md).</span></span>

- <span data-ttu-id="028ce-136">Si vuole ereditare un valore di proprietà automaticamente da un elemento padre nell'albero degli elementi.</span><span class="sxs-lookup"><span data-stu-id="028ce-136">You want to inherit a property value automatically from a parent element in the element tree.</span></span> <span data-ttu-id="028ce-137">In questo caso, eseguire la registrazione con il <xref:System.Windows.DependencyProperty.RegisterAttached%2A> metodo, anche se si crea anche un wrapper di proprietà per l'accesso a CLR.</span><span class="sxs-lookup"><span data-stu-id="028ce-137">In this case, register with the <xref:System.Windows.DependencyProperty.RegisterAttached%2A> method, even if you also create a property wrapper for CLR access.</span></span> <span data-ttu-id="028ce-138">Per altre informazioni, vedere [Ereditarietà del valore della proprietà](property-value-inheritance.md).</span><span class="sxs-lookup"><span data-stu-id="028ce-138">For more information, see [Property Value Inheritance](property-value-inheritance.md).</span></span>

- <span data-ttu-id="028ce-139">Si vuole che la proprietà sia animata.</span><span class="sxs-lookup"><span data-stu-id="028ce-139">You want your property to be animatable.</span></span> <span data-ttu-id="028ce-140">Per altre informazioni, vedere [Cenni preliminari sull'animazione](../graphics-multimedia/animation-overview.md).</span><span class="sxs-lookup"><span data-stu-id="028ce-140">For more information, see [Animation Overview](../graphics-multimedia/animation-overview.md).</span></span>

- <span data-ttu-id="028ce-141">Si vuole che il sistema di proprietà segnali quando il valore precedente della proprietà è stato modificato da azioni intraprese dal sistema di proprietà, dall'ambiente o dall'utente oppure tramite la lettura e l'uso degli stili.</span><span class="sxs-lookup"><span data-stu-id="028ce-141">You want the property system to report when the previous value of the property has been changed by actions taken by the property system, the environment, or the user, or by reading and using styles.</span></span> <span data-ttu-id="028ce-142">Se si usano i metadati della proprietà, la proprietà può specificare un metodo di callback che verrà richiamato ogni volta il sistema di proprietà determina che il valore della proprietà è stato modificato definitivamente.</span><span class="sxs-lookup"><span data-stu-id="028ce-142">By using property metadata, your property can specify a callback method that will be invoked each time the property system determines that your property value was definitively changed.</span></span> <span data-ttu-id="028ce-143">Un concetto correlato è la coercizione del valore di proprietà.</span><span class="sxs-lookup"><span data-stu-id="028ce-143">A related concept is property value coercion.</span></span> <span data-ttu-id="028ce-144">Per altre informazioni, vedere [Callback e convalida delle proprietà di dipendenza](dependency-property-callbacks-and-validation.md).</span><span class="sxs-lookup"><span data-stu-id="028ce-144">For more information, see [Dependency Property Callbacks and Validation](dependency-property-callbacks-and-validation.md).</span></span>

- <span data-ttu-id="028ce-145">Si vogliono usare convenzioni di metadati definite usate anche dai processi [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], ad esempio la segnalazione dell'eventualità che la modifica di un valore di proprietà richieda che il sistema di layout ricomponga gli elementi visivi di un elemento.</span><span class="sxs-lookup"><span data-stu-id="028ce-145">You want to use established metadata conventions that are also used by [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] processes, such as reporting whether changing a property value should require the layout system to recompose the visuals for an element.</span></span> <span data-ttu-id="028ce-146">Oppure si vogliono usare override di metadati in modo che le classi derivate possano modificare caratteristiche basate sui metadati quali il valore predefinito.</span><span class="sxs-lookup"><span data-stu-id="028ce-146">Or you want to be able to use metadata overrides so that derived classes can change metadata-based characteristics such as the default value.</span></span>

- <span data-ttu-id="028ce-147">Si desidera che le proprietà di un controllo personalizzato ricevano il supporto di progettazione WPF di Visual Studio, ad esempio la modifica della finestra **Proprietà** .</span><span class="sxs-lookup"><span data-stu-id="028ce-147">You want properties of a custom control to receive Visual Studio WPF Designer support, such as **Properties** window editing.</span></span> <span data-ttu-id="028ce-148">Per altre informazioni, vedere [Cenni preliminari sulla modifica di controlli](../controls/control-authoring-overview.md).</span><span class="sxs-lookup"><span data-stu-id="028ce-148">For more information, see [Control Authoring Overview](../controls/control-authoring-overview.md).</span></span>

<span data-ttu-id="028ce-149">Quando si esaminano questi scenari, è necessario considerare anche se è possibile realizzare lo scenario eseguendo l'override dei metadati di una proprietà di dipendenza esistente, piuttosto che implementando una proprietà completamente nuova.</span><span class="sxs-lookup"><span data-stu-id="028ce-149">When you examine these scenarios, you should also consider whether you can achieve your scenario by overriding the metadata of an existing dependency property, rather than implementing a completely new property.</span></span> <span data-ttu-id="028ce-150">La praticità di un override di metadati dipende dallo scenario e dalla somiglianza di tale scenario con l'implementazione nelle proprietà di dipendenza [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] esistenti e nelle classi.</span><span class="sxs-lookup"><span data-stu-id="028ce-150">Whether a metadata override is practical depends on your scenario and how closely that scenario resembles the implementation in existing [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] dependency properties and classes.</span></span> <span data-ttu-id="028ce-151">Per altre informazioni sull'override dei metadati nelle proprietà esistenti, vedere [Metadati delle proprietà di dipendenza](dependency-property-metadata.md).</span><span class="sxs-lookup"><span data-stu-id="028ce-151">For more information about overriding metadata on existing properties, see [Dependency Property Metadata](dependency-property-metadata.md).</span></span>

<a name="checklist"></a>

## <a name="checklist-for-defining-a-dependency-property"></a><span data-ttu-id="028ce-152">Elenco di controllo per la definizione di una proprietà di dipendenza</span><span class="sxs-lookup"><span data-stu-id="028ce-152">Checklist for Defining a Dependency Property</span></span>

<span data-ttu-id="028ce-153">La definizione di una proprietà di dipendenza include quattro concetti distinti.</span><span class="sxs-lookup"><span data-stu-id="028ce-153">Defining a dependency property consists of four distinct concepts.</span></span> <span data-ttu-id="028ce-154">Questi concetti non rappresentano necessariamente passaggi rigidi di una procedura, in quanto alcuni di questi finiscono per essere combinati come singole righe di codice nell'implementazione:</span><span class="sxs-lookup"><span data-stu-id="028ce-154">These concepts are not necessarily strict procedural steps, because some of these end up being combined as single lines of code in the implementation:</span></span>

- <span data-ttu-id="028ce-155">(Facoltativo) Creare metadati di proprietà per la proprietà di dipendenza.</span><span class="sxs-lookup"><span data-stu-id="028ce-155">(Optional) Create property metadata for the dependency property.</span></span>

- <span data-ttu-id="028ce-156">Registrare il nome della proprietà con il sistema di proprietà, specificando un tipo di proprietario e il tipo del valore di proprietà.</span><span class="sxs-lookup"><span data-stu-id="028ce-156">Register the property name with the property system, specifying an owner type and the type of the property value.</span></span> <span data-ttu-id="028ce-157">Se usati, specificare anche i metadati della proprietà.</span><span class="sxs-lookup"><span data-stu-id="028ce-157">Also specify the property metadata, if used.</span></span>

- <span data-ttu-id="028ce-158">Definire un <xref:System.Windows.DependencyProperty> identificatore come `public` `static` `readonly` campo nel tipo di proprietario.</span><span class="sxs-lookup"><span data-stu-id="028ce-158">Define a <xref:System.Windows.DependencyProperty> identifier as a `public` `static` `readonly` field on the owner type.</span></span>

- <span data-ttu-id="028ce-159">Definire una proprietà "wrapper" CLR il cui nome corrisponda al nome della proprietà di dipendenza.</span><span class="sxs-lookup"><span data-stu-id="028ce-159">Define a CLR "wrapper" property whose name matches the name of the dependency property.</span></span> <span data-ttu-id="028ce-160">Implementare le funzioni di accesso e della proprietà "wrapper" CLR `get` `set` per connettersi alla proprietà di dipendenza che la esegue.</span><span class="sxs-lookup"><span data-stu-id="028ce-160">Implement the CLR "wrapper" property's `get` and `set` accessors to connect with the dependency property that backs it.</span></span>

<a name="registering"></a>

### <a name="registering-the-property-with-the-property-system"></a><span data-ttu-id="028ce-161">Registrazione della proprietà nel sistema di proprietà</span><span class="sxs-lookup"><span data-stu-id="028ce-161">Registering the Property with the Property System</span></span>

<span data-ttu-id="028ce-162">Affinché la proprietà sia una proprietà di dipendenza, è necessario registrarla in una tabella gestita dal sistema di proprietà e assegnarle un identificatore univoco usato come qualificatore per le successive operazioni del sistema di proprietà.</span><span class="sxs-lookup"><span data-stu-id="028ce-162">In order for your property to be a dependency property, you must register that property into a table maintained by the property system, and give it a unique identifier that is used as the qualifier for later property system operations.</span></span> <span data-ttu-id="028ce-163">Queste operazioni possono essere operazioni interne o il codice che chiama le API del sistema di proprietà.</span><span class="sxs-lookup"><span data-stu-id="028ce-163">These operations might be internal operations, or your own code calling property system APIs.</span></span> <span data-ttu-id="028ce-164">Per registrare la proprietà, è necessario chiamare il <xref:System.Windows.DependencyProperty.Register%2A> metodo all'interno del corpo della classe (all'interno della classe, ma all'esterno di qualsiasi definizione di membro).</span><span class="sxs-lookup"><span data-stu-id="028ce-164">To register the property, you call the <xref:System.Windows.DependencyProperty.Register%2A> method within the body of your class (inside the class, but outside of any member definitions).</span></span> <span data-ttu-id="028ce-165">Il campo identificatore viene anche fornito dalla <xref:System.Windows.DependencyProperty.Register%2A> chiamata al metodo come valore restituito.</span><span class="sxs-lookup"><span data-stu-id="028ce-165">The identifier field is also provided by the <xref:System.Windows.DependencyProperty.Register%2A> method call, as the return value.</span></span> <span data-ttu-id="028ce-166">Il motivo per cui la <xref:System.Windows.DependencyProperty.Register%2A> chiamata viene eseguita al di fuori delle altre definizioni dei membri è perché si usa questo valore restituito per assegnare e creare un `public` `static` `readonly` campo di tipo <xref:System.Windows.DependencyProperty> come parte della classe.</span><span class="sxs-lookup"><span data-stu-id="028ce-166">The reason that the <xref:System.Windows.DependencyProperty.Register%2A> call is done outside of other member definitions is because you use this return value to assign and create a `public` `static` `readonly` field of type <xref:System.Windows.DependencyProperty> as part of your class.</span></span> <span data-ttu-id="028ce-167">Questo campo diventa l'identificatore per la proprietà di dipendenza.</span><span class="sxs-lookup"><span data-stu-id="028ce-167">This field becomes the identifier for your dependency property.</span></span>

[!code-csharp[WPFAquariumSln#RegisterAG](~/samples/snippets/csharp/VS_Snippets_Wpf/WPFAquariumSln/CSharp/WPFAquariumObjects/Class1.cs#registerag)]
[!code-vb[WPFAquariumSln#RegisterAG](~/samples/snippets/visualbasic/VS_Snippets_Wpf/WPFAquariumSln/visualbasic/wpfaquariumobjects/class1.vb#registerag)]

<a name="nameconventions"></a>

### <a name="dependency-property-name-conventions"></a><span data-ttu-id="028ce-168">Convenzioni di denominazione delle proprietà di dipendenza</span><span class="sxs-lookup"><span data-stu-id="028ce-168">Dependency Property Name Conventions</span></span>

<span data-ttu-id="028ce-169">Esistono convenzioni di denominazione definite relative alle proprietà di dipendenza che è necessario seguire in tutte le circostanze tranne in casi eccezionali.</span><span class="sxs-lookup"><span data-stu-id="028ce-169">There are established naming conventions regarding dependency properties that you must follow in all but exceptional circumstances.</span></span>

<span data-ttu-id="028ce-170">La proprietà di dipendenza stessa avrà un nome di base, "AquariumGraphic", come in questo esempio, fornito come primo parametro di <xref:System.Windows.DependencyProperty.Register%2A> .</span><span class="sxs-lookup"><span data-stu-id="028ce-170">The dependency property itself will have a basic name, "AquariumGraphic" as in this example, which is given as the first parameter of <xref:System.Windows.DependencyProperty.Register%2A>.</span></span> <span data-ttu-id="028ce-171">Tale nome deve essere univoco all'interno di ogni tipo di registrazione.</span><span class="sxs-lookup"><span data-stu-id="028ce-171">That name must be unique within each registering type.</span></span> <span data-ttu-id="028ce-172">Le proprietà di dipendenza ereditate tramite tipi di base sono considerate già parte del tipo di registrazione. I nomi delle proprietà ereditate non possono essere registrati nuovamente.</span><span class="sxs-lookup"><span data-stu-id="028ce-172">Dependency properties inherited through base types are considered to be already part of the registering type; names of inherited properties cannot be registered again.</span></span> <span data-ttu-id="028ce-173">Tuttavia, esiste una tecnica per aggiungere una classe come proprietario di una proprietà di dipendenza persino quando quella proprietà di dipendenza non è ereditata. Per informazioni dettagliate, vedere [Metadati delle proprietà di dipendenza](dependency-property-metadata.md).</span><span class="sxs-lookup"><span data-stu-id="028ce-173">However, there is a technique for adding a class as owner of a dependency property even when that dependency property is not inherited; for details, see [Dependency Property Metadata](dependency-property-metadata.md).</span></span>

<span data-ttu-id="028ce-174">Quando si crea il campo dell'identificatore, denominare questo campo con il nome della proprietà registrata, più il suffisso `Property`.</span><span class="sxs-lookup"><span data-stu-id="028ce-174">When you create the identifier field, name this field by the name of the property as you registered it, plus the suffix `Property`.</span></span> <span data-ttu-id="028ce-175">Questo campo è l'identificatore della proprietà di dipendenza e verrà usato in un secondo momento come input per le <xref:System.Windows.DependencyObject.SetValue%2A> chiamate e <xref:System.Windows.DependencyObject.GetValue%2A> che verranno effettuate nei wrapper, da qualsiasi altro codice che accede alla proprietà tramite il proprio codice, da qualsiasi accesso al codice esterno consentito, dal sistema di proprietà e potenzialmente dai [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processori.</span><span class="sxs-lookup"><span data-stu-id="028ce-175">This field is your identifier for the dependency property, and it will be used later as an input for the <xref:System.Windows.DependencyObject.SetValue%2A> and <xref:System.Windows.DependencyObject.GetValue%2A> calls you will make in the wrappers, by any other code access to the property by your own code, by any external code access you allow, by the property system, and potentially by [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processors.</span></span>

> [!NOTE]
> <span data-ttu-id="028ce-176">La definizione della proprietà di dipendenza nel corpo della classe costituisce l'implementazione tipica, ma è anche possibile definire una proprietà di dipendenza nel costruttore statico della classe.</span><span class="sxs-lookup"><span data-stu-id="028ce-176">Defining the dependency property in the class body is the typical implementation, but it is also possible to define a dependency property in the class static constructor.</span></span> <span data-ttu-id="028ce-177">Questo approccio potrebbe essere utile nel caso in cui siano necessarie più righe di codice per inizializzare la proprietà di dipendenza.</span><span class="sxs-lookup"><span data-stu-id="028ce-177">This approach might make sense if you need more than one line of code to initialize the dependency property.</span></span>

<a name="wrapper1"></a>

### <a name="implementing-the-wrapper"></a><span data-ttu-id="028ce-178">Implementazione del "wrapper"</span><span class="sxs-lookup"><span data-stu-id="028ce-178">Implementing the "Wrapper"</span></span>

<span data-ttu-id="028ce-179">L'implementazione del wrapper deve chiamare <xref:System.Windows.DependencyObject.GetValue%2A> nell' `get` implementazione di e <xref:System.Windows.DependencyObject.SetValue%2A> nell' `set` implementazione (la chiamata di registrazione originale e il campo vengono visualizzati anche per maggiore chiarezza).</span><span class="sxs-lookup"><span data-stu-id="028ce-179">Your wrapper implementation should call <xref:System.Windows.DependencyObject.GetValue%2A> in the `get` implementation, and <xref:System.Windows.DependencyObject.SetValue%2A> in the `set` implementation (the original registration call and field are shown here too for clarity).</span></span>

<span data-ttu-id="028ce-180">In tutte le circostanze eccezionali, le implementazioni del wrapper devono eseguire <xref:System.Windows.DependencyObject.GetValue%2A> rispettivamente le <xref:System.Windows.DependencyObject.SetValue%2A> azioni e.</span><span class="sxs-lookup"><span data-stu-id="028ce-180">In all but exceptional circumstances, your wrapper implementations should perform only the <xref:System.Windows.DependencyObject.GetValue%2A> and <xref:System.Windows.DependencyObject.SetValue%2A> actions, respectively.</span></span> <span data-ttu-id="028ce-181">La ragione è discussa nell'argomento [Caricamento XAML e proprietà di dipendenza](xaml-loading-and-dependency-properties.md).</span><span class="sxs-lookup"><span data-stu-id="028ce-181">The reason for this is discussed in the topic [XAML Loading and Dependency Properties](xaml-loading-and-dependency-properties.md).</span></span>

<span data-ttu-id="028ce-182">Tutte le proprietà di dipendenza pubbliche esistenti fornite nelle classi [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] usano questo semplice modello di implementazione del wrapper. La maggior parte della complessità della modalità di funzionamento delle proprietà di dipendenza è dovuta a un comportamento intrinseco del sistema di proprietà oppure è implementata tramite altri concetti quali la coercizione o i callback di modifica della proprietà mediante i metadati della proprietà.</span><span class="sxs-lookup"><span data-stu-id="028ce-182">All existing public dependency properties that are provided on the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] classes use this simple wrapper implementation model; most of the complexity of how dependency properties work is either inherently a behavior of the property system, or is implemented through other concepts such as coercion or property change callbacks through property metadata.</span></span>

[!code-csharp[WPFAquariumSln#AGWithWrapper](~/samples/snippets/csharp/VS_Snippets_Wpf/WPFAquariumSln/CSharp/WPFAquariumObjects/Class1.cs#agwithwrapper)]
[!code-vb[WPFAquariumSln#AGWithWrapper](~/samples/snippets/visualbasic/VS_Snippets_Wpf/WPFAquariumSln/visualbasic/wpfaquariumobjects/class1.vb#agwithwrapper)]

<span data-ttu-id="028ce-183">Anche in questo caso, per convenzione, il nome della proprietà wrapper deve corrispondere al nome scelto e specificato come primo parametro della <xref:System.Windows.DependencyProperty.Register%2A> chiamata che ha registrato la proprietà.</span><span class="sxs-lookup"><span data-stu-id="028ce-183">Again, by convention, the name of the wrapper property must be the same as the name chosen and given as first parameter of the <xref:System.Windows.DependencyProperty.Register%2A> call that registered the property.</span></span> <span data-ttu-id="028ce-184">Se la proprietà non segue la convenzione, non necessariamente vengono disabilitati tutti i possibili usi, ma si riscontreranno vari problemi rilevanti:</span><span class="sxs-lookup"><span data-stu-id="028ce-184">If your property does not follow the convention, this does not necessarily disable all possible uses, but you will encounter several notable issues:</span></span>

- <span data-ttu-id="028ce-185">Determinati aspetti di stili e modelli non funzioneranno.</span><span class="sxs-lookup"><span data-stu-id="028ce-185">Certain aspects of styles and templates will not work.</span></span>

- <span data-ttu-id="028ce-186">La maggior parte degli strumenti e delle finestre di progettazione devono basarsi sulle convenzioni di denominazione per serializzare correttamente [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] o per fornire assistenza relativamente all'ambiente della finestra di progettazione a livello di singola proprietà.</span><span class="sxs-lookup"><span data-stu-id="028ce-186">Most tools and designers must rely on the naming conventions to properly serialize [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], or to provide designer environment assistance at a per-property level.</span></span>

- <span data-ttu-id="028ce-187">L'implementazione corrente del [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] caricatore ignora completamente i wrapper e si basa sulla convenzione di denominazione durante l'elaborazione dei valori di attributo.</span><span class="sxs-lookup"><span data-stu-id="028ce-187">The current implementation of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] loader bypasses the wrappers entirely, and relies on the naming convention when processing attribute values.</span></span> <span data-ttu-id="028ce-188">Per altre informazioni, vedere [Caricamento XAML e proprietà di dipendenza](xaml-loading-and-dependency-properties.md).</span><span class="sxs-lookup"><span data-stu-id="028ce-188">For more information, see [XAML Loading and Dependency Properties](xaml-loading-and-dependency-properties.md).</span></span>

<a name="metadata"></a>

### <a name="property-metadata-for-a-new-dependency-property"></a><span data-ttu-id="028ce-189">Metadati della proprietà per una nuova proprietà di dipendenza</span><span class="sxs-lookup"><span data-stu-id="028ce-189">Property Metadata for a New Dependency Property</span></span>

<span data-ttu-id="028ce-190">Quando si registra una proprietà di dipendenza, la registrazione tramite il sistema di proprietà crea un oggetto dei metadati che archivia le caratteristiche della proprietà.</span><span class="sxs-lookup"><span data-stu-id="028ce-190">When you register a dependency property, the registration through the property system creates a metadata object that stores property characteristics.</span></span> <span data-ttu-id="028ce-191">Molte di queste caratteristiche hanno impostazioni predefinite che vengono impostate se la proprietà è registrata con le firme semplici di <xref:System.Windows.DependencyProperty.Register%2A> .</span><span class="sxs-lookup"><span data-stu-id="028ce-191">Many of these characteristics have defaults that are set if the property is registered with the simple signatures of <xref:System.Windows.DependencyProperty.Register%2A>.</span></span> <span data-ttu-id="028ce-192">Altre firme di <xref:System.Windows.DependencyProperty.Register%2A> consentono di specificare i metadati desiderati durante la registrazione della proprietà.</span><span class="sxs-lookup"><span data-stu-id="028ce-192">Other signatures of <xref:System.Windows.DependencyProperty.Register%2A> allow you to specify the metadata that you want as you register the property.</span></span> <span data-ttu-id="028ce-193">I metadati più comuni per le proprietà di dipendenza consistono nel fornire a tali proprietà un valore predefinito che viene applicato alle nuove istanze che usano la proprietà.</span><span class="sxs-lookup"><span data-stu-id="028ce-193">The most common metadata given for dependency properties is to give them a default value that is applied on new instances that use the property.</span></span>

<span data-ttu-id="028ce-194">Se si crea una proprietà di dipendenza esistente in una classe derivata di <xref:System.Windows.FrameworkElement> , è possibile usare la classe di metadati più specializzata <xref:System.Windows.FrameworkPropertyMetadata> invece della classe di base <xref:System.Windows.PropertyMetadata> .</span><span class="sxs-lookup"><span data-stu-id="028ce-194">If you are creating a dependency property that exists on a derived class of <xref:System.Windows.FrameworkElement>, you can use the more specialized metadata class <xref:System.Windows.FrameworkPropertyMetadata> rather than the base <xref:System.Windows.PropertyMetadata> class.</span></span> <span data-ttu-id="028ce-195">Il costruttore per la <xref:System.Windows.FrameworkPropertyMetadata> classe presenta diverse firme in cui è possibile specificare diverse caratteristiche dei metadati in combinazione.</span><span class="sxs-lookup"><span data-stu-id="028ce-195">The constructor for the <xref:System.Windows.FrameworkPropertyMetadata> class has several signatures where you can specify various metadata characteristics in combination.</span></span> <span data-ttu-id="028ce-196">Se si desidera specificare solo il valore predefinito, utilizzare la firma che accetta un solo parametro di tipo <xref:System.Object> .</span><span class="sxs-lookup"><span data-stu-id="028ce-196">If you want to specify the default value only, use the signature that takes a single parameter of type <xref:System.Object>.</span></span> <span data-ttu-id="028ce-197">Passare il parametro dell'oggetto come valore predefinito specifico del tipo per la proprietà (il valore predefinito fornito deve corrispondere al tipo specificato come `propertyType` parametro nella <xref:System.Windows.DependencyProperty.Register%2A> chiamata).</span><span class="sxs-lookup"><span data-stu-id="028ce-197">Pass that object parameter as a type-specific default value for your property (the default value provided must be the type you provided as the `propertyType` parameter in the <xref:System.Windows.DependencyProperty.Register%2A> call).</span></span>

<span data-ttu-id="028ce-198">Per <xref:System.Windows.FrameworkPropertyMetadata> , è anche possibile specificare i flag di opzione dei metadati per la proprietà.</span><span class="sxs-lookup"><span data-stu-id="028ce-198">For <xref:System.Windows.FrameworkPropertyMetadata>, you can also specify metadata option flags for your property.</span></span> <span data-ttu-id="028ce-199">Questi flag vengono convertiti in proprietà discrete nei metadati della proprietà dopo la registrazione e usati per comunicare determinate istruzioni condizionali agli altri processi quali il motore di layout.</span><span class="sxs-lookup"><span data-stu-id="028ce-199">These flags are converted into discrete properties on the property metadata after registration and are used to communicate certain conditionals to other processes such as the layout engine.</span></span>

#### <a name="setting-appropriate-metadata-flags"></a><span data-ttu-id="028ce-200">Impostazione dei flag di metadati appropriati</span><span class="sxs-lookup"><span data-stu-id="028ce-200">Setting Appropriate Metadata Flags</span></span>

- <span data-ttu-id="028ce-201">Se la proprietà o le modifiche del relativo valore influiscono su [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] e in particolare influiscono sul modo in cui il sistema di layout deve ridimensionare o eseguire il rendering dell'elemento in una pagina, impostare uno o più dei flag seguenti: <xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsMeasure> , <xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsArrange> , <xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsRender> .</span><span class="sxs-lookup"><span data-stu-id="028ce-201">If your property (or changes in its value) affects the [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)], and in particular affects how the layout system should size or render your element in a page, set one or more of the following flags: <xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsMeasure>, <xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsArrange>, <xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsRender>.</span></span>

  - <span data-ttu-id="028ce-202"><xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsMeasure>indica che una modifica a questa proprietà richiede una modifica al [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] rendering in cui l'oggetto contenitore potrebbe richiedere più o meno spazio all'interno dell'elemento padre.</span><span class="sxs-lookup"><span data-stu-id="028ce-202"><xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsMeasure> indicates that a change to this property requires a change to [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] rendering where the containing object might require more or less space within the parent.</span></span> <span data-ttu-id="028ce-203">Ad esempio, è necessario impostare questo flag per una proprietà "Width".</span><span class="sxs-lookup"><span data-stu-id="028ce-203">For example, a "Width" property should have this flag set.</span></span>

  - <span data-ttu-id="028ce-204"><xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsArrange>indica che una modifica a questa proprietà richiede una modifica al [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] rendering che in genere non richiede una modifica nello spazio dedicato, ma indica che il posizionamento all'interno dello spazio è stato modificato.</span><span class="sxs-lookup"><span data-stu-id="028ce-204"><xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsArrange> indicates that a change to this property requires a change to [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] rendering that typically does not require a change in the dedicated space, but does indicate that the positioning within the space has changed.</span></span> <span data-ttu-id="028ce-205">Ad esempio, è necessario impostare questo flag per una proprietà "Alignment".</span><span class="sxs-lookup"><span data-stu-id="028ce-205">For example, an "Alignment" property should have this flag set.</span></span>

  - <span data-ttu-id="028ce-206"><xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsRender>indica che si è verificata un'altra modifica che non influirà sul layout e sulla misura, ma richiede un altro rendering.</span><span class="sxs-lookup"><span data-stu-id="028ce-206"><xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsRender> indicates that some other change has occurred that will not affect layout and measure, but does require another render.</span></span> <span data-ttu-id="028ce-207">Un esempio potrebbe essere una proprietà che modifica un colore di un elemento esistente, ad esempio "Background".</span><span class="sxs-lookup"><span data-stu-id="028ce-207">An example would be a property that changes a color of an existing element, such as "Background".</span></span>

  - <span data-ttu-id="028ce-208">Questi flag vengono spesso usati come protocollo nei metadati per le implementazioni di override del sistema di proprietà o per i callback del layout.</span><span class="sxs-lookup"><span data-stu-id="028ce-208">These flags are often used as a protocol in metadata for your own override implementations of property system or layout callbacks.</span></span> <span data-ttu-id="028ce-209">Ad esempio, è possibile che si disponga di un <xref:System.Windows.DependencyObject.OnPropertyChanged%2A> callback che chiamerà <xref:System.Windows.UIElement.InvalidateArrange%2A> se una proprietà dell'istanza segnala una modifica del valore e ha <xref:System.Windows.FrameworkPropertyMetadata.AffectsArrange%2A> come `true` nei relativi metadati.</span><span class="sxs-lookup"><span data-stu-id="028ce-209">For instance, you might have an <xref:System.Windows.DependencyObject.OnPropertyChanged%2A> callback that will call <xref:System.Windows.UIElement.InvalidateArrange%2A> if any property of the instance reports a value change and has <xref:System.Windows.FrameworkPropertyMetadata.AffectsArrange%2A> as `true` in its metadata.</span></span>

- <span data-ttu-id="028ce-210">Alcune proprietà possono influire sulle caratteristiche di rendering dell'elemento padre contenitore, in modo maggiore rispetto alle modifiche nelle dimensioni necessarie indicate in precedenza.</span><span class="sxs-lookup"><span data-stu-id="028ce-210">Some properties may affect the rendering characteristics of the containing parent element, in ways above and beyond the changes in required size mentioned above.</span></span> <span data-ttu-id="028ce-211">Un esempio è la <xref:System.Windows.Documents.Paragraph.MinOrphanLines%2A> proprietà usata nel modello di documento dinamico, in cui le modifiche apportate a tale proprietà possono modificare il rendering complessivo del documento dinamico che contiene il paragrafo.</span><span class="sxs-lookup"><span data-stu-id="028ce-211">An example is the <xref:System.Windows.Documents.Paragraph.MinOrphanLines%2A> property used in the flow document model, where changes to that property can change the overall rendering of the flow document that contains the paragraph.</span></span> <span data-ttu-id="028ce-212">Usare <xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsParentArrange> o <xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsParentMeasure> per identificare casi simili nelle proprietà.</span><span class="sxs-lookup"><span data-stu-id="028ce-212">Use <xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsParentArrange> or <xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsParentMeasure> to identify similar cases in your own properties.</span></span>

- <span data-ttu-id="028ce-213">Per impostazione predefinita, le proprietà di dipendenza supportano il data binding.</span><span class="sxs-lookup"><span data-stu-id="028ce-213">By default, dependency properties support data binding.</span></span> <span data-ttu-id="028ce-214">È possibile disabilitare intenzionalmente il data binding per i casi in cui non esiste uno scenario realistico per il data binding o nei quali le prestazioni del data binding per un oggetto di grandi dimensioni viene considerata un problema.</span><span class="sxs-lookup"><span data-stu-id="028ce-214">You can deliberately disable data binding, for cases where there is no realistic scenario for data binding, or where performance in data binding for a large object is recognized as a problem.</span></span>

- <span data-ttu-id="028ce-215">Per impostazione predefinita, data binding <xref:System.Windows.Data.Binding.Mode%2A> per le proprietà di dipendenza viene impostato sul valore predefinito <xref:System.Windows.Data.BindingMode.OneWay> .</span><span class="sxs-lookup"><span data-stu-id="028ce-215">By default, data binding <xref:System.Windows.Data.Binding.Mode%2A> for dependency properties defaults to <xref:System.Windows.Data.BindingMode.OneWay>.</span></span> <span data-ttu-id="028ce-216">È sempre possibile modificare l'associazione in modo che sia per <xref:System.Windows.Data.BindingMode.TwoWay> ogni istanza dell'associazione. per informazioni dettagliate, vedere [specificare la direzione del binding](../data/how-to-specify-the-direction-of-the-binding.md).</span><span class="sxs-lookup"><span data-stu-id="028ce-216">You can always change the binding to be <xref:System.Windows.Data.BindingMode.TwoWay> per binding instance; for details, see [Specify the Direction of the Binding](../data/how-to-specify-the-direction-of-the-binding.md).</span></span> <span data-ttu-id="028ce-217">Tuttavia, come autore della proprietà di dipendenza, è possibile scegliere di fare in modo che la proprietà usi la <xref:System.Windows.Data.BindingMode.TwoWay> modalità di associazione per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="028ce-217">But as the dependency property author, you can choose to make the property use <xref:System.Windows.Data.BindingMode.TwoWay> binding mode by default.</span></span> <span data-ttu-id="028ce-218">Un esempio di una proprietà di dipendenza esistente è <xref:System.Windows.Controls.MenuItem.IsSubmenuOpen%2A?displayProperty=nameWithType> . lo scenario per questa proprietà è che la <xref:System.Windows.Controls.MenuItem.IsSubmenuOpen%2A> logica di impostazione e la composizione di <xref:System.Windows.Controls.MenuItem> interagiscono con lo stile del tema predefinito.</span><span class="sxs-lookup"><span data-stu-id="028ce-218">An example of an existing dependency property is <xref:System.Windows.Controls.MenuItem.IsSubmenuOpen%2A?displayProperty=nameWithType>; the scenario for this property is that the <xref:System.Windows.Controls.MenuItem.IsSubmenuOpen%2A> setting logic and the compositing of <xref:System.Windows.Controls.MenuItem> interact with the default theme style.</span></span> <span data-ttu-id="028ce-219">La <xref:System.Windows.Controls.MenuItem.IsSubmenuOpen%2A> logica della proprietà usa data binding in modo nativo per mantenere lo stato della proprietà in base alle altre proprietà di stato e alle chiamate al metodo.</span><span class="sxs-lookup"><span data-stu-id="028ce-219">The <xref:System.Windows.Controls.MenuItem.IsSubmenuOpen%2A> property logic uses data binding natively to maintain the state of the property in accordance to other state properties and method calls.</span></span> <span data-ttu-id="028ce-220">Un'altra proprietà di esempio associata <xref:System.Windows.Data.BindingMode.TwoWay> per impostazione predefinita è <xref:System.Windows.Controls.TextBox.Text%2A?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="028ce-220">Another example property that binds <xref:System.Windows.Data.BindingMode.TwoWay> by default is <xref:System.Windows.Controls.TextBox.Text%2A?displayProperty=nameWithType>.</span></span>

- <span data-ttu-id="028ce-221">È anche possibile abilitare l'ereditarietà delle proprietà in una proprietà di dipendenza personalizzata impostando il <xref:System.Windows.FrameworkPropertyMetadataOptions.Inherits> flag.</span><span class="sxs-lookup"><span data-stu-id="028ce-221">You can also enable property inheritance in a custom dependency property by setting the <xref:System.Windows.FrameworkPropertyMetadataOptions.Inherits> flag.</span></span> <span data-ttu-id="028ce-222">L'ereditarietà della proprietà è utile per uno scenario in cui gli elementi padre e gli elementi figlio hanno una proprietà in comune e avrebbe senso per gli elementi figlio avere quel particolare valore di proprietà impostato sullo stesso valore impostato dall'elemento padre.</span><span class="sxs-lookup"><span data-stu-id="028ce-222">Property inheritance is useful for a scenario where parent elements and child elements have a property in common, and it makes sense for the child elements to have that particular property value set to the same value as the parent set it.</span></span> <span data-ttu-id="028ce-223">Una proprietà ereditabile di esempio è <xref:System.Windows.FrameworkElement.DataContext%2A> , che viene usata per le operazioni di associazione per abilitare lo scenario Master-Detail importante per la presentazione dei dati.</span><span class="sxs-lookup"><span data-stu-id="028ce-223">An example inheritable property is <xref:System.Windows.FrameworkElement.DataContext%2A>, which is used for binding operations to enable the important master-detail scenario for data presentation.</span></span> <span data-ttu-id="028ce-224">Rendendo <xref:System.Windows.FrameworkElement.DataContext%2A> ereditabili, tutti gli elementi figlio ereditano anche quel contesto dati.</span><span class="sxs-lookup"><span data-stu-id="028ce-224">By making <xref:System.Windows.FrameworkElement.DataContext%2A> inheritable, any child elements inherit that data context also.</span></span> <span data-ttu-id="028ce-225">A causa dell'ereditarietà del valore della proprietà, è possibile specificare un contesto dati alla radice della pagina o dell'applicazione e non è necessario specificarlo di nuovo per i binding in tutti i possibili elementi figlio.</span><span class="sxs-lookup"><span data-stu-id="028ce-225">Because of property value inheritance, you can specify a data context at the page or application root, and do not need to respecify it for bindings in all possible child elements.</span></span> <span data-ttu-id="028ce-226"><xref:System.Windows.FrameworkElement.DataContext%2A>è anche un buon esempio per illustrare che l'ereditarietà esegue l'override del valore predefinito, ma può sempre essere impostata localmente su un particolare elemento figlio. per informazioni dettagliate, vedere [usare il modello Master-Details con dati gerarchici](../data/how-to-use-the-master-detail-pattern-with-hierarchical-data.md).</span><span class="sxs-lookup"><span data-stu-id="028ce-226"><xref:System.Windows.FrameworkElement.DataContext%2A> is also a good example to illustrate that inheritance overrides the default value, but it can always be set locally on any particular child element; for details, see [Use the Master-Detail Pattern with Hierarchical Data](../data/how-to-use-the-master-detail-pattern-with-hierarchical-data.md).</span></span> <span data-ttu-id="028ce-227">L'ereditarietà del valore della proprietà può incidere negativamente sulle prestazioni e pertanto deve essere usata sporadicamente. Per informazioni dettagliate, vedere [Ereditarietà del valore della proprietà](property-value-inheritance.md).</span><span class="sxs-lookup"><span data-stu-id="028ce-227">Property value inheritance does have a possible performance cost, and thus should be used sparingly; for details, see [Property Value Inheritance](property-value-inheritance.md).</span></span>

- <span data-ttu-id="028ce-228">Impostare il <xref:System.Windows.FrameworkPropertyMetadataOptions.Journal> flag per indicare se la proprietà di dipendenza deve essere rilevata o utilizzata dai servizi di journaling di navigazione.</span><span class="sxs-lookup"><span data-stu-id="028ce-228">Set the <xref:System.Windows.FrameworkPropertyMetadataOptions.Journal> flag to indicate if your dependency property should be detected or used by navigation journaling services.</span></span> <span data-ttu-id="028ce-229">Un esempio è la <xref:System.Windows.Controls.Primitives.Selector.SelectedIndex%2A> Proprietà. qualsiasi elemento selezionato in un controllo di selezione deve essere reso permanente quando viene spostata la cronologia del journaling.</span><span class="sxs-lookup"><span data-stu-id="028ce-229">An example is the <xref:System.Windows.Controls.Primitives.Selector.SelectedIndex%2A> property; any item selected in a selection control should be persisted when the journaling history is navigated.</span></span>

<a name="RODP"></a>

## <a name="read-only-dependency-properties"></a><span data-ttu-id="028ce-230">Proprietà di dipendenza di sola lettura</span><span class="sxs-lookup"><span data-stu-id="028ce-230">Read-Only Dependency Properties</span></span>

<span data-ttu-id="028ce-231">È possibile definire una proprietà di dipendenza di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="028ce-231">You can define a dependency property that is read-only.</span></span> <span data-ttu-id="028ce-232">Tuttavia, gli scenari in base ai quali è possibile definire la proprietà come proprietà di sola lettura sono piuttosto diversi, allo stesso modo della procedura per registrare queste proprietà con il sistema di proprietà e di quella per esporre l'identificatore.</span><span class="sxs-lookup"><span data-stu-id="028ce-232">However, the scenarios for why you might define your property as read-only are somewhat different, as is the procedure for registering them with the property system and exposing the identifier.</span></span> <span data-ttu-id="028ce-233">Per altre informazioni, vedere [Proprietà di dipendenza di sola lettura](read-only-dependency-properties.md).</span><span class="sxs-lookup"><span data-stu-id="028ce-233">For more information, see [Read-Only Dependency Properties](read-only-dependency-properties.md).</span></span>

<a name="CTDP"></a>

## <a name="collection-type-dependency-properties"></a><span data-ttu-id="028ce-234">Proprietà di dipendenza di tipo raccolta</span><span class="sxs-lookup"><span data-stu-id="028ce-234">Collection-Type Dependency Properties</span></span>

<span data-ttu-id="028ce-235">Le proprietà di dipendenza di tipo di raccolta presentano alcuni problemi di implementazione aggiuntivi che è opportuno considerare.</span><span class="sxs-lookup"><span data-stu-id="028ce-235">Collection-type dependency properties have some additional implementation issues to consider.</span></span> <span data-ttu-id="028ce-236">Per altri dettagli, vedere [Proprietà di dipendenza di tipo raccolta](collection-type-dependency-properties.md).</span><span class="sxs-lookup"><span data-stu-id="028ce-236">For details, see [Collection-Type Dependency Properties](collection-type-dependency-properties.md).</span></span>

<a name="SecurityC"></a>

## <a name="dependency-property-security-considerations"></a><span data-ttu-id="028ce-237">Considerazioni sulla sicurezza delle proprietà di dipendenza</span><span class="sxs-lookup"><span data-stu-id="028ce-237">Dependency Property Security Considerations</span></span>

<span data-ttu-id="028ce-238">Le proprietà di dipendenza devono essere dichiarate come proprietà pubbliche.</span><span class="sxs-lookup"><span data-stu-id="028ce-238">Dependency properties should be declared as public properties.</span></span> <span data-ttu-id="028ce-239">I campi dell'identificatore delle proprietà di dipendenza devono essere dichiarati come campi statici pubblici.</span><span class="sxs-lookup"><span data-stu-id="028ce-239">Dependency property identifier fields should be declared as public static fields.</span></span> <span data-ttu-id="028ce-240">Anche se si tenta di dichiarare altri livelli di accesso (ad esempio protected), è sempre possibile accedere a una proprietà di dipendenza tramite l'identificatore in combinazione con le API del sistema di proprietà.</span><span class="sxs-lookup"><span data-stu-id="028ce-240">Even if you attempt to declare other access levels (such as protected), a dependency property can always be accessed through the identifier in combination with the property system APIs.</span></span> <span data-ttu-id="028ce-241">Anche un campo dell'identificatore protetto è potenzialmente accessibile a causa della creazione di report dei metadati o delle API di determinazione del valore che fanno parte del sistema di proprietà, ad esempio <xref:System.Windows.LocalValueEnumerator> .</span><span class="sxs-lookup"><span data-stu-id="028ce-241">Even a protected identifier field is potentially accessible because of metadata reporting or value determination APIs that are part of the property system, such as <xref:System.Windows.LocalValueEnumerator>.</span></span> <span data-ttu-id="028ce-242">Per altre informazioni, vedere [Sicurezza delle proprietà di dipendenza](dependency-property-security.md).</span><span class="sxs-lookup"><span data-stu-id="028ce-242">For more information, see [Dependency Property Security](dependency-property-security.md).</span></span>

<a name="DPCtor"></a>

## <a name="dependency-properties-and-class-constructors"></a><span data-ttu-id="028ce-243">Proprietà di dipendenza e costruttori di classi</span><span class="sxs-lookup"><span data-stu-id="028ce-243">Dependency Properties and Class Constructors</span></span>

<span data-ttu-id="028ce-244">Esiste un principio generale nella programmazione del codice gestito (spesso applicato mediante strumenti di analisi del codice quale FxCop) in base al quale i costruttori di classi non devono chiamare metodi virtuali.</span><span class="sxs-lookup"><span data-stu-id="028ce-244">There is a general principle in managed code programming (often enforced by code analysis tools such as FxCop) that class constructors should not call virtual methods.</span></span> <span data-ttu-id="028ce-245">Il motivo sta nel fatto che i costruttori possono essere chiamati come inizializzazione di base di un costruttore di classe derivato, pertanto l'uso del metodo virtuale tramite il costruttore potrebbe avvenire a uno stato incompleto dell'inizializzazione dell'istanza di oggetto in corso di creazione.</span><span class="sxs-lookup"><span data-stu-id="028ce-245">This is because constructors can be called as base initialization of a derived class constructor, and entering the virtual method through the constructor might occur at an incomplete initialization state of the object instance being constructed.</span></span> <span data-ttu-id="028ce-246">Quando si deriva da una classe che deriva già da <xref:System.Windows.DependencyObject> , è necessario tenere presente che il sistema di proprietà stesso chiama ed espone internamente i metodi virtuali.</span><span class="sxs-lookup"><span data-stu-id="028ce-246">When you derive from any class that already derives from <xref:System.Windows.DependencyObject>, you should be aware that the property system itself calls and exposes virtual methods internally.</span></span> <span data-ttu-id="028ce-247">Tali metodi virtuali sono parte dei servizi del sistema di proprietà [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="028ce-247">These virtual methods are part of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] property system services.</span></span> <span data-ttu-id="028ce-248">L'esecuzione dell'override dei metodi consente alle classi derivate di partecipare alla determinazione del valore.</span><span class="sxs-lookup"><span data-stu-id="028ce-248">Overriding the methods enables derived classes to participate in value determination.</span></span> <span data-ttu-id="028ce-249">Per evitare eventuali problemi con l'inizializzazione del runtime, è consigliabile evitare di impostare valori della proprietà di dipendenza all'interno dei costruttori di classi, a meno che non si segua un modello del costruttore molto specifico.</span><span class="sxs-lookup"><span data-stu-id="028ce-249">To avoid potential issues with runtime initialization, you should not set dependency property values within constructors of classes, unless you follow a very specific constructor pattern.</span></span> <span data-ttu-id="028ce-250">Per altri dettagli, vedere [Modelli di costruttore sicuri per DependencyObject](safe-constructor-patterns-for-dependencyobjects.md).</span><span class="sxs-lookup"><span data-stu-id="028ce-250">For details, see [Safe Constructor Patterns for DependencyObjects](safe-constructor-patterns-for-dependencyobjects.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="028ce-251">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="028ce-251">See also</span></span>

- [<span data-ttu-id="028ce-252">Cenni preliminari sulle proprietà di dipendenza</span><span class="sxs-lookup"><span data-stu-id="028ce-252">Dependency Properties Overview</span></span>](dependency-properties-overview.md)
- [<span data-ttu-id="028ce-253">Metadati delle proprietà di dipendenza</span><span class="sxs-lookup"><span data-stu-id="028ce-253">Dependency Property Metadata</span></span>](dependency-property-metadata.md)
- [<span data-ttu-id="028ce-254">Panoramica della creazione di controlli</span><span class="sxs-lookup"><span data-stu-id="028ce-254">Control Authoring Overview</span></span>](../controls/control-authoring-overview.md)
- [<span data-ttu-id="028ce-255">Proprietà di dipendenza di tipo raccolta</span><span class="sxs-lookup"><span data-stu-id="028ce-255">Collection-Type Dependency Properties</span></span>](collection-type-dependency-properties.md)
- [<span data-ttu-id="028ce-256">Sicurezza delle proprietà di dipendenza</span><span class="sxs-lookup"><span data-stu-id="028ce-256">Dependency Property Security</span></span>](dependency-property-security.md)
- [<span data-ttu-id="028ce-257">Caricamento XAML e proprietà di dipendenza</span><span class="sxs-lookup"><span data-stu-id="028ce-257">XAML Loading and Dependency Properties</span></span>](xaml-loading-and-dependency-properties.md)
- [<span data-ttu-id="028ce-258">Modelli di costruttore sicuri per DependencyObject</span><span class="sxs-lookup"><span data-stu-id="028ce-258">Safe Constructor Patterns for DependencyObjects</span></span>](safe-constructor-patterns-for-dependencyobjects.md)
