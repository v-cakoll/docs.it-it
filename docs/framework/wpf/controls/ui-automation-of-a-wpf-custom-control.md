---
title: Automazione interfaccia utente di un controllo personalizzato
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- custom controls [WPF], applying UI automation
- accessibility [WPF], applying to custom controls
- custom controls [WPF], improving accessibility
- UI Automation [WPF], using with custom controls
ms.assetid: 47b310fc-fbd5-4ce2-a606-22d04c6d4911
ms.openlocfilehash: a370ed2c6b1f3273eca93b4865a032e8299f1cfb
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/24/2020
ms.locfileid: "76738204"
---
# <a name="ui-automation-of-a-wpf-custom-control"></a><span data-ttu-id="d5d0b-102">Automazione interfaccia utente di un controllo personalizzato WPF</span><span class="sxs-lookup"><span data-stu-id="d5d0b-102">UI Automation of a WPF Custom Control</span></span>
[!INCLUDE[TLA#tla_uiautomation](../../../../includes/tlasharptla-uiautomation-md.md)] <span data-ttu-id="d5d0b-103">fornisce una singola interfaccia generalizzata che i client di automazione possono usare per esaminare o gestire le interfacce utente di una varietà di piattaforme e framework.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-103">provides a single, generalized interface that automation clients can use to examine or operate the user interfaces of a variety of platforms and frameworks.</span></span> [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="d5d0b-104">consente sia al codice di controllo di qualità (test) sia alle applicazioni di accessibilità, ad esempio le utilità per la lettura dello schermo, di esaminare gli elementi dell'interfaccia utente e simulare l'interazione dell'utente da altro codice.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-104">enables both quality-assurance (test) code and accessibility applications such as screen readers to examine user-interface elements and simulate user interaction with them from other code.</span></span> <span data-ttu-id="d5d0b-105">Per informazioni su [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] in tutte le piattaforme, vedere Accessibilità.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-105">For information about [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] across all platforms, see Accessibility.</span></span>  
  
 <span data-ttu-id="d5d0b-106">L'articolo descrive come implementare un provider di automazione interfaccia utente sul lato server per un controllo personalizzato che viene eseguito in un'applicazione WPF.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-106">This topic describes how to implement a server-side UI Automation provider for a custom control that runs in a WPF application.</span></span> <span data-ttu-id="d5d0b-107">WPF supporta [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] attraverso un albero di oggetti di automazione peer che affianca l'albero di elementi dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-107">WPF supports [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] through a tree of peer automation objects that parallels the tree of user interface elements.</span></span> <span data-ttu-id="d5d0b-108">Il codice di test e le applicazioni che forniscono funzionalità di accessibilità possono usare gli oggetti peer di automazione direttamente (per il codice in-process) o tramite l'interfaccia generalizzata fornita da [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d5d0b-108">Test code and applications that provide accessibility features can use automation peer objects directly (for in-process code) or through the generalized interface provided by [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)].</span></span>  

<a name="AutomationPeerClasses"></a>   
## <a name="automation-peer-classes"></a><span data-ttu-id="d5d0b-109">Classi peer di automazione</span><span class="sxs-lookup"><span data-stu-id="d5d0b-109">Automation Peer Classes</span></span>  
 <span data-ttu-id="d5d0b-110">I controlli WPF supportano [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] tramite un albero di classi peer che derivano da <xref:System.Windows.Automation.Peers.AutomationPeer>.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-110">WPF controls support [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] through a tree of peer classes that derive from <xref:System.Windows.Automation.Peers.AutomationPeer>.</span></span> <span data-ttu-id="d5d0b-111">Per convenzione, i nomi delle classi peer iniziano con il nome della classe del controllo e terminano con "AutomationPeer".</span><span class="sxs-lookup"><span data-stu-id="d5d0b-111">By convention, peer class names begin with the control class name and end with "AutomationPeer".</span></span> <span data-ttu-id="d5d0b-112">Ad esempio, <xref:System.Windows.Automation.Peers.ButtonAutomationPeer> è la classe peer per la classe del controllo <xref:System.Windows.Controls.Button>.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-112">For example, <xref:System.Windows.Automation.Peers.ButtonAutomationPeer> is the peer class for the <xref:System.Windows.Controls.Button> control class.</span></span> <span data-ttu-id="d5d0b-113">Le classi peer sono approssimativamente equivalenti ai tipi di controllo [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] ma sono specifici degli elementi WPF.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-113">The peer classes are roughly equivalent to [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] control types but are specific to WPF elements.</span></span> <span data-ttu-id="d5d0b-114">Il codice di automazione che accede alle applicazioni WPF tramite l'interfaccia [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] non usa direttamente i peer di automazione, invece il codice di automazione nello stesso spazio di processo può usarli direttamente.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-114">Automation code that accesses WPF applications through the [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] interface does not use automation peers directly, but automation code in the same process space can use automation peers directly.</span></span>  
  
<a name="BuiltInAutomationPeerClasses"></a>   
## <a name="built-in-automation-peer-classes"></a><span data-ttu-id="d5d0b-115">Classi peer di automazione integrate</span><span class="sxs-lookup"><span data-stu-id="d5d0b-115">Built-in Automation Peer Classes</span></span>  
 <span data-ttu-id="d5d0b-116">Gli elementi implementano una classe peer di automazione se accettano l'attività dell'interfaccia da parte dell'utente o se contengono le informazioni necessarie per gli utenti di applicazioni per la lettura dello schermo.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-116">Elements implement an automation peer class if they accept interface activity from the user, or if they contain information needed by users of screen-reader applications.</span></span> <span data-ttu-id="d5d0b-117">Non tutti gli oggetti visivi WPF dispongono di peer di automazione.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-117">Not all WPF visual elements have automation peers.</span></span> <span data-ttu-id="d5d0b-118">Esempi di classi che implementano i peer di automazione sono <xref:System.Windows.Controls.Button>, <xref:System.Windows.Controls.TextBox>e <xref:System.Windows.Controls.Label>.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-118">Examples of classes that implement automation peers are <xref:System.Windows.Controls.Button>, <xref:System.Windows.Controls.TextBox>, and <xref:System.Windows.Controls.Label>.</span></span> <span data-ttu-id="d5d0b-119">Esempi di classi che non implementano i peer di automazione sono classi che derivano da <xref:System.Windows.Controls.Decorator>, ad esempio <xref:System.Windows.Controls.Border>, e classi basate su <xref:System.Windows.Controls.Panel>, ad esempio <xref:System.Windows.Controls.Grid> e <xref:System.Windows.Controls.Canvas>.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-119">Examples of classes that do not implement automation peers are classes that derive from <xref:System.Windows.Controls.Decorator>, such as <xref:System.Windows.Controls.Border>, and classes based on <xref:System.Windows.Controls.Panel>, such as <xref:System.Windows.Controls.Grid> and <xref:System.Windows.Controls.Canvas>.</span></span>  
  
 <span data-ttu-id="d5d0b-120">La classe di base <xref:System.Windows.Controls.Control> non dispone di una classe peer corrispondente.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-120">The base <xref:System.Windows.Controls.Control> class does not have a corresponding peer class.</span></span> <span data-ttu-id="d5d0b-121">Se è necessaria una classe peer che corrisponda a un controllo personalizzato che deriva da <xref:System.Windows.Controls.Control>, è necessario derivare la classe peer personalizzata da <xref:System.Windows.Automation.Peers.FrameworkElementAutomationPeer>.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-121">If you need a peer class to correspond to a custom control that derives from <xref:System.Windows.Controls.Control>, you should derive the custom peer class from <xref:System.Windows.Automation.Peers.FrameworkElementAutomationPeer>.</span></span>  
  
<a name="SecurityConsiderations"></a>   
## <a name="security-considerations-for-derived-peers"></a><span data-ttu-id="d5d0b-122">Considerazioni sulla sicurezza per i peer derivati</span><span class="sxs-lookup"><span data-stu-id="d5d0b-122">Security Considerations for Derived Peers</span></span>  
 <span data-ttu-id="d5d0b-123">I peer di automazione devono essere eseguiti in un ambiente parzialmente attendibile.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-123">Automation peers must run in a partial-trust environment.</span></span> <span data-ttu-id="d5d0b-124">Il codice nell'assembly UIAutomationClient non è configurato per l'esecuzione in un ambiente parzialmente attendibile e il codice di peer di automazione non deve fare riferimento a tale assembly.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-124">Code in the UIAutomationClient assembly is not configured to run in a partial-trust environment, and automation peer code should not reference that assembly.</span></span> <span data-ttu-id="d5d0b-125">È consigliabile invece usare le classi nell'assembly UIAutomationTypes.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-125">Instead, you should use the classes in the UIAutomationTypes assembly.</span></span> <span data-ttu-id="d5d0b-126">Ad esempio, è necessario usare la classe <xref:System.Windows.Automation.AutomationElementIdentifiers> dall'assembly UIAutomationTypes, che corrisponde alla classe <xref:System.Windows.Automation.AutomationElement> nell'assembly UIAutomationClient.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-126">For example, you should use the <xref:System.Windows.Automation.AutomationElementIdentifiers> class from the UIAutomationTypes assembly, which corresponds to the <xref:System.Windows.Automation.AutomationElement> class in the UIAutomationClient assembly.</span></span> <span data-ttu-id="d5d0b-127">Un modo sicuro consiste nel fare riferimento all'assembly UIAutomationTypes nel codice del peer di automazione.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-127">It is safe to reference the UIAutomationTypes assembly in automation peer code.</span></span>  
  
<a name="PeerNavigation"></a>   
## <a name="peer-navigation"></a><span data-ttu-id="d5d0b-128">Navigazione nel peer</span><span class="sxs-lookup"><span data-stu-id="d5d0b-128">Peer Navigation</span></span>  
 <span data-ttu-id="d5d0b-129">Dopo aver individuato un peer di automazione, il codice in-process può spostarsi nell'albero del peer chiamando i metodi di <xref:System.Windows.Automation.Peers.AutomationPeer.GetChildren%2A> e <xref:System.Windows.Automation.Peers.AutomationPeer.GetParent%2A> dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-129">After locating an automation peer, in-process code can navigate the peer tree by calling the object's <xref:System.Windows.Automation.Peers.AutomationPeer.GetChildren%2A> and <xref:System.Windows.Automation.Peers.AutomationPeer.GetParent%2A> methods.</span></span> <span data-ttu-id="d5d0b-130">Lo spostamento tra elementi WPF all'interno di un controllo è supportato dall'implementazione del peer del <xref:System.Windows.Automation.Peers.AutomationPeer.GetChildrenCore%2A> metodo.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-130">Navigation among WPF elements within a control is supported by the peer's implementation of the <xref:System.Windows.Automation.Peers.AutomationPeer.GetChildrenCore%2A> method.</span></span> <span data-ttu-id="d5d0b-131">Il sistema di Automazione interfaccia utente chiama questo metodo per creare un albero di sottoelementi contenuti in un controllo, come ad esempio le voci di una casella di riepilogo.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-131">The UI Automation system calls this method to build up a tree of subelements contained within a control; for example, list items in a list box.</span></span> <span data-ttu-id="d5d0b-132">Il metodo <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetChildrenCore%2A?displayProperty=nameWithType> predefinito attraversa la struttura ad albero visuale degli elementi per compilare la struttura ad albero dei peer di automazione.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-132">The default <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetChildrenCore%2A?displayProperty=nameWithType> method traverses the visual tree of elements to build the tree of automation peers.</span></span> <span data-ttu-id="d5d0b-133">I controlli personalizzati eseguono l'override del metodo per esporre gli elementi figlio ai client di automazione, restituendo i peer di automazione di elementi che contengono informazioni o consentono l'interazione da parte dell'utente.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-133">Custom controls override this method to expose children elements to automation clients, returning the automation peers of elements that convey information or allow user interaction.</span></span>  
  
<a name="Customizations"></a>   
## <a name="customizations-in-a-derived-peer"></a><span data-ttu-id="d5d0b-134">Personalizzazioni in un peer derivato</span><span class="sxs-lookup"><span data-stu-id="d5d0b-134">Customizations in a Derived Peer</span></span>  
 <span data-ttu-id="d5d0b-135">Tutte le classi che derivano da <xref:System.Windows.UIElement> e <xref:System.Windows.ContentElement> contengono il metodo virtuale protetto <xref:System.Windows.UIElement.OnCreateAutomationPeer%2A>.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-135">All classes that derive from <xref:System.Windows.UIElement> and <xref:System.Windows.ContentElement> contain the protected virtual method <xref:System.Windows.UIElement.OnCreateAutomationPeer%2A>.</span></span> <span data-ttu-id="d5d0b-136">WPF chiama <xref:System.Windows.UIElement.OnCreateAutomationPeer%2A> per ottenere l'oggetto peer di automazione per ogni controllo.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-136">WPF calls <xref:System.Windows.UIElement.OnCreateAutomationPeer%2A> to get the automation peer object for each control.</span></span> <span data-ttu-id="d5d0b-137">Il codice di automazione può usare il peer per ottenere informazioni sulle funzionalità e le caratteristiche di un controllo e per simulare l'uso interattivo.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-137">Automation code can use the peer to get information about a control’s characteristics and features and to simulate interactive use.</span></span> <span data-ttu-id="d5d0b-138">Un controllo personalizzato che supporta l'automazione deve eseguire l'override di <xref:System.Windows.UIElement.OnCreateAutomationPeer%2A> e restituire un'istanza di una classe che deriva da <xref:System.Windows.Automation.Peers.AutomationPeer>.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-138">A custom control that supports automation must override <xref:System.Windows.UIElement.OnCreateAutomationPeer%2A> and return an instance of a class that derives from <xref:System.Windows.Automation.Peers.AutomationPeer>.</span></span> <span data-ttu-id="d5d0b-139">Se, ad esempio, un controllo personalizzato deriva dalla classe <xref:System.Windows.Controls.Primitives.ButtonBase>, l'oggetto restituito da <xref:System.Windows.UIElement.OnCreateAutomationPeer%2A> deve derivare da <xref:System.Windows.Automation.Peers.ButtonBaseAutomationPeer>.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-139">For example, if a custom control derives from the <xref:System.Windows.Controls.Primitives.ButtonBase> class, then the object returned by <xref:System.Windows.UIElement.OnCreateAutomationPeer%2A> should derive from <xref:System.Windows.Automation.Peers.ButtonBaseAutomationPeer>.</span></span>  
  
 <span data-ttu-id="d5d0b-140">Quando si implementa un controllo personalizzato, è necessario eseguire l'override dei metodi "Core" dalla classe peer di automazione di base che descrivono il comportamento univoco e specifico del controllo personalizzato.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-140">When implementing a custom control, you must override the "Core" methods from the base automation peer class that describe behavior unique and specific to your custom control.</span></span>  
  
### <a name="override-oncreateautomationpeer"></a><span data-ttu-id="d5d0b-141">Override di OnCreateAutomationPeer</span><span class="sxs-lookup"><span data-stu-id="d5d0b-141">Override OnCreateAutomationPeer</span></span>  
 <span data-ttu-id="d5d0b-142">Eseguire l'override del metodo <xref:System.Windows.UIElement.OnCreateAutomationPeer%2A> per il controllo personalizzato in modo che restituisca l'oggetto provider, che deve derivare direttamente o indirettamente da <xref:System.Windows.Automation.Peers.AutomationPeer>.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-142">Override the <xref:System.Windows.UIElement.OnCreateAutomationPeer%2A> method for your custom control so that it returns your provider object, which must derive directly or indirectly from <xref:System.Windows.Automation.Peers.AutomationPeer>.</span></span>  
  
### <a name="override-getpattern"></a><span data-ttu-id="d5d0b-143">Override di GetPattern</span><span class="sxs-lookup"><span data-stu-id="d5d0b-143">Override GetPattern</span></span>  
 <span data-ttu-id="d5d0b-144">I peer di automazione semplificano alcuni aspetti dell'implementazione di provider [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] sul lato server, tuttavia i peer di automazione di controlli personalizzati devono comunque gestire le interfacce dei criteri.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-144">Automation peers simplify some implementation aspects of server-side [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] providers, but custom control automation peers must still handle pattern interfaces.</span></span> <span data-ttu-id="d5d0b-145">Come per i provider non WPF, i peer supportano i pattern di controllo fornendo le implementazioni delle interfacce nello spazio dei nomi <xref:System.Windows.Automation.Provider?displayProperty=nameWithType>, ad esempio <xref:System.Windows.Automation.Provider.IInvokeProvider>.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-145">Like non-WPF providers, peers support control patterns by providing implementations of interfaces in the <xref:System.Windows.Automation.Provider?displayProperty=nameWithType> namespace, such as <xref:System.Windows.Automation.Provider.IInvokeProvider>.</span></span> <span data-ttu-id="d5d0b-146">Le interfacce dei criteri di controllo possono essere implementate dal peer stesso o da un altro oggetto.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-146">The control pattern interfaces can be implemented by the peer itself or by another object.</span></span> <span data-ttu-id="d5d0b-147">L'implementazione del peer di <xref:System.Windows.Automation.Peers.AutomationPeer.GetPattern%2A> restituisce l'oggetto che supporta il criterio specificato.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-147">The peer's implementation of <xref:System.Windows.Automation.Peers.AutomationPeer.GetPattern%2A> returns the object that supports the specified pattern.</span></span> [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="d5d0b-148">codice chiama il metodo <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetPattern%2A> e specifica un <xref:System.Windows.Automation.Peers.PatternInterface> valore di enumerazione.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-148">code calls the <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetPattern%2A> method and specifies a <xref:System.Windows.Automation.Peers.PatternInterface> enumeration value.</span></span> <span data-ttu-id="d5d0b-149">L'override di <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetPattern%2A> deve restituire l'oggetto che implementa il pattern specificato.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-149">Your override of <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetPattern%2A> should return the object that implements the specified pattern.</span></span> <span data-ttu-id="d5d0b-150">Se il controllo non dispone di un'implementazione personalizzata di un modello, è possibile chiamare l'implementazione del tipo di base di <xref:System.Windows.Automation.Peers.AutomationPeer.GetPattern%2A> per recuperare la relativa implementazione o null se il modello non è supportato per questo tipo di controllo.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-150">If your control does not have a custom implementation of a pattern, you can call the base type's implementation of <xref:System.Windows.Automation.Peers.AutomationPeer.GetPattern%2A> to retrieve either its implementation or null if the pattern is not supported for this control type.</span></span> <span data-ttu-id="d5d0b-151">Un controllo NumericUpDown personalizzato, ad esempio, può essere impostato su un valore compreso in un intervallo, quindi il relativo [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] peer implementa l'interfaccia <xref:System.Windows.Automation.Provider.IRangeValueProvider>.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-151">For example, a custom NumericUpDown control can be set to a value within a range, so its [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] peer would implement the <xref:System.Windows.Automation.Provider.IRangeValueProvider> interface.</span></span> <span data-ttu-id="d5d0b-152">Nell'esempio seguente viene illustrato come eseguire l'override del metodo <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetPattern%2A> del peer per rispondere a un valore <xref:System.Windows.Automation.Peers.PatternInterface.RangeValue?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-152">The following example shows how the peer's <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetPattern%2A> method is overridden to respond to a <xref:System.Windows.Automation.Peers.PatternInterface.RangeValue?displayProperty=nameWithType> value.</span></span>  
  
 [!code-csharp[CustomControlNumericUpDown#GetPattern](~/samples/snippets/csharp/VS_Snippets_Wpf/CustomControlNumericUpDown/CSharp/CustomControlLibrary/NumericUpDown.cs#getpattern)]
 [!code-vb[CustomControlNumericUpDown#GetPattern](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CustomControlNumericUpDown/visualbasic/customcontrollibrary/numericupdown.vb#getpattern)]  
  
 <span data-ttu-id="d5d0b-153">Un metodo <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetPattern%2A> può inoltre specificare un sottoelemento come provider di criteri.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-153">A <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetPattern%2A> method can also specify a subelement as a pattern provider.</span></span> <span data-ttu-id="d5d0b-154">Nel codice seguente viene illustrato il modo in cui <xref:System.Windows.Controls.ItemsControl> trasferisce la gestione dei pattern di scorrimento al peer del controllo <xref:System.Windows.Controls.ScrollViewer> interno.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-154">The following code shows how <xref:System.Windows.Controls.ItemsControl> transfers scroll pattern handling to the peer of its internal <xref:System.Windows.Controls.ScrollViewer> control.</span></span>  
  
```csharp  
public override object GetPattern(PatternInterface patternInterface)  
{  
    if (patternInterface == PatternInterface.Scroll)  
    {  
        ItemsControl owner = (ItemsControl) base.Owner;  
  
        // ScrollHost is internal to the ItemsControl class  
        if (owner.ScrollHost != null)  
        {  
            AutomationPeer peer = UIElementAutomationPeer.CreatePeerForElement(owner.ScrollHost);  
            if ((peer != null) && (peer is IScrollProvider))  
            {  
                peer.EventsSource = this;  
                return (IScrollProvider) peer;  
            }  
        }  
    }  
    return base.GetPattern(patternInterface);  
}  
```  
  
```vb  
Public Class Class1  
    Public Overrides Function GetPattern(ByVal patternInterface__1 As PatternInterface) As Object  
        If patternInterface1 = PatternInterface.Scroll Then  
            Dim owner As ItemsControl = DirectCast(MyBase.Owner, ItemsControl)  
  
            ' ScrollHost is internal to the ItemsControl class  
            If owner.ScrollHost IsNot Nothing Then  
                Dim peer As AutomationPeer = UIElementAutomationPeer.CreatePeerForElement(owner.ScrollHost)  
                If (peer IsNot Nothing) AndAlso (TypeOf peer Is IScrollProvider) Then  
                    peer.EventsSource = Me  
                    Return DirectCast(peer, IScrollProvider)  
                End If  
            End If  
        End If  
        Return MyBase.GetPattern(patternInterface1)  
    End Function  
End Class  
```  
  
 <span data-ttu-id="d5d0b-155">Per specificare un sottoelemento per la gestione dei modelli, questo codice ottiene l'oggetto sottoelemento, crea un peer usando il metodo <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.CreatePeerForElement%2A>, imposta la proprietà <xref:System.Windows.Automation.Peers.AutomationPeer.EventsSource%2A> del nuovo peer sul peer corrente e restituisce il nuovo peer.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-155">To specify a subelement for pattern handling, this code gets the subelement object, creates a peer by using the <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.CreatePeerForElement%2A> method, sets the <xref:System.Windows.Automation.Peers.AutomationPeer.EventsSource%2A> property of the new peer to the current peer, and returns the new peer.</span></span> <span data-ttu-id="d5d0b-156">L'impostazione di <xref:System.Windows.Automation.Peers.AutomationPeer.EventsSource%2A> su un sottoelemento impedisce la visualizzazione del sottoelemento nell'albero del peer di automazione e designa tutti gli eventi generati dal sottoelemento come originati dal controllo specificato in <xref:System.Windows.Automation.Peers.AutomationPeer.EventsSource%2A>.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-156">Setting <xref:System.Windows.Automation.Peers.AutomationPeer.EventsSource%2A> on a subelement prevents the subelement from appearing in the automation peer tree and designates all events raised by the subelement as originating from the control specified in <xref:System.Windows.Automation.Peers.AutomationPeer.EventsSource%2A>.</span></span> <span data-ttu-id="d5d0b-157">Il controllo <xref:System.Windows.Controls.ScrollViewer> non viene visualizzato nell'albero di automazione e gli eventi di scorrimento generati sembrano avere origine dall'oggetto <xref:System.Windows.Controls.ItemsControl>.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-157">The <xref:System.Windows.Controls.ScrollViewer> control does not appear in the automation tree, and scrolling events that it generates appear to originate from the <xref:System.Windows.Controls.ItemsControl> object.</span></span>  
  
### <a name="override-core-methods"></a><span data-ttu-id="d5d0b-158">Override dei metodi "Core"</span><span class="sxs-lookup"><span data-stu-id="d5d0b-158">Override "Core" Methods</span></span>  
 <span data-ttu-id="d5d0b-159">Il codice di automazione ottiene informazioni sul controllo tramite chiamate a metodi pubblici della classe peer.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-159">Automation code gets information about your control by calling public methods of the peer class.</span></span> <span data-ttu-id="d5d0b-160">Per fornire informazioni sul controllo, eseguire l'override di ogni metodo il cui nome termina con "Core" quando l'implementazione del controllo differisce da quella fornita dalla classe peer di automazione di base.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-160">To provide information about your control, override each method whose name ends with "Core" when your control implementation differs from that of that provided by the base automation peer class.</span></span> <span data-ttu-id="d5d0b-161">Come minimo, il controllo deve implementare i metodi <xref:System.Windows.Automation.Peers.AutomationPeer.GetClassNameCore%2A> e <xref:System.Windows.Automation.Peers.AutomationPeer.GetAutomationControlTypeCore%2A>, come illustrato nell'esempio seguente.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-161">At a minimum, your control must implement the <xref:System.Windows.Automation.Peers.AutomationPeer.GetClassNameCore%2A> and <xref:System.Windows.Automation.Peers.AutomationPeer.GetAutomationControlTypeCore%2A> methods, as shown in the following example.</span></span>  
  
 [!code-csharp[CustomControlNumericUpDown#CoreOverrides](~/samples/snippets/csharp/VS_Snippets_Wpf/CustomControlNumericUpDown/CSharp/CustomControlLibrary/NumericUpDown.cs#coreoverrides)]
 [!code-vb[CustomControlNumericUpDown#CoreOverrides](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CustomControlNumericUpDown/visualbasic/customcontrollibrary/numericupdown.vb#coreoverrides)]  
  
 <span data-ttu-id="d5d0b-162">L'implementazione di <xref:System.Windows.Automation.Peers.AutomationPeer.GetAutomationControlTypeCore%2A> descrive il controllo restituendo un valore <xref:System.Windows.Automation.ControlType>.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-162">Your implementation of <xref:System.Windows.Automation.Peers.AutomationPeer.GetAutomationControlTypeCore%2A> describes your control by returning a <xref:System.Windows.Automation.ControlType> value.</span></span> <span data-ttu-id="d5d0b-163">Sebbene sia possibile restituire <xref:System.Windows.Automation.ControlType.Custom?displayProperty=nameWithType>, è necessario restituire uno dei tipi di controllo più specifici se il controllo viene descritto in modo accurato.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-163">Although you can return <xref:System.Windows.Automation.ControlType.Custom?displayProperty=nameWithType>, you should return one of the more specific control types if it accurately describes your control.</span></span> <span data-ttu-id="d5d0b-164">Un valore restituito di <xref:System.Windows.Automation.ControlType.Custom?displayProperty=nameWithType> richiede un lavoro aggiuntivo affinché il provider implementi [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)]e [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] i prodotti client non siano in grado di prevedere la struttura del controllo, l'interazione da tastiera e i possibili pattern di controllo.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-164">A return value of <xref:System.Windows.Automation.ControlType.Custom?displayProperty=nameWithType> requires extra work for the provider to implement [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)], and [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] client products are unable to anticipate the control structure, keyboard interaction, and possible control patterns.</span></span>  
  
 <span data-ttu-id="d5d0b-165">Implementare i metodi <xref:System.Windows.Automation.Peers.AutomationPeer.IsContentElementCore%2A> e <xref:System.Windows.Automation.Peers.AutomationPeer.IsControlElementCore%2A> per indicare se il controllo contiene contenuto dati o se soddisfa un ruolo interattivo nell'interfaccia utente (o entrambi).</span><span class="sxs-lookup"><span data-stu-id="d5d0b-165">Implement the <xref:System.Windows.Automation.Peers.AutomationPeer.IsContentElementCore%2A> and <xref:System.Windows.Automation.Peers.AutomationPeer.IsControlElementCore%2A> methods to indicate whether your control contains data content or fulfills an interactive role in the user interface (or both).</span></span> <span data-ttu-id="d5d0b-166">Per impostazione predefinita, entrambi i metodi restituiscono `true`.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-166">By default, both methods return `true`.</span></span> <span data-ttu-id="d5d0b-167">Queste impostazioni migliorano l'usabilità di strumenti di automazione, come le utilità per la lettura dello schermo, i quali possono usare questi metodi per filtrare l'albero di automazione.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-167">These settings improve the usability of automation tools such as screen readers, which may use these methods to filter the automation tree.</span></span> <span data-ttu-id="d5d0b-168">Se il metodo <xref:System.Windows.Automation.Peers.AutomationPeer.GetPattern%2A> trasferisce la gestione dei modelli a un peer di sottoelemento, il metodo di <xref:System.Windows.Automation.Peers.AutomationPeer.IsControlElementCore%2A> del peer del sottoelemento può restituire false per nascondere il peer del sottoelemento dalla struttura ad albero di automazione.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-168">If your <xref:System.Windows.Automation.Peers.AutomationPeer.GetPattern%2A> method transfers pattern handling to a subelement peer, the subelement peer's <xref:System.Windows.Automation.Peers.AutomationPeer.IsControlElementCore%2A> method can return false to hide the subelement peer from the automation tree.</span></span> <span data-ttu-id="d5d0b-169">Ad esempio, lo scorrimento in un <xref:System.Windows.Controls.ListBox> viene gestito da un <xref:System.Windows.Controls.ScrollViewer>e il peer di automazione per <xref:System.Windows.Automation.Peers.PatternInterface.Scroll?displayProperty=nameWithType> viene restituito dal metodo <xref:System.Windows.Automation.Peers.AutomationPeer.GetPattern%2A> del <xref:System.Windows.Automation.Peers.ScrollViewerAutomationPeer> associato al <xref:System.Windows.Automation.Peers.ListBoxAutomationPeer>. Pertanto, il metodo <xref:System.Windows.Automation.Peers.AutomationPeer.IsControlElementCore%2A> della <xref:System.Windows.Automation.Peers.ScrollViewerAutomationPeer> restituisce `false`, in modo che il <xref:System.Windows.Automation.Peers.ScrollViewerAutomationPeer> non venga visualizzato nell'albero di automazione.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-169">For example, scrolling in a <xref:System.Windows.Controls.ListBox> is handled by a <xref:System.Windows.Controls.ScrollViewer>, and the automation peer for <xref:System.Windows.Automation.Peers.PatternInterface.Scroll?displayProperty=nameWithType> is returned by the <xref:System.Windows.Automation.Peers.AutomationPeer.GetPattern%2A> method of the <xref:System.Windows.Automation.Peers.ScrollViewerAutomationPeer> that is associated with the <xref:System.Windows.Automation.Peers.ListBoxAutomationPeer>.Therefore, the <xref:System.Windows.Automation.Peers.AutomationPeer.IsControlElementCore%2A> method of the <xref:System.Windows.Automation.Peers.ScrollViewerAutomationPeer> returns `false`, so that the <xref:System.Windows.Automation.Peers.ScrollViewerAutomationPeer> does not appear in the automation tree.</span></span>  
  
 <span data-ttu-id="d5d0b-170">Il peer di automazione deve fornire valori predefiniti appropriati per il controllo.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-170">Your automation peer should provide appropriate default values for your control.</span></span> <span data-ttu-id="d5d0b-171">Si noti che XAML che fa riferimento al controllo può eseguire l'override delle implementazioni peer dei metodi principali includendo <xref:System.Windows.Automation.AutomationProperties> attributi.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-171">Note that XAML that references your control can override your peer implementations of core methods by including <xref:System.Windows.Automation.AutomationProperties> attributes.</span></span> <span data-ttu-id="d5d0b-172">Il codice XAML seguente, ad esempio, crea un pulsante che dispone di due proprietà [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] personalizzate.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-172">For example, the following XAML creates a button that has two customized [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] properties.</span></span>  
  
```xaml  
<Button AutomationProperties.Name="Special"   
    AutomationProperties.HelpText="This is a special button."/>  
```  
  
### <a name="implement-pattern-providers"></a><span data-ttu-id="d5d0b-173">Implementare i provider di criteri</span><span class="sxs-lookup"><span data-stu-id="d5d0b-173">Implement Pattern Providers</span></span>  
 <span data-ttu-id="d5d0b-174">Le interfacce implementate da un provider personalizzato vengono dichiarate in modo esplicito se l'elemento proprietario deriva direttamente da <xref:System.Windows.Controls.Control>.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-174">The interfaces implemented by a custom provider are explicitly declared if the owning element derives directly from <xref:System.Windows.Controls.Control>.</span></span> <span data-ttu-id="d5d0b-175">Il codice seguente, ad esempio, dichiara un peer per un <xref:System.Windows.Controls.Control> che implementa un valore di intervallo.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-175">For example, the following code declares a peer for a <xref:System.Windows.Controls.Control> that implements a range value.</span></span>  
  
```csharp  
public class RangePeer1 : FrameworkElementAutomationPeer, IRangeValueProvider { }  
```  
  
```vb  
Public Class RangePeer1  
    Inherits FrameworkElementAutomationPeer  
    Implements IRangeValueProvider  
End Class  
```  
  
 <span data-ttu-id="d5d0b-176">Se il controllo proprietario deriva da un tipo specifico di controllo, ad esempio <xref:System.Windows.Controls.Primitives.RangeBase>, il peer può essere derivato da una classe peer derivata equivalente.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-176">If the owning control derives from a specific type of control such as <xref:System.Windows.Controls.Primitives.RangeBase>, the peer can be derived from an equivalent derived peer class.</span></span> <span data-ttu-id="d5d0b-177">In questo caso, il peer deriverebbe da <xref:System.Windows.Automation.Peers.RangeBaseAutomationPeer>, che fornisce un'implementazione di base di <xref:System.Windows.Automation.Provider.IRangeValueProvider>.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-177">In this case, the peer would derive from <xref:System.Windows.Automation.Peers.RangeBaseAutomationPeer>, which supplies a base implementation of <xref:System.Windows.Automation.Provider.IRangeValueProvider>.</span></span> <span data-ttu-id="d5d0b-178">Il codice seguente mostra la dichiarazione di un peer di questo tipo.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-178">The following code shows the declaration of such a peer.</span></span>  
  
```csharp  
public class RangePeer2 : RangeBaseAutomationPeer { }  
```  
  
```vb  
Public Class RangePeer2  
    Inherits RangeBaseAutomationPeer  
End Class  
```  
  
<span data-ttu-id="d5d0b-179">Per un'implementazione di esempio, vedere [C#](https://github.com/dotnet/samples/tree/master/snippets/csharp/VS_Snippets_Wpf/CustomControlNumericUpDown/CSharp) o [Visual Basic](https://github.com/dotnet/samples/tree/master/snippets/visualbasic/VS_Snippets_Wpf/CustomControlNumericUpDown/visualbasic) codice sorgente che implementa e utilizza un controllo personalizzato NumericUpDown.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-179">For an example implementation, see the [C#](https://github.com/dotnet/samples/tree/master/snippets/csharp/VS_Snippets_Wpf/CustomControlNumericUpDown/CSharp) or [Visual Basic](https://github.com/dotnet/samples/tree/master/snippets/visualbasic/VS_Snippets_Wpf/CustomControlNumericUpDown/visualbasic) source code that implements and consumes a NumericUpDown custom control.</span></span>  
  
### <a name="raise-events"></a><span data-ttu-id="d5d0b-180">Generare eventi</span><span class="sxs-lookup"><span data-stu-id="d5d0b-180">Raise Events</span></span>  
 <span data-ttu-id="d5d0b-181">I client di automazione possono sottoscrivere eventi di automazione.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-181">Automation clients can subscribe to automation events.</span></span> <span data-ttu-id="d5d0b-182">I controlli personalizzati devono segnalare le modifiche allo stato del controllo chiamando il metodo <xref:System.Windows.Automation.Peers.AutomationPeer.RaiseAutomationEvent%2A>.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-182">Custom controls must report changes to control state by calling the <xref:System.Windows.Automation.Peers.AutomationPeer.RaiseAutomationEvent%2A> method.</span></span> <span data-ttu-id="d5d0b-183">Analogamente, quando viene modificato il valore di una proprietà, chiamare il metodo <xref:System.Windows.Automation.Peers.AutomationPeer.RaisePropertyChangedEvent%2A>.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-183">Similarly, when a property value changes, call the <xref:System.Windows.Automation.Peers.AutomationPeer.RaisePropertyChangedEvent%2A> method.</span></span> <span data-ttu-id="d5d0b-184">Il codice seguente mostra come ottenere l'oggetto peer dall'interno del codice del controllo e chiamare un metodo per generare un evento.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-184">The following code shows how to get the peer object from within the control code and call a method to raise an event.</span></span> <span data-ttu-id="d5d0b-185">Per ottimizzare la procedura, il codice determina se sono presenti listener per questo tipo di evento.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-185">As an optimization, the code determines if there are any listeners for this event type.</span></span> <span data-ttu-id="d5d0b-186">La generazione dell'evento solo in presenza di listener evita un sovraccarico inutile e consente al controllo di rimane pronto a rispondere.</span><span class="sxs-lookup"><span data-stu-id="d5d0b-186">Raising the event only when there are listeners avoids unnecessary overhead and helps the control remain responsive.</span></span>  
  
 [!code-csharp[CustomControlNumericUpDown#RaiseEventFromControl](~/samples/snippets/csharp/VS_Snippets_Wpf/CustomControlNumericUpDown/CSharp/CustomControlLibrary/NumericUpDown.cs#raiseeventfromcontrol)]
 [!code-vb[CustomControlNumericUpDown#RaiseEventFromControl](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CustomControlNumericUpDown/visualbasic/customcontrollibrary/numericupdown.vb#raiseeventfromcontrol)]  
  
## <a name="see-also"></a><span data-ttu-id="d5d0b-187">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="d5d0b-187">See also</span></span>

- [<span data-ttu-id="d5d0b-188">Panoramica di automazione interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="d5d0b-188">UI Automation Overview</span></span>](../../ui-automation/ui-automation-overview.md)
- [<span data-ttu-id="d5d0b-189">Implementazione del provider di automazione interfaccia utente lato server</span><span class="sxs-lookup"><span data-stu-id="d5d0b-189">Server-Side UI Automation Provider Implementation</span></span>](../../ui-automation/server-side-ui-automation-provider-implementation.md)
- [<span data-ttu-id="d5d0b-190">Controllo personalizzato NumericUpDown (C#) su GitHub</span><span class="sxs-lookup"><span data-stu-id="d5d0b-190">NumericUpDown custom control (C#) on GitHub</span></span>](https://github.com/dotnet/samples/tree/master/snippets/csharp/VS_Snippets_Wpf/CustomControlNumericUpDown/CSharp)  
- [<span data-ttu-id="d5d0b-191">Controllo personalizzato NumericUpDown (Visual Basic) su GitHub</span><span class="sxs-lookup"><span data-stu-id="d5d0b-191">NumericUpDown custom control (Visual Basic) on GitHub</span></span>](https://github.com/dotnet/samples/tree/master/snippets/visualbasic/VS_Snippets_Wpf/CustomControlNumericUpDown/visualbasic)
