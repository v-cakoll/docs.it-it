---
title: Problemi di sicurezza nella reflection emit
description: Individuare i problemi di sicurezza nella reflection emit, eseguita tramite assembly dinamici o metodi dinamici connessi a assembly esistenti o ospitati anonimamente.
ms.date: 03/30/2017
helpviewer_keywords:
- partially trusted code
- emitting dynamic assemblies, security
- reflection emit, security
- reflection emit, partial trust scenarios
- partial trust,emitting dynamic methods
- anonymously hosted dynamic methods [.NET Framework]
- emitting dynamic assemblies,partial trust scenarios
- dynamic assemblies, security
ms.assetid: 0f8bf8fa-b993-478f-87ab-1a1a7976d298
ms.openlocfilehash: d0ca26a1d0964c935137b0a30a5d7c78f93c597b
ms.sourcegitcommit: 3d84eac0818099c9949035feb96bbe0346358504
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/21/2020
ms.locfileid: "86865242"
---
# <a name="security-issues-in-reflection-emit"></a><span data-ttu-id="365dc-103">Problemi di sicurezza nella reflection emit</span><span class="sxs-lookup"><span data-stu-id="365dc-103">Security Issues in Reflection Emit</span></span>
<span data-ttu-id="365dc-104">.NET Framework offre tre modalità per creare codice Microsoft Intermediate Language (MSIL), ciascuna con specifici problemi di sicurezza:</span><span class="sxs-lookup"><span data-stu-id="365dc-104">The .NET Framework provides three ways to emit Microsoft intermediate language (MSIL), each with its own security issues:</span></span>  
  
- [<span data-ttu-id="365dc-105">Assembly dinamici</span><span class="sxs-lookup"><span data-stu-id="365dc-105">Dynamic assemblies</span></span>](#Dynamic_Assemblies)  
  
- [<span data-ttu-id="365dc-106">Metodi dinamici ospitati anonimamente</span><span class="sxs-lookup"><span data-stu-id="365dc-106">Anonymously hosted dynamic methods</span></span>](#Anonymously_Hosted_Dynamic_Methods)  
  
- [<span data-ttu-id="365dc-107">Metodi dinamici associati ad assembly esistenti</span><span class="sxs-lookup"><span data-stu-id="365dc-107">Dynamic methods associated with existing assemblies</span></span>](#Dynamic_Methods_Associated_with_Existing_Assemblies)  
  
 <span data-ttu-id="365dc-108">Indipendentemente dalla modalità di generazione del codice dinamico, l'esecuzione del codice generato richiede tutte le autorizzazioni necessarie per i tipi e i metodi usati dal codice generato.</span><span class="sxs-lookup"><span data-stu-id="365dc-108">Regardless of the way you generate dynamic code, executing the generated code requires all the permissions that are required by the types and methods the generated code uses.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="365dc-109">Le autorizzazioni necessarie per la reflection sul codice e sul codice di creazione sono state modificate nelle versioni successive di .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="365dc-109">The permissions that are required for reflecting on code and emitting code have changed with succeeding releases of the .NET Framework.</span></span> <span data-ttu-id="365dc-110">Vedere [Informazioni sulla versione](#Version_Information) più avanti in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="365dc-110">See [Version Information](#Version_Information), later in this topic.</span></span>  
  
<a name="Dynamic_Assemblies"></a>
## <a name="dynamic-assemblies"></a><span data-ttu-id="365dc-111">Assembly dinamici</span><span class="sxs-lookup"><span data-stu-id="365dc-111">Dynamic Assemblies</span></span>  
 <span data-ttu-id="365dc-112">Gli assembly dinamici vengono creati usando gli overload del metodo <xref:System.AppDomain.DefineDynamicAssembly%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="365dc-112">Dynamic assemblies are created by using overloads of the <xref:System.AppDomain.DefineDynamicAssembly%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="365dc-113">La maggior parte degli overload di questo metodo sono deprecati in .NET Framework 4 a causa dell'eliminazione dei criteri di sicurezza a livello di computer.</span><span class="sxs-lookup"><span data-stu-id="365dc-113">Most overloads of this method are deprecated in the .NET Framework 4, because of the elimination of machine-wide security policy.</span></span> <span data-ttu-id="365dc-114">Vedere [modifiche della sicurezza](https://docs.microsoft.com/previous-versions/dotnet/framework/security/security-changes). Gli overload rimanenti possono essere eseguiti da qualsiasi codice, indipendentemente dal livello di attendibilità.</span><span class="sxs-lookup"><span data-stu-id="365dc-114">(See [Security Changes](https://docs.microsoft.com/previous-versions/dotnet/framework/security/security-changes).) The remaining overloads can be executed by any code, regardless of trust level.</span></span> <span data-ttu-id="365dc-115">Questi overload rientrano in due gruppi: quelli che specificano un elenco di attributi da applicare all'assembly dinamico quando viene creato e quelli che non lo specificano.</span><span class="sxs-lookup"><span data-stu-id="365dc-115">These overloads fall into two groups: those that specify a list of attributes to apply to the dynamic assembly when it is created, and those that do not.</span></span> <span data-ttu-id="365dc-116">Se non si specifica il modello di trasparenza per l'assembly, applicando l'attributo <xref:System.Security.SecurityRulesAttribute> durante la creazione, il modello di trasparenza viene ereditato dall'assembly di creazione.</span><span class="sxs-lookup"><span data-stu-id="365dc-116">If you do not specify the transparency model for the assembly, by applying the <xref:System.Security.SecurityRulesAttribute> attribute when you create it, the transparency model is inherited from the emitting assembly.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="365dc-117">Gli attributi applicati all'assembly dinamico dopo averlo creato mediante il metodo <xref:System.Reflection.Emit.AssemblyBuilder.SetCustomAttribute%2A> non sono effettivi fino a quando l'assembly non viene salvato su disco e caricato di nuovo in memoria.</span><span class="sxs-lookup"><span data-stu-id="365dc-117">Attributes that you apply to the dynamic assembly after it is created, by using the <xref:System.Reflection.Emit.AssemblyBuilder.SetCustomAttribute%2A> method, do not take effect until the assembly has been saved to disk and loaded into memory again.</span></span>  
  
 <span data-ttu-id="365dc-118">Il codice in un assembly dinamico può accedere a tipi e membri visibili in altri assembly.</span><span class="sxs-lookup"><span data-stu-id="365dc-118">Code in a dynamic assembly can access visible types and members in other assemblies.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="365dc-119">Gli assembly dinamici non usano i flag <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> e <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> che consentono ai metodi dinamici di accedere a tipi e membri non pubblici.</span><span class="sxs-lookup"><span data-stu-id="365dc-119">Dynamic assemblies do not use the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> and <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flags that allow dynamic methods to access nonpublic types and members.</span></span>  
  
 <span data-ttu-id="365dc-120">Gli assembly dinamici temporanei vengono creati in memoria e non vengono mai salvati su disco, pertanto non richiedono alcuna autorizzazione di accesso ai file.</span><span class="sxs-lookup"><span data-stu-id="365dc-120">Transient dynamic assemblies are created in memory and never saved to disk, so they require no file access permissions.</span></span> <span data-ttu-id="365dc-121">Il salvataggio di un assembly dinamico su disco richiede <xref:System.Security.Permissions.FileIOPermission> con flag appropriati.</span><span class="sxs-lookup"><span data-stu-id="365dc-121">Saving a dynamic assembly to disk requires <xref:System.Security.Permissions.FileIOPermission> with the appropriate flags.</span></span>  
  
### <a name="generating-dynamic-assemblies-from-partially-trusted-code"></a><span data-ttu-id="365dc-122">Generazione di assembly dinamici da codice parzialmente attendibile</span><span class="sxs-lookup"><span data-stu-id="365dc-122">Generating Dynamic Assemblies from Partially Trusted Code</span></span>  
 <span data-ttu-id="365dc-123">Considerare le condizioni in cui un assembly con autorizzazioni Internet può generare un assembly dinamico temporaneo ed eseguirne il codice:</span><span class="sxs-lookup"><span data-stu-id="365dc-123">Consider the conditions in which an assembly with Internet permissions can generate a transient dynamic assembly and execute its code:</span></span>  
  
- <span data-ttu-id="365dc-124">L'assembly dinamico usa solo tipi e membri pubblici di altri assembly.</span><span class="sxs-lookup"><span data-stu-id="365dc-124">The dynamic assembly uses only public types and members of other assemblies.</span></span>  
  
- <span data-ttu-id="365dc-125">Le autorizzazioni richieste da questi tipi e membri sono incluse nel set di concessioni dell'assembly parzialmente attendibile.</span><span class="sxs-lookup"><span data-stu-id="365dc-125">The permissions demanded by those types and members are included in the grant set of the partially trusted assembly.</span></span>  
  
- <span data-ttu-id="365dc-126">L'assembly non viene salvato su disco.</span><span class="sxs-lookup"><span data-stu-id="365dc-126">The assembly is not saved to disk.</span></span>  
  
- <span data-ttu-id="365dc-127">I simboli di debug non vengono generati.</span><span class="sxs-lookup"><span data-stu-id="365dc-127">Debug symbols are not generated.</span></span> <span data-ttu-id="365dc-128">I set di autorizzazioni `Internet` e `LocalIntranet` non includono le autorizzazioni necessarie.</span><span class="sxs-lookup"><span data-stu-id="365dc-128">(`Internet` and `LocalIntranet` permission sets do not include the necessary permissions.)</span></span>  
  
<a name="Anonymously_Hosted_Dynamic_Methods"></a>
## <a name="anonymously-hosted-dynamic-methods"></a><span data-ttu-id="365dc-129">Metodi dinamici ospitati anonimamente</span><span class="sxs-lookup"><span data-stu-id="365dc-129">Anonymously Hosted Dynamic Methods</span></span>  
 <span data-ttu-id="365dc-130">I metodi dinamici ospitati anonimamente vengono creati usando i due costruttori <xref:System.Reflection.Emit.DynamicMethod> che non specificano un tipo o un modulo associato, <xref:System.Reflection.Emit.DynamicMethod.%23ctor%28System.String%2CSystem.Type%2CSystem.Type%5B%5D%29> e <xref:System.Reflection.Emit.DynamicMethod.%23ctor%28System.String%2CSystem.Type%2CSystem.Type%5B%5D%2CSystem.Boolean%29>.</span><span class="sxs-lookup"><span data-stu-id="365dc-130">Anonymously hosted dynamic methods are created by using the two <xref:System.Reflection.Emit.DynamicMethod> constructors that do not specify an associated type or module, <xref:System.Reflection.Emit.DynamicMethod.%23ctor%28System.String%2CSystem.Type%2CSystem.Type%5B%5D%29> and <xref:System.Reflection.Emit.DynamicMethod.%23ctor%28System.String%2CSystem.Type%2CSystem.Type%5B%5D%2CSystem.Boolean%29>.</span></span> <span data-ttu-id="365dc-131">Questi costruttori inseriscono i metodi dinamici in un assembly fornito dal sistema, completamente attendibile, trasparente per la sicurezza.</span><span class="sxs-lookup"><span data-stu-id="365dc-131">These constructors place the dynamic methods in a system-provided, fully trusted, security-transparent assembly.</span></span> <span data-ttu-id="365dc-132">Non sono necessarie autorizzazioni per usare questi costruttori o per generare il codice per i metodi dinamici.</span><span class="sxs-lookup"><span data-stu-id="365dc-132">No permissions are required to use these constructors or to emit code for the dynamic methods.</span></span>  
  
 <span data-ttu-id="365dc-133">Al contrario, quando viene creato un metodo dinamico ospitato anonimamente, viene acquisito lo stack di chiamate.</span><span class="sxs-lookup"><span data-stu-id="365dc-133">Instead, when an anonymously hosted dynamic method is created, the call stack is captured.</span></span> <span data-ttu-id="365dc-134">Quando il metodo viene costruito, le richieste di sicurezza vengono effettuate sullo stack di chiamate acquisito.</span><span class="sxs-lookup"><span data-stu-id="365dc-134">When the method is constructed, security demands are made against the captured call stack.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="365dc-135">Concettualmente, le richieste vengono effettuate durante la costruzione del metodo.</span><span class="sxs-lookup"><span data-stu-id="365dc-135">Conceptually, demands are made during the construction of the method.</span></span> <span data-ttu-id="365dc-136">In altre parole, le richieste potrebbero essere effettuate durante la creazione delle singole istruzioni MSIL.</span><span class="sxs-lookup"><span data-stu-id="365dc-136">That is, demands could be made as each MSIL instruction is emitted.</span></span> <span data-ttu-id="365dc-137">Nell'implementazione corrente tutte le richieste vengono effettuate quando il metodo <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A?displayProperty=nameWithType> viene chiamato o quando viene richiamato il compilatore Just-In-Time (JIT), se il metodo viene richiamato senza chiamare <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A>.</span><span class="sxs-lookup"><span data-stu-id="365dc-137">In the current implementation, all demands are made when the <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A?displayProperty=nameWithType> method is called or when the just-in-time (JIT) compiler is invoked, if the method is invoked without calling <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A>.</span></span>  
  
 <span data-ttu-id="365dc-138">Se il dominio applicazione lo consente, i metodi dinamici ospitati anonimamente possono ignorare i controlli di visibilità JIT, ma solo se viene rispettata la restrizione seguente: i tipi e i membri non pubblici a cui accede un metodo dinamico ospitato anonimamente devono trovarsi in assembly i cui set di concessioni sono uguali o sono subset del set di concessioni dello stack di chiamate di creazione.</span><span class="sxs-lookup"><span data-stu-id="365dc-138">If the application domain permits it, anonymously hosted dynamic methods can skip JIT visibility checks, subject to the following restriction: The nonpublic types and members accessed by an anonymously hosted dynamic method must be in assemblies whose grant sets are equal to, or subsets of, the grant set of the emitting call stack.</span></span> <span data-ttu-id="365dc-139">Questa possibilità limitata di ignorare i controlli di visibilità JIT viene abilitata se il dominio applicazione concede <xref:System.Security.Permissions.ReflectionPermission> con il flag <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="365dc-139">This restricted ability to skip JIT visibility checks is enabled if the application domain grants <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag.</span></span>  
  
- <span data-ttu-id="365dc-140">Se il metodo usa solo tipi e membri pubblici, non sono necessarie autorizzazioni durante la costruzione.</span><span class="sxs-lookup"><span data-stu-id="365dc-140">If your method uses only public types and members, no permissions are required during construction.</span></span>  
  
- <span data-ttu-id="365dc-141">Se si specifica che i controlli di visibilità JIT debbano essere ignorati, la richiesta effettuata durante la costruzione del metodo includerà <xref:System.Security.Permissions.ReflectionPermission> con il flag <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> e il set di concessioni dell'assembly che contiene il membro non pubblico a cui si accede.</span><span class="sxs-lookup"><span data-stu-id="365dc-141">If you specify that JIT visibility checks should be skipped, the demand that is made when the method is constructed includes <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag and the grant set of the assembly that contains the nonpublic member that is being accessed.</span></span>  
  
 <span data-ttu-id="365dc-142">Poiché il set di concessioni del membro non pubblico viene preso in considerazione, il codice parzialmente attendibile che ha ottenuto <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> non può elevare i privilegi eseguendo membri non pubblici di assembly attendibili.</span><span class="sxs-lookup"><span data-stu-id="365dc-142">Because the grant set of the nonpublic member is taken into consideration, partially trusted code that has been granted <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> cannot elevate its privileges by executing nonpublic members of trusted assemblies.</span></span>  
  
 <span data-ttu-id="365dc-143">Come con qualsiasi altro codice generato, l'esecuzione del metodo dinamico richiede le autorizzazioni obbligatorie per i metodi usate dal metodo dinamico.</span><span class="sxs-lookup"><span data-stu-id="365dc-143">As with any other emitted code, executing the dynamic method requires whatever permissions are demanded by the methods the dynamic method uses.</span></span>  
  
 <span data-ttu-id="365dc-144">L'assembly di sistema che ospita i metodi dinamici ospitati in modo anonimo usa il modello di trasparenza <xref:System.Security.SecurityRuleSet.Level1?displayProperty=nameWithType>, usato in .NET Framework prima di .NET Framework 4.</span><span class="sxs-lookup"><span data-stu-id="365dc-144">The system assembly that hosts anonymously-hosted dynamic methods uses the <xref:System.Security.SecurityRuleSet.Level1?displayProperty=nameWithType> transparency model, which is the transparency model that was used in the .NET Framework before the .NET Framework 4.</span></span>  
  
 <span data-ttu-id="365dc-145">Per altre informazioni, vedere la classe <xref:System.Reflection.Emit.DynamicMethod>.</span><span class="sxs-lookup"><span data-stu-id="365dc-145">For more information, see the <xref:System.Reflection.Emit.DynamicMethod> class.</span></span>  
  
### <a name="generating-anonymously-hosted-dynamic-methods-from-partially-trusted-code"></a><span data-ttu-id="365dc-146">Generazione di metodi dinamici ospitati anonimamente dal codice parzialmente attendibile</span><span class="sxs-lookup"><span data-stu-id="365dc-146">Generating Anonymously Hosted Dynamic Methods from Partially Trusted Code</span></span>  
 <span data-ttu-id="365dc-147">Considerare le condizioni in cui un assembly con autorizzazioni Internet può generare un metodo dinamico ospitato anonimamente ed eseguirlo:</span><span class="sxs-lookup"><span data-stu-id="365dc-147">Consider the conditions in which an assembly with Internet permissions can generate an anonymously hosted dynamic method and execute it:</span></span>  
  
- <span data-ttu-id="365dc-148">Il metodo dinamico usa solo tipi e membri pubblici.</span><span class="sxs-lookup"><span data-stu-id="365dc-148">The dynamic method uses only public types and members.</span></span> <span data-ttu-id="365dc-149">Se il set di concessioni include <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>, è possibile usare i tipi e i membri non pubblici di qualsiasi assembly il cui set di concessioni sia uguale o sia un subset del set di concessioni dell'assembly di creazione.</span><span class="sxs-lookup"><span data-stu-id="365dc-149">If its grant set includes <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>, it can use nonpublic types and members of any assembly whose grant set is equal to, or a subset of, the grant set of the emitting assembly.</span></span>  
  
- <span data-ttu-id="365dc-150">Le autorizzazioni necessarie per tutti i tipi e i membri usati dal metodo dinamico sono incluse nel set di concessioni dell'assembly parzialmente attendibile.</span><span class="sxs-lookup"><span data-stu-id="365dc-150">The permissions that are required by all the types and members used by the dynamic method are included in the grant set of the partially trusted assembly.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="365dc-151">I metodi dinamici non supportano i simboli di debug.</span><span class="sxs-lookup"><span data-stu-id="365dc-151">Dynamic methods do not support debug symbols.</span></span>  
  
<a name="Dynamic_Methods_Associated_with_Existing_Assemblies"></a>
## <a name="dynamic-methods-associated-with-existing-assemblies"></a><span data-ttu-id="365dc-152">Metodi dinamici associati ad assembly esistenti</span><span class="sxs-lookup"><span data-stu-id="365dc-152">Dynamic Methods Associated with Existing Assemblies</span></span>  
 <span data-ttu-id="365dc-153">Per associare un metodo dinamico a un tipo o a un modulo in un assembly esistente, usare uno qualsiasi dei costruttori <xref:System.Reflection.Emit.DynamicMethod> che specificano il tipo o il modulo associato.</span><span class="sxs-lookup"><span data-stu-id="365dc-153">To associate a dynamic method with a type or module in an existing assembly, use any of the <xref:System.Reflection.Emit.DynamicMethod> constructors that specify the associated type or module.</span></span> <span data-ttu-id="365dc-154">Le autorizzazioni necessarie per chiamare questi costruttori variano, poiché l'associazione di un metodo dinamico a un tipo o a un modulo esistente fornisce al metodo dinamico l'accesso ai membri e ai tipi non pubblici:</span><span class="sxs-lookup"><span data-stu-id="365dc-154">The permissions that are required to call these constructors vary, because associating a dynamic method with an existing type or module gives the dynamic method access to nonpublic types and members:</span></span>  
  
- <span data-ttu-id="365dc-155">Un metodo dinamico associato a un tipo può accedere a tutti i membri di tale tipo, anche ai membri privati, e a tutti i tipi e membri interni nell'assembly che contiene il tipo associato.</span><span class="sxs-lookup"><span data-stu-id="365dc-155">A dynamic method that is associated with a type has access to all members of that type, even private members, and to all internal types and members in the assembly that contains the associated type.</span></span>  
  
- <span data-ttu-id="365dc-156">Un metodo dinamico associato a un modulo può accedere a tutti i tipi e membri di `internal` (`Friend` in Visual Basic, `assembly` nei metadati di Common Language Runtime) nel modulo.</span><span class="sxs-lookup"><span data-stu-id="365dc-156">A dynamic method that is associated with a module has access to all the `internal` types and members (`Friend` in Visual Basic, `assembly` in common language runtime metadata) in the module.</span></span>  
  
 <span data-ttu-id="365dc-157">Inoltre, è possibile usare un costruttore che consente di specificare la possibilità di ignorare i controlli di visibilità del compilatore JIT.</span><span class="sxs-lookup"><span data-stu-id="365dc-157">In addition, you can use a constructor that specifies the ability to skip the visibility checks of the JIT compiler.</span></span> <span data-ttu-id="365dc-158">In questo modo il metodo dinamico può accedere a tutti i tipi e membri in tutti gli assembly, indipendentemente dal livello di accesso.</span><span class="sxs-lookup"><span data-stu-id="365dc-158">Doing so gives your dynamic method access to all types and members in all assemblies, regardless of access level.</span></span>  
  
 <span data-ttu-id="365dc-159">Le autorizzazioni richieste dal costruttore dipendono dal livello di accesso che si decide di concedere al metodo dinamico:</span><span class="sxs-lookup"><span data-stu-id="365dc-159">The permissions demanded by the constructor depend on how much access you decide to give your dynamic method:</span></span>  
  
- <span data-ttu-id="365dc-160">Se il metodo usa solo membri e tipi pubblici e lo si associa a un tipo o a un modulo personalizzato, non sono necessarie autorizzazioni.</span><span class="sxs-lookup"><span data-stu-id="365dc-160">If your method uses only public types and members, and you associate it with your own type or your own module, no permissions are required.</span></span>  
  
- <span data-ttu-id="365dc-161">Se si specifica che devono essere ignorati i controlli di visibilità JIT, il costruttore richiede <xref:System.Security.Permissions.ReflectionPermission> con il flag <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="365dc-161">If you specify that JIT visibility checks should be skipped, the constructor demands <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> flag.</span></span>  
  
- <span data-ttu-id="365dc-162">Se si associa il metodo dinamico a un altro tipo, anche all'interno dell'assembly, il costruttore richiede <xref:System.Security.Permissions.ReflectionPermission> con il flag <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> e <xref:System.Security.Permissions.SecurityPermission> con il flag <xref:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="365dc-162">If you associate the dynamic method with another type, even another type in your own assembly, the constructor demands <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> flag and <xref:System.Security.Permissions.SecurityPermission> with the <xref:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence?displayProperty=nameWithType> flag.</span></span>  
  
- <span data-ttu-id="365dc-163">Se si associa il metodo dinamico a un tipo o a un modulo in un altro assembly, il costruttore richiede due cose: <xref:System.Security.Permissions.ReflectionPermission> con il flag <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> e il set di concessioni dell'assembly che contiene l'altro modulo.</span><span class="sxs-lookup"><span data-stu-id="365dc-163">If you associate the dynamic method with a type or module in another assembly, the constructor demands two things: <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag, and the grant set of the assembly that contains the other module.</span></span> <span data-ttu-id="365dc-164">Ovvero, lo stack di chiamate deve includere tutte le autorizzazioni nel set di concessioni del modulo di destinazione, oltre a <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="365dc-164">That is, your call stack must include all the permissions in the grant set of the target module, plus <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>.</span></span>  
  
    > [!NOTE]
    > <span data-ttu-id="365dc-165">Per la compatibilità con le versioni precedenti, se la richiesta per il set di concessioni di destinazione con <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> ha esito negativo, il costruttore richiede <xref:System.Security.Permissions.SecurityPermission> con il flag <xref:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="365dc-165">For backward compatibility, if the demand for the target grant set plus <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> fails, the constructor demands <xref:System.Security.Permissions.SecurityPermission> with the <xref:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence?displayProperty=nameWithType> flag.</span></span>  
  
 <span data-ttu-id="365dc-166">Anche se gli elementi nell'elenco vengono descritti in termini di set di concessioni dell'assembly, tenere presente che le richieste vengono effettuate sullo stack di chiamate completo, incluso il limite del dominio applicazione.</span><span class="sxs-lookup"><span data-stu-id="365dc-166">Although the items in this list are described in terms of the grant set of the emitting assembly, remember that the demands are made against the full call stack, including the application domain boundary.</span></span>  
  
 <span data-ttu-id="365dc-167">Per altre informazioni, vedere la classe <xref:System.Reflection.Emit.DynamicMethod>.</span><span class="sxs-lookup"><span data-stu-id="365dc-167">For more information, see the <xref:System.Reflection.Emit.DynamicMethod> class.</span></span>  
  
### <a name="generating-dynamic-methods-from-partially-trusted-code"></a><span data-ttu-id="365dc-168">Generazione di metodi dinamici dal codice parzialmente attendibile</span><span class="sxs-lookup"><span data-stu-id="365dc-168">Generating Dynamic Methods from Partially Trusted Code</span></span>  
  
> [!NOTE]
> <span data-ttu-id="365dc-169">Il metodo consigliato per generare metodi dinamici dal codice parzialmente attendibile consiste nell'usare [metodi dinamici ospitati anonimamente](#Anonymously_Hosted_Dynamic_Methods).</span><span class="sxs-lookup"><span data-stu-id="365dc-169">The recommended way to generate dynamic methods from partially trusted code is to use [anonymously hosted dynamic methods](#Anonymously_Hosted_Dynamic_Methods).</span></span>  
  
 <span data-ttu-id="365dc-170">Considerare le condizioni in cui un assembly con autorizzazioni Internet può generare un metodo dinamico ed eseguirlo:</span><span class="sxs-lookup"><span data-stu-id="365dc-170">Consider the conditions in which an assembly with Internet permissions can generate a dynamic method and execute it:</span></span>  
  
- <span data-ttu-id="365dc-171">Il metodo dinamico è associato al modulo o al tipo che lo genera oppure il set di concessioni include <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> ed è associato a un modulo in un assembly il cui set di concessioni è uguale o è un subset del set di concessioni dell'assembly di creazione.</span><span class="sxs-lookup"><span data-stu-id="365dc-171">Either the dynamic method is associated with the module or type that emits it, or its grant set includes <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> and it is associated with a module in an assembly whose grant set is equal to, or a subset of, the grant set of the emitting assembly.</span></span>  
  
- <span data-ttu-id="365dc-172">Il metodo dinamico usa solo tipi e membri pubblici.</span><span class="sxs-lookup"><span data-stu-id="365dc-172">The dynamic method uses only public types and members.</span></span> <span data-ttu-id="365dc-173">Se il set di concessioni include <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> ed è associato a un modulo in un assembly il cui set di concessioni è uguale o è un subset del set di concessioni dell'assembly di creazione, può usare tipi e membri contrassegnati come `internal` (`Friend` in Visual Basic, `assembly` nei metadati di Common Language Runtime) nel modulo associato.</span><span class="sxs-lookup"><span data-stu-id="365dc-173">If its grant set includes <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> and it is associated with a module in an assembly whose grant set is equal to, or a subset of, the grant set of the emitting assembly, it can use types and members marked `internal` (`Friend` in Visual Basic, `assembly` in common language runtime metadata) in the associated module.</span></span>  
  
- <span data-ttu-id="365dc-174">Le autorizzazioni richieste da tutti i tipi e i membri usati dal metodo dinamico sono inclusi nel set di concessioni dell'assembly parzialmente attendibile.</span><span class="sxs-lookup"><span data-stu-id="365dc-174">The permissions demanded by all the types and members used by the dynamic method are included in the grant set of the partially trusted assembly.</span></span>  
  
- <span data-ttu-id="365dc-175">Il metodo dinamico non ignora i controlli di visibilità JIT.</span><span class="sxs-lookup"><span data-stu-id="365dc-175">The dynamic method does not skip JIT visibility checks.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="365dc-176">I metodi dinamici non supportano i simboli di debug.</span><span class="sxs-lookup"><span data-stu-id="365dc-176">Dynamic methods do not support debug symbols.</span></span>  
  
<a name="Version_Information"></a>
## <a name="version-information"></a><span data-ttu-id="365dc-177">Informazioni sulla versione</span><span class="sxs-lookup"><span data-stu-id="365dc-177">Version Information</span></span>  
 <span data-ttu-id="365dc-178">A partire da .NET Framework 4, i criteri di sicurezza a livello di computer vengono eliminati e la trasparenza della sicurezza diventa il meccanismo di imposizione predefinito.</span><span class="sxs-lookup"><span data-stu-id="365dc-178">Starting with the .NET Framework 4, machine-wide security policy is eliminated and security transparency becomes the default enforcement mechanism.</span></span> <span data-ttu-id="365dc-179">Vedere [Modifiche di sicurezza](https://docs.microsoft.com/previous-versions/dotnet/framework/security/security-changes).</span><span class="sxs-lookup"><span data-stu-id="365dc-179">See [Security Changes](https://docs.microsoft.com/previous-versions/dotnet/framework/security/security-changes).</span></span>  
  
 <span data-ttu-id="365dc-180">A partire da .NET Framework 2.0 Service Pack 1, non è più necessario usare <xref:System.Security.Permissions.ReflectionPermission> con il flag <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit?displayProperty=nameWithType> quando si generano assembly e metodi dinamici.</span><span class="sxs-lookup"><span data-stu-id="365dc-180">Starting with the .NET Framework 2.0 Service Pack 1, <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit?displayProperty=nameWithType> flag is no longer required when emitting dynamic assemblies and dynamic methods.</span></span> <span data-ttu-id="365dc-181">Questo flag è richiesto in tutte le versioni precedenti di .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="365dc-181">This flag is required in all earlier versions of the .NET Framework.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="365dc-182"><xref:System.Security.Permissions.ReflectionPermission> con il flag <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit?displayProperty=nameWithType> viene incluso per impostazione predefinita nei set di autorizzazioni denominati `FullTrust` e `LocalIntranet`, ma non nel set di autorizzazioni `Internet`.</span><span class="sxs-lookup"><span data-stu-id="365dc-182"><xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit?displayProperty=nameWithType> flag is included by default in the `FullTrust` and `LocalIntranet` named permission sets, but not in the `Internet` permission set.</span></span> <span data-ttu-id="365dc-183">Pertanto, nelle versioni precedenti di .NET Framework è possibile usare una libreria con autorizzazioni Internet solo se viene eseguito un <xref:System.Security.PermissionSet.Assert%2A> per <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit>.</span><span class="sxs-lookup"><span data-stu-id="365dc-183">Therefore, in earlier versions of the .NET Framework, a library can be used with Internet permissions only if it executes an <xref:System.Security.PermissionSet.Assert%2A> for <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit>.</span></span> <span data-ttu-id="365dc-184">Tali librerie richiedono un'attenta revisione della sicurezza perché eventuali errori nel codice potrebbe produrre delle vulnerabilità.</span><span class="sxs-lookup"><span data-stu-id="365dc-184">Such libraries require careful security review because coding errors could result in security holes.</span></span> <span data-ttu-id="365dc-185">.NET Framework 2.0 SP1 consente di generare codice in scenari con attendibilità parziale senza creare alcuna richiesta di sicurezza, poiché la generazione di codice non è implicitamente un'operazione con privilegi.</span><span class="sxs-lookup"><span data-stu-id="365dc-185">The .NET Framework 2.0 SP1 allows code to be emitted in partial trust scenarios without issuing any security demands, because generating code is not inherently a privileged operation.</span></span> <span data-ttu-id="365dc-186">Ovvero, il codice generato non dispone di ulteriori autorizzazioni rispetto all'assembly che lo genera.</span><span class="sxs-lookup"><span data-stu-id="365dc-186">That is, the generated code has no more permissions than the assembly that emits it.</span></span> <span data-ttu-id="365dc-187">Questo consente alle librerie che generano il codice di essere SecurityTransparent ed elimina la necessità di asserire <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit>, che semplifica l'attività di scrittura di una libreria protetta.</span><span class="sxs-lookup"><span data-stu-id="365dc-187">This allows libraries that emit code to be security transparent and removes the need to assert <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit>, which simplifies the task of writing a secure library.</span></span>  
  
 <span data-ttu-id="365dc-188">.NET Framework 2.0 SP1 introduce inoltre il flag <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> per l'accesso a tipi e membri non pubblici da metodi dinamici parzialmente attendibili.</span><span class="sxs-lookup"><span data-stu-id="365dc-188">In addition, the .NET Framework 2.0 SP1 introduces the <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag for accessing nonpublic types and members from partially trusted dynamic methods.</span></span> <span data-ttu-id="365dc-189">Le versioni precedenti di .NET Framework richiedono il flag <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> per i metodi dinamici che accedono a membri e tipi non pubblici; si tratta di un'autorizzazione che non dovrebbe mai essere concessa a codice parzialmente attendibile.</span><span class="sxs-lookup"><span data-stu-id="365dc-189">Earlier versions of the .NET Framework require the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> flag for dynamic methods that access nonpublic types and members; this is a permission that should never be granted to partially trusted code.</span></span>  
  
 <span data-ttu-id="365dc-190">.NET Framework 2.0 SP1 introduce infine i metodi ospitati anonimamente.</span><span class="sxs-lookup"><span data-stu-id="365dc-190">Finally, the .NET Framework 2.0 SP1 introduces anonymously hosted methods.</span></span>  
  
### <a name="obtaining-information-on-types-and-members"></a><span data-ttu-id="365dc-191">Informazioni su tipi e membri</span><span class="sxs-lookup"><span data-stu-id="365dc-191">Obtaining Information on Types and Members</span></span>  
 <span data-ttu-id="365dc-192">A partire da .NET Framework 2.0 non sono necessarie autorizzazioni per ottenere informazioni sui tipi e i membri non pubblici.</span><span class="sxs-lookup"><span data-stu-id="365dc-192">Starting with the .NET Framework 2.0, no permissions are required to obtain information about nonpublic types and members.</span></span> <span data-ttu-id="365dc-193">Per ottenere le informazioni necessarie a generare metodi dinamici viene usato Reflection.</span><span class="sxs-lookup"><span data-stu-id="365dc-193">Reflection is used to obtain information needed to emit dynamic methods.</span></span> <span data-ttu-id="365dc-194">Ad esempio, gli oggetti <xref:System.Reflection.MethodInfo> vengono usati per generare le chiamate al metodo.</span><span class="sxs-lookup"><span data-stu-id="365dc-194">For example, <xref:System.Reflection.MethodInfo> objects are used to emit method calls.</span></span> <span data-ttu-id="365dc-195">Le versioni precedenti di .NET Framework richiedono <xref:System.Security.Permissions.ReflectionPermission> con il flag <xref:System.Security.Permissions.ReflectionPermissionFlag.TypeInformation?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="365dc-195">Earlier versions of the .NET Framework require <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.TypeInformation?displayProperty=nameWithType> flag.</span></span> <span data-ttu-id="365dc-196">Per altre informazioni, vedere [Security Considerations for Reflection](security-considerations-for-reflection.md) (Considerazioni sulla sicurezza per reflection).</span><span class="sxs-lookup"><span data-stu-id="365dc-196">For more information, see [Security Considerations for Reflection](security-considerations-for-reflection.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="365dc-197">Vedi anche</span><span class="sxs-lookup"><span data-stu-id="365dc-197">See also</span></span>

- [<span data-ttu-id="365dc-198">Considerazioni sulla sicurezza in relazione alla reflection</span><span class="sxs-lookup"><span data-stu-id="365dc-198">Security Considerations for Reflection</span></span>](security-considerations-for-reflection.md)
- [<span data-ttu-id="365dc-199">Creazione di assembly e metodi dinamici</span><span class="sxs-lookup"><span data-stu-id="365dc-199">Emitting Dynamic Methods and Assemblies</span></span>](emitting-dynamic-methods-and-assemblies.md)
