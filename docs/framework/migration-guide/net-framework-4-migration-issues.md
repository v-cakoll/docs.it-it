---
title: Problemi di migrazione di .NET Framework 4
description: Informazioni sui problemi di migrazione tra .NET Framework 3,5 Service Pack 1 e .NET Framework 4, incluse le correzioni e le modifiche per la conformità agli standard e la sicurezza.
ms.date: 05/02/2017
helpviewer_keywords:
- .NET Framework 4, migration
- application compatibility
ms.assetid: df478548-8c05-4de2-8ba7-adcdbe1c2a60
ms.openlocfilehash: bbb9a3803986c922fd1ef04a87cd1e230fc3d623
ms.sourcegitcommit: cf5a800a33de64d0aad6d115ffcc935f32375164
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/20/2020
ms.locfileid: "86475281"
---
# <a name="net-framework-4-migration-issues"></a>Problemi di migrazione di .NET Framework 4

In questo articolo vengono descritti i problemi di migrazione tra .NET Framework versione 3,5 Service Pack 1 e .NET Framework versione 4, incluse le correzioni, le modifiche per la conformità agli standard e la sicurezza e le modifiche in base ai suggerimenti dei clienti. La maggior parte di queste modifiche non richiede alcuna modifica a livello di codice delle applicazioni. Per coloro che possono comportare modifiche, vedere la colonna **modifiche consigliate** della tabella. Le modifiche rilevanti vengono suddivise in base all'area, ad esempio ASP.NET e Windows Presentation Foundation (WPF).

Per una panoramica più dettagliata dei problemi in questo articolo, vedere [Guida alla migrazione a .NET Framework 4](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ff657133%28v=vs.100%29).

Per informazioni sulle nuove funzionalità, vedere Novità [di .NET Framework 4](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms171868%28v=vs.100%29).

## <a name="aspnet-and-web"></a>ASP.NET e Web

Spazi dei nomi: <xref:System.Web> , <xref:System.Web.Mobile> , <xref:System.Web.Security> ,<xref:System.Web.UI.WebControls>

Assembly: System. Web (in System.Web.dll)

| Funzionalità  | Differenze rispetto alla versione 3.5 SP1 | Modifiche consigliate |
| -------- | ------------------------ | ------------------- |
| **File di definizione del browser** | I file di definizione del browser sono stati aggiornati per includere informazioni su browser e dispositivi nuovi e aggiornati. Sono stati rimossi browser e dispositivi precedenti come Netscape Navigator e sono stati aggiunti browser e dispositivi più recenti come Google Chrome e Apple iPhone.<br><br>Se l'applicazione in uso contiene definizioni del browser personalizzate che derivano da una delle definizioni del browser rimosse, viene visualizzato un errore.<br><br>L'oggetto <xref:System.Web.HttpBrowserCapabilities> esposto dalla proprietà `Request.Browse` della pagina è gestito dai file di definizione del browser. Pertanto le informazioni restituite mediante accesso a una proprietà di quest'oggetto in ASP.NET 4 possono essere diverse dalle informazioni restituite in una versione precedente di ASP.NET. | Se l'applicazione si basa sui file di definizione del browser precedenti è possibile copiarli dalla seguente cartella:<br><br>*Browser di configurazione di Windows \\ Microsoft.NET \\ Framework \\ v 2.0.50727 \\ \\*<br><br>Copiare i file nella cartella corrispondente dei * \\ \\ browser di configurazione* per ASP.NET 4. Dopo la copia dei file eseguire lo strumento della riga di comando [Aspnet_regbrowsers.exe](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms229858(v=vs.90)). Per ulteriori informazioni, vedere il [https://www.asp.net/mobile](/aspnet/mobile/overview) sito Web. |
| **Applicazioni figlio in esecuzione in versioni diverse di ASP.NET** | Le applicazioni ASP.NET 4 configurate come elementi figlio di applicazioni che eseguono versioni precedenti di ASP.NET potrebbero non avviarsi a causa di errori di compilazione o di configurazione. Gli errori specifici variano a seconda che l'applicazione sia eseguita in IIS 6.0, in IIS 7 o in IIS 7.5. | È possibile apportare modifiche ai file di configurazione delle applicazioni interessate in modo che il sistema di configurazione riconosca correttamente l'applicazione ASP.NET 4. Per informazioni sulle modifiche da apportare, vedere la sezione "ASP.NET 4 Child Applications Fail to Start When Under ASP.NET 2.0 or ASP.NET 3.5 Applications" (Le applicazioni figlio ASP.NET 4 non si avviano se dipendono da applicazioni ASP.NET 2.0 o ASP.NET 3.5) nel documento [ASP.NET 4 Breaking Changes](/aspnet/whitepapers/aspnet4/breaking-changes) (Modifiche di rilievo in ASP.NET 4) sul sito Web ASP.NET. |
| **Modifiche a ClientID** | La nuova impostazione `clientIDMode` in ASP.NET 4 consente di specificare la modalità con cui ASP.NET genera l'attributo `id` per gli elementi HTML. Nelle versioni precedenti di ASP.NET il comportamento predefinito era equivalente all'impostazione `AutoID` di `clientIDMode`. L'impostazione predefinita è ora `Predictable`. Per altre informazioni, vedere [ASP.NET Web Server Control Identification](https://docs.microsoft.com/previous-versions/aspnet/1d04y8ss%28v=vs.100%29) (Identificazione del controllo server Web ASP.NET). | Se si usa Visual Studio per aggiornare l'applicazione da ASP.NET 2,0 o ASP.NET 3,5, lo strumento aggiunge automaticamente un'impostazione al file Web.config che conserva il comportamento delle versioni precedenti di .NET Framework. Tuttavia, se si aggiorna un'applicazione modificando il pool di applicazioni in IIS impostando come destinazione .NET Framework 4, per impostazione predefinita ASP.NET utilizzerà la nuova modalità. Per disattivare la nuova modalità ID client, aggiungere l'impostazione seguente al file Web.config:<br><br>`<pages clientIDMode="AutoID" />` |
| **Sicurezza dall'accesso di codice (CAS)** | Le funzionalità .NET di ASP.NET 2.0 aggiunte in ASP.NET 3.5 usano il modello di sicurezza dall'accesso di codice .NET Framework 1.1 e .NET Framework 2.0. Tuttavia l'implementazione di CAS in ASP.NET 4 è stata modificata in modo sostanziale. Di conseguenza le applicazioni ASP.NET con attendibilità parziale che si basano su codice attendibile in esecuzione nella Global Assembly Cache possono bloccarsi, generando diverse eccezioni di sicurezza. Le applicazioni parzialmente attendibili che si basano su modifiche estese ai criteri CAS del computer potrebbe a loro volta bloccarsi e generare eccezioni di sicurezza. | È possibile ripristinare il comportamento di ASP.NET 1.1 e 2.0 per le applicazioni ASP.NET 4 con attendibilità parziale usando il nuovo attributo `legacyCasModel` nell'elemento di configurazione `trust`, come visualizzato nell'esempio seguente:<br><br>`<trust level= "Medium" legacyCasModel="true" />`<br><br>Importante: il ripristino del modello di sicurezza CAS meno recente può comportare una riduzione della protezione.<br><br>Per altre informazioni sul nuovo modello di sicurezza dall'accesso di codice di ASP.NET 4, vedere [Sicurezza dall'accesso di codice per applicazioni ASP.NET 4](https://docs.microsoft.com/previous-versions/dd984947(v=vs.100)). |
| **File di configurazione** | I file di configurazione radice (il file machine.config e il file di Web.config radice) per .NET Framework e ASP.NET 4 sono stati aggiornati in modo da includere la maggior parte delle informazioni di configurazione standard trovate nei file di Web.config dell'applicazione in ASP.NET 3,5. Data la complessità dei sistemi di configurazione gestiti IIS 7 e IIS 7.5 l'esecuzione di applicazioni ASP.NET 3.5 in ASP.NET 4 e in IIS 7 e IIS 7.5 può determinare errori ASP.NET o errori IIS. | Aggiornare le applicazioni ASP.NET 3.5 ad ASP.NET 4 con gli strumenti di aggiornamento progetto di Visual Studio. Visual Studio 2010 modifica automaticamente il file Web.config dell'applicazione ASP.NET 3.5 in modo che contenga le impostazioni appropriate per ASP.NET 4.<br><br>Tuttavia, è possibile eseguire le applicazioni ASP.NET 3,5 usando .NET Framework 4 senza ricompilazione. In tal caso, potrebbe essere necessario modificare manualmente il file di Web.config dell'applicazione prima di eseguire l'applicazione in .NET Framework 4 e in IIS 7 o IIS 7,5. La modifica specifica da apportare dipende dalla combinazione di software in uso, inclusi i Service Pack (SP). Per informazioni sulle possibili combinazioni di software interessate da questa modifica e sulla risoluzione dei problemi con combinazioni specifiche, vedere la sezione "Configuration Errors Related to New ASP.NET 4 Root Configuration" (Errori di configurazione associati alla nuova configurazione radice di ASP.NET 4) nel documento [ASP.NET 4 Breaking Changes](/aspnet/whitepapers/aspnet4/breaking-changes) (Modifiche di rilievo in ASP.NET 4) sul sito Web ASP.NET. |
| **Rendering dei controlli** | Nelle versioni precedenti di ASP.NET alcuni controlli generavano markup che non era possibile disabilitare. Per impostazione predefinita i markup di questo tipo non vengono generati in ASP.NET 4. Le modifiche per il rendering interessano i controlli seguenti:<br><br>\*I `Image` `ImageButton` controlli e non eseguono più il rendering di un `border="0"` attributo.<br>\*La `BaseValidator` classe e i controlli di convalida che derivano da esso non eseguono più il rendering del testo rosso per impostazione predefinita.<br>\*Il `HtmlForm` controllo non esegue il rendering di un `name` attributo.<br>\*Il `Table` controllo non esegue più il rendering di un `border="0"` attributo.<br><br>I controlli non progettati per l'input utente (ad esempio il controllo `Label`) non eseguono più il rendering dell'attributo `disabled="disabled"` se la loro proprietà `Enabled` è impostata su `false` (o se ereditano questa impostazione da un controllo contenitore). | Se si usa Visual Studio per aggiornare l'applicazione da ASP.NET 2.0 o ASP.NET 3.5, lo strumento aggiunge automaticamente al file Web.config un'impostazione che mantiene il rendering delle versioni precedenti. Tuttavia, se si aggiorna un'applicazione modificando il pool di applicazioni in IIS impostando come destinazione .NET Framework 4, ASP.NET usa la nuova modalità di rendering per impostazione predefinita. Per disattivare la nuova modalità di rendering aggiungere l'impostazione seguente al file Web.config:<br><br>`<pages controlRenderingCompatibilityVersion="3.5" />` |
| **Gestori eventi nei documenti predefiniti** | In ASP.NET 4, nell'elemento HTML `form` il rendering del valore dell'attributo `action` restituisce una stringa vuota quando viene effettuata una richiesta a un URL senza estensione al quale è mappato un documento predefinito. Nelle versioni precedenti di ASP.NET una richiesta a `http://contoso.com` dava come risultato una richiesta a Default.aspx. In tale documento il tag di apertura `form` veniva restituito come nell'esempio seguente:<br><br>`<form action="Default.aspx" />`<br><br>Anche in ASP.NET 4 una richiesta a `http://contoso.com` restituisce una richiesta a Default.aspx, ma ora in ASP.NET il tag di apertura HTML `form` viene restituito come nell'esempio seguente:<br><br>`<form action="" />`<br><br>Quando l'attributo `action` è una stringa vuota, l'oggetto `DefaultDocumentModule` IIS crea una richiesta figlio a Default.aspx. Nella maggior parte dei casi la richiesta figlio è trasparente per il codice dell'applicazione e la pagina Default.aspx viene eseguita normalmente. Tuttavia una potenziale interazione tra il codice gestito e la modalità integrata di IIS 7 o IIS 7.5 può interrompere il funzionamento corretto delle pagine gestite con estensione aspx durante la richiesta figlio. La richiesta figlio a un documento predefinito con estensione aspx restituisce un errore o un comportamento imprevisto se si verificano le condizioni seguenti:<br><br>\*Una pagina aspx viene inviata al browser con l'attributo dell' `form` elemento `action` impostato su "".<br>\*Viene eseguito il postback del modulo a ASP.NET.<br>\*Un modulo HTTP gestito legge una parte del corpo dell'entità, ad esempio `Request.Form` o `Request.Params` . Di conseguenza il corpo dell'entità della richiesta POST viene letto nella memoria gestita. Pertanto il corpo dell'entità non è più disponibile per i moduli di codice nativo che sono in esecuzione in modalità integrata IIS 7 o IIS 7.5.<br>\*L' `DefaultDocumentModule` oggetto IIS viene infine eseguito e crea una richiesta figlio al documento default. aspx. Tuttavia poiché il corpo dell'entità è già stato letto da un frammento di codice gestito, non è disponibile alcun corpo di entità da inviare alla richiesta figlio.<br>\*Quando la pipeline HTTP viene eseguita per la richiesta figlio, il gestore per i file con estensione aspx viene eseguito durante la fase di esecuzione del gestore.<br><br>Poiché non è presente nessun corpo dell'entità, non sono presenti variabili del modulo né uno stato di visualizzazione. Di conseguenza il gestore della pagina con estensione aspx non dispone di informazioni per determinare quale evento vada eventualmente generato. Pertanto non viene eseguito nessun gestore dell'evento di postback per la pagina con estensione aspx interessata. | Per informazioni sulla risoluzione dei problemi che possono verificarsi in seguito a questa modifica, vedere "Event Handlers Might Not Be Not Raised in a Default Document in IIS 7 or IIS 7.5 Integrated Mode" (I gestori eventi potrebbero non essere attivati in un documento predefinito in modalità integrata IIS 7 o IIS 7.5) nel documento [ASP.NET 4 Breaking Changes](/aspnet/whitepapers/aspnet4/breaking-changes) (Modifiche di rilievo in ASP.NET 4) sul sito Web ASP.NET. |
| **Algoritmo hash** | Per la protezione di dati come i cookie di autenticazione modulo e lo stato di visualizzazione, ASP.NET usa sia la crittografia che gli algoritmi hash. Per impostazione predefinita, ASP.NET 4 usa l'algoritmo <xref:System.Security.Cryptography.HMACSHA256> per le operazioni di hash sui cookie e lo stato di visualizzazione. Le versioni precedenti di ASP.NET usano l'algoritmo meno recente <xref:System.Security.Cryptography.HMACSHA1>. | Se si eseguono applicazioni che combinano ASP.NET 2.0 e ASP.NET 4 in cui i dati quali i cookie di autenticazione moduli devono funzionare con tutte le versioni di .NET Framework, è possibile configurare un'applicazione Web ASP.NET 4 per l'uso dell'algoritmo meno recente <xref:System.Security.Cryptography.HMACSHA1> aggiungendo la seguente impostazione nel file Web.config:<br><br>`<machineKey validation="SHA1" />` |
| **Hosting di controlli in Internet Explorer** | Non è più possibile eseguire l'hosting di controlli Windows Form in Internet Explorer, perché esistono soluzioni migliori per l'hosting di controlli sul Web. Pertanto, gli assembly IEHost.dll e IEExec.exe sono stati rimossi da .NET Framework. | Per lo sviluppo di controlli personalizzati è possibile usare le tecnologie seguenti nelle applicazioni Web:<br><br>\*È possibile creare un'applicazione Silverlight e configurarla per l'esecuzione all'esterno del browser. Per altre informazioni, vedere [Out-of-Browser Support](https://docs.microsoft.com/previous-versions/windows/silverlight/dotnet-windows-silverlight/dd550721%28v=vs.95%29) (Supporto out-of-browser).<br>\*È possibile creare un'applicazione browser XAML (XBAP) per sfruttare le funzionalità di WPF (richiede .NET Framework nei computer client). Per altre informazioni, vedere [Panoramica delle applicazioni browser XAML di WPF](../wpf/app-development/wpf-xaml-browser-applications-overview.md). |
| **Metodi HtmlEncode e UrlEncode** | I metodi `HtmlEncode` e `UrlEncode` delle classi <xref:System.Web.HttpUtility> e <xref:System.Web.HttpServerUtility> sono stati aggiornati per codificare il carattere virgoletta singola (') come indicato di seguito:<br><br>\*Il `HtmlEncode` metodo codifica le istanze delle virgolette singole come`&#39;`<br>\*Il `UrlEncode` metodo codifica le istanze delle virgolette singole come`%27` | Esaminare le aree del codice in cui si usano i metodi `HtmlEncode` e `UrlEncode` e verificare che la variazione della codifica non produca alterazioni che possono avere effetto sull'applicazione. |
| **Errori HttpException nelle applicazioni ASP.NET 2.0** | Dopo l'abilitazione di ASP.NET 4 in IIS 6, le applicazioni ASP.NET 2.0 in esecuzione su IIS 6 (in Windows Server 2003 o Windows Server 2003 R2) possono generare errori come il seguente: `System.Web.HttpException: Path '/[yourApplicationRoot]/eurl.axd/[Value]' was not found.` | * Se ASP.NET 4 non è necessario per l'esecuzione del sito Web, modificare il mapping del sito e abilitare l'uso di ASP.NET 2.0.<br><br>-oppure-<br><br>\*Se è necessario ASP.NET 4 per eseguire il sito Web, spostare le directory virtuali ASP.NET 2,0 figlio in un sito Web diverso mappato a ASP.NET 2,0.<br><br>-oppure-<br><br>\*Disabilitare gli URL con estensione. Per altre informazioni, vedere "ASP.NET 2.0 Applications Might Generate HttpException Errors That Reference eurl.axd" (Le applicazioni ASP.NET 2.0 possono generare errori HttpException con riferimenti a eurl.axd) nel documento [ASP.NET 4 Breaking Changes](/aspnet/whitepapers/aspnet4/breaking-changes) (Modifiche di rilievo in ASP.NET 4) nel sito Web ASP.NET. |
| **Tipi di appartenenza** | Alcuni tipi (ad esempio <xref:System.Web.Security.MembershipProvider>) usati nell'appartenenza di ASP.NET sono stati spostati da System.Web.dll a System.Web.ApplicationServices.dll. I tipi sono stati spostati per risolvere dipendenze dei livelli di architettura tra i tipi nel client e negli SKU estesi di .NET Framework. | La compilazione di librerie di classi aggiornate da versioni precedenti di ASP.NET che usano tipi di appartenenza spostati potrebbe non riuscire quando tali librerie vengono usate in un progetto ASP.NET 4. In questo caso aggiungere un riferimento a System.Web.ApplicationServices.dll nel progetto della libreria di classi. |
| **Modifiche al controllo Menu** | Le modifiche apportate al controllo <xref:System.Web.UI.WebControls.Menu> danno origine al comportamento seguente:<br><br>\*Se <xref:System.Web.UI.WebControls.MenuRenderingMode> è impostato su `List` o se <xref:System.Web.UI.WebControls.MenuRenderingMode> è impostato su `Default` e <xref:System.Web.Configuration.PagesSection.ControlRenderingCompatibilityVersion> è impostato su `4.0` o versione successiva, la <xref:System.Web.UI.WebControls.MenuItem.PopOutImageUrl> proprietà non ha alcun effetto.<br>\*Se il percorso impostato nelle <xref:System.Web.UI.WebControls.Menu.StaticPopOutImageUrl%2A> <xref:System.Web.UI.WebControls.Menu.DynamicPopOutImageUrl> proprietà e contiene una barra rovesciata ( \\ ), non viene eseguito il rendering delle immagini. Nelle versioni precedenti di ASP.NET il percorso poteva includere una barra rovesciata. | * Anziché impostare la proprietà <xref:System.Web.UI.WebControls.MenuItem.PopOutImageUrl> per singole voci di menu, impostare <xref:System.Web.UI.WebControls.Menu.StaticPopOutImageUrl%2A> o <xref:System.Web.UI.WebControls.Menu.DynamicPopOutImageUrl> del controllo <xref:System.Web.UI.WebControls.Menu> padre.<br><br>-oppure-<br><br>Impostare <xref:System.Web.UI.WebControls.MenuRenderingMode> su `Table` o impostare <xref:System.Web.UI.WebControls.MenuRenderingMode> su `Default` e impostare <xref:System.Web.Configuration.PagesSection.ControlRenderingCompatibilityVersion> su `3.5`. Con queste impostazioni il controllo <xref:System.Web.UI.WebControls.Menu> usa il layout basato su tabella HTML che usava anche nelle versioni precedenti di ASP.NET.<br>\*Se il percorso nella <xref:System.Web.UI.WebControls.Menu.StaticPopOutImageUrl%2A> proprietà o <xref:System.Web.UI.WebControls.Menu.DynamicPopOutImageUrl> contiene una barra rovesciata ( \\ ), sostituire un carattere barra (/). |
| **Assembly Mobile nel file Web.config** | Nelle versioni precedenti di ASP.NET un riferimento all'assembly System.Web.Mobile.dll è incluso nel file Web.config radice nella sezione `assemblies`, sotto `system.web`/`compilation`. Per migliorare le prestazioni, il riferimento a questo assembly è stato rimosso.<br><br>Nota: l'assembly System.Web.Mobile.dll e i controlli mobili ASP.NET sono inclusi in ASP.NET 4, ma sono deprecati. | Per usare tipi di questo assembly aggiungere un riferimento all'assembly nel file Web.config radice o in un file Web.config dell'applicazione. |
| **Memorizzazione dell'output nella cache** | In ASP.NET 1,0, un bug ha causato le pagine memorizzate nella cache che hanno specificato `Location="ServerAndClient"` come output l' &euro; impostazione della cache per emettere un' `Vary:*` intestazione HTTP nella risposta. Questa intestazione comunicava ai browser client di non memorizzare mai la pagina nella cache in locale. In ASP.NET 1.1 è stato aggiunto il metodo <xref:System.Web.HttpCachePolicy.SetOmitVaryStar%2A> che può essere chiamato per eliminare l'intestazione `Vary:*`. Tuttavia i report sui bug indicano che gli sviluppatori non sono a conoscenza del comportamento `SetOmitVaryStar` esistente.<br><br>In ASP.NET 4 l'intestazione HTTP `Vary:*` non viene più generata dalle risposte che specificano la direttiva seguente:<br><br>`<%@ OutputCache Location="ServerAndClient" %>`<br><br>Di conseguenza il metodo <xref:System.Web.HttpCachePolicy.SetOmitVaryStar%2A> non è più necessario per eliminare l'intestazione `Vary:*`. Nelle applicazioni che specificano "ServerAndClient" come attributo `Location` le pagine possono essere memorizzate nella cache del browser senza che sia necessario chiamare <xref:System.Web.HttpCachePolicy.SetOmitVaryStar%2A>. | Se è necessario che le pagine dell'applicazione emettano `Vary:*`, chiamare il metodo <xref:System.Web.HttpResponse.AppendHeader%2A> come illustrato nell'esempio seguente:<br><br>`System.Web.HttpResponse.AppendHeader("Vary","*");`<br><br>In alternativa è possibile impostare su "Server" il valore dell'attributo di memorizzazione nella cache dell'output `Location`. |
| **Analisi della pagina** | Il parser di pagina per le pagine Web (file con estensione aspx) e i controlli utente (file con estensione ascx) di ASP.NET è più restrittivo in ASP.NET 4 rispetto alle versioni precedenti di ASP.NET e rileva una quantità di markup non valido superiore a quella rilevata nelle versioni precedenti. | Esaminare i messaggi di errore generati durante l'esecuzione di una pagina e correggere gli errori risultanti da markup non valido. |
| **Tipi Passport** | Il supporto per Passport incorporato in ASP.NET 2.0 è obsoleto e non è più riconosciuto a causa delle modifiche apportate a Passport (ora denominato SDK Live ID). Di conseguenza i tipi associati a Passport in <xref:System.Web.Security> ora sono contrassegnati con l'attributo `ObsoleteAttribute`. | Modificare il codice che utilizza i tipi Passport nello <xref:System.Web.Security> spazio dei nomi (ad esempio, <xref:System.Web.Security.PassportIdentity> ) per utilizzare Windows Live ID SDK. |
| **Informazioni PathInfo nella proprietà FilePath** | In ASP.NET 4 il valore `PathInfo` non è più incluso nei valori restituiti da proprietà quali <xref:System.Web.HttpRequest.FilePath>, <xref:System.Web.HttpRequest.AppRelativeCurrentExecutionFilePath> e <xref:System.Web.HttpRequest.CurrentExecutionFilePath>. Le informazioni `PathInfo` ora sono disponibili in <xref:System.Web.HttpRequest.PathInfo>. Considerare ad esempio il frammento di URL seguente:<br><br>`/testapp/Action.mvc/SomeAction`<br><br>Nelle versioni precedenti di ASP.NET le proprietà <xref:System.Web.HttpRequest> hanno i valori seguenti:<br><br>\* <xref:System.Web.HttpRequest.FilePath>: `/testapp/Action.mvc/SomeAction`<br>\*<xref:System.Web.HttpRequest.PathInfo>: (vuoto)<br><br>In ASP.NET 4 invece i valori delle proprietà <xref:System.Web.HttpRequest> sono i seguenti:<br><br>\* <xref:System.Web.HttpRequest.FilePath>: `/testapp/Action.mvc`<br>\* <xref:System.Web.HttpRequest.PathInfo>: `SomeAction` | Esaminare le aree del codice che usano le proprietà della classe <xref:System.Web.HttpRequest> per restituire informazioni sul percorso e modificare il codice in modo che rifletta le modifiche delle modalità di restituzione delle informazioni sul percorso. |
| **Convalida delle richieste** | Per migliorare la convalida delle richieste, la convalida della richiesta ASP.NET viene chiamata in una fase precedente del ciclo di vita della richiesta. Di conseguenza la convalida delle richieste viene eseguita per richieste che non sono destinate a file con estensione aspx, ad esempio per chiamate al servizio Web e per gestori personalizzati. La convalida delle richieste resta attiva anche quando nella pipeline di elaborazione richieste sono in esecuzione moduli HTTP personalizzati.<br><br>In seguito a questa modifica le richieste di risorse diverse da file con estensione aspx possono generare errori di convalida delle richieste. Anche il codice personalizzato eseguito nella pipeline delle richieste (ad esempio moduli HTTP personalizzati) può generare errori di convalida delle richieste. | Se necessario è possibile ripristinare il comportamento precedente in cui la convalida richieste veniva attivata solo dalle pagine con estensione aspx. Per fare ciò usare l'impostazione seguente nel file di configurazione Web:<br><br>`<httpRuntime requestValidationMode="2.0" />`<br><br>Avviso: se si ripristina il comportamento precedente, assicurarsi che tutto il codice in gestori, moduli e altro codice personalizzato esistenti esegua controlli per gli input HTTP potenzialmente non sicuri che potrebbero essere vettori di attacco XSS. |
| **Routing** | Se si crea un sito Web di file system in Visual Studio 2010 e il sito Web si trova in una cartella il cui nome contiene un punto (.), il routing dell'URL non funziona in modo affidabile. Alcuni percorsi virtuali restituiscono un errore HTTP 404. Questo errore si verifica perché Visual Studio 2010 avvia Visual Studio Development Server usando un percorso non corretto per la directory radice virtuale. | * Nella pagina **Proprietà** del sito Web basato su file impostare l'attributo **Percorso virtuale** su "/".<br><br>-oppure-<br><br>\*Creare un progetto di applicazione Web invece di un progetto di sito Web. I progetti di applicazione Web non presentano questo problema e il routing di URL funziona anche se il nome della cartella del progetto contiene un punto.<br><br>-oppure-<br><br>\*Creare un sito Web basato su HTTP ospitato in IIS. Sia il percorso virtuale sia la cartella del file di progetto dei siti Web ospitati in IIS possono includere punti. |
| **Siti di SharePoint** | Se si prova a eseguire un sito Web ASP.NET 4 distribuito come figlio di un sito Web SharePoint che contiene un livello di attendibilità parziale personalizzato denominato `WSS_Minimal`, viene visualizzato l'errore seguente:<br><br>`Could not find permission set named 'ASP.Net'.` | Attualmente nessuna versione di SharePoint è compatibile con ASP.NET. Pertanto evitare di eseguire un sito Web ASP.NET 4 come figlio di un sito Web SharePoint. |
| **Standard XHTML 1.1** | Per abilitare la conformità XHTML 1,1 per i nuovi siti Web, i controlli ASP.NET in .NET Framework 4 genereranno codice HTML conforme a XHTML 1,1. Il rendering viene abilitato con l'opzione seguente nel file Web.config all'interno dell'elemento `<system.Web>`:<br><br>`<pages controlRenderingCompatibilityVersion="4.0"/>`<br><br>L'impostazione predefinita di questa opzione è 4.0. Nei progetti Web aggiornati da Visual Studio 2008 l'impostazione attivata è 3.5, per garantire la compatibilità. | No. |

## <a name="core"></a>Core

### <a name="general-features"></a>Funzionalità generali

| Funzionalità | Differenze rispetto alla versione 3.5 SP1 | Modifiche consigliate |
| ------- | ------------------------ | ------------------- |
| **CardSpace** | Windows CardSpace non è più incluso in .NET Framework; viene fornito separatamente. | È possibile scaricare Windows CardSpace nell'[Area download Microsoft](https://go.microsoft.com/fwlink/?LinkId=199868). |
| **File di configurazione** | Sono state apportate correzioni per il modo in cui .NET Framework accede ai file di configurazione dell'applicazione. | Se il file di configurazione dell'applicazione è denominato *application-name.config*, rinominarlo *application-name.exe.config*. Rinominare, ad esempio, *MyApp.config* in *MyApp.exe.config*. |
| **Compilatore di codice C#** | Le `Compiler` `CompilerError` classi, e `ErrorLevel` <xref:Microsoft.CSharp> incluse nello spazio dei nomi non sono più disponibili e il relativo assembly (cscompmgd.dll) non è più incluso nel .NET Framework. | Usare la classe <xref:System.CodeDom.Compiler.CodeDomProvider> e le altre classi dello spazio dei nomi <xref:System.CodeDom.Compiler>. Per altre informazioni, vedere [Uso di CodeDOM](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/y2k85ax6%28v=vs.100%29). |
| **Hosting** (API non gestite) | Per migliorare le funzionalità di hosting, alcune API di attivazione hosting sono state deprecate. Le funzionalità di esecuzione side-by-side in-process consentono a un'applicazione di caricare e avviare più versioni di .NET Framework nello stesso processo. È ad esempio possibile eseguire applicazioni che caricano componenti aggiuntivi (o componenti) basati su .NET Framework 2,0 SP1 e componenti aggiuntivi basati su .NET Framework 4 nello stesso processo. I componenti di versioni precedenti continuano a usare la versione precedente di .NET Framework e i nuovi componenti usano la nuova versione. | Usare le configurazioni descritte in [Esecuzione side-by-side in-process](../deployment/in-process-side-by-side-execution.md). |
| **Nuovo modello di sicurezza** | I criteri di sicurezza dall'accesso di codice sono stati disattivati e sostituiti con un modello semplificato, come descritto in [modifiche della sicurezza in .NET Framework 4](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/dd233103%28v=vs.100%29). | Se le applicazioni usano i criteri di sicurezza dall'accesso di codice può risultare necessario apportare modifiche. Per altre informazioni, vedere [Migrazione e compatibilità dei criteri di sicurezza dall'accesso di codice](../misc/code-access-security-policy-compatibility-and-migration.md). |

### <a name="date-and-time"></a>Data e ora

Namespace<xref:System>

Assembly: mscorlib (in mscorlib.dll)

| Funzionalità | Differenze rispetto alla versione 3.5 SP1 | Modifiche consigliate |
| ------- | ------------------------ | ------------------- |
| **Ora legale** | Per garantire la coerenza con l'orologio di sistema, le proprietà di ora (ad esempio <xref:System.TimeZoneInfo.Local> e <xref:System.DateTime.Now>) adottano le regole del sistema operativo anziché altri dati di .NET Framework per le operazioni con ora legale. | No. |
| **Formattazione di stringhe** | Per supportare una formattazione che rileva le impostazioni cultura, la struttura <xref:System.TimeSpan> include nuovi overload dei metodi `ToString`, `Parse` e `TryParse` oltre ai nuovi metodi `ParseExact` e `TryParseExact`. | No. |

### <a name="globalization"></a>Globalizzazione

Per l'elenco delle nuove impostazioni cultura neutre e specifiche, vedere [What's New in Globalization and Localization](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/dd997383%28v=vs.100%29) (Novità relative alla globalizzazione e alla localizzazione).

Namespace<xref:System.Globalization>

Assembly: mscorlib (in mscorlib.dll)

| Funzionalità | Differenze rispetto alla versione 3.5 SP1 | Modifiche consigliate |
| ------- | ------------------------ | ------------------- |
| **Nomi delle impostazioni cultura** | Le seguenti modifiche di nome interessano le impostazioni cultura Divehi, Tedesco e Afrikaans:<br><br>\*<xref:System.Globalization.CultureAndRegionInfoBuilder.CurrencyEnglishName>: Il nome della valuta per le impostazioni cultura tedesche (Svizzera) (de-ch) è stato modificato da "SFR". a "Fr.".<br>\*<xref:System.Globalization.DateTimeFormatInfo.LongDatePattern>: Il modello di data estesa per le impostazioni cultura Divehi (Maldive) (DV-MV) è stato modificato da "gg/MMMM/aaaa" a "gg/mm/aaaa".<br>\*<xref:System.Globalization.DateTimeFormatInfo.PMDesignator>: Le 19:00 delle impostazioni cultura Afrikaans (Sud Africa) (af-ZA) è stato cambiato da "nm" a "PM". | Prendere nota delle modifiche dei nomi delle impostazioni cultura. |
| **Parametro LCID** | Per coerenza con il comportamento previsto nelle impostazioni del server di automazione, CLR non trasferisce più le impostazioni cultura correnti per il parametro `LCID` alle applicazioni basate su COM non gestite. Ora vengono trasferite le impostazioni cultura 1033 (en-US). | Non sono necessarie modifiche, salvo per le applicazioni native che richiedono impostazioni cultura specifiche. |
| **Tipi di impostazioni cultura obsoleti** | I tipi di impostazioni cultura <xref:System.Globalization.CultureTypes> e <xref:System.Globalization.CultureTypes> sono obsoleti.<br><br>Per garantire la compatibilità con le versioni precedenti, <xref:System.Globalization.CultureTypes> ora restituisce le impostazioni cultura neutre e specifiche incluse con la versione precedente di .NET Framework e <xref:System.Globalization.CultureTypes> ora restituisce un elenco vuoto. | Usare altri valori dell'enumerazione <xref:System.Globalization.CultureTypes>. |
| **Recupero delle impostazioni cultura** | A partire da Windows 7, .NET Framework 4 recupera le informazioni sulle impostazioni cultura dal sistema operativo anziché archiviare i dati stessi. Inoltre, .NET Framework viene sincronizzato con Windows per l'ordinamento e la combinazione di maiuscole e minuscole. | No. |
| **Standard Unicode 5.1** | .NET Framework supporta ora tutti i caratteri Unicode 5,1, ovvero un'aggiunta di circa 1400 caratteri. I caratteri aggiuntivi includono nuovi simboli, frecce, segni diacritici, punteggiatura, simboli matematici, tratti CJK e ideogrammi, caratteri numerici aggiuntivi Malayalam e Telugu e vari caratteri latini, arabi, greci, mongoli, cirillici e birmani. Unicode 5.1 supporta ora anche gli alfabeti seguenti: Sundanese, Lepcha, Ol Chiki, Vai, Saurashtra, Kayah Li, Rejang, Gurmukhi, Odia, Tamil, Telugu, Malayalam e Cham. | No. |

### <a name="exceptions"></a>Eccezioni

Spazi dei nomi: <xref:System> ,<xref:System.Runtime.ExceptionServices>

Assembly: mscorlib (in mscorlib.dll)

| Funzionalità | Differenze rispetto alla versione 3.5 SP1 | Modifiche consigliate |
| ------- | ------------------------ | ------------------- |
| **Eccezioni per lo stato di processo danneggiato** | CLR non trasmette più eccezioni per lo stato di processo danneggiato ai gestori di eccezioni nel codice gestito. | Queste eccezioni indicano che lo stato di un processo è danneggiato. Se viene segnalato questo stato non è consigliabile eseguire l'applicazione.<br><br>Per ulteriori informazioni, vedere <xref:System.Runtime.ExceptionServices.HandleProcessCorruptedStateExceptionsAttribute> e la voce relativa alla [gestione delle eccezioni di stato danneggiato](https://docs.microsoft.com/archive/msdn-magazine/2009/february/clr-inside-out-handling-corrupted-state-exceptions) in MSDN Magazine. |
| **Eccezioni del motore di esecuzione** | <xref:System.ExecutionEngineException> è obsoleta perché un'eccezione intercettabile consente di continuare l'esecuzione di un processo instabile. Questa modifica migliora la prevedibilità e l'affidabilità in fase di runtime. | Usare <xref:System.InvalidOperationException> per segnalare la condizione. |

### <a name="reflection"></a>Reflection

Namespace<xref:System.Reflection>

Assembly: mscorlib (in mscorlib.dll)

| Funzionalità | Differenze rispetto alla versione 3.5 SP1 | Modifiche consigliate |
| ------- | ------------------------ | ------------------- |
| **Algoritmi hash degli assembly** | La proprietà <xref:System.Reflection.AssemblyName.HashAlgorithm> ora restituisce <xref:System.Configuration.Assemblies.AssemblyHashAlgorithm> perché il runtime non conosce l'algoritmo hash dell'assembly di riferimento quando l'assembly non è caricato. Questa voce si riferisce all'uso della proprietà in un assembly di riferimento, ad esempio quello restituito dal metodo <xref:System.Reflection.Assembly.GetReferencedAssemblies%2A>. | No. |
| **Caricamento degli assembly** | Per evitare il caricamento ridondante di assembly e per risparmiare spazio degli indirizzi virtuali, CLR ora carica gli assembly usando solo la funzione `MapViewOfFile` Win32. La funzione `LoadLibrary` non viene più chiamata.<br><br>Questa modifica influisce sulle applicazioni di diagnostica nei modi seguenti:<br><br>\*Un oggetto <xref:System.Diagnostics.ProcessModuleCollection> non conterrà più moduli da una libreria di classi (file con estensione dll), come ottenuto da una chiamata a `Process.GetCurrentProcess().Modules` .<br>\*Le applicazioni Win32 che usano la `EnumProcessModules` funzione non vedranno tutti i moduli gestiti elencati. | No. |
| **Tipo dichiarante** | La proprietà <xref:System.Type.DeclaringType> ora restituisce correttamente null quando il tipo non dispone di un tipo dichiarante. | No. |
| **Delegati** | Un delegato ora genera un'eccezione <xref:System.ArgumentNullException> anziché un'eccezione <xref:System.NullReferenceException> quando viene passato un valore null al costruttore del delegato. | Verificare che la gestione delle eccezioni rilevi <xref:System.ArgumentNullException>. |
| **Modifica del percorso della Global Assembly Cache** | Per gli assembly di .NET Framework 4, la Global Assembly Cache è stata spostata dalla directory di Windows (%WINDIR%) alla sottodirectory di Microsoft.Net (*%WINDIR%\\Microsoft.Net*). Gli assembly delle versioni precedenti rimangono nella directory precedente.<br><br>L'enumerazione [ASM_CACHE_FLAGS](../unmanaged-api/fusion/asm-cache-flags-enumeration.md) non gestita contiene il nuovo flag `ASM_CACHE_ROOT_EX`. Il flag ottiene il percorso della cache per gli assembly di .NET Framework 4, che può essere ottenuto con la funzione [GetCachePath](../unmanaged-api/fusion/getcachepath-function.md). | Nessuno a condizione che le applicazioni non usino percorsi espliciti per gli assembly, una procedura sconsigliata. |
| **Strumento Global Assembly Cache** | Lo strumento Global Assembly Cache ([Gacutil.exe](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ex0ss12c%28v=vs.100%29)) non supporta più il visualizzatore plug-in della shell. | No. |

### <a name="interoperability"></a>Interoperabilità

Namespace<xref:System.Runtime.InteropServices>

Assembly: mscorlib (in mscorlib.dll)

| Funzionalità | Differenze rispetto alla versione 3.5 SP1 | Modifiche consigliate |
| ------- | ------------------------ | ------------------- |
| **Lunghezza del buffer** (API non gestita) | Per risparmiare memoria, la funzionalità del parametro `pBufferLengthOffset` per il metodo [ICorProfilerInfo2::GetStringLayout](../unmanaged-api/profiling/icorprofilerinfo2-getstringlayout-method.md) è stata modificata e ora corrisponde a quella del parametro `pStringLengthOffset`. Ora entrambi i parametri puntano alla posizione di offset della lunghezza della stringa. La lunghezza del buffer è stata rimossa dalla rappresentazione della classe String. | Rimuovere qualsiasi dipendenza della lunghezza del buffer. |
| **Debug JIT** | Per semplificare la registrazione per il debug JIT, il debugger di .NET Framework ora usa solo la chiave del Registro di sistema AeDebug, che controlla il comportamento di debug JIT per il codice nativo. I risultati cambiano nel modo seguente:<br><br>\*Non è più possibile registrare due diversi debugger per il codice gestito e il codice nativo.<br>\*Non è più possibile avviare il debugger automaticamente per un processo non interattivo, ma è possibile richiedere all'utente un processo interattivo.<br>\*Non si riceve più una notifica quando l'avvio del debugger non riesce o quando non è presente alcun debugger registrato da avviare.<br>\*I criteri di avvio automatico che dipendono dall'interattività dell'applicazione non sono più supportati. | Modificare di conseguenza le operazioni di debug. |
| **Platform Invoke** | Per migliorare le prestazioni di interoperabilità con il codice non gestito, le convenzioni di chiamata errate in un platform invoke ora causano l'arresto dell'applicazione. Nelle versioni precedenti il livello di marshalling risolveva questi errori a monte nello stack. | Il debug delle applicazioni in Microsoft Visual Studio segnala questi errori all'utente e ne consente la correzione.<br><br>Se sono presenti file binari che non possono essere aggiornati, è possibile includere l' [\<NetFx40_PInvokeStackResilience>](../configure-apps/file-schema/runtime/netfx40-pinvokestackresilience-element.md) elemento nel file di configurazione dell'applicazione per consentire la risoluzione degli errori di chiamata per la risoluzione dello stack come nelle versioni precedenti. Tuttavia questa impostazione può ridurre le prestazioni dell'applicazione. |
| **Interfacce rimosse** (API non gestita) | Per evitare di confondere gli sviluppatori le interfacce seguenti sono state rimosse, perché non offrono alcuno scenario di runtime utile e il CLR non offre né accetta nessuna implementazione:<br><br>\* **INativeImageINativeImageDependency**<br>\* **INativeImageInstallInfo**<br>\* **INativeImageEvaluate**<br>\* **INativeImageConverter**<br>\* **ICorModule**<br>\* **IMetaDataConverter** | No. |

## <a name="data"></a>Data

In questa sezione vengono descritti i problemi di migrazione per l'uso di set di dati e SQL Client, Entity Framework, LINQ to SQL e WCF Data Servers (denominato in precedenza ADO.NET Data Services).

### <a name="dataset-and-sql-client"></a>Set di dati e SQL Client

La tabella seguente presenta i miglioramenti apportati a funzionalità che in precedenza avevano limitazioni o altri problemi.

Spazi dei nomi: <xref:System.Data> , <xref:System.Data.Objects.DataClasses> ,<xref:System.Data.SqlClient>

Assembly: System. Data (in System.Data.dll), System. Data. Entity (in System.Data.Entity.dll)

| Funzionalità | Differenze rispetto alla versione 3.5 SP1 |
| ------- | ------------------------ |
| **Scenari POCO** | L'interfaccia <xref:System.Data.Objects.DataClasses.IRelatedEnd> dispone di nuovi metodi per migliorare l'usabilità negli scenari POCO (Plain Old CLR Object). I nuovi metodi accettano come parametro un'entità <xref:System.Object> anziché un'entità <xref:System.Data.Objects.DataClasses.IEntityWithRelationships>. |
| **Modifica di righe** | Il metodo <xref:System.Collections.IList.IndexOf%2A> implementato dalla classe <xref:System.Data.DataView> ora restituisce correttamente il valore di una riga modificata, anziché restituire -1. |
| **Events** | L'evento <xref:System.Data.DataRowView.PropertyChanged> ora viene generato quando una riga è in uno stato modificato e viene chiamato il metodo <xref:System.Data.DataRow.RejectChanges%2A>. Questa modifica rende più semplice la creazione di controlli dell'interfaccia utente che espongono il contenuto di un oggetto <xref:System.Data.DataSet>. |
| **Eccezioni** | Il metodo <xref:System.Data.SqlClient.SqlCommand.Prepare%2A> ora genera un'eccezione <xref:System.InvalidOperationException> anziché <xref:System.NullReferenceException> quando una connessione non è impostata o aperta. |
| **Mapping delle visualizzazioni** | Gli errori di mapping della visualizzazione di query vengono ora rilevati in fase di progettazione anziché generare un'eccezione <xref:System.NullReferenceException> in fase di esecuzione.<br><br>La convalida di mapping ora rileva l'errore per il quale in Conceptual Schema Definition Language (CSDL) viene eseguito il mapping di due set di associazioni sulla stessa colonna. |
| **Transazioni** | Se un'applicazione prova a eseguire un'istruzione su una connessione dopo che una transazione è stata completata (anche se interrotta o sottoposta a rollback), ora viene generata un'eccezione <xref:System.InvalidOperationException>. Nelle versioni precedenti non veniva generata un'eccezione ed era possibile eseguire comandi aggiuntivi anche se una transazione veniva interrotta. |

### <a name="entity-framework"></a>Entity Framework

La tabella seguente presenta i miglioramenti apportati a funzionalità che in precedenza avevano limitazioni o altri problemi.

Spazi dei nomi: <xref:System.Data> , <xref:System.Data.Objects> ,<xref:System.Data.Objects.DataClasses>

Assembly: System. Data. Entity (in System.Data.Entity.dll)

| Funzionalità | Differenze rispetto alla versione 3.5 SP1 |
| ------- | ------------------------ |
| **Oggetti entità** | Ora è presente la parità tra il metodo <xref:System.Data.Objects.ObjectContext.Detach%2A> e lo stato dell'oggetto entità quando viene chiamato il metodo <xref:System.Data.Objects.ObjectContext.SaveChanges%2A>. Questo miglioramento della coerenza evita la generazione di eccezioni impreviste. |
| **Entity SQL** | Sono state migliorate le regole per la risoluzione di identificatori in Entity SQL.<br><br>Il parser Entity SQL dispone di logica migliorata per la risoluzione di identificatori a più parti. |
| **Annotazioni strutturali** | Entity Framework ora riconosce le annotazioni strutturali. |
| **Query** | Sono stati apportati i seguenti miglioramenti alle query:<br><br>\*Una `GroupBy` query che usa una chiave null su una raccolta vuota non restituirà alcuna riga, indipendentemente dalla presenza di altre selezioni nella query.<br>\*Le query SQL generate nelle query LINQ e Entity-SQL ora considerano i parametri di stringa come valori non Unicode per impostazione predefinita. |

### <a name="linq-to-sql"></a>LINQ to SQL

La tabella seguente presenta i miglioramenti apportati a funzionalità che in precedenza avevano limitazioni o altri problemi.

Namespace<xref:System.Data.Linq>

Assembly: System. Data. Linq (in System.Data.Linq.dll)

| Funzionalità | Differenze rispetto alla versione 3.5 SP1 |
| ------- | ------------------------ |
| **Events** | Una raccolta <xref:System.Data.Linq.EntitySet%601> attiva ora l'evento <xref:System.Data.Linq.EntitySet%601.ListChanged> per operazioni di aggiunta e rimozione se <xref:System.Data.Linq.EntitySet%601> viene scaricata, oltre ad attivare l'evento quando la raccolta viene caricata. |
| **Query** | `Skip(0)` non viene più ignorato nelle query LINQ to SQL. Di conseguenza è possibile che le query con questo metodo funzionino in modo diverso. In alcuni casi, ad esempio, `OrderBy` è richiesta una clausola con `Skip(0)` e la query genera ora un' <xref:System.NotSupportedException> eccezione se la `OrderBy` clausola non è inclusa. |

### <a name="wcf-data-services"></a>WCF Data Services

La tabella seguente presenta i miglioramenti apportati a funzionalità che in precedenza avevano limitazioni o altri problemi.

Spazi dei nomi: <xref:System.Data.Services> , <xref:System.Data.Services.Client> , <xref:System.Data.Services.Common> ,<xref:System.Data.Services.Providers>

Assembly: System. Data. Services (in System.Data.Services.dll), System. Data. Services. client (in System.Data.Services.Client.dll)

| Funzionalità | Differenze rispetto alla versione 3.5 SP1 |
| ------- | ------------------------ |
| **Contenuto binario in batch** | WCF Data Services ora supporta il contenuto binario in batch nelle richieste e nelle risposte. |
| **Intercettori di modifiche** | Gli intercettori di modifiche ora vengono eseguiti per le richieste DELETE.<br><br>Un intercettore di modifiche è un metodo che viene eseguito ogni volta che il server riceve una richiesta di modifica di un'entità del set di entità. Viene eseguito prima della richiesta in arrivo. L'intercettore di modifiche offre l'accesso all'entità che viene modificata e all'operazione da eseguire su tale entità. |
| **Eccezioni** | Le condizioni seguenti ora generano eccezioni più utili di <xref:System.NullReferenceException>:<br><br>\*Oggetto <xref:System.ServiceProcess.TimeoutException> quando si verifica il timeout di una chiamata a un servizio dati.<br>\*Oggetto <xref:System.Data.Services.Client.DataServiceRequestException> quando viene effettuata una richiesta non valida a un servizio dati.<br><br>Nelle applicazioni è consigliabile modificare la gestione delle eccezioni per intercettare le nuove eccezioni. |
| **Intestazioni** | Sono stati apportati i seguenti miglioramenti alle intestazioni:<br><br>\*WCF Data Services ora rifiuta correttamente un' `eTag` intestazione con un valore non specificato.<br>\*WCF Data Services ora restituisce un errore e non esegue la richiesta di una richiesta DELETE a un collegamento quando un' `if-*` intestazione è presente nella richiesta.<br>\*WCF Data Services ora restituisce un errore al client nel formato (Atom, JSON) specificato dal client nell'intestazione Accept. |
| **Lettore JSON** | Il lettore JavaScript Object Notation (JSON) ora restituisce correttamente un errore quando legge il carattere di escape barra rovesciata singola ("\\") durante l'elaborazione di payload JSON inviati a un servizio WCF Data Services. |
| **Unioni** | Sono stati apportati i seguenti miglioramenti all'enumerazione <xref:System.Data.Services.Client.MergeOption>:<br><br>\*L' <xref:System.Data.Services.Client.MergeOption> opzione Merge non modifica più l'entità nel client in seguito a una risposta successiva da un servizio dati.<br>\*L' <xref:System.Data.Services.Client.MergeOption> opzione è ora coerente tra gli aggiornamenti SQL dinamici e basati su stored procedure. |
| **Richieste** | Prima dell'elaborazione di una richiesta a un servizio dati ora viene chiamato un metodo <xref:System.Data.Services.DataService%601.OnStartProcessingRequest%2A>. In questo modo la richiesta funziona correttamente per i servizi <xref:System.Data.Services.Providers.ServiceOperation>. |
| **Flussi** | WCF Data Services non chiude più il flusso sottostante per operazioni di lettura e scrittura. |
| **URI** | L'escape di URI da parte del client WCF Data Services è stato corretto. |

## <a name="windows-communication-foundation-wcf"></a>Windows Communication Foundation (WCF)

La tabella seguente presenta i miglioramenti apportati a funzionalità che in precedenza avevano limitazioni o altri problemi.

| Funzionalità | Differenze rispetto alla versione 3.5 SP1 |
| ------- | ------------------------ |
| **File di configurazione** | Per abilitare l'ereditarietà dei comportamenti attraverso la gerarchia di file di configurazione, WCF ora supporta l'unione tra i file di configurazione.<br><br>Il modello di ereditarietà di configurazione è stato espanso e consente agli utenti di definire i comportamenti che verranno applicati a tutti i servizi in esecuzione nel computer.<br><br>Se sono presenti comportamenti con lo stesso nome a livelli diversi della gerarchia è possibile che si riscontrino differenze a livello di comportamento. |
| **Hosting del servizio** | Non è più possibile specificare l'elemento di configurazione `<serviceHostingEnvironment>` a livello di servizio aggiungendo l'attributo `allowDefinition="MachineToApplication"` alla definizione dell'elemento.<br><br>La specifica dell'elemento `<serviceHostingEnvironment>` a livello di servizio è tecnicamente errata e determina un comportamento incoerente. |

## <a name="windows-presentation-foundation-wpf"></a>Windows Presentation Foundation (WPF)

### <a name="applications"></a>Applicazioni

Spazi dei nomi: <xref:System.Windows> ,<xref:System.Windows.Controls>

Assembly: PresentationFramework (in PresentationFramework.dll)

| Funzionalità | Differenze rispetto alla versione 3.5 SP1 | Modifiche consigliate |
| ------- | ------------------------ | ------------------- |
| **Gestione delle eccezioni** | Per abilitare un rilevamento più rapido degli errori, WPF genera un <xref:System.Reflection.TargetInvocationException> e imposta la proprietà <xref:System.Exception.InnerException> per eccezioni critiche come <xref:System.NullReferenceException>, <xref:System.OutOfMemoryException>, <xref:System.StackOverflowException> e <xref:System.Security.SecurityException> anziché rilevare l'eccezione originale. | No. |
| **Linked Resources** | Per semplificare il collegamento, quando l'applicazione viene compilata i file di risorse (ad esempio immagini) che si trovano in un percorso diverso dalla struttura di cartelle del progetto usano come ID di risorsa il percorso completo del file di risorse anziché il solo nome file. L'applicazione sarà in grado di trovare i file in fase di esecuzione. | No. |
| **Applicazioni con attendibilità parziale** | Per motivi di sicurezza, le applicazioni per Windows eseguite con attendibilità parziale che contengono un controllo <xref:System.Windows.Controls.WebBrowser> o un controllo <xref:System.Windows.Controls.Frame> con codice HTML generano un <xref:System.Security.SecurityException> al momento della creazione del controllo.<br><br>Le applicazioni browser generano un'eccezione e visualizzano un messaggio se vengono soddisfatte tutte le condizioni seguenti:<br><br>\*L'applicazione è in esecuzione in Firefox.<br>\*L'applicazione è in esecuzione in attendibilità parziale nell'area Internet da siti non attendibili.<br>\*L'applicazione contiene un <xref:System.Windows.Controls.WebBrowser> controllo o un <xref:System.Windows.Controls.Frame> controllo che contiene codice HTML.<br><br>Le applicazioni che vengono eseguite da siti attendibili o dall'area Intranet non saranno interessate. | Nelle applicazioni browser è possibile attenuare l'effetto di questa modifica eseguendo una di queste operazioni:<br><br>\*Eseguire l'applicazione browser con attendibilità totale.<br>\*Chiedere ai clienti di aggiungere il sito dell'applicazione all'area siti attendibili.<br>\*Chiedere ai clienti di eseguire l'applicazione in Internet Explorer. |
| **Dizionari risorse** | Per migliorare i dizionari risorse a livello di tema e impedirne la modifica, le risorse bloccabili definite in un dizionario risorse e unite in un dizionario a livello di tema ora sono sempre contrassegnate come bloccate e non sono modificabili. Questo è il comportamento previsto per le risorse bloccabili. | Le applicazioni che modificano una risorsa definita in un dizionario unito a livello di tema devono duplicare la risorsa e modificare la copia duplicata. In alternativa è possibile contrassegnare la risorsa come `x:Shared="false"` in modo che <xref:System.Windows.ResourceDictionary> crei una nuova copia ogni volta che viene eseguita una query sulla risorsa. |
| **Windows 7** | Per migliorare il funzionamento delle applicazioni WPF in Windows 7 sono stati apportati i miglioramenti seguenti per correggere il comportamento delle finestre:<br><br>\*Gli Stati di ancoraggio e movimento ora funzionano come previsto in base alle interazioni dell'utente.<br>\*I comandi della barra delle applicazioni propagano le **finestre, visualizzano**le finestre in pila e **visualizzano le finestre affiancate** ora hanno il comportamento corretto e aggiornano le proprietà appropriate.<br>\*Le `Top` `Left` proprietà,, `Width` e `Height` per una finestra ingrandita o ridotta a icona ora contengono il percorso di ripristino corretto della finestra anziché altri valori, a seconda del monitoraggio. | No. |
| **Stile di Windows e trasparenza** | Viene generata un'eccezione <xref:System.InvalidOperationException> se si prova a impostare <xref:System.Windows.Window.WindowStyle> su un valore diverso da <xref:System.Windows.WindowStyle> quando <xref:System.Windows.Window.AllowsTransparency> è `true` e <xref:System.Windows.WindowState> è <xref:System.Windows.WindowState>. | Se è necessario modificare <xref:System.Windows.Window.WindowStyle> quando <xref:System.Windows.Window.AllowsTransparency> è `true`, è possibile chiamare la funzione Win32 `SetWindowLongPtr`. |
| **XPS Viewer** | WPF non include Microsoft XML Paper Specification Essentials Pack (XPSEP). XPSEP è incluso in Windows 7 e Windows Vista.<br><br>In un computer in cui è in esecuzione Windows XP senza .NET Framework 3,5 SP1 installato, la stampa tramite un'API WPF diversa da quella in <xref:System.Windows.Controls.PrintDialog> si basa su winspool. Alcune funzionalità della stampante non vengono comunicate e alcune impostazioni della stampante non vengono applicate durante la stampa. | Se necessario, installare [Microsoft XML Paper Specification Essentials Pack](https://www.microsoft.com/en-us/download/details.aspx?id=11816). |

### <a name="controls"></a>Controlli

Spazi dei nomi: <xref:System.Windows> , <xref:System.Windows.Controls> , <xref:System.Windows.Data> ,<xref:System.Windows.Input>

Assembly: PresentationFramework (in PresentationFramework.dll), PresentationCore (in PresentationCore.dll), WindowsBase (in WindowsBase.dll)

| Funzionalità | Differenze rispetto alla versione 3.5 SP1 | Modifiche consigliate |
| ------- | ------------------------ | ------------------- |
| **Finestre di dialogo** | Per migliorare l'affidabilità, il metodo <xref:Microsoft.Win32.CommonDialog.ShowDialog%2A> viene chiamato sullo stesso thread che ha creato il controllo <xref:Microsoft.Win32.FileDialog>. | Assicurarsi di creare un controllo <xref:Microsoft.Win32.FileDialog> e di chiamare il metodo <xref:Microsoft.Win32.CommonDialog.ShowDialog%2A> sullo stesso thread. |
| **Finestre mobili** | Per correggere la logica di ripristino dello stato attivo che continua a riattivare in modo errato una finestra mobile (rendendola simile a una finestra di dialogo modale), il ripristino dello stato attivo ora viene bloccato se la destinazione non è un elemento figlio della finestra. | No. |
| **Elementi di raccolte** | Quando un elemento viene spostato o aggiunto a una raccolta sottostante, appare in <xref:System.Windows.Data.CollectionView> nello stesso percorso relativo se <xref:System.Windows.Data.CollectionView> non è ordinata. Ciò garantisce la coerenza tra la posizione dell'elemento nella raccolta e nella <xref:System.Windows.Data.CollectionView> associata. | Usare il metodo <xref:System.Windows.Controls.ItemContainerGenerator.ContainerFromItem%2A> o <xref:System.Windows.Data.CollectionView.IndexOf%2A> per trovare il percorso di un elemento in una <xref:System.Windows.Data.CollectionView> anziché basarsi sul percorso fisso dell'elemento. |
| **Layout** | Per eliminare rigenerazioni di layout non necessarie, la modifica di <xref:System.Windows.Controls.Page.ShowsNavigationUI> non imposta più il layout come non valido e non attiva un altro passaggio di layout. | Se è previsto che la modifica di <xref:System.Windows.Controls.Page.ShowsNavigationUI> attivi un altro passaggio di layout, chiamare <xref:System.Windows.UIElement.InvalidateVisual%2A> dopo l'impostazione della proprietà. |
| **Menu** | Per abilitare il testo ClearType nei menu popup sono state apportate modifiche alla classe <xref:System.Windows.Controls.ControlTemplate>, al controllo <xref:System.Windows.Controls.MenuItem> e ad altri controlli. | È consigliabile evitare che le applicazioni dipendano dalla struttura visiva dei modelli di controllo. Nel contratto pubblico sono incluse solo le parti denominate di un <xref:System.Windows.Controls.ControlTemplate>. Se un'applicazione deve trovare un determinato oggetto in un <xref:System.Windows.Controls.ControlTemplate> è consigliabile eseguire la ricerca di un tipo specifico nella struttura ad albero visuale anziché basarsi sul percorso fisso di un oggetto nella struttura ad albero. |
| **Esplorazione** | Se un <xref:System.Windows.Controls.Frame> passa direttamente a un percorso, la proprietà <xref:System.Windows.Navigation.NavigatingCancelEventArgs.IsNavigationInitiator> è `true` dopo l'esplorazione iniziale. Questa modifica impedisce l'attivazione di eventi aggiuntivi negli scenari di avvio. | No. |
| **Popup** | Il delegato <xref:System.Windows.Controls.Primitives.CustomPopupPlacementCallback> ora può essere chiamato più volte (anziché una sola volta) durante un passaggio di layout. | Se il delegato <xref:System.Windows.Controls.Primitives.CustomPopupPlacementCallback> calcola la posizione di un <xref:System.Windows.Controls.Primitives.Popup> in base alla posizione precedente, ricalcolare la posizione solo se cambiano i valori dei parametri `popupSize`, `targetSize`, o `offset`. |
| **Valori delle proprietà** | Il <xref:System.Windows.DependencyObject.SetCurrentValue%2A> metodo consente ora di impostare una proprietà su un valore effettivo, sebbene continui a rispettare qualsiasi binding, stile o trigger che influisca sulla proprietà. | È consigliabile che gli autori di controlli usino <xref:System.Windows.DependencyObject.SetCurrentValue%2A> ogni volta che il valore della proprietà viene modificato come effetto secondario di un'altra azione, tra cui una modifica apportata dall'utente. |
| **Caselle di testo** | Per motivi di sicurezza i metodi <xref:System.Windows.Forms.TextBoxBase.Copy%2A> e <xref:System.Windows.Forms.TextBoxBase.Cut%2A> chiamati con attendibilità parziale si interrompono senza avvisi.<br><br>Con l'attendibilità parziale viene anche bloccata l'esecuzione a livello di codice della proprietà <xref:System.Windows.Input.ApplicationCommands.Copy> o <xref:System.Windows.Input.ApplicationCommands.Cut> su un controllo che eredita da <xref:System.Windows.Controls.Primitives.TextBoxBase>. Funzionano invece i comandi di tipo copia e incolla avviati dall'utente, ad esempio il clic su un pulsante la cui proprietà <xref:System.Windows.Controls.Primitives.ButtonBase.Command> è associata a uno di questi comandi. Le operazioni copia e incolla con scelte rapide da tastiera o con le opzioni del menu contestuale funzionano nel modo consueto con l'attendibilità parziale. | Impostare il binding del comando <xref:System.Windows.Input.ApplicationCommands.Copy> o <xref:System.Windows.Input.ApplicationCommands.Cut> a un'azione avviata dall'utente, ad esempio un clic su un pulsante. |

### <a name="graphics"></a>Grafica

Spazi dei nomi: <xref:System.Windows> , <xref:System.Windows.Controls> , <xref:System.Windows.Data> , <xref:System.Windows.Input> ,<xref:System.Windows.Media.Effects>

Assembly: PresentationFramework (in PresentationFramework.dll), PresentationCore (in PresentationCore.dll), WindowsBase (in WindowsBase.dll)

| Funzionalità | Differenze rispetto alla versione 3.5 SP1 | Modifiche consigliate |
| ------- | ------------------------ | ------------------- |
| **Effetti bitmap** | Per migliorare le prestazioni, la classe <xref:System.Windows.Media.Effects.BitmapEffect> e le classi che ereditano dalla classe <xref:System.Windows.Media.Effects.BitmapEffect> sono ancora presenti ma disattivate. Il rendering dell'effetto verrà eseguito tramite la pipeline di rendering con accelerazione hardware se sono soddisfatte le condizioni seguenti:<br><br>\*Nell'applicazione viene utilizzato un oggetto <xref:System.Windows.Media.Effects.DropShadowBitmapEffect> o <xref:System.Windows.Media.Effects.BlurBitmapEffect> con una proprietà RADIUS impostata su un valore inferiore a 100 DIU.<br>\*La scheda video del computer che esegue l'applicazione supporta pixel shader 2,0.<br><br>Se non vengono soddisfatte queste condizioni, un oggetto <xref:System.Windows.Media.Effects.BitmapEffect> non ha alcun effetto.<br><br>Visual Studio produce un avviso del compilatore anche quando rileva l'oggetto <xref:System.Windows.Media.Effects.BitmapEffect> o una sottoclasse.<br><br>Il metodo <xref:System.Windows.Media.DrawingContext.PushEffect%2A> è contrassegnato come obsoleto. | È consigliabile evitare di usare la classe legacy <xref:System.Windows.Media.Effects.BitmapEffect> e le classi derivate e usare invece le nuove classi derivate da <xref:System.Windows.Media.Effects.Effect>: <xref:System.Windows.Media.Effects.BlurEffect>, <xref:System.Windows.Media.Effects.DropShadowEffect> e <xref:System.Windows.Media.Effects.ShaderEffect>.<br><br>È anche possibile creare effetti personalizzati con l'ereditarietà dalla classe <xref:System.Windows.Media.Effects.ShaderEffect>. |
| **Fotogrammi bitmap** | Gli oggetti <xref:System.Windows.Media.Imaging.BitmapFrame> clonati ora ricevono gli eventi <xref:System.Windows.Media.Imaging.BitmapSource.DownloadProgress>, <xref:System.Windows.Media.Imaging.BitmapSource.DownloadCompleted> e <xref:System.Windows.Media.Imaging.BitmapSource.DownloadFailed>. In questo modo le immagini scaricate dal Web e applicate al controllo <xref:System.Windows.Controls.Image> con un <xref:System.Windows.Style> vengono elaborate correttamente.<br><br>Si rileva una modifica del comportamento solo se tutte le affermazioni seguenti sono vere:<br><br>\*Si sottoscrive l' <xref:System.Windows.Media.Imaging.BitmapSource.DownloadProgress> evento, <xref:System.Windows.Media.Imaging.BitmapSource.DownloadCompleted> o <xref:System.Windows.Media.Imaging.BitmapSource.DownloadFailed> .<br>\*L'origine del <xref:System.Windows.Media.Imaging.BitmapFrame> è dal Web.<br>\*<xref:System.Windows.Media.Imaging.BitmapFrame>Viene clonato mentre il download è ancora in corso. | Controllare il mittente nel gestore dell'evento e intervenire solo se il mittente è il <xref:System.Windows.Media.Imaging.BitmapFrame> originale. |
| **Decodifica di immagini** | Per evitare che un <xref:System.IO.IOException> non venga gestito quando non è possibile decodificare le immagini, la classe <xref:System.Windows.Media.Imaging.BitmapSource> genera l'evento <xref:System.Windows.Media.Imaging.BitmapSource.DecodeFailed> quando non decodifica un'immagine. | Rimuovere la gestione eccezioni per <xref:System.IO.IOException> e usare l'evento <xref:System.Windows.Media.Imaging.BitmapSource.DecodeFailed> per verificare la presenza di errori di decodifica. |

### <a name="input"></a>Input

Spazi dei nomi: <xref:System.Windows> , <xref:System.Windows.Controls> , <xref:System.Windows.Data> ,<xref:System.Windows.Input>

Assembly: PresentationFramework (in PresentationFramework.dll), PresentationCore (in PresentationCore.dll), WindowsBase (in WindowsBase.dll)

| Funzionalità | Differenze rispetto alla versione 3.5 SP1 | Modifiche consigliate |
| ------- | ------------------------ | ------------------- |
| **Binding di istanze di comandi** | Per offrire un meccanismo per il binding di istanze di comandi basate su View-Model a movimenti di input basati su View, la classe <xref:System.Windows.Input.InputBinding> ora eredita da <xref:System.Windows.Freezable> anziché da <xref:System.Windows.DependencyObject>. Le proprietà seguenti sono ora proprietà di dipendenza:<br><br>\* <xref:System.Windows.Input.InputBinding.Command><br>\* <xref:System.Windows.Input.InputBinding.CommandParameter><br>\* <xref:System.Windows.Input.InputBinding.CommandTarget><br><br>I risultati cambiano nel modo seguente:<br><br>\*Un <xref:System.Windows.Input.InputBinding> oggetto è ora bloccato quando viene registrato anziché rimanere modificabile.<br>\*Non è possibile accedere a oggetti a livello di istanza <xref:System.Windows.Input.InputBinding> da più thread, a causa delle restrizioni della <xref:System.Windows.DependencyObject> classe.<br>\*Non è possibile modificare le associazioni di input a livello di classe dopo la registrazione, a causa delle restrizioni della <xref:System.Windows.Freezable> classe.<br>\*Non è possibile specificare Binding di input in istanze di comandi create in un modello di visualizzazione. | Se i binding devono essere modificabili, creare istanze distinte di una classe <xref:System.Windows.Input.InputBinding> su thread separati oppure bloccarle in un altro modo. Non modificare un <xref:System.Windows.Input.InputBinding> statico di livello classe dopo che è stato registrato. |
| **Applicazioni browser** | Le applicazioni browser WPF (con estensione xbap) ora elaborano gli eventi chiave come le applicazioni WPF standalone, per cui gli oggetti ricevono eventi chiave indirizzati nell'ordine corretto. | No. |
| **Combinazioni di tasti a cui non è associata alcuna funzione** | WPF disattiva i tasti a cui non è associata alcuna funzione che non producono caratteri visibili, ma indica che il tasto va combinato con il tasto lettera contiguo per produrre un carattere. Gli eventi di input dei tasti, ad esempio l'evento <xref:System.Windows.Input.Keyboard.KeyDownEvent>, segnalano quando un tasto non è associato ad alcuna funzione impostando la proprietà <xref:System.Windows.Input.KeyEventArgs.Key> sul valore <xref:System.Windows.Input.Key>. Questo comportamento è in genere previsto perché le applicazioni non rispondono a input da tastiera che creano un carattere combinato. | Le applicazioni che prevedono la lettura di tasti che fanno parte di un carattere combinato possono ottenere il tasto disattivato usando la proprietà <xref:System.Windows.Input.KeyEventArgs.DeadCharProcessedKey>. |
| **Gestione dello stato attivo** | Quando il metodo <xref:System.Windows.Input.FocusManager.GetFocusedElement(System.Windows.DependencyObject)?displayProperty=nameWithType> riceve un elemento la cui proprietà associata [IsFocusScope](xref:System.Windows.Input.FocusManager.IsFocusScope%2A) è impostata su `true` restituisce un elemento corrispondente all'ultimo elemento attivato da tastiera nell'ambito di attivazione corrente solo se l'elemento restituito appartiene allo stesso oggetto <xref:System.Windows.PresentationSource> al quale appartiene l'elemento passato al metodo. | No. |

### <a name="ui-automation"></a>Automazione interfaccia utente

Spazio dei nomi: <xref:System.Windows> , <xref:System.Windows.Automation.Peers> , <xref:System.Windows.Automation.Provider> , <xref:System.Windows.Controls> , <xref:System.Windows.Data> ,<xref:System.Windows.Input>

Assembly: PresentationFramework (in PresentationFramework.dll), PresentationCore (in PresentationCore.dll), UIAutomationProvider (in UIAutomationProvider.dll), WindowsBase (in WindowsBase.dll)

| Funzionalità | Differenze rispetto alla versione 3.5 SP1 | Modifiche consigliate |
| ------- | ------------------------ | ------------------- |
| **Gerarchia di classi delle viste** | Le classi <xref:System.Windows.Automation.Peers.TreeViewAutomationPeer> e <xref:System.Windows.Automation.Peers.TreeViewItemAutomationPeer> ereditano da <xref:System.Windows.Automation.Peers.ItemsControlAutomationPeer> anziché da <xref:System.Windows.Automation.Peers.FrameworkElementAutomationPeer>. | Se si eredita dalle classi <xref:System.Windows.Automation.Peers.TreeViewItemAutomationPeer> e si esegue l'override del metodo <xref:System.Windows.Automation.Peers.TreeViewItemAutomationPeer.GetChildrenCore%2A> considerare la possibilità di restituire un oggetto che eredita dalla nuova classe <xref:System.Windows.Automation.Peers.TreeViewDataItemAutomationPeer>. |
| **Contenitori fuori schermo** | Per la correzione di un valore restituito errato, il metodo <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.IsOffscreenCore%2A> ora restituisce correttamente `false` per i contenitori di elementi che vengono fatti scorrere fuori dalla vista. Il valore del metodo non è interessato dall'occlusione da parte di altre finestre o dal fatto che l'elemento sia o non sia visibile su un monitor specifico. | No. |
| **Menu e oggetti figlio** | Per abilitare l'automazione interfaccia utente di menu che contengono elementi figlio diversi da oggetti <xref:System.Windows.Controls.MenuItem>, il metodo <xref:System.Windows.Automation.Peers.MenuItemAutomationPeer.GetChildrenCore%2A> restituisce l'oggetto <xref:System.Windows.Automation.Peers.AutomationPeer> di un oggetto <xref:System.Windows.UIElement> figlio anziché un oggetto <xref:System.Windows.Automation.Peers.MenuItemAutomationPeer>. | No. |
| **Nuove interfacce e assembly** | Per abilitare le nuove funzionalità di automazione interfaccia utente sono state aggiunte le interfacce seguenti:<br><br>\* <xref:System.Windows.Automation.Provider.IItemContainerProvider><br>\* <xref:System.Windows.Automation.Provider.ISynchronizedInputProvider><br>\* <xref:System.Windows.Automation.Provider.IVirtualizedItemProvider> | Qualsiasi progetto che compila peer di automazione WPF deve aggiungere un riferimento esplicito a UIAutomationProvider.dll. |
| **Miniature** | Il metodo <xref:System.Windows.Automation.Peers.ThumbAutomationPeer.GetClassNameCore%2A> restituisce un valore anziché null. Di conseguenza, i controlli come <xref:System.Windows.Controls.GridSplitter> che ereditano dalla classe <xref:System.Windows.Controls.Primitives.Thumb> segnalano un nome ad Automazione interfaccia utente. | No. |
| **Elementi virtualizzati** | Per migliorare le prestazioni, il metodo <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetChildrenCore%2A> restituisce solo gli oggetti figlio che si trovano effettivamente nella struttura ad albero visuale anziché tutti gli oggetti figlio, virtualizzati o meno. | Usare <xref:System.Windows.Automation.ItemContainerPattern> per l'iterazione su tutti gli elementi di un <xref:System.Windows.Automation.Peers.ItemsControlAutomationPeer>. |

### <a name="xaml"></a>XAML

Spazi dei nomi: <xref:System.Windows> , <xref:System.Windows.Controls> , <xref:System.Windows.Data> , <xref:System.Windows.Input> ,<xref:System.Windows.Markup>

Assembly: PresentationFramework (in PresentationFramework.dll), PresentationCore (in PresentationCore.dll), WindowsBase (in WindowsBase.dll)

| Funzionalità | Differenze rispetto alla versione 3.5 SP1 | Modifiche consigliate |
| ------- | ------------------------ | ------------------- |
| **Estensione di markup** | Quando un'estensione di markup viene usata per impostare una proprietà o per creare un elemento in una raccolta, WPF ora usa sempre correttamente il valore del metodo <xref:System.Windows.Markup.MarkupExtension.ProvideValue%2A> anziché restituire in alcuni casi l'oggetto <xref:System.Windows.Markup.MarkupExtension>. In determinati casi è possibile che un'estensione di markup restituisca se stessa. | Se l'applicazione accede a una risorsa che ha restituito un oggetto <xref:System.Windows.Markup.MarkupExtension> nelle versioni precedenti, fare riferimento all'oggetto restituito da <xref:System.Windows.Markup.MarkupExtension.ProvideValue%2A> anziché all'oggetto <xref:System.Windows.Markup.MarkupExtension>. |
| **Analisi degli attributi** | Gli attributi in XAML ora possono avere un solo punto. Di seguito sono riportati esempi validi:<br><br>`<Button Background="Red"/>` (nessun punto)<br><br>`<Button Button.Background = "Red"/>` (un punto)<br><br>L'elemento seguente non è più valido:<br><br>`<Button Control.Button.Background = "Red"/>` (più di un punto) | Correggere gli attributi XAML che hanno più di un punto. |

## <a name="xml"></a>XML

Questa tabella descrive miglioramenti a funzionalità che in precedenza presentavano limitazioni o altri problemi.

### <a name="schema-and-transforms"></a>Schema e trasformazioni

Spazi dei nomi: <xref:System.Xml.Linq> ; <xref:System.Xml.Schema> ,<xref:System.Xml.XPath>

Assembly: System.Xml (in System.Xml.dll) System.Xml. LINQ (in System.Xml.Linq.dll)

| Funzionalità | Differenze rispetto alla versione 3.5 SP1 |
| ------- | ------------------------ |
| **Schemi camaleonte** | Per evitare il danneggiamento dei dati, ora gli schemi camaleonte vengono duplicati correttamente quando sono inclusi in più schemi.<br><br>Gli schemi camaleonte sono schemi che non dispongono di uno spazio dei nomi di destinazione e quando vengono inclusi in un altro schema XSD adottano lo spazio dei nomi di destinazione dello schema di importazione. Vengono spesso usati per includere tipi comuni in uno schema. |
| **Funzioni ID** | La [funzione id](/sql/xquery/functions-on-sequences-id) XSLT ora restituisce il valore corretto anziché null quando un oggetto <xref:System.Xml.XmlReader> viene passato a un XLST.<br><br>In precedenza, quando l'utente creava un oggetto <xref:System.Xml.XmlReader> da una classe LINQ to XML usando il metodo <xref:System.Xml.Linq.XNode.CreateReader%2A> e questo oggetto <xref:System.Xml.XmlReader> veniva passato a un XSLT, le eventuali istanze della funzione `id` nell'XSLT restituivano null. Questo valore restituito non è consentito per la funzione `id`. |
| **Namespace (attributo)** | Per evitare il danneggiamento dei dati, ora un oggetto <xref:System.Xml.XPath.XPathNavigator> restituisce correttamente il nome locale dell'attributo `x:xmlns`. |
| **Dichiarazioni degli spazi dei nomi** | Un <xref:System.Xml.XmlReader> oggetto in un sottoalbero non crea più dichiarazioni dello spazio dei nomi duplicate all'interno di un elemento XML. |
| **Convalida dello schema** | Per impedire errori nella convalida dello schema, la classe <xref:System.Xml.Schema.XmlSchemaSet> consente la compilazione corretta e coerente degli schemi XSD. Questi schemi possono includere altri schemi, ad esempio `A.xsd` può includere `B.xsd` che a sua volta può includere `C.xsd`. La compilazione di uno di questi elementi determina l'attraversamento di questa struttura di dipendenze. |
| **Funzioni di script** | La [funzione function-available](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms256124(v=vs.100)) non restituisce più erroneamente `false` quando la funzione è di fatto disponibile. |
| **URI** | Il metodo <xref:System.Xml.Linq.XElement.Load%2A> ora restituisce il BaseURI corretto nelle query LINQ. |

### <a name="validation"></a>Convalida

Spazi dei nomi: <xref:System.Xml.Linq> ; <xref:System.Xml.Schema> ,<xref:System.Xml.XPath>

Assembly: System.Xml (in System.Xml.dll) System.Xml. LINQ (in System.Xml.Linq.dll)

| Funzionalità | Differenze rispetto alla versione 3.5 SP1 |
| ------- | ------------------------ |
| **Risolutori dello spazio dei nomi** | Il metodo <xref:System.Xml.XmlReader.ReadContentAs%2A> non ignora più il resolver <xref:System.Xml.IXmlNamespaceResolver> passato al metodo stesso.<br><br>Nelle versioni precedenti il resolver dello spazio dei nomi specificato veniva ignorato e veniva invece usato <xref:System.Xml.XmlReader>. |
| **Spazi vuoti** | Per evitare la perdita di dati quando si crea un lettore, il metodo <xref:System.Xml.XmlReader.Create%2A> non rimuove più gli spazi vuoti significativi.<br><br>La convalida XML riconosce la modalità contenuto misto in cui il testo può essere alternato a markup XML. In modalità mista tutti gli spazi vuoti sono significativi e devono essere segnalati. |

### <a name="writing"></a>Scrittura

Spazi dei nomi: <xref:System.Xml.Linq> ; <xref:System.Xml.Schema> ,<xref:System.Xml.XPath>

Assembly: System.Xml (in System.Xml.dll) System.Xml. LINQ (in System.Xml.Linq.dll)

| Funzionalità | Differenze rispetto alla versione 3.5 SP1 |
| ------- | ------------------------ |
| **Riferimenti alle entità** | Per evitare il danneggiamento dei dati i riferimenti alle entità non vengono più ripetuti due volte negli attributi XML.<br><br>Se l'utente cercava di scrivere un'entità in un attributo `xmlns` o in un attributo `xml:lang` o `xml:space` con il metodo <xref:System.Xml.XmlWriter.WriteEntityRef%2A> l'entità veniva ripetuta due volte nell'output e i dati risultavano danneggiati. |
| **Gestione dei valori di nuova riga** | Per evitare il danneggiamento dei dati ora gli oggetti <xref:System.Xml.XmlWriter> rispettano l'opzione <xref:System.Xml.NewLineHandling>. |

## <a name="see-also"></a>Vedere anche

- [Nuovi tipi e membri in .NET Framework 4](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ff641764%28v=vs.100%29)
- [Guida alla migrazione a .NET Framework 4](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ff657133%28v=vs.100%29)
- [Novità di .NET Framework 4](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms171868%28v=vs.100%29)
- [Compatibilità tra le versioni in .NET Framework](version-compatibility.md)
- [Migrazione di soluzioni Office a .NET Framework 4](/visualstudio/vsto/migrating-office-solutions-to-the-dotnet-framework-4-or-later)
- [Elementi obsoleti nella libreria di classi .NET Framework](../whats-new/whats-obsolete.md)
