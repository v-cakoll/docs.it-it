---
title: 'Mitigazione: Nuovo compilatore JIT a 64 bit'
description: Informazioni sul nuovo compilatore JIT a 64 bit incluso in .NET Framework 4,6 e sul comportamento imprevisto o sulle eccezioni che possono verificarsi durante la compilazione.
ms.date: 03/30/2017
helpviewer_keywords:
- JIT compiler, 64-bit
- JIT compilation, 64-bit
- RyuJIT compiler
ms.assetid: 0332dabc-72c5-4bdc-8975-20d717802b17
ms.openlocfilehash: f059cbdd3b2a66ac8a668b7b8a80d9ad1551fa64
ms.sourcegitcommit: cf5a800a33de64d0aad6d115ffcc935f32375164
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/20/2020
ms.locfileid: "86475229"
---
# <a name="mitigation-new-64-bit-jit-compiler"></a><span data-ttu-id="6577b-103">Mitigazione: Nuovo compilatore JIT a 64 bit</span><span class="sxs-lookup"><span data-stu-id="6577b-103">Mitigation: New 64-bit JIT Compiler</span></span>
<span data-ttu-id="6577b-104">A partire da .NET Framework 4,6, il runtime include un nuovo compilatore JIT a 64 bit per la compilazione just-in-time.</span><span class="sxs-lookup"><span data-stu-id="6577b-104">Starting with .NET Framework 4.6, the runtime includes a new 64-bit JIT compiler for just-in-time compilation.</span></span> <span data-ttu-id="6577b-105">Questa modifica non influisce sulla compilazione con il compilatore JIT a 32 bit.</span><span class="sxs-lookup"><span data-stu-id="6577b-105">This change does not affect compilation with the 32-bit JIT compiler.</span></span>  
  
## <a name="unexpected-behavior-or-exceptions"></a><span data-ttu-id="6577b-106">Comportamento imprevisto o eccezioni</span><span class="sxs-lookup"><span data-stu-id="6577b-106">Unexpected behavior or exceptions</span></span>  
 <span data-ttu-id="6577b-107">In alcuni casi, la compilazione con il nuovo compilatore JIT a 64 bit comporta un'eccezione di runtime o un comportamento che non viene osservato durante l'esecuzione di codice compilato dal compilatore JIT a 64 bit precedente.</span><span class="sxs-lookup"><span data-stu-id="6577b-107">In some cases, compilation with the new 64-bit JIT compiler results in a runtime exception or in behavior that is not observed when executing code compiled by the older 64-bit JIT compiler.</span></span> <span data-ttu-id="6577b-108">Le differenze note includono quanto segue:</span><span class="sxs-lookup"><span data-stu-id="6577b-108">The known differences include the following:</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="6577b-109">Tutti questi problemi noti sono stati risolti nel nuovo compilatore a 64 bit rilasciato con .NET Framework 4.6.2.</span><span class="sxs-lookup"><span data-stu-id="6577b-109">All of these known issues have been addressed in the new 64-bit compiler released with the .NET Framework 4.6.2.</span></span> <span data-ttu-id="6577b-110">La maggior parte dei problemi è stata inoltre risolta nelle service release di .NET Framework 4.6 e 4.6.1 incluse con Windows Update.</span><span class="sxs-lookup"><span data-stu-id="6577b-110">Most have also been addressed in service releases of the .NET Framework 4.6 and 4.6.1 that are included with Windows Update.</span></span> <span data-ttu-id="6577b-111">È possibile evitare questi problemi assicurandosi che la versione di Windows sia aggiornata o eseguendo l'aggiornamento a .NET Framework 4.6.2.</span><span class="sxs-lookup"><span data-stu-id="6577b-111">You can eliminate these issues by ensuring that your version of Windows is up to date, or by upgrading to the .NET Framework 4.6.2.</span></span>  
  
- <span data-ttu-id="6577b-112">In determinate condizioni, un'operazione di conversione unboxing può generare <xref:System.NullReferenceException> nelle build di rilascio con l'ottimizzazione attivata.</span><span class="sxs-lookup"><span data-stu-id="6577b-112">Under certain conditions, an unboxing operation may throw a <xref:System.NullReferenceException> in Release builds with optimization turned on.</span></span>  
  
- <span data-ttu-id="6577b-113">In alcuni casi l'esecuzione del codice di produzione in un corpo del metodo di grandi dimensioni può generare <xref:System.StackOverflowException>.</span><span class="sxs-lookup"><span data-stu-id="6577b-113">In some cases, execution of production code in a large method body may throw a <xref:System.StackOverflowException>.</span></span>  
  
- <span data-ttu-id="6577b-114">In determinate condizioni, le strutture passate a un metodo vengono considerate come tipi di riferimento piuttosto che tipi di valore nelle build di rilascio.</span><span class="sxs-lookup"><span data-stu-id="6577b-114">Under certain conditions, structures passed to a method are treated as reference types rather than value types in Release builds.</span></span> <span data-ttu-id="6577b-115">Una delle manifestazioni di questo problema è che i singoli elementi in una raccolta vengono visualizzati in un ordine imprevisto.</span><span class="sxs-lookup"><span data-stu-id="6577b-115">One of the manifestations of this issue is that the individual items in a collection appear in an unexpected order.</span></span>  
  
- <span data-ttu-id="6577b-116">In determinate condizioni, il confronto dei valori di <xref:System.UInt16> con il set di bit elevato non è corretto se l'ottimizzazione è abilitata.</span><span class="sxs-lookup"><span data-stu-id="6577b-116">Under certain conditions, the comparison of <xref:System.UInt16> values with their high bit set is incorrect if optimization is enabled.</span></span>  
  
- <span data-ttu-id="6577b-117">In determinate condizioni, in particolare durante l'inizializzazione dei valori della matrice, è possibile che l'inizializzazione della memoria con l'istruzione IL <xref:System.Reflection.Emit.OpCodes.Initblk?displayProperty=nameWithType> venga eseguita con un valore non corretto.</span><span class="sxs-lookup"><span data-stu-id="6577b-117">Under certain conditions, particularly when initializing array values, memory initialization by the <xref:System.Reflection.Emit.OpCodes.Initblk?displayProperty=nameWithType> IL instruction may initialize memory with an incorrect value.</span></span> <span data-ttu-id="6577b-118">Ciò può generare un'eccezione non gestita o un output non corretto.</span><span class="sxs-lookup"><span data-stu-id="6577b-118">This can result either in an unhandled exception or incorrect output.</span></span>  
  
- <span data-ttu-id="6577b-119">In alcuni casi rari, un test condizionale dei bit può restituire il valore <xref:System.Boolean> non corretto o generare un'eccezione se sono abilitate le ottimizzazioni del compilatore.</span><span class="sxs-lookup"><span data-stu-id="6577b-119">Under certain rare conditions, a conditional bit test can return the incorrect <xref:System.Boolean> value or throw an exception if compiler optimizations are enabled.</span></span>  
  
- <span data-ttu-id="6577b-120">In determinate condizioni, se un'istruzione `if` viene usata per testare una condizione prima di immettere un blocco `try` e in uscita dal blocco `try`, e la stessa condizione viene valutata nel blocco `catch` o `finally`, il nuovo compilatore JIT a 64 bit rimuove la condizione `if` dal blocco `catch` o `finally` quando ottimizza il codice.</span><span class="sxs-lookup"><span data-stu-id="6577b-120">Under certain conditions, if an `if` statement is used to test for a condition before entering  a `try` block and in the exit from the `try` block, and the same condition is evaluated in the `catch` or `finally` block, the new 64-bit JIT compiler removes the `if` condition from the `catch` or `finally` block when it optimizes code.</span></span> <span data-ttu-id="6577b-121">Di conseguenza, il codice contenuto nell'istruzione `if` nel blocco `catch` o `finally` viene eseguita in modo non condizionale.</span><span class="sxs-lookup"><span data-stu-id="6577b-121">As a result, code inside the `if` statement in the `catch` or `finally` block is executed unconditionally.</span></span>  
  
<a name="General"></a>
## <a name="mitigation-of-known-issues"></a><span data-ttu-id="6577b-122">Mitigazione dei problemi noti</span><span class="sxs-lookup"><span data-stu-id="6577b-122">Mitigation of known issues</span></span>  
 <span data-ttu-id="6577b-123">Se si verificano i problemi elencati in precedenza, è possibile risolverli effettuando una delle operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="6577b-123">If you encounter the issues listed above, you can address them by doing any of the following:</span></span>  
  
- <span data-ttu-id="6577b-124">Eseguire l'aggiornamento a .NET Framework 4.6.2.</span><span class="sxs-lookup"><span data-stu-id="6577b-124">Upgrade to the .NET Framework 4.6.2.</span></span> <span data-ttu-id="6577b-125">Il nuovo compilatore a 64 bit incluso in .NET Framework 4.6.2 risolve tutti questi problemi noti.</span><span class="sxs-lookup"><span data-stu-id="6577b-125">The new 64-bit compiler included with the .NET Framework 4.6.2 addresses each of these known issues.</span></span>  
  
- <span data-ttu-id="6577b-126">Assicurarsi che la versione di Windows venga aggiornata tramite l'esecuzione di Windows Update.</span><span class="sxs-lookup"><span data-stu-id="6577b-126">Ensure that your version of Windows is up to date by running Windows Update.</span></span> <span data-ttu-id="6577b-127">Gli aggiornamenti dei servizi per .NET Framework 4.6 e 4.6.1 risolvono tutti questi problemi, ad eccezione di <xref:System.NullReferenceException> in un'operazione di conversione unboxing.</span><span class="sxs-lookup"><span data-stu-id="6577b-127">Service updates to the .NET Framework 4.6 and 4.6.1 address each of these issues except the <xref:System.NullReferenceException> in an unboxing operation.</span></span>  
  
- <span data-ttu-id="6577b-128">Eseguire la compilazione con la versione precedente del compilatore JIT a 64 bit.</span><span class="sxs-lookup"><span data-stu-id="6577b-128">Compile with the older 64-bit JIT compiler.</span></span> <span data-ttu-id="6577b-129">Vedere la sezione [Mitigazione di altri problemi](#Other) per altre informazioni su come eseguire questa operazione.</span><span class="sxs-lookup"><span data-stu-id="6577b-129">See the [Mitigation of other issues](#Other) section for more information on how to do this.</span></span>  
  
<a name="Other"></a>
## <a name="mitigation-of-other-issues"></a><span data-ttu-id="6577b-130">Mitigazione di altri problemi</span><span class="sxs-lookup"><span data-stu-id="6577b-130">Mitigation of other issues</span></span>  
 <span data-ttu-id="6577b-131">Nel caso di qualsiasi altra differenza nel comportamento tra il codice compilato con la versione precedente del compilatore a 64 bit e quello compilato con la versione nuova, oppure tra le versioni di debug e rilascio dell'app compilate entrambe con il nuovo compilatore JIT a 64 bit, è possibile eseguire le operazioni seguenti per compilare l'app con la versione precedente del compilatore JIT a 64 bit:</span><span class="sxs-lookup"><span data-stu-id="6577b-131">If you encounter any other difference in behavior between code compiled with the older 64-bit compiler and the new 64-bit JIT compiler, or between the debug and release versions of your app that are both compiled with the new 64-bit JIT compiler, you can do the following to compile your app with the older 64-bit JIT compiler:</span></span>  
  
- <span data-ttu-id="6577b-132">Per ogni singola applicazione, è possibile aggiungere l' [\<useLegacyJit>](../configure-apps/file-schema/runtime/uselegacyjit-element.md) elemento al file di configurazione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="6577b-132">On a per-application basis, you can add the [\<useLegacyJit>](../configure-apps/file-schema/runtime/uselegacyjit-element.md) element to your application's configuration file.</span></span> <span data-ttu-id="6577b-133">Le operazioni seguenti consentono di disattivare la compilazione con il nuovo compilatore JIT a 64 bit e usare invece il compilatore JIT a 64 bit legacy.</span><span class="sxs-lookup"><span data-stu-id="6577b-133">The following disables compilation with the new 64-bit JIT compiler and instead uses the legacy 64-bit JIT compiler.</span></span>  
  
    ```xml  
    <?xml version ="1.0"?>  
    <configuration>  
        <runtime>  
           <useLegacyJit enabled="1" />  
        </runtime>  
    </configuration>  
    ```  
  
- <span data-ttu-id="6577b-134">Per ogni utente è possibile aggiungere un valore `REG_DWORD` denominato `useLegacyJit` per la chiave `HKEY_CURRENT_USER\SOFTWARE\Microsoft\.NETFramework` del Registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="6577b-134">On a per-user basis, you can add a `REG_DWORD` value named `useLegacyJit` to the `HKEY_CURRENT_USER\SOFTWARE\Microsoft\.NETFramework` key of the registry.</span></span> <span data-ttu-id="6577b-135">Il valore 1 abilita il compilatore JIT a 64 bit legacy, mentre il valore 0 lo disattiva e consente di abilitare il nuovo compilatore JIT a 64 bit.</span><span class="sxs-lookup"><span data-stu-id="6577b-135">A value of 1 enables the legacy 64-bit JIT compiler; a value of 0 disables it and enables the new 64-bit JIT compiler.</span></span>  
  
- <span data-ttu-id="6577b-136">Per ogni macchina è possibile aggiungere un valore `REG_DWORD` denominato `useLegacyJit` per la chiave `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\.NETFramework` del Registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="6577b-136">On a per-machine basis, you can add a `REG_DWORD` value named `useLegacyJit` to the `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\.NETFramework` key of the registry.</span></span> <span data-ttu-id="6577b-137">Il valore 1 abilita il compilatore JIT a 64 bit legacy, mentre il valore 0 lo disattiva e consente di abilitare il nuovo compilatore JIT a 64 bit.</span><span class="sxs-lookup"><span data-stu-id="6577b-137">A value of 1 enables the legacy 64-bit JIT compiler; a value of 0 disables it and enables the new 64-bit JIT compiler.</span></span>  
  
 <span data-ttu-id="6577b-138">È possibile inoltre inviare i dettagli sul problema segnalando un bug in [Microsoft Connect](https://connect.microsoft.com/VisualStudio).</span><span class="sxs-lookup"><span data-stu-id="6577b-138">You can also let us know about the problem by reporting a bug on [Microsoft Connect](https://connect.microsoft.com/VisualStudio).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6577b-139">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="6577b-139">See also</span></span>

- [<span data-ttu-id="6577b-140">Compatibilità tra le versioni</span><span class="sxs-lookup"><span data-stu-id="6577b-140">Application compatibility</span></span>](application-compatibility.md)
- [<span data-ttu-id="6577b-141">\<useLegacyJit>Elemento</span><span class="sxs-lookup"><span data-stu-id="6577b-141">\<useLegacyJit> Element</span></span>](../configure-apps/file-schema/runtime/uselegacyjit-element.md)
