---
title: Confronto tra XPath e LINQ to XML
description: Informazioni sulle analogie e sulle differenze di funzionalità tra XPath e LINQ to XML in C#. È possibile utilizzare entrambi per eseguire una query su un albero XML.
ms.date: 07/20/2015
dev_langs:
- csharp
- vb
ms.assetid: 87d361b1-daa9-4fd4-a53a-cbfa40111ad3
ms.openlocfilehash: e2f34903b20a53dea6e5ff4858d4fadaebd9c37a
ms.sourcegitcommit: 04022ca5d00b2074e1b1ffdbd76bec4950697c4c
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/23/2020
ms.locfileid: "87104004"
---
# <a name="comparison-of-xpath-and-linq-to-xml"></a><span data-ttu-id="d4a17-104">Confronto tra XPath e LINQ to XML</span><span class="sxs-lookup"><span data-stu-id="d4a17-104">Comparison of XPath and LINQ to XML</span></span>
<span data-ttu-id="d4a17-105">XPath e LINQ to XML offrono alcune funzionalità analoghe.</span><span class="sxs-lookup"><span data-stu-id="d4a17-105">XPath and LINQ to XML offer some similar functionality.</span></span> <span data-ttu-id="d4a17-106">Entrambi possono essere usati per eseguire query su un albero XML, restituendo risultati quali una raccolta di elementi, una raccolta di attributi, una raccolta di nodi o il valore di un elemento o di un attributo.</span><span class="sxs-lookup"><span data-stu-id="d4a17-106">Both can be used to query an XML tree, returning such results as a collection of elements, a collection of attributes, a collection of nodes, or the value of an element or attribute.</span></span> <span data-ttu-id="d4a17-107">Esistono tuttavia alcune differenze.</span><span class="sxs-lookup"><span data-stu-id="d4a17-107">However, there are also some differences.</span></span>  
  
## <a name="differences-between-xpath-and-linq-to-xml"></a><span data-ttu-id="d4a17-108">Differenze tra XPath e LINQ to XML</span><span class="sxs-lookup"><span data-stu-id="d4a17-108">Differences Between XPath and LINQ to XML</span></span>  
 <span data-ttu-id="d4a17-109">XPath non consente la proiezione di nuovi tipi.</span><span class="sxs-lookup"><span data-stu-id="d4a17-109">XPath does not allow projection of new types.</span></span> <span data-ttu-id="d4a17-110">Può restituire solo raccolte di nodi dall'albero, mentre tramite LINQ to XML può eseguire una query e proiettare un oggetto grafico o un albero XML in una nuova forma.</span><span class="sxs-lookup"><span data-stu-id="d4a17-110">It can only return collections of nodes from the tree, whereas LINQ to XML can execute a query and project an object graph or an XML tree in a new shape.</span></span> <span data-ttu-id="d4a17-111">Le query LINQ to XML includono molte più funzionalità e sono molto più efficaci delle espressioni XPath.</span><span class="sxs-lookup"><span data-stu-id="d4a17-111">LINQ to XML queries encompass much more functionality and are much more powerful than XPath expressions.</span></span>  
  
 <span data-ttu-id="d4a17-112">Le espressioni XPath esistono in isolamento all'interno di una stringa.</span><span class="sxs-lookup"><span data-stu-id="d4a17-112">XPath expressions exist in isolation within a string.</span></span> <span data-ttu-id="d4a17-113">Il compilatore C# non consente di analizzare l'espressione XPath in fase di compilazione.</span><span class="sxs-lookup"><span data-stu-id="d4a17-113">The C# compiler cannot help parse the XPath expression at compile time.</span></span> <span data-ttu-id="d4a17-114">Al contrario, le query LINQ to XML vengono analizzate e compilate tramite il compilatore C#.</span><span class="sxs-lookup"><span data-stu-id="d4a17-114">By contrast, LINQ to XML queries are parsed and compiled by the C# compiler.</span></span> <span data-ttu-id="d4a17-115">Il compilatore è in grado di intercettare molti errori di query.</span><span class="sxs-lookup"><span data-stu-id="d4a17-115">The compiler is able to catch many query errors.</span></span>  
  
 <span data-ttu-id="d4a17-116">I risultati di XPath non sono fortemente tipizzati.</span><span class="sxs-lookup"><span data-stu-id="d4a17-116">XPath results are not strongly typed.</span></span> <span data-ttu-id="d4a17-117">In diverse circostanze il risultato della valutazione di un'espressione XPath è un oggetto e spetta allo sviluppatore determinare il tipo appropriato ed eseguire il cast del risultato secondo necessità.</span><span class="sxs-lookup"><span data-stu-id="d4a17-117">In a number of circumstances, the result of evaluating an XPath expression is an object, and it is up to the developer to determine the proper type and cast the result as necessary.</span></span> <span data-ttu-id="d4a17-118">Al contrario, le proiezioni di una query LINQ to XML sono fortemente tipizzate.</span><span class="sxs-lookup"><span data-stu-id="d4a17-118">By contrast, the projections from a LINQ to XML query are strongly typed.</span></span>  
  
## <a name="result-ordering"></a><span data-ttu-id="d4a17-119">Ordinazione di risultati</span><span class="sxs-lookup"><span data-stu-id="d4a17-119">Result Ordering</span></span>  
 <span data-ttu-id="d4a17-120">Nella raccomandazione XPath 1.0 si afferma che una raccolta corrispondente al risultato della valutazione di un'espressione XPath non è ordinata.</span><span class="sxs-lookup"><span data-stu-id="d4a17-120">The XPath 1.0 Recommendation states that a collection that is the result of evaluating an XPath expression is unordered.</span></span>  
  
 <span data-ttu-id="d4a17-121">Tuttavia, quando si esegue l'iterazione di una raccolta restituita da un metodo dell'asse XPath LINQ to XML, i nodi della raccolta vengono restituiti nell'ordine del documento.</span><span class="sxs-lookup"><span data-stu-id="d4a17-121">However, when iterating through a collection returned by a LINQ to XML XPath axis method, the nodes in the collection are returned in document order.</span></span> <span data-ttu-id="d4a17-122">Ciò è vero anche quando si accede a assi XPath in cui i predicati sono espressi in termini di ordine inverso del documento, ad esempio `preceding` e `preceding-sibling`.</span><span class="sxs-lookup"><span data-stu-id="d4a17-122">This is the case even when accessing the XPath axes where predicates are expressed in terms of reverse document order, such as `preceding` and `preceding-sibling`.</span></span>  
  
 <span data-ttu-id="d4a17-123">Al contrario, la maggior parte degli assi LINQ to XML restituisce le raccolte nell'ordine del documento, ma due di essi, <xref:System.Xml.Linq.XElement.AncestorsAndSelf%2A> e <xref:System.Xml.Linq.XNode.Ancestors%2A>, restituiscono le raccolte nell'ordine inverso del documento.</span><span class="sxs-lookup"><span data-stu-id="d4a17-123">By contrast, most of the LINQ to XML axes return collections in document order, but two of them, <xref:System.Xml.Linq.XNode.Ancestors%2A> and <xref:System.Xml.Linq.XElement.AncestorsAndSelf%2A>, return collections in reverse document order.</span></span> <span data-ttu-id="d4a17-124">Nella tabella seguente sono enumerati gli assi e viene indicato l'ordine delle raccolte per ognuno di essi:</span><span class="sxs-lookup"><span data-stu-id="d4a17-124">The following table enumerates the axes, and indicates collection order for each:</span></span>  
  
|<span data-ttu-id="d4a17-125">Asse LINQ to XML</span><span class="sxs-lookup"><span data-stu-id="d4a17-125">LINQ to XML axis</span></span>|<span data-ttu-id="d4a17-126">Ordering</span><span class="sxs-lookup"><span data-stu-id="d4a17-126">Ordering</span></span>|  
|----------------------|--------------|  
|<span data-ttu-id="d4a17-127">XContainer.DescendantNodes</span><span class="sxs-lookup"><span data-stu-id="d4a17-127">XContainer.DescendantNodes</span></span>|<span data-ttu-id="d4a17-128">Ordine del documento</span><span class="sxs-lookup"><span data-stu-id="d4a17-128">Document order</span></span>|  
|<span data-ttu-id="d4a17-129">XContainer.Descendants</span><span class="sxs-lookup"><span data-stu-id="d4a17-129">XContainer.Descendants</span></span>|<span data-ttu-id="d4a17-130">Ordine del documento</span><span class="sxs-lookup"><span data-stu-id="d4a17-130">Document order</span></span>|  
|<span data-ttu-id="d4a17-131">XContainer.Elements</span><span class="sxs-lookup"><span data-stu-id="d4a17-131">XContainer.Elements</span></span>|<span data-ttu-id="d4a17-132">Ordine del documento</span><span class="sxs-lookup"><span data-stu-id="d4a17-132">Document order</span></span>|  
|<span data-ttu-id="d4a17-133">XContainer.Nodes</span><span class="sxs-lookup"><span data-stu-id="d4a17-133">XContainer.Nodes</span></span>|<span data-ttu-id="d4a17-134">Ordine del documento</span><span class="sxs-lookup"><span data-stu-id="d4a17-134">Document order</span></span>|  
|<span data-ttu-id="d4a17-135">XContainer.NodesAfterSelf</span><span class="sxs-lookup"><span data-stu-id="d4a17-135">XContainer.NodesAfterSelf</span></span>|<span data-ttu-id="d4a17-136">Ordine del documento</span><span class="sxs-lookup"><span data-stu-id="d4a17-136">Document order</span></span>|  
|<span data-ttu-id="d4a17-137">XContainer.NodesBeforeSelf</span><span class="sxs-lookup"><span data-stu-id="d4a17-137">XContainer.NodesBeforeSelf</span></span>|<span data-ttu-id="d4a17-138">Ordine del documento</span><span class="sxs-lookup"><span data-stu-id="d4a17-138">Document order</span></span>|  
|<span data-ttu-id="d4a17-139">XElement.AncestorsAndSelf</span><span class="sxs-lookup"><span data-stu-id="d4a17-139">XElement.AncestorsAndSelf</span></span>|<span data-ttu-id="d4a17-140">Ordine inverso del documento</span><span class="sxs-lookup"><span data-stu-id="d4a17-140">Reverse document order</span></span>|  
|<span data-ttu-id="d4a17-141">XElement.Attributes</span><span class="sxs-lookup"><span data-stu-id="d4a17-141">XElement.Attributes</span></span>|<span data-ttu-id="d4a17-142">Ordine del documento</span><span class="sxs-lookup"><span data-stu-id="d4a17-142">Document order</span></span>|  
|<span data-ttu-id="d4a17-143">XElement.DescendantNodesAndSelf</span><span class="sxs-lookup"><span data-stu-id="d4a17-143">XElement.DescendantNodesAndSelf</span></span>|<span data-ttu-id="d4a17-144">Ordine del documento</span><span class="sxs-lookup"><span data-stu-id="d4a17-144">Document order</span></span>|  
|<span data-ttu-id="d4a17-145">XElement.DescendantsAndSelf</span><span class="sxs-lookup"><span data-stu-id="d4a17-145">XElement.DescendantsAndSelf</span></span>|<span data-ttu-id="d4a17-146">Ordine del documento</span><span class="sxs-lookup"><span data-stu-id="d4a17-146">Document order</span></span>|  
|<span data-ttu-id="d4a17-147">XNode.Ancestors</span><span class="sxs-lookup"><span data-stu-id="d4a17-147">XNode.Ancestors</span></span>|<span data-ttu-id="d4a17-148">Ordine inverso del documento</span><span class="sxs-lookup"><span data-stu-id="d4a17-148">Reverse document order</span></span>|  
|<span data-ttu-id="d4a17-149">XNode.ElementsAfterSelf</span><span class="sxs-lookup"><span data-stu-id="d4a17-149">XNode.ElementsAfterSelf</span></span>|<span data-ttu-id="d4a17-150">Ordine del documento</span><span class="sxs-lookup"><span data-stu-id="d4a17-150">Document order</span></span>|  
|<span data-ttu-id="d4a17-151">XNode.ElementsBeforeSelf</span><span class="sxs-lookup"><span data-stu-id="d4a17-151">XNode.ElementsBeforeSelf</span></span>|<span data-ttu-id="d4a17-152">Ordine del documento</span><span class="sxs-lookup"><span data-stu-id="d4a17-152">Document order</span></span>|  
|<span data-ttu-id="d4a17-153">XNode.NodesAfterSelf</span><span class="sxs-lookup"><span data-stu-id="d4a17-153">XNode.NodesAfterSelf</span></span>|<span data-ttu-id="d4a17-154">Ordine del documento</span><span class="sxs-lookup"><span data-stu-id="d4a17-154">Document order</span></span>|  
|<span data-ttu-id="d4a17-155">XNode.NodesBeforeSelf</span><span class="sxs-lookup"><span data-stu-id="d4a17-155">XNode.NodesBeforeSelf</span></span>|<span data-ttu-id="d4a17-156">Ordine del documento</span><span class="sxs-lookup"><span data-stu-id="d4a17-156">Document order</span></span>|  
  
## <a name="positional-predicates"></a><span data-ttu-id="d4a17-157">Predicati di posizione</span><span class="sxs-lookup"><span data-stu-id="d4a17-157">Positional Predicates</span></span>  
 <span data-ttu-id="d4a17-158">All'interno di un'espressione XPath, i predicati di posizione vengono espressi in termini di ordine del documento per molti assi, mentre sono espressi in ordine inverso del documento per gli assi inversi, che sono `preceding`, `preceding-sibling`, `ancestor` e `ancestor-or-self`.</span><span class="sxs-lookup"><span data-stu-id="d4a17-158">Within an XPath expression, positional predicates are expressed in terms of document order for many axes, but are expressed in reverse document order for reverse axes, which are `preceding`, `preceding-sibling`, `ancestor`, and `ancestor-or-self`.</span></span> <span data-ttu-id="d4a17-159">Ad esempio, l'espressione XPath `preceding-sibling::*[1]` restituisce l'elemento di pari livello immediatamente precedente.</span><span class="sxs-lookup"><span data-stu-id="d4a17-159">For example, the XPath expression `preceding-sibling::*[1]` returns the immediately preceding sibling.</span></span> <span data-ttu-id="d4a17-160">Ciò è vero anche se il set di risultati finale è presentato nell'ordine del documento.</span><span class="sxs-lookup"><span data-stu-id="d4a17-160">This is the case even though the final result set is presented in document order.</span></span>  
  
 <span data-ttu-id="d4a17-161">Al contrario, tutti i predicati di posizione di LINQ to XML sono sempre espressi in termini di ordine dell'asse.</span><span class="sxs-lookup"><span data-stu-id="d4a17-161">By contrast, all positional predicates in LINQ to XML are always expressed in terms of the order of the axis.</span></span> <span data-ttu-id="d4a17-162">Ad esempio, `anElement.ElementsBeforeSelf().ElementAt(0)` restituisce il primo elemento figlio del padre dell'elemento sottoposto a query, non l'elemento di pari livello immediatamente precedente.</span><span class="sxs-lookup"><span data-stu-id="d4a17-162">For example, `anElement.ElementsBeforeSelf().ElementAt(0)` returns the first child element of the parent of the queried element, not the immediate preceding sibling.</span></span> <span data-ttu-id="d4a17-163">Un altro esempio: `anElement.Ancestors().ElementAt(0)` restituisce l'elemento padre.</span><span class="sxs-lookup"><span data-stu-id="d4a17-163">Another example: `anElement.Ancestors().ElementAt(0)` returns the parent element.</span></span>  
  
 <span data-ttu-id="d4a17-164">Se si vuole trovare l'elemento immediatamente precedente in LINQ to XML, scrivere l'espressione seguente:</span><span class="sxs-lookup"><span data-stu-id="d4a17-164">If you wanted to find the immediately preceding element in LINQ to XML, you would write the following expression:</span></span>  
  
```csharp
ElementsBeforeSelf().Last()
```
  
```vb
ElementsBeforeSelf().Last()
```
  
## <a name="performance-differences"></a><span data-ttu-id="d4a17-165">Differenze di prestazioni</span><span class="sxs-lookup"><span data-stu-id="d4a17-165">Performance Differences</span></span>  
 <span data-ttu-id="d4a17-166">Le query XPath che usano la funzionalità XPath in LINQ to XML non garantiscono le stesse prestazioni delle query LINQ to XML.</span><span class="sxs-lookup"><span data-stu-id="d4a17-166">XPath queries that use the XPath functionality in LINQ to XML will not perform as well as LINQ to XML queries.</span></span>  
  
## <a name="comparison-of-composition"></a><span data-ttu-id="d4a17-167">Confronto di composizione</span><span class="sxs-lookup"><span data-stu-id="d4a17-167">Comparison of Composition</span></span>  
 <span data-ttu-id="d4a17-168">La composizione di una query LINQ to XML è parallela a quella di un'espressione XPath, anche se molto diversa nella sintassi.</span><span class="sxs-lookup"><span data-stu-id="d4a17-168">Composition of a LINQ to XML query is somewhat parallel to composition of an XPath expression, although very different in syntax.</span></span>  
  
 <span data-ttu-id="d4a17-169">Se ad esempio una variabile denominata `customers` contiene un elemento e si desidera trovare un elemento nipote denominato `CompanyName` sotto tutti gli elementi figlio denominati `Customer`, è necessario scrivere la seguente espressione XPath:</span><span class="sxs-lookup"><span data-stu-id="d4a17-169">For example, if you have an element in a variable named `customers`, and you want to find a grandchild element named `CompanyName` under all child elements named `Customer`, you would write an XPath expression as follows:</span></span>  
  
```csharp  
customers.XPathSelectElements("./Customer/CompanyName")
```  
  
```vb
customers.XPathSelectElements("./Customer/CompanyName")
```

 <span data-ttu-id="d4a17-170">L'equivalente di una query LINQ to XML è:</span><span class="sxs-lookup"><span data-stu-id="d4a17-170">The equivalent LINQ to XML query is:</span></span>  
  
```csharp  
customers.Elements("Customer").Elements("CompanyName")
```  
  
```vb
customers.Elements("Customer").Elements("CompanyName")
```  

 <span data-ttu-id="d4a17-171">Esistono paralleli analoghi per ogni asse XPath.</span><span class="sxs-lookup"><span data-stu-id="d4a17-171">There are similar parallels for each of the XPath axes.</span></span>  
  
|<span data-ttu-id="d4a17-172">Asse XPath</span><span class="sxs-lookup"><span data-stu-id="d4a17-172">XPath axis</span></span>|<span data-ttu-id="d4a17-173">Asse LINQ to XML</span><span class="sxs-lookup"><span data-stu-id="d4a17-173">LINQ to XML axis</span></span>|  
|----------------|----------------------|  
|<span data-ttu-id="d4a17-174">child (asse predefinito)</span><span class="sxs-lookup"><span data-stu-id="d4a17-174">child (the default axis)</span></span>|<xref:System.Xml.Linq.XContainer.Elements%2A?displayProperty=nameWithType>|  
|<span data-ttu-id="d4a17-175">Parent (..)</span><span class="sxs-lookup"><span data-stu-id="d4a17-175">Parent (..)</span></span>|<xref:System.Xml.Linq.XObject.Parent%2A?displayProperty=nameWithType>|  
|<span data-ttu-id="d4a17-176">attribute (@)</span><span class="sxs-lookup"><span data-stu-id="d4a17-176">attribute axis (@)</span></span>|<xref:System.Xml.Linq.XElement.Attribute%2A?displayProperty=nameWithType><br /><br /> <span data-ttu-id="d4a17-177">oppure</span><span class="sxs-lookup"><span data-stu-id="d4a17-177">or</span></span><br /><br /> <xref:System.Xml.Linq.XElement.Attributes%2A?displayProperty=nameWithType>|  
|<span data-ttu-id="d4a17-178">asse ancestor</span><span class="sxs-lookup"><span data-stu-id="d4a17-178">ancestor axis</span></span>|<xref:System.Xml.Linq.XNode.Ancestors%2A?displayProperty=nameWithType>|  
|<span data-ttu-id="d4a17-179">asse ancestor-or-self</span><span class="sxs-lookup"><span data-stu-id="d4a17-179">ancestor-or-self axis</span></span>|<xref:System.Xml.Linq.XElement.AncestorsAndSelf%2A?displayProperty=nameWithType>|  
|<span data-ttu-id="d4a17-180">asse descendant (//)</span><span class="sxs-lookup"><span data-stu-id="d4a17-180">descendant axis (//)</span></span>|<xref:System.Xml.Linq.XContainer.Descendants%2A?displayProperty=nameWithType><br /><br /> <span data-ttu-id="d4a17-181">oppure</span><span class="sxs-lookup"><span data-stu-id="d4a17-181">or</span></span><br /><br /> <xref:System.Xml.Linq.XContainer.DescendantNodes%2A?displayProperty=nameWithType>|  
|<span data-ttu-id="d4a17-182">descendant-or-self</span><span class="sxs-lookup"><span data-stu-id="d4a17-182">descendant-or-self</span></span>|<xref:System.Xml.Linq.XElement.DescendantsAndSelf%2A?displayProperty=nameWithType><br /><br /> <span data-ttu-id="d4a17-183">oppure</span><span class="sxs-lookup"><span data-stu-id="d4a17-183">or</span></span><br /><br /> <xref:System.Xml.Linq.XElement.DescendantNodesAndSelf%2A?displayProperty=nameWithType>|  
|<span data-ttu-id="d4a17-184">following-sibling</span><span class="sxs-lookup"><span data-stu-id="d4a17-184">following-sibling</span></span>|<xref:System.Xml.Linq.XNode.ElementsAfterSelf%2A?displayProperty=nameWithType><br /><br /> <span data-ttu-id="d4a17-185">oppure</span><span class="sxs-lookup"><span data-stu-id="d4a17-185">or</span></span><br /><br /> <xref:System.Xml.Linq.XNode.NodesAfterSelf%2A?displayProperty=nameWithType>|  
|<span data-ttu-id="d4a17-186">preceding-sibling</span><span class="sxs-lookup"><span data-stu-id="d4a17-186">preceding-sibling</span></span>|<xref:System.Xml.Linq.XNode.ElementsBeforeSelf%2A?displayProperty=nameWithType><br /><br /> <span data-ttu-id="d4a17-187">oppure</span><span class="sxs-lookup"><span data-stu-id="d4a17-187">or</span></span><br /><br /> <xref:System.Xml.Linq.XNode.NodesBeforeSelf%2A?displayProperty=nameWithType>|  
|<span data-ttu-id="d4a17-188">following</span><span class="sxs-lookup"><span data-stu-id="d4a17-188">following</span></span>|<span data-ttu-id="d4a17-189">Nessun equivalente diretto.</span><span class="sxs-lookup"><span data-stu-id="d4a17-189">No direct equivalent.</span></span>|  
|<span data-ttu-id="d4a17-190">preceding</span><span class="sxs-lookup"><span data-stu-id="d4a17-190">preceding</span></span>|<span data-ttu-id="d4a17-191">Nessun equivalente diretto.</span><span class="sxs-lookup"><span data-stu-id="d4a17-191">No direct equivalent.</span></span>|  
  