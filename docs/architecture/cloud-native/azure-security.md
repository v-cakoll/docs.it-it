---
title: Sicurezza di Azure per app native del cloud
description: Architettura di app .NET cloud native per Azure | Sicurezza di Azure per le app cloud native
ms.date: 05/13/2020
ms.openlocfilehash: 223d9e77aca611697958981bf2ee3a630fb9fffb
ms.sourcegitcommit: e7748001b1cee80ced691d8a76ca814c0b02dd9b
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/14/2020
ms.locfileid: "86374494"
---
# <a name="azure-security-for-cloud-native-apps"></a><span data-ttu-id="4c68e-103">Sicurezza di Azure per app native del cloud</span><span class="sxs-lookup"><span data-stu-id="4c68e-103">Azure security for cloud-native apps</span></span>

<span data-ttu-id="4c68e-104">Le applicazioni native del cloud possono essere più semplici e più difficili da proteggere rispetto alle applicazioni tradizionali.</span><span class="sxs-lookup"><span data-stu-id="4c68e-104">Cloud-native applications can be both easier and more difficult to secure than traditional applications.</span></span> <span data-ttu-id="4c68e-105">Sul lato negativo, è necessario proteggere applicazioni più piccole e dedicare maggiore energia per creare l'infrastruttura di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="4c68e-105">On the downside, you need to secure more smaller applications and dedicate more energy to build out the security infrastructure.</span></span> <span data-ttu-id="4c68e-106">La natura eterogenea dei linguaggi di programmazione e degli stili nella maggior parte delle distribuzioni di servizi comporta inoltre la necessità di prestare maggiore attenzione ai bollettini sulla sicurezza di diversi provider.</span><span class="sxs-lookup"><span data-stu-id="4c68e-106">The heterogeneous nature of programming languages and styles in most service deployments also means you need to pay more attention to security bulletins from many different providers.</span></span>

<span data-ttu-id="4c68e-107">Sul lato flip, i servizi più piccoli, ognuno con il proprio archivio dati, limitano l'ambito di un attacco.</span><span class="sxs-lookup"><span data-stu-id="4c68e-107">On the flip side, smaller services, each with their own data store, limit the scope of an attack.</span></span> <span data-ttu-id="4c68e-108">Se un utente malintenzionato compromette un sistema, è probabilmente più difficile per l'autore dell'attacco passare a un altro sistema rispetto a un'applicazione monolitica.</span><span class="sxs-lookup"><span data-stu-id="4c68e-108">If an attacker compromises one system, it's probably more difficult for the attacker to make the jump to another system than it is in a monolithic application.</span></span> <span data-ttu-id="4c68e-109">I limiti del processo sono limiti forti.</span><span class="sxs-lookup"><span data-stu-id="4c68e-109">Process boundaries are strong boundaries.</span></span> <span data-ttu-id="4c68e-110">Inoltre, in caso di perdita di un backup del database, il danno è più limitato perché il database contiene solo un subset di dati e non può contenere dati personali.</span><span class="sxs-lookup"><span data-stu-id="4c68e-110">Also, if a database backup leaks, then the damage is more limited, as that database contains only a subset of data and is unlikely to contain personal data.</span></span>

## <a name="threat-modeling"></a><span data-ttu-id="4c68e-111">Modellazione delle minacce</span><span class="sxs-lookup"><span data-stu-id="4c68e-111">Threat modeling</span></span>

<span data-ttu-id="4c68e-112">Indipendentemente dal fatto che i vantaggi superino gli svantaggi delle applicazioni native del cloud, è necessario seguire la stessa mentalità olistica per la sicurezza.</span><span class="sxs-lookup"><span data-stu-id="4c68e-112">No matter if the advantages outweigh the disadvantages of cloud-native applications, the same holistic security mindset must be followed.</span></span> <span data-ttu-id="4c68e-113">La sicurezza e il pensiero sicuro devono far parte di ogni fase della storia di sviluppo e operatività.</span><span class="sxs-lookup"><span data-stu-id="4c68e-113">Security and secure thinking must be part of every step of the development and operations story.</span></span> <span data-ttu-id="4c68e-114">Quando si pianifica un'applicazione, porre domande come:</span><span class="sxs-lookup"><span data-stu-id="4c68e-114">When planning an application ask questions like:</span></span>

- <span data-ttu-id="4c68e-115">Qual è l'effetto della perdita dei dati?</span><span class="sxs-lookup"><span data-stu-id="4c68e-115">What would be the impact of this data being lost?</span></span>
- <span data-ttu-id="4c68e-116">In che modo è possibile limitare i danni causati da dati danneggiati da inserire in questo servizio?</span><span class="sxs-lookup"><span data-stu-id="4c68e-116">How can we limit the damage from bad data being injected into this service?</span></span>
- <span data-ttu-id="4c68e-117">Utenti autorizzati ad accedere a questi dati</span><span class="sxs-lookup"><span data-stu-id="4c68e-117">Who should have access to this data?</span></span>
- <span data-ttu-id="4c68e-118">Sono disponibili criteri di controllo per il processo di sviluppo e rilascio?</span><span class="sxs-lookup"><span data-stu-id="4c68e-118">Are there auditing policies in place around the development and release process?</span></span>

<span data-ttu-id="4c68e-119">Tutte queste domande fanno parte di un processo denominato [modellazione dei rischi](https://docs.microsoft.com/azure/security/azure-security-threat-modeling-tool).</span><span class="sxs-lookup"><span data-stu-id="4c68e-119">All these questions are part of a process called [threat modeling](https://docs.microsoft.com/azure/security/azure-security-threat-modeling-tool).</span></span> <span data-ttu-id="4c68e-120">Questo processo prova a rispondere alla domanda di quali sono le minacce al sistema, alla probabilità che si verifichino le minacce e ai potenziali danni.</span><span class="sxs-lookup"><span data-stu-id="4c68e-120">This process tries to answer the question of what threats there are to the system, how likely the threats are, and the potential damage from them.</span></span>

<span data-ttu-id="4c68e-121">Una volta stabilito l'elenco delle minacce, è necessario decidere se è opportuno attenuarle.</span><span class="sxs-lookup"><span data-stu-id="4c68e-121">Once the list of threats has been established, you need to decide whether they're worth mitigating.</span></span> <span data-ttu-id="4c68e-122">A volte una minaccia è così improbabile e costosa da pianificare perché non vale la pena spendere energia.</span><span class="sxs-lookup"><span data-stu-id="4c68e-122">Sometimes a threat is so unlikely and expensive to plan for that it isn't worth spending energy on it.</span></span> <span data-ttu-id="4c68e-123">Ad esempio, un attore del livello di stato potrebbe inserire le modifiche nella progettazione di un processo usato da milioni di dispositivi.</span><span class="sxs-lookup"><span data-stu-id="4c68e-123">For instance, some state level actor could inject changes into the design of a process that is used by millions of devices.</span></span> <span data-ttu-id="4c68e-124">A questo punto, invece di eseguire una determinata parte di codice nell' [anello 3](https://en.wikipedia.org/wiki/Protection_ring), il codice viene eseguito nell'anello 0.</span><span class="sxs-lookup"><span data-stu-id="4c68e-124">Now, instead of running a certain piece of code in [Ring 3](https://en.wikipedia.org/wiki/Protection_ring), that code is run in Ring 0.</span></span> <span data-ttu-id="4c68e-125">Questo consente un exploit che può ignorare l'hypervisor ed eseguire il codice di attacco sui computer bare metal, consentendo attacchi su tutte le macchine virtuali in esecuzione su tale hardware.</span><span class="sxs-lookup"><span data-stu-id="4c68e-125">This allows an exploit that can bypass the hypervisor and run the attack code on the bare metal machines, allowing attacks on all the virtual machines that are running on that hardware.</span></span>

<span data-ttu-id="4c68e-126">I processori modificati sono difficili da rilevare senza un microscopio e una conoscenza avanzata della progettazione del processore in silicone.</span><span class="sxs-lookup"><span data-stu-id="4c68e-126">The altered processors are difficult to detect without a microscope and advanced knowledge of the on silicon design of that processor.</span></span> <span data-ttu-id="4c68e-127">Questo scenario è improbabile e costoso da mitigare, quindi probabilmente nessun modello di minaccia suggerisce la creazione della protezione dagli exploit.</span><span class="sxs-lookup"><span data-stu-id="4c68e-127">This scenario is unlikely to happen and expensive to mitigate, so probably no threat model would recommend building exploit protection for it.</span></span>

<span data-ttu-id="4c68e-128">Minacce più probabili, ad esempio i controlli di accesso interrotti che consentono `Id` di incrementare gli attacchi (sostituendo `Id=2` con `Id=3` nell'URL) o SQL injection, sono più interessanti per la creazione di protezioni da.</span><span class="sxs-lookup"><span data-stu-id="4c68e-128">More likely threats, such as broken access controls permitting `Id` incrementing attacks (replacing `Id=2` with `Id=3` in the URL) or SQL injection, are more attractive to build protections against.</span></span> <span data-ttu-id="4c68e-129">Le mitigazioni per queste minacce sono piuttosto ragionevoli per la creazione e la prevenzione di problemi di sicurezza imbarazzanti che informano la reputazione dell'azienda.</span><span class="sxs-lookup"><span data-stu-id="4c68e-129">The mitigations for these threats are quite reasonable to build and prevent embarrassing security holes that smear the company's reputation.</span></span>

## <a name="principle-of-least-privilege"></a><span data-ttu-id="4c68e-130">Principio dei privilegi minimi</span><span class="sxs-lookup"><span data-stu-id="4c68e-130">Principle of least privilege</span></span>

<span data-ttu-id="4c68e-131">Una delle idee più rilevate nella sicurezza dei computer è il principio del privilegio minimo (POLP).</span><span class="sxs-lookup"><span data-stu-id="4c68e-131">One of the founding ideas in computer security is the Principle of Least Privilege (POLP).</span></span> <span data-ttu-id="4c68e-132">Si tratta in realtà di un'idea fondamentale nella maggior parte dei casi di sicurezza, sia digitale che fisica.</span><span class="sxs-lookup"><span data-stu-id="4c68e-132">It's actually a foundational idea in most any form of security be it digital or physical.</span></span> <span data-ttu-id="4c68e-133">In breve, il principio è che qualsiasi utente o processo deve avere il minor numero di diritti possibile per eseguire la relativa attività.</span><span class="sxs-lookup"><span data-stu-id="4c68e-133">In short, the principle is that any user or process should have the smallest number of rights possible to execute its task.</span></span>

<span data-ttu-id="4c68e-134">Si pensi ad esempio ai cassieri di una banca: l'accesso al Safe è un'attività non comune.</span><span class="sxs-lookup"><span data-stu-id="4c68e-134">As an example, think of the tellers at a bank: accessing the safe is an uncommon activity.</span></span> <span data-ttu-id="4c68e-135">Quindi, la cassiera media non può aprire la cassaforte.</span><span class="sxs-lookup"><span data-stu-id="4c68e-135">So, the average teller can't open the safe themselves.</span></span> <span data-ttu-id="4c68e-136">Per ottenere l'accesso, è necessario inoltrare la richiesta tramite un responsabile della banca che esegue controlli di sicurezza aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="4c68e-136">To gain access, they need to escalate their request through a bank manager, who performs additional security checks.</span></span>

<span data-ttu-id="4c68e-137">In un sistema informatico, un esempio fantastico è costituito dai diritti di un utente che si connette a un database.</span><span class="sxs-lookup"><span data-stu-id="4c68e-137">In a computer system, a fantastic example is the rights of a user connecting to a database.</span></span> <span data-ttu-id="4c68e-138">In molti casi, è disponibile un singolo account utente che consente di compilare la struttura del database ed eseguire l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="4c68e-138">In many cases, there's a single user account used to both build the database structure and run the application.</span></span> <span data-ttu-id="4c68e-139">Ad eccezione dei casi estremi, l'account che esegue l'applicazione non necessita della possibilità di aggiornare le informazioni sullo schema.</span><span class="sxs-lookup"><span data-stu-id="4c68e-139">Except in extreme cases, the account running the application doesn't need the ability to update schema information.</span></span> <span data-ttu-id="4c68e-140">Dovrebbero essere presenti diversi account che forniscono diversi livelli di privilegio.</span><span class="sxs-lookup"><span data-stu-id="4c68e-140">There should be several accounts that provide different levels of privilege.</span></span> <span data-ttu-id="4c68e-141">L'applicazione deve utilizzare solo il livello di autorizzazione che concede l'accesso in lettura e scrittura ai dati nelle tabelle.</span><span class="sxs-lookup"><span data-stu-id="4c68e-141">The application should only use the permission level that grants read and write access to the data in the tables.</span></span> <span data-ttu-id="4c68e-142">Questo tipo di protezione eliminerà gli attacchi che miravano a eliminare le tabelle di database o a introdurre trigger dannosi.</span><span class="sxs-lookup"><span data-stu-id="4c68e-142">This kind of protection would eliminate attacks that aimed to drop database tables or introduce malicious triggers.</span></span>

<span data-ttu-id="4c68e-143">Quasi tutte le parti della creazione di un'applicazione nativa del cloud possono trarre vantaggio dalla memorizzazione del principio dei privilegi minimi.</span><span class="sxs-lookup"><span data-stu-id="4c68e-143">Almost every part of building a cloud-native application can benefit from remembering the principle of least privilege.</span></span> <span data-ttu-id="4c68e-144">È possibile trovarlo quando si configurano i firewall, i gruppi di sicurezza di rete, i ruoli e gli ambiti nel controllo degli accessi in base al ruolo (RBAC).</span><span class="sxs-lookup"><span data-stu-id="4c68e-144">You can find it at play when setting up firewalls, network security groups, roles, and scopes in Role-based access control (RBAC).</span></span>

## <a name="penetration-testing"></a><span data-ttu-id="4c68e-145">Test di penetrazione</span><span class="sxs-lookup"><span data-stu-id="4c68e-145">Penetration testing</span></span>

<span data-ttu-id="4c68e-146">Man mano che le applicazioni diventano più complesse, il numero di vettori di attacco aumenta a una velocità allarmante.</span><span class="sxs-lookup"><span data-stu-id="4c68e-146">As applications become more complicated the number of attack vectors increases at an alarming rate.</span></span> <span data-ttu-id="4c68e-147">La modellazione delle minacce è difettosa in quanto tende a essere eseguita dalle stesse persone che compilano il sistema.</span><span class="sxs-lookup"><span data-stu-id="4c68e-147">Threat modeling is flawed in that it tends to be executed by the same people building the system.</span></span> <span data-ttu-id="4c68e-148">Nello stesso modo in cui molti sviluppatori riscontrano problemi durante la progettazione delle interazioni utente e quindi compilano interfacce utente inutilizzabili, la maggior parte degli sviluppatori ha difficoltà a osservare ogni vettore di attacco.</span><span class="sxs-lookup"><span data-stu-id="4c68e-148">In the same way that many developers have trouble envisioning user interactions and then build unusable user interfaces, most developers have difficulty seeing every attack vector.</span></span> <span data-ttu-id="4c68e-149">È anche possibile che gli sviluppatori che compilano il sistema non siano in grado di affrontare le metodologie di attacco e perdano qualcosa di fondamentale.</span><span class="sxs-lookup"><span data-stu-id="4c68e-149">It's also possible that the developers building the system aren't well versed in attack methodologies and miss something crucial.</span></span>

<span data-ttu-id="4c68e-150">Il test di penetrazione o il "test di penna" comporta l'inserimento di attori esterni per tentare di attaccare il sistema.</span><span class="sxs-lookup"><span data-stu-id="4c68e-150">Penetration testing or "pen testing" involves bringing in external actors to attempt to attack the system.</span></span> <span data-ttu-id="4c68e-151">Questi utenti malintenzionati possono essere una società di consulenza esterna o altri sviluppatori con una conoscenza di sicurezza di un'altra parte dell'azienda.</span><span class="sxs-lookup"><span data-stu-id="4c68e-151">These attackers may be an external consulting company or other developers with good security knowledge from another part of the business.</span></span> <span data-ttu-id="4c68e-152">A loro viene assegnata una carta bianca per tentare di sovvertire il sistema.</span><span class="sxs-lookup"><span data-stu-id="4c68e-152">They're given carte blanche to attempt to subvert the system.</span></span> <span data-ttu-id="4c68e-153">Spesso, troveranno buchi di sicurezza completi che devono essere corretti.</span><span class="sxs-lookup"><span data-stu-id="4c68e-153">Frequently, they'll find extensive security holes that need to be patched.</span></span> <span data-ttu-id="4c68e-154">Talvolta il vettore di attacco è qualcosa di imprevisto, ad esempio sfruttando un attacco di phishing contro il CEO.</span><span class="sxs-lookup"><span data-stu-id="4c68e-154">Sometimes the attack vector will be something totally unexpected like exploiting a phishing attack against the CEO.</span></span>

<span data-ttu-id="4c68e-155">Azure è costantemente in corso di attacchi da parte [di un team di hacker di Microsoft](https://azure.microsoft.com/resources/videos/red-vs-blue-internal-security-penetration-testing-of-microsoft-azure/).</span><span class="sxs-lookup"><span data-stu-id="4c68e-155">Azure itself is constantly undergoing attacks from a [team of hackers inside Microsoft](https://azure.microsoft.com/resources/videos/red-vs-blue-internal-security-penetration-testing-of-microsoft-azure/).</span></span> <span data-ttu-id="4c68e-156">Nel corso degli anni sono stati i primi a trovare dozzine di vettori di attacco potenzialmente catastrofici, chiuderli prima che possano essere sfruttati esternamente.</span><span class="sxs-lookup"><span data-stu-id="4c68e-156">Over the years, they've been the first to find dozens of potentially catastrophic attack vectors, closing them before they can be exploited externally.</span></span> <span data-ttu-id="4c68e-157">Maggiore è la tentazione di una destinazione, maggiore è la probabilità che gli attori eterni tentino di sfruttarla e che ci siano alcuni obiettivi più accattivanti rispetto ad Azure.</span><span class="sxs-lookup"><span data-stu-id="4c68e-157">The more tempting a target, the more likely that eternal actors will attempt to exploit it and there are a few targets in the world more tempting than Azure.</span></span>

## <a name="monitoring"></a><span data-ttu-id="4c68e-158">Monitoraggio</span><span class="sxs-lookup"><span data-stu-id="4c68e-158">Monitoring</span></span>

<span data-ttu-id="4c68e-159">Se un utente malintenzionato tenta di penetrare in un'applicazione, dovrebbe essere presente un messaggio di avviso.</span><span class="sxs-lookup"><span data-stu-id="4c68e-159">Should an attacker attempt to penetrate an application, there should be some warning of it.</span></span> <span data-ttu-id="4c68e-160">Spesso è possibile individuare gli attacchi esaminando i log dei servizi.</span><span class="sxs-lookup"><span data-stu-id="4c68e-160">Frequently, attacks can be spotted by examining the logs from services.</span></span> <span data-ttu-id="4c68e-161">Gli attacchi lasciano segni di rivelamento che possono essere individuati prima che abbiano esito positivo.</span><span class="sxs-lookup"><span data-stu-id="4c68e-161">Attacks leave telltale signs that can be spotted before they succeed.</span></span> <span data-ttu-id="4c68e-162">Ad esempio, un utente malintenzionato che tenta di indovinare una password effettuerà molte richieste a un sistema di accesso.</span><span class="sxs-lookup"><span data-stu-id="4c68e-162">For instance, an attacker attempting to guess a password will make many requests to a login system.</span></span> <span data-ttu-id="4c68e-163">Il monitoraggio del sistema di accesso è in grado di rilevare modelli bizzarri che non rientrano nel modello di accesso tipico.</span><span class="sxs-lookup"><span data-stu-id="4c68e-163">Monitoring around the login system can detect weird patterns that are out of line with the typical access pattern.</span></span> <span data-ttu-id="4c68e-164">Questo monitoraggio può essere trasformato in un avviso che può, a sua volta, avvisare un operatore operativo per attivare una sorta di contromisura.</span><span class="sxs-lookup"><span data-stu-id="4c68e-164">This monitoring can be turned into an alert that can, in turn, alert an operations person to activate some sort of countermeasure.</span></span> <span data-ttu-id="4c68e-165">Un sistema di monitoraggio estremamente maturo potrebbe anche intervenire in base a queste deviazioni in modo proattivo aggiungendo regole per bloccare le richieste o limitare le risposte.</span><span class="sxs-lookup"><span data-stu-id="4c68e-165">A highly mature monitoring system might even take action based on these deviations proactively adding rules to block requests or throttle responses.</span></span>

## <a name="securing-the-build"></a><span data-ttu-id="4c68e-166">Sicurezza della compilazione</span><span class="sxs-lookup"><span data-stu-id="4c68e-166">Securing the build</span></span>

<span data-ttu-id="4c68e-167">Una delle posizioni in cui la sicurezza è spesso trascurata è il processo di compilazione.</span><span class="sxs-lookup"><span data-stu-id="4c68e-167">One place where security is often overlooked is around the build process.</span></span> <span data-ttu-id="4c68e-168">Non solo i controlli di sicurezza dell'esecuzione della compilazione, ad esempio l'analisi di codice non sicuro o credenziali archiviate, ma la compilazione stessa dovrebbe essere sicura.</span><span class="sxs-lookup"><span data-stu-id="4c68e-168">Not only should the build run security checks, such as scanning for insecure code or checked-in credentials, but the build itself should be secure.</span></span> <span data-ttu-id="4c68e-169">Se il server di compilazione è compromesso, fornisce un vettore fantastico per l'introduzione di codice arbitrario nel prodotto.</span><span class="sxs-lookup"><span data-stu-id="4c68e-169">If the build server is compromised, then it provides a fantastic vector for introducing arbitrary code into the product.</span></span>

<span data-ttu-id="4c68e-170">Si supponga che un utente malintenzionato stia cercando di rubare le password degli utenti che accedono a un'applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="4c68e-170">Imagine that an attacker is looking to steal the passwords of people signing into a web application.</span></span> <span data-ttu-id="4c68e-171">Potrebbero introdurre un'istruzione di compilazione che modifichi il codice estratto per eseguire il mirroring di qualsiasi richiesta di accesso a un altro server.</span><span class="sxs-lookup"><span data-stu-id="4c68e-171">They could introduce a build step that modifies the checked-out code to mirror any login request to another server.</span></span> <span data-ttu-id="4c68e-172">La volta successiva che il codice passa attraverso la compilazione, viene aggiornato in modo invisibile all'utente.</span><span class="sxs-lookup"><span data-stu-id="4c68e-172">The next time code goes through the build, it's silently updated.</span></span> <span data-ttu-id="4c68e-173">L'analisi delle vulnerabilità del codice sorgente non rileva questa condizione mentre viene eseguita prima della compilazione.</span><span class="sxs-lookup"><span data-stu-id="4c68e-173">The source code vulnerability scanning won't catch this as it runs before the build.</span></span> <span data-ttu-id="4c68e-174">Allo stesso modo, nessuno lo rileverà in una revisione del codice perché le fasi di compilazione si trovano nel server di compilazione.</span><span class="sxs-lookup"><span data-stu-id="4c68e-174">Equally, nobody will catch it in a code review because the build steps live on the build server.</span></span> <span data-ttu-id="4c68e-175">Il codice sfruttato passerà all'ambiente di produzione in cui è possibile raccogliere le password.</span><span class="sxs-lookup"><span data-stu-id="4c68e-175">The exploited code will go to production where it can harvest passwords.</span></span> <span data-ttu-id="4c68e-176">Probabilmente non è presente alcun log di controllo delle modifiche del processo di compilazione o almeno nessuno monitora il controllo.</span><span class="sxs-lookup"><span data-stu-id="4c68e-176">Probably there's no audit log of the build process changes, or at least nobody monitoring the audit.</span></span>

<span data-ttu-id="4c68e-177">Si tratta di un esempio perfetto di una destinazione di valore apparentemente bassa che può essere usata per suddividere nel sistema.</span><span class="sxs-lookup"><span data-stu-id="4c68e-177">This is a perfect example of a seemingly low value target that can be used to break into the system.</span></span> <span data-ttu-id="4c68e-178">Una volta che un utente malintenzionato ha violato il perimetro del sistema, può iniziare a lavorare per trovare modi per elevare le loro autorizzazioni al punto in cui possono causare danni reali ovunque si trovino.</span><span class="sxs-lookup"><span data-stu-id="4c68e-178">Once an attacker breaches the perimeter of the system, they can start working on finding ways to elevate their permissions to the point that they can cause real harm anywhere they like.</span></span>

## <a name="building-secure-code"></a><span data-ttu-id="4c68e-179">Creazione di codice sicuro</span><span class="sxs-lookup"><span data-stu-id="4c68e-179">Building secure code</span></span>

<span data-ttu-id="4c68e-180">.NET Framework è già un Framework abbastanza sicuro.</span><span class="sxs-lookup"><span data-stu-id="4c68e-180">.NET Framework is already a quite secure framework.</span></span> <span data-ttu-id="4c68e-181">Evita alcuni problemi del codice non gestito, ad esempio l'analisi delle estremità delle matrici.</span><span class="sxs-lookup"><span data-stu-id="4c68e-181">It avoids some of the pitfalls of unmanaged code, such as walking off the ends of arrays.</span></span> <span data-ttu-id="4c68e-182">Il lavoro viene svolto attivamente per correggere i problemi di sicurezza non appena vengono individuati.</span><span class="sxs-lookup"><span data-stu-id="4c68e-182">Work is actively done to fix security holes as they're discovered.</span></span> <span data-ttu-id="4c68e-183">Esiste anche un [programma di Bounty dei bug](https://www.microsoft.com/msrc/bounty) che consente ai ricercatori di individuare i problemi del Framework e di segnalarli anziché sfruttarli.</span><span class="sxs-lookup"><span data-stu-id="4c68e-183">There's even a [bug bounty program](https://www.microsoft.com/msrc/bounty) that pays researchers to find issues in the framework and report them instead of exploiting them.</span></span>

<span data-ttu-id="4c68e-184">Esistono diversi modi per rendere più sicuro il codice .NET.</span><span class="sxs-lookup"><span data-stu-id="4c68e-184">There are many ways to make .NET code more secure.</span></span> <span data-ttu-id="4c68e-185">Le linee guida seguenti, ad esempio le [linee guida per la codifica sicura per .NET](../../standard/security/secure-coding-guidelines.md) , sono un'operazione ragionevole da eseguire per garantire che il codice sia protetto da zero.</span><span class="sxs-lookup"><span data-stu-id="4c68e-185">Following guidelines such as the [Secure coding guidelines for .NET](../../standard/security/secure-coding-guidelines.md) article is a reasonable step to take to ensure that the code is secure from the ground up.</span></span> <span data-ttu-id="4c68e-186">[OWASP Top 10](https://owasp.org/www-project-top-ten/) è un'altra guida preziosa per la creazione di codice sicuro.</span><span class="sxs-lookup"><span data-stu-id="4c68e-186">The [OWASP top 10](https://owasp.org/www-project-top-ten/) is another invaluable guide to build secure code.</span></span>

<span data-ttu-id="4c68e-187">Il processo di compilazione è una posizione ideale per inserire gli strumenti di analisi per rilevare i problemi nel codice sorgente prima di crearli nell'ambiente di produzione.</span><span class="sxs-lookup"><span data-stu-id="4c68e-187">The build process is a good place to put scanning tools to detect problems in source code before they make it into production.</span></span> <span data-ttu-id="4c68e-188">La maggior parte di ogni progetto ha dipendenze da altri pacchetti.</span><span class="sxs-lookup"><span data-stu-id="4c68e-188">Most every project has dependencies on some other packages.</span></span> <span data-ttu-id="4c68e-189">Uno strumento che consente di analizzare i pacchetti obsoleti rileverà i problemi in una compilazione notturna.</span><span class="sxs-lookup"><span data-stu-id="4c68e-189">A tool that can scan for outdated packages will catch problems in a nightly build.</span></span> <span data-ttu-id="4c68e-190">Anche quando si compilano immagini Docker, è utile controllare e verificare che l'immagine di base non abbia vulnerabilità note.</span><span class="sxs-lookup"><span data-stu-id="4c68e-190">Even when building Docker images, it's useful to check and make sure that the base image doesn't have known vulnerabilities.</span></span> <span data-ttu-id="4c68e-191">Un altro aspetto da controllare è che nessuno ha accidentalmente archiviato le credenziali.</span><span class="sxs-lookup"><span data-stu-id="4c68e-191">Another thing to check is that nobody has accidentally checked in credentials.</span></span>

## <a name="built-in-security"></a><span data-ttu-id="4c68e-192">Sicurezza integrata</span><span class="sxs-lookup"><span data-stu-id="4c68e-192">Built-in security</span></span>

<span data-ttu-id="4c68e-193">Azure è progettato per bilanciare l'usabilità e la sicurezza per la maggior parte degli utenti.</span><span class="sxs-lookup"><span data-stu-id="4c68e-193">Azure is designed to balance usability and security for the majority of users.</span></span> <span data-ttu-id="4c68e-194">Utenti diversi avranno requisiti di sicurezza diversi, quindi dovranno ottimizzare il proprio approccio alla sicurezza del cloud.</span><span class="sxs-lookup"><span data-stu-id="4c68e-194">Different users are going to have different security requirements, so they need to fine-tune their approach to cloud security.</span></span> <span data-ttu-id="4c68e-195">Microsoft pubblica una grande quantità di informazioni di sicurezza nel [centro](https://azure.microsoft.com/support/trust-center/)protezione.</span><span class="sxs-lookup"><span data-stu-id="4c68e-195">Microsoft publishes a great deal of security information in the [Trust Center](https://azure.microsoft.com/support/trust-center/).</span></span> <span data-ttu-id="4c68e-196">Questa risorsa dovrebbe essere la prima tappa per i professionisti interessati a comprendere il funzionamento delle tecnologie di mitigazione degli attacchi incorporate.</span><span class="sxs-lookup"><span data-stu-id="4c68e-196">This resource should be the first stop for those professionals interested in understanding how the built-in attack mitigation technologies work.</span></span>

<span data-ttu-id="4c68e-197">All'interno del portale di Azure, il [Azure Advisor](https://azure.microsoft.com/services/advisor/) è un sistema che esegue costantemente la scansione di un ambiente e le raccomandazioni.</span><span class="sxs-lookup"><span data-stu-id="4c68e-197">Within the Azure portal, the [Azure Advisor](https://azure.microsoft.com/services/advisor/) is a system that is constantly scanning an environment and making recommendations.</span></span> <span data-ttu-id="4c68e-198">Alcuni di questi consigli sono progettati per risparmiare denaro agli utenti, mentre altri sono progettati per identificare configurazioni potenzialmente non sicure, ad esempio un contenitore di archiviazione aperto al mondo e non protetto da una rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="4c68e-198">Some of these recommendations are designed to save users money, but others are designed to identify potentially insecure configurations, such as having a storage container open to the world and not protected by a Virtual Network.</span></span>

## <a name="azure-network-infrastructure"></a><span data-ttu-id="4c68e-199">Infrastruttura di rete di Azure</span><span class="sxs-lookup"><span data-stu-id="4c68e-199">Azure network infrastructure</span></span>

<span data-ttu-id="4c68e-200">In un ambiente di distribuzione locale, una grande quantità di energia è dedicata alla configurazione della rete.</span><span class="sxs-lookup"><span data-stu-id="4c68e-200">In an on-premises deployment environment, a great deal of energy is dedicated to setting up networking.</span></span> <span data-ttu-id="4c68e-201">La configurazione di router, commutatori e di questo tipo è un lavoro complesso.</span><span class="sxs-lookup"><span data-stu-id="4c68e-201">Setting up routers, switches, and the such is complicated work.</span></span> <span data-ttu-id="4c68e-202">Le reti consentono a determinate risorse di comunicare con altre risorse e di impedire l'accesso in alcuni casi.</span><span class="sxs-lookup"><span data-stu-id="4c68e-202">Networks allow certain resources to talk to other resources and prevent access in some cases.</span></span> <span data-ttu-id="4c68e-203">Una regola di rete frequente consiste nel limitare l'accesso all'ambiente di produzione dall'ambiente di sviluppo, in caso di mancata esecuzione di un frammento di codice parzialmente sviluppato che elimina una fascia di dati.</span><span class="sxs-lookup"><span data-stu-id="4c68e-203">A frequent network rule is to restrict access to the production environment from the development environment on the off chance that a half-developed piece of code runs awry and deletes a swath of data.</span></span>

<span data-ttu-id="4c68e-204">Per impostazione predefinita, la maggior parte delle risorse di Azure PaaS ha solo la configurazione di rete più semplice e permissiva.</span><span class="sxs-lookup"><span data-stu-id="4c68e-204">Out of the box, most PaaS Azure resources have only the most basic and permissive networking setup.</span></span> <span data-ttu-id="4c68e-205">Ad esempio, chiunque su Internet può accedere a un servizio app.</span><span class="sxs-lookup"><span data-stu-id="4c68e-205">For instance, anybody on the Internet can access an app service.</span></span> <span data-ttu-id="4c68e-206">Le nuove istanze di SQL Server vengono in genere limitate, in modo che le parti esterne non possano accedervi, ma gli intervalli di indirizzi IP usati da Azure sono consentiti tramite.</span><span class="sxs-lookup"><span data-stu-id="4c68e-206">New SQL Server instances typically come restricted, so that external parties can't access them, but the IP address ranges used by Azure itself are permitted through.</span></span> <span data-ttu-id="4c68e-207">Quindi, sebbene SQL Server sia protetto da minacce esterne, un utente malintenzionato deve solo configurare una testa di ponte di Azure da cui possano avviare attacchi contro tutte le istanze di SQL in Azure.</span><span class="sxs-lookup"><span data-stu-id="4c68e-207">So, while the SQL server is protected from external threats, an attacker only needs to set up an Azure bridgehead from where they can launch attacks against all SQL instances on Azure.</span></span>

<span data-ttu-id="4c68e-208">Fortunatamente, la maggior parte delle risorse di Azure può essere posizionata in una rete virtuale di Azure che consente il controllo degli accessi con granularità fine.</span><span class="sxs-lookup"><span data-stu-id="4c68e-208">Fortunately, most Azure resources can be placed into an Azure Virtual Network that allows finer grained access control.</span></span> <span data-ttu-id="4c68e-209">Analogamente al modo in cui le reti locali stabiliscono reti private protette dal mondo più ampio, le reti virtuali sono isole di indirizzi IP privati che si trovano all'interno della rete di Azure.</span><span class="sxs-lookup"><span data-stu-id="4c68e-209">Similar to the way that on-premises networks establish private networks that are protected from the wider world, virtual networks are islands of private IP addresses that are located within the Azure network.</span></span>

![Figura 9-1 una rete virtuale in Azure](./media/virtual-network.png)

<span data-ttu-id="4c68e-211">**Figura 9-1**.</span><span class="sxs-lookup"><span data-stu-id="4c68e-211">**Figure 9-1**.</span></span> <span data-ttu-id="4c68e-212">Una rete virtuale in Azure.</span><span class="sxs-lookup"><span data-stu-id="4c68e-212">A virtual network in Azure.</span></span>

<span data-ttu-id="4c68e-213">Nello stesso modo in cui le reti locali hanno un firewall che controlla l'accesso alla rete, è possibile stabilire un firewall simile al limite della rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="4c68e-213">In the same way that on-premises networks have a firewall governing access to the network, you can establish a similar firewall at the boundary of the virtual network.</span></span> <span data-ttu-id="4c68e-214">Per impostazione predefinita, tutte le risorse in una rete virtuale possono comunque comunicare con Internet.</span><span class="sxs-lookup"><span data-stu-id="4c68e-214">By default, all the resources on a virtual network can still talk to the Internet.</span></span> <span data-ttu-id="4c68e-215">Sono solo le connessioni in ingresso che richiedono una qualche forma di eccezione esplicita del firewall.</span><span class="sxs-lookup"><span data-stu-id="4c68e-215">It's only incoming connections that require some form of explicit firewall exception.</span></span>

<span data-ttu-id="4c68e-216">Con la rete stabilita, è possibile configurare risorse interne come gli account di archiviazione in modo da consentire l'accesso solo a risorse che si trovano anche nella rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="4c68e-216">With the network established, internal resources like storage accounts can be set up to only allow for access by resources that are also on the Virtual Network.</span></span> <span data-ttu-id="4c68e-217">Questo firewall fornisce un livello aggiuntivo di sicurezza, in caso di perdita delle chiavi per l'account di archiviazione, gli utenti malintenzionati non sarebbero in grado di connettersi a tale account per sfruttare le chiavi perse.</span><span class="sxs-lookup"><span data-stu-id="4c68e-217">This firewall provides an extra level of security, should the keys for that storage account be leaked, attackers wouldn't be able to connect to it to exploit the leaked keys.</span></span> <span data-ttu-id="4c68e-218">Si tratta di un altro esempio del principio del privilegio minimo.</span><span class="sxs-lookup"><span data-stu-id="4c68e-218">This is another example of the principle of least privilege.</span></span>

<span data-ttu-id="4c68e-219">I nodi in un cluster Azure Kubernetes possono partecipare a una rete virtuale come ad altre risorse più native di Azure.</span><span class="sxs-lookup"><span data-stu-id="4c68e-219">The nodes in an Azure Kubernetes cluster can participate in a virtual network just like other resources that are more native to Azure.</span></span> <span data-ttu-id="4c68e-220">Questa funzionalità è denominata [interfaccia di rete del contenitore di Azure](https://github.com/Azure/azure-container-networking/blob/master/docs/cni.md).</span><span class="sxs-lookup"><span data-stu-id="4c68e-220">This functionality is called [Azure Container Networking Interface](https://github.com/Azure/azure-container-networking/blob/master/docs/cni.md).</span></span> <span data-ttu-id="4c68e-221">In effetti, alloca una subnet all'interno della rete virtuale in cui sono allocate le macchine virtuali e le immagini del contenitore.</span><span class="sxs-lookup"><span data-stu-id="4c68e-221">In effect, it allocates a subnet within the virtual network on which virtual machines and container images are allocated.</span></span>

<span data-ttu-id="4c68e-222">Continuando il percorso di illustrare il principio dei privilegi minimi, non tutte le risorse all'interno di una rete virtuale devono comunicare con tutte le altre risorse.</span><span class="sxs-lookup"><span data-stu-id="4c68e-222">Continuing down the path of illustrating the principle of least privilege, not every resource within a Virtual Network needs to talk to every other resource.</span></span> <span data-ttu-id="4c68e-223">Ad esempio, in un'applicazione che fornisce un'API Web su un account di archiviazione e un database SQL, è improbabile che il database e l'account di archiviazione debbano comunicare tra loro.</span><span class="sxs-lookup"><span data-stu-id="4c68e-223">For instance, in an application that provides a web API over a storage account and a SQL database, it's unlikely that the database and the storage account need to talk to one another.</span></span> <span data-ttu-id="4c68e-224">La condivisione dei dati tra di essi passa attraverso l'applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="4c68e-224">Any data sharing between them would go through the web application.</span></span> <span data-ttu-id="4c68e-225">Quindi, è possibile usare un [gruppo di sicurezza di rete (NSG)](https://docs.microsoft.com/azure/virtual-network/security-overview) per negare il traffico tra i due servizi.</span><span class="sxs-lookup"><span data-stu-id="4c68e-225">So, a [network security group (NSG)](https://docs.microsoft.com/azure/virtual-network/security-overview) could be used to deny traffic between the two services.</span></span>

<span data-ttu-id="4c68e-226">Un criterio per negare la comunicazione tra le risorse può essere fastidioso da implementare, soprattutto in base all'uso di Azure senza restrizioni di traffico.</span><span class="sxs-lookup"><span data-stu-id="4c68e-226">A policy of denying communication between resources can be annoying to implement, especially coming from a background of using Azure without traffic restrictions.</span></span> <span data-ttu-id="4c68e-227">In alcuni altri cloud il concetto di gruppi di sicurezza di rete è molto più prevalente.</span><span class="sxs-lookup"><span data-stu-id="4c68e-227">On some other clouds, the concept of network security groups is much more prevalent.</span></span> <span data-ttu-id="4c68e-228">Ad esempio, il criterio predefinito in AWS è che le risorse non possono comunicare tra loro fino a quando non sono abilitate da regole in un NSG.</span><span class="sxs-lookup"><span data-stu-id="4c68e-228">For instance, the default policy on AWS is that resources can't communicate among themselves until enabled by rules in an NSG.</span></span> <span data-ttu-id="4c68e-229">Sebbene sia più lento sviluppare questo, un ambiente più restrittivo fornisce un valore predefinito più sicuro.</span><span class="sxs-lookup"><span data-stu-id="4c68e-229">While slower to develop this, more restrictive environment provides a more secure default.</span></span> <span data-ttu-id="4c68e-230">L'uso di procedure DevOps appropriate, in particolare l'uso di [Azure Resource Manager o di bonifica](infrastructure-as-code.md) per gestire le autorizzazioni può rendere più semplice il controllo delle regole.</span><span class="sxs-lookup"><span data-stu-id="4c68e-230">Making use of proper DevOps practices, especially using [Azure Resource Manager or Terraform](infrastructure-as-code.md) to manage permissions can make controlling the rules easier.</span></span>

<span data-ttu-id="4c68e-231">Le reti virtuali possono essere utili anche quando si configura la comunicazione tra le risorse locali e quelle cloud.</span><span class="sxs-lookup"><span data-stu-id="4c68e-231">Virtual Networks can also be useful when setting up communication between on-premises and cloud resources.</span></span> <span data-ttu-id="4c68e-232">Una rete privata virtuale può essere usata per connettere facilmente le due reti.</span><span class="sxs-lookup"><span data-stu-id="4c68e-232">A virtual private network can be used to seamlessly attach the two networks together.</span></span> <span data-ttu-id="4c68e-233">In questo modo è possibile eseguire una rete virtuale senza gateway per gli scenari in cui tutti gli utenti sono in sede.</span><span class="sxs-lookup"><span data-stu-id="4c68e-233">This allows running a virtual network without any sort of gateway for scenarios where all the users are on-site.</span></span> <span data-ttu-id="4c68e-234">Per stabilire questa rete è possibile utilizzare diverse tecnologie.</span><span class="sxs-lookup"><span data-stu-id="4c68e-234">There are a number of technologies that can be used to establish this network.</span></span> <span data-ttu-id="4c68e-235">Il più semplice consiste nell'usare una [VPN da sito a sito](https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-about-vpngateways?toc=%2fazure%2fvirtual-network%2ftoc.json#s2smulti) che può essere stabilita tra molti router e Azure.</span><span class="sxs-lookup"><span data-stu-id="4c68e-235">The simplest is to use a [site-to-site VPN](https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-about-vpngateways?toc=%2fazure%2fvirtual-network%2ftoc.json#s2smulti) that can be established between many routers and Azure.</span></span> <span data-ttu-id="4c68e-236">Il traffico viene crittografato ed effettuato tramite tunneling su Internet con lo stesso costo per byte di qualsiasi altro traffico.</span><span class="sxs-lookup"><span data-stu-id="4c68e-236">Traffic is encrypted and tunneled over the Internet at the same cost per byte as any other traffic.</span></span> <span data-ttu-id="4c68e-237">Per gli scenari in cui è auspicabile una maggiore larghezza di banda o maggiore sicurezza, Azure offre un servizio denominato [Express Route](https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-about-vpngateways?toc=%2fazure%2fvirtual-network%2ftoc.json#ExpressRoute) che usa un circuito privato tra una rete locale e Azure.</span><span class="sxs-lookup"><span data-stu-id="4c68e-237">For scenarios where more bandwidth or more security is desirable, Azure offers a service called [Express Route](https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-about-vpngateways?toc=%2fazure%2fvirtual-network%2ftoc.json#ExpressRoute) that uses a private circuit between an on-premises network and Azure.</span></span> <span data-ttu-id="4c68e-238">È più costoso e difficile da stabilire ma anche più sicuro.</span><span class="sxs-lookup"><span data-stu-id="4c68e-238">It's more costly and difficult to establish but also more secure.</span></span>

## <a name="role-based-access-control-for-restricting-access-to-azure-resources"></a><span data-ttu-id="4c68e-239">Controllo degli accessi in base al ruolo per limitare l'accesso alle risorse di Azure</span><span class="sxs-lookup"><span data-stu-id="4c68e-239">Role-based access control for restricting access to Azure resources</span></span>

<span data-ttu-id="4c68e-240">RBAC è un sistema che fornisce un'identità alle applicazioni in esecuzione in Azure.</span><span class="sxs-lookup"><span data-stu-id="4c68e-240">RBAC is a system that provides an identity to applications running in Azure.</span></span> <span data-ttu-id="4c68e-241">Le applicazioni possono accedere alle risorse utilizzando questa identità anziché o in aggiunta all'utilizzo di chiavi o password.</span><span class="sxs-lookup"><span data-stu-id="4c68e-241">Applications can access resources using this identity instead of or in addition to using keys or passwords.</span></span>

## <a name="security-principals"></a><span data-ttu-id="4c68e-242">Entità di sicurezza</span><span class="sxs-lookup"><span data-stu-id="4c68e-242">Security Principals</span></span>

<span data-ttu-id="4c68e-243">Il primo componente di RBAC è un'entità di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="4c68e-243">The first component in RBAC is a security principal.</span></span> <span data-ttu-id="4c68e-244">Un'entità di sicurezza può essere un utente, un gruppo, un'entità servizio o un'identità gestita.</span><span class="sxs-lookup"><span data-stu-id="4c68e-244">A security principal can be a user, group, service principal, or managed identity.</span></span>

![Figura 9-2 tipi diversi di entità di sicurezza](./media/rbac-security-principal.png)

<span data-ttu-id="4c68e-246">**Figura 9-2**.</span><span class="sxs-lookup"><span data-stu-id="4c68e-246">**Figure 9-2**.</span></span> <span data-ttu-id="4c68e-247">Tipi diversi di entità di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="4c68e-247">Different types of security principals.</span></span>

- <span data-ttu-id="4c68e-248">Utente: qualsiasi utente che dispone di un account in Azure Active Directory è un utente.</span><span class="sxs-lookup"><span data-stu-id="4c68e-248">User - Any user who has an account in Azure Active Directory is a user.</span></span>
- <span data-ttu-id="4c68e-249">Group: raccolta di utenti da Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="4c68e-249">Group - A collection of users from Azure Active Directory.</span></span> <span data-ttu-id="4c68e-250">Come membro di un gruppo, un utente assume i ruoli del gruppo in aggiunta ai rispettivi.</span><span class="sxs-lookup"><span data-stu-id="4c68e-250">As a member of a group, a user takes on the roles of that group in addition to their own.</span></span>
- <span data-ttu-id="4c68e-251">Entità servizio: identità di sicurezza in cui vengono eseguiti i servizi o le applicazioni.</span><span class="sxs-lookup"><span data-stu-id="4c68e-251">Service principal - A security identity under which services or applications run.</span></span>
- <span data-ttu-id="4c68e-252">Identità gestita: identità Azure Active Directory gestita da Azure.</span><span class="sxs-lookup"><span data-stu-id="4c68e-252">Managed identity - An Azure Active Directory identity managed by Azure.</span></span> <span data-ttu-id="4c68e-253">Le identità gestite vengono in genere usate quando si sviluppano applicazioni cloud che gestiscono le credenziali per l'autenticazione ai servizi di Azure.</span><span class="sxs-lookup"><span data-stu-id="4c68e-253">Managed identities are typically used when developing cloud applications that manage the credentials for authenticating to Azure services.</span></span>

<span data-ttu-id="4c68e-254">L'entità di sicurezza può essere applicata alla maggior parte delle risorse.</span><span class="sxs-lookup"><span data-stu-id="4c68e-254">The security principal can be applied to most any resource.</span></span> <span data-ttu-id="4c68e-255">Ciò significa che è possibile assegnare un'entità di sicurezza a un contenitore in esecuzione in Azure Kubernetes, consentendo l'accesso ai segreti archiviati in Key Vault.</span><span class="sxs-lookup"><span data-stu-id="4c68e-255">This means that it's possible to assign a security principal to a container running within Azure Kubernetes, allowing it to access secrets stored in Key Vault.</span></span> <span data-ttu-id="4c68e-256">Una funzione di Azure può assumere un'autorizzazione che consente di comunicare con un'istanza di Active Directory per convalidare un JWT per un utente chiamante.</span><span class="sxs-lookup"><span data-stu-id="4c68e-256">An Azure Function could take on a permission allowing it to talk to an Active Directory instance to validate a JWT for a calling user.</span></span> <span data-ttu-id="4c68e-257">Una volta abilitati i servizi con un'entità servizio, le autorizzazioni possono essere gestite in modo granulare tramite ruoli e ambiti.</span><span class="sxs-lookup"><span data-stu-id="4c68e-257">Once services are enabled with a service principal, their permissions can be managed granularly using roles and scopes.</span></span>

## <a name="roles"></a><span data-ttu-id="4c68e-258">Ruoli</span><span class="sxs-lookup"><span data-stu-id="4c68e-258">Roles</span></span>

<span data-ttu-id="4c68e-259">Un'entità di sicurezza può assumere molti ruoli o, usando un'analogia sartoriale, ha molti cappelli.</span><span class="sxs-lookup"><span data-stu-id="4c68e-259">A security principal can take on many roles or, using a more sartorial analogy, wear many hats.</span></span> <span data-ttu-id="4c68e-260">Ogni ruolo definisce una serie di autorizzazioni, ad esempio "leggere i messaggi dall'endpoint del bus di servizio di Azure".</span><span class="sxs-lookup"><span data-stu-id="4c68e-260">Each role defines a series of permissions such as "Read messages from Azure Service Bus endpoint".</span></span> <span data-ttu-id="4c68e-261">Il set di autorizzazioni valide di un'entità di sicurezza è la combinazione di tutte le autorizzazioni assegnate a tutti i ruoli dell'entità di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="4c68e-261">The effective permission set of a security principal is the combination of all the permissions assigned to all the roles that security principal has.</span></span> <span data-ttu-id="4c68e-262">Azure dispone di un numero elevato di ruoli predefiniti e gli utenti possono definire i propri ruoli.</span><span class="sxs-lookup"><span data-stu-id="4c68e-262">Azure has a large number of built-in roles and users can define their own roles.</span></span>

![Figura 9-3 definizioni di ruolo RBAC](./media/rbac-role-definition.png)

<span data-ttu-id="4c68e-264">**Figura 9-3**.</span><span class="sxs-lookup"><span data-stu-id="4c68e-264">**Figure 9-3**.</span></span> <span data-ttu-id="4c68e-265">Definizioni di ruolo RBAC.</span><span class="sxs-lookup"><span data-stu-id="4c68e-265">RBAC role definitions.</span></span>

<span data-ttu-id="4c68e-266">Incorporati in Azure sono anche un numero di ruoli di alto livello, ad esempio proprietario, collaboratore, lettore e amministratore account utente.</span><span class="sxs-lookup"><span data-stu-id="4c68e-266">Built into Azure are also a number of high-level roles such as Owner, Contributor, Reader, and User Account Administrator.</span></span> <span data-ttu-id="4c68e-267">Con il ruolo proprietario, un'entità di sicurezza può accedere a tutte le risorse e assegnare le autorizzazioni ad altri utenti.</span><span class="sxs-lookup"><span data-stu-id="4c68e-267">With the Owner role, a security principal can access all resources and assign permissions to others.</span></span> <span data-ttu-id="4c68e-268">Un collaboratore ha lo stesso livello di accesso a tutte le risorse, ma non può assegnare autorizzazioni.</span><span class="sxs-lookup"><span data-stu-id="4c68e-268">A contributor has the same level of access to all resources but they can't assign permissions.</span></span> <span data-ttu-id="4c68e-269">Un lettore può solo visualizzare le risorse di Azure esistenti e un amministratore dell'account utente può gestire l'accesso alle risorse di Azure.</span><span class="sxs-lookup"><span data-stu-id="4c68e-269">A Reader can only view existing Azure resources and a User Account Administrator can manage access to Azure resources.</span></span>

<span data-ttu-id="4c68e-270">I ruoli predefiniti più granulari, come il [collaboratore zona DNS](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles#dns-zone-contributor) , hanno diritti limitati a un singolo servizio.</span><span class="sxs-lookup"><span data-stu-id="4c68e-270">More granular built-in roles such as [DNS Zone Contributor](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles#dns-zone-contributor) have rights limited to a single service.</span></span> <span data-ttu-id="4c68e-271">Le entità di sicurezza possono assumere un numero qualsiasi di ruoli.</span><span class="sxs-lookup"><span data-stu-id="4c68e-271">Security principals can take on any number of roles.</span></span>

## <a name="scopes"></a><span data-ttu-id="4c68e-272">Ambiti</span><span class="sxs-lookup"><span data-stu-id="4c68e-272">Scopes</span></span>

<span data-ttu-id="4c68e-273">I ruoli possono essere applicati a un set limitato di risorse in Azure.</span><span class="sxs-lookup"><span data-stu-id="4c68e-273">Roles can be applied to a restricted set of resources within Azure.</span></span> <span data-ttu-id="4c68e-274">Ad esempio, applicando l'ambito all'esempio precedente di lettura da una coda del bus di servizio, è possibile limitare l'autorizzazione a una singola coda: "leggere i messaggi dall'endpoint del bus di servizio di Azure `blah.servicebus.windows.net/queue1` "</span><span class="sxs-lookup"><span data-stu-id="4c68e-274">For instance, applying scope to the previous example of reading from a Service Bus queue, you can narrow the permission to a single queue: "Read messages from Azure Service Bus endpoint `blah.servicebus.windows.net/queue1`"</span></span>

<span data-ttu-id="4c68e-275">L'ambito può essere limitato come una singola risorsa oppure può essere applicato a un intero gruppo di risorse, una sottoscrizione o un gruppo di gestione.</span><span class="sxs-lookup"><span data-stu-id="4c68e-275">The scope can be as narrow as a single resource or it can be applied to an entire resource group, subscription, or even management group.</span></span>

<span data-ttu-id="4c68e-276">Quando si esegue il test se un'entità di sicurezza dispone di un'autorizzazione specifica, viene presa in considerazione la combinazione di ruolo e ambito.</span><span class="sxs-lookup"><span data-stu-id="4c68e-276">When testing if a security principal has a certain permission, the combination of role and scope are taken into account.</span></span> <span data-ttu-id="4c68e-277">Questa combinazione fornisce un potente meccanismo di autorizzazione.</span><span class="sxs-lookup"><span data-stu-id="4c68e-277">This combination provides a powerful authorization mechanism.</span></span>

## <a name="deny"></a><span data-ttu-id="4c68e-278">Nega</span><span class="sxs-lookup"><span data-stu-id="4c68e-278">Deny</span></span>

<span data-ttu-id="4c68e-279">In precedenza erano consentite solo le regole "Allow" per RBAC.</span><span class="sxs-lookup"><span data-stu-id="4c68e-279">Previously, only "allow" rules were permitted for RBAC.</span></span> <span data-ttu-id="4c68e-280">Questo comportamento rendeva complicate le compilazioni degli ambiti.</span><span class="sxs-lookup"><span data-stu-id="4c68e-280">This behavior made some scopes complicated to build.</span></span> <span data-ttu-id="4c68e-281">Ad esempio, per consentire a un'entità di sicurezza di accedere a tutti gli account di archiviazione, ad eccezione di uno, è necessario concedere l'autorizzazione esplicita a un elenco potenzialmente infinito di account di archiviazione</span><span class="sxs-lookup"><span data-stu-id="4c68e-281">For instance, allowing a security principal access to all storage accounts except one required granting explicit permission to a potentially endless list of storage accounts.</span></span> <span data-ttu-id="4c68e-282">Ogni volta che viene creato un nuovo account di archiviazione, è necessario aggiungerlo a questo elenco di account.</span><span class="sxs-lookup"><span data-stu-id="4c68e-282">Every time a new storage account was created, it would have to be added to this list of accounts.</span></span> <span data-ttu-id="4c68e-283">Questo ulteriore sovraccarico di gestione che certamente non era auspicabile.</span><span class="sxs-lookup"><span data-stu-id="4c68e-283">This added management overhead that certainly wasn't desirable.</span></span>

<span data-ttu-id="4c68e-284">Le regole Deny hanno la precedenza sulle regole Allow.</span><span class="sxs-lookup"><span data-stu-id="4c68e-284">Deny rules take precedence over allow rules.</span></span> <span data-ttu-id="4c68e-285">Ora rappresenta lo stesso ambito "Consenti tutto tranne uno" può essere rappresentato come due regole "Consenti tutto" e "nega questo uno specifico".</span><span class="sxs-lookup"><span data-stu-id="4c68e-285">Now representing the same "allow all but one" scope could be represented as two rules "allow all" and "deny this one specific one".</span></span> <span data-ttu-id="4c68e-286">Negare le regole non solo semplifica la gestione, ma consente le risorse più sicure negando l'accesso a tutti gli utenti.</span><span class="sxs-lookup"><span data-stu-id="4c68e-286">Deny rules not only ease management but allow for resources that are extra secure by denying access to everybody.</span></span>

## <a name="checking-access"></a><span data-ttu-id="4c68e-287">Verifica dell'accesso</span><span class="sxs-lookup"><span data-stu-id="4c68e-287">Checking access</span></span>

<span data-ttu-id="4c68e-288">Come si può immaginare, avere un numero elevato di ruoli e ambiti può rendere piuttosto difficile l'autorizzazione efficace di un'entità servizio.</span><span class="sxs-lookup"><span data-stu-id="4c68e-288">As you can imagine, having a large number of roles and scopes can make figuring out the effective permission of a service principal quite difficult.</span></span> <span data-ttu-id="4c68e-289">L'accumulo di regole di negazione, serve solo per aumentare la complessità.</span><span class="sxs-lookup"><span data-stu-id="4c68e-289">Piling deny rules on top of that, only serves to increase the complexity.</span></span> <span data-ttu-id="4c68e-290">Fortunatamente, è disponibile un calcolatore delle autorizzazioni che consente di visualizzare le autorizzazioni valide per qualsiasi entità servizio.</span><span class="sxs-lookup"><span data-stu-id="4c68e-290">Fortunately, there's a permissions calculator that can show the effective permissions for any service principal.</span></span> <span data-ttu-id="4c68e-291">Si trova in genere nella scheda IAM del portale, come illustrato nella figura 10-3.</span><span class="sxs-lookup"><span data-stu-id="4c68e-291">It's typically found under the IAM tab in the portal, as shown in Figure 10-3.</span></span>

![Figura 9-4 calcolatore delle autorizzazioni per un servizio app](./media/check-rbac.png)

<span data-ttu-id="4c68e-293">**Figura 9-4**.</span><span class="sxs-lookup"><span data-stu-id="4c68e-293">**Figure 9-4**.</span></span> <span data-ttu-id="4c68e-294">Calcolatore delle autorizzazioni per un servizio app.</span><span class="sxs-lookup"><span data-stu-id="4c68e-294">Permission calculator for an app service.</span></span>

## <a name="securing-secrets"></a><span data-ttu-id="4c68e-295">Protezione dei segreti</span><span class="sxs-lookup"><span data-stu-id="4c68e-295">Securing secrets</span></span>

<span data-ttu-id="4c68e-296">Le password e i certificati rappresentano un vettore di attacco comune per gli utenti malintenzionati.</span><span class="sxs-lookup"><span data-stu-id="4c68e-296">Passwords and certificates are a common attack vector for attackers.</span></span> <span data-ttu-id="4c68e-297">L'hardware con cracking delle password può eseguire un attacco di forza bruta e provare a indovinare miliardi di password al secondo.</span><span class="sxs-lookup"><span data-stu-id="4c68e-297">Password-cracking hardware can do a  brute-force attack and try to guess billions of passwords per second.</span></span> <span data-ttu-id="4c68e-298">È quindi importante che le password usate per accedere alle risorse siano complesse, con una grande varietà di caratteri.</span><span class="sxs-lookup"><span data-stu-id="4c68e-298">So it's important that the passwords that are used to access resources are strong, with a large variety of characters.</span></span> <span data-ttu-id="4c68e-299">Queste password sono esattamente il tipo di password quasi impossibile da ricordare.</span><span class="sxs-lookup"><span data-stu-id="4c68e-299">These passwords are exactly the kind of passwords that are near impossible to remember.</span></span> <span data-ttu-id="4c68e-300">Fortunatamente, le password in Azure non devono essere effettivamente note a tutti gli utenti.</span><span class="sxs-lookup"><span data-stu-id="4c68e-300">Fortunately, the passwords in Azure don't actually need to be known by any human.</span></span>

<span data-ttu-id="4c68e-301">Molti esperti di sicurezza [suggeriscono](https://www.troyhunt.com/password-managers-dont-have-to-be-perfect-they-just-have-to-be-better-than-not-having-one/) che l'uso di un gestore di password per tenere le proprie password è l'approccio migliore.</span><span class="sxs-lookup"><span data-stu-id="4c68e-301">Many security [experts suggest](https://www.troyhunt.com/password-managers-dont-have-to-be-perfect-they-just-have-to-be-better-than-not-having-one/) that using a password manager to keep your own passwords is the best approach.</span></span> <span data-ttu-id="4c68e-302">Mentre centralizza le password in un'unica posizione, consente anche l'uso di password estremamente complesse e garantisce che siano univoche per ogni account.</span><span class="sxs-lookup"><span data-stu-id="4c68e-302">While it centralizes your passwords in one location, it also allows using highly complex passwords and ensuring they're unique for each account.</span></span> <span data-ttu-id="4c68e-303">Lo stesso sistema esiste in Azure: un archivio centrale per i segreti.</span><span class="sxs-lookup"><span data-stu-id="4c68e-303">The same system exists within Azure: a central store for secrets.</span></span>

## <a name="azure-key-vault"></a><span data-ttu-id="4c68e-304">Insieme di credenziali chiave di Azure</span><span class="sxs-lookup"><span data-stu-id="4c68e-304">Azure Key Vault</span></span>

<span data-ttu-id="4c68e-305">Azure Key Vault fornisce una posizione centralizzata per archiviare le password per elementi quali database, chiavi API e certificati.</span><span class="sxs-lookup"><span data-stu-id="4c68e-305">Azure Key Vault provides a centralized location to store passwords for things such as databases, API keys, and certificates.</span></span> <span data-ttu-id="4c68e-306">Una volta immesso un segreto nell'insieme di credenziali, non viene mai visualizzato di nuovo e i comandi da estrarre e visualizzare sono volutamente complicati.</span><span class="sxs-lookup"><span data-stu-id="4c68e-306">Once a secret is entered into the Vault, it's never shown again and the commands to extract and view it are purposefully complicated.</span></span> <span data-ttu-id="4c68e-307">Le informazioni in Safe sono protette tramite la crittografia software o i moduli di protezione hardware convalidati FIPS 140-2 Level 2.</span><span class="sxs-lookup"><span data-stu-id="4c68e-307">The information in the safe is protected using either software encryption or FIPS 140-2 Level 2 validated Hardware Security Modules.</span></span>

<span data-ttu-id="4c68e-308">L'accesso all'insieme di credenziali delle chiavi viene fornito tramite RBAC, vale a dire che non solo tutti gli utenti possono accedere alle informazioni nell'insieme di credenziali.</span><span class="sxs-lookup"><span data-stu-id="4c68e-308">Access to the key vault is provided through RBACs, meaning that not just any user can access the information in the vault.</span></span> <span data-ttu-id="4c68e-309">Si consideri un'applicazione Web che desidera accedere alla stringa di connessione del database archiviata in Azure Key Vault.</span><span class="sxs-lookup"><span data-stu-id="4c68e-309">Say a web application wishes to access the database connection string stored in Azure Key Vault.</span></span> <span data-ttu-id="4c68e-310">Per ottenere l'accesso, le applicazioni devono essere eseguite usando un'entità servizio.</span><span class="sxs-lookup"><span data-stu-id="4c68e-310">To gain access, applications need to run using a service principal.</span></span> <span data-ttu-id="4c68e-311">Con questo ruolo assunto possono leggere i segreti dalla sicurezza.</span><span class="sxs-lookup"><span data-stu-id="4c68e-311">Under this assumed role, they can read the secrets from the safe.</span></span> <span data-ttu-id="4c68e-312">Sono disponibili diverse impostazioni di sicurezza che possono limitare ulteriormente l'accesso di un'applicazione all'insieme di credenziali, in modo che non possa aggiornare i segreti, ma solo leggerli.</span><span class="sxs-lookup"><span data-stu-id="4c68e-312">There are a number of different security settings that can further limit the access that an application has to the vault, so that it can't update secrets but only read them.</span></span>

<span data-ttu-id="4c68e-313">È possibile monitorare l'accesso all'insieme di credenziali delle chiavi per assicurarsi che solo le applicazioni previste accedano all'insieme di credenziali.</span><span class="sxs-lookup"><span data-stu-id="4c68e-313">Access to the key vault can be monitored to ensure that only the expected applications are accessing the vault.</span></span> <span data-ttu-id="4c68e-314">I log possono essere integrati di nuovo in monitoraggio di Azure, sbloccando la possibilità di impostare avvisi quando vengono rilevate condizioni impreviste.</span><span class="sxs-lookup"><span data-stu-id="4c68e-314">The logs can be integrated back into Azure Monitor, unlocking the ability to set up alerts when unexpected conditions are encountered.</span></span>

## <a name="kubernetes"></a><span data-ttu-id="4c68e-315">Kubernetes</span><span class="sxs-lookup"><span data-stu-id="4c68e-315">Kubernetes</span></span>

<span data-ttu-id="4c68e-316">All'interno di Kubernetes è disponibile un servizio simile per la gestione di piccoli elementi di informazioni segrete.</span><span class="sxs-lookup"><span data-stu-id="4c68e-316">Within Kubernetes, there's a similar service for maintaining small pieces of secret information.</span></span> <span data-ttu-id="4c68e-317">I segreti Kubernetes possono essere impostati tramite il tipico `kubectl` eseguibile.</span><span class="sxs-lookup"><span data-stu-id="4c68e-317">Kubernetes Secrets can be set via the typical `kubectl` executable.</span></span>

<span data-ttu-id="4c68e-318">La creazione di un segreto è semplice come trovare la versione Base64 dei valori da archiviare:</span><span class="sxs-lookup"><span data-stu-id="4c68e-318">Creating a secret is as simple as finding the base64 version of the values to be stored:</span></span>

```console
echo -n 'admin' | base64
YWRtaW4=
echo -n '1f2d1e2e67df' | base64
MWYyZDFlMmU2N2Rm
```

<span data-ttu-id="4c68e-319">Quindi, aggiungerlo a un file Secrets denominato, `secret.yml` ad esempio, simile all'esempio seguente:</span><span class="sxs-lookup"><span data-stu-id="4c68e-319">Then adding it to a secrets file named `secret.yml` for example that looks similar to the following example:</span></span>

```yml
apiVersion: v1
kind: Secret
metadata:
  name: mysecret
type: Opaque
data:
  username: YWRtaW4=
  password: MWYyZDFlMmU2N2Rm
```

<span data-ttu-id="4c68e-320">Infine, è possibile caricare il file in Kubernetes eseguendo il comando seguente:</span><span class="sxs-lookup"><span data-stu-id="4c68e-320">Finally, this file can be loaded into Kubernetes by running the following command:</span></span>

```console
kubectl apply -f ./secret.yaml
```

<span data-ttu-id="4c68e-321">Questi segreti possono quindi essere montati in volumi o esposti ai processi dei contenitori tramite le variabili di ambiente.</span><span class="sxs-lookup"><span data-stu-id="4c68e-321">These secrets can then be mounted into volumes or exposed to container processes through environment variables.</span></span> <span data-ttu-id="4c68e-322">L'approccio dell' [app a dodici fattori](https://12factor.net/) per la creazione di applicazioni suggerisce l'uso del denominatore comune più basso per trasmettere le impostazioni a un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="4c68e-322">The [Twelve-factor app](https://12factor.net/) approach to building applications suggests using the lowest common denominator to transmit settings to an application.</span></span> <span data-ttu-id="4c68e-323">Le variabili di ambiente sono il denominatore comune più basso, perché sono supportate indipendentemente dal sistema operativo o dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="4c68e-323">Environment variables are the lowest common denominator, because they're supported no matter the operating system or application.</span></span>

<span data-ttu-id="4c68e-324">Un'alternativa all'uso dei segreti Kubernetes predefiniti è l'accesso ai segreti in Azure Key Vault dall'interno di Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="4c68e-324">An alternative to use the built-in Kubernetes secrets is to access the secrets in Azure Key Vault from within Kubernetes.</span></span> <span data-ttu-id="4c68e-325">Il modo più semplice per eseguire questa operazione consiste nell'assegnare un ruolo RBAC al contenitore che desidera caricare i segreti.</span><span class="sxs-lookup"><span data-stu-id="4c68e-325">The simplest way to do this is to assign an RBAC role to the container looking to load secrets.</span></span> <span data-ttu-id="4c68e-326">L'applicazione può quindi usare le API Azure Key Vault per accedere ai segreti.</span><span class="sxs-lookup"><span data-stu-id="4c68e-326">The application can then use the Azure Key Vault APIs to access the secrets.</span></span> <span data-ttu-id="4c68e-327">Tuttavia, questo approccio richiede modifiche al codice e non segue il modello di utilizzo delle variabili di ambiente.</span><span class="sxs-lookup"><span data-stu-id="4c68e-327">However, this approach requires modifications to the code and doesn't follow the pattern of using environment variables.</span></span> <span data-ttu-id="4c68e-328">In alternativa, è possibile inserire i valori in un contenitore tramite l'uso del [Azure Key Vault iniettore](https://mrdevops.io/introducing-azure-key-vault-to-kubernetes-931f82364354).</span><span class="sxs-lookup"><span data-stu-id="4c68e-328">Instead, it's possible to inject values into a container through the use of the [Azure Key Vault Injector](https://mrdevops.io/introducing-azure-key-vault-to-kubernetes-931f82364354).</span></span> <span data-ttu-id="4c68e-329">Questo approccio è in realtà più sicuro rispetto all'uso diretto dei segreti Kubernetes, in quanto è possibile accedervi dagli utenti del cluster.</span><span class="sxs-lookup"><span data-stu-id="4c68e-329">This approach is actually more secure than using the Kubernetes secrets directly, as they can be accessed by users on the cluster.</span></span>

## <a name="encryption-in-transit-and-at-rest"></a><span data-ttu-id="4c68e-330">Crittografia in transito e a riposo</span><span class="sxs-lookup"><span data-stu-id="4c68e-330">Encryption in transit and at rest</span></span>

<span data-ttu-id="4c68e-331">Mantenere la sicurezza dei dati è importante se si trova su disco o in transito tra diversi servizi.</span><span class="sxs-lookup"><span data-stu-id="4c68e-331">Keeping data safe is important whether it's on disk or transiting between various different services.</span></span> <span data-ttu-id="4c68e-332">Il modo più efficace per evitare la perdita di dati consiste nel crittografarlo in un formato che non può essere facilmente letto da altri utenti.</span><span class="sxs-lookup"><span data-stu-id="4c68e-332">The most effective way to keep data from leaking is to encrypt it into a format that can't be easily read by others.</span></span> <span data-ttu-id="4c68e-333">Azure supporta un'ampia gamma di opzioni di crittografia.</span><span class="sxs-lookup"><span data-stu-id="4c68e-333">Azure supports a wide range of encryption options.</span></span>

### <a name="in-transit"></a><span data-ttu-id="4c68e-334">In transito</span><span class="sxs-lookup"><span data-stu-id="4c68e-334">In transit</span></span>

<span data-ttu-id="4c68e-335">Esistono diversi modi per crittografare il traffico sulla rete in Azure.</span><span class="sxs-lookup"><span data-stu-id="4c68e-335">There are several ways to encrypt traffic on the network in Azure.</span></span> <span data-ttu-id="4c68e-336">L'accesso ai servizi di Azure viene in genere eseguito tramite connessioni che usano Transport Layer Security (TLS).</span><span class="sxs-lookup"><span data-stu-id="4c68e-336">The access to Azure services is typically done over connections that use Transport Layer Security (TLS).</span></span> <span data-ttu-id="4c68e-337">Ad esempio, tutte le connessioni alle API di Azure richiedono connessioni TLS.</span><span class="sxs-lookup"><span data-stu-id="4c68e-337">For instance, all the connections to the Azure APIs require TLS connections.</span></span> <span data-ttu-id="4c68e-338">Analogamente, le connessioni agli endpoint in archiviazione di Azure possono essere limitate a funzionare solo su connessioni crittografate TLS.</span><span class="sxs-lookup"><span data-stu-id="4c68e-338">Equally, connections to endpoints in Azure storage can be restricted to work only over TLS encrypted connections.</span></span>

<span data-ttu-id="4c68e-339">TLS è un protocollo complesso e sa semplicemente che la connessione sta usando TLS non è sufficiente per garantire la sicurezza.</span><span class="sxs-lookup"><span data-stu-id="4c68e-339">TLS is a complicated protocol and simply knowing that the connection is using TLS isn't sufficient to ensure security.</span></span> <span data-ttu-id="4c68e-340">Il protocollo TLS 1,0, ad esempio, non è protetto in modo cronico e TLS 1,1 non è molto migliore.</span><span class="sxs-lookup"><span data-stu-id="4c68e-340">For instance, TLS 1.0 is chronically insecure, and TLS 1.1 isn't much better.</span></span> <span data-ttu-id="4c68e-341">Anche nelle versioni di TLS sono disponibili diverse impostazioni che possono semplificare la decrittografia delle connessioni.</span><span class="sxs-lookup"><span data-stu-id="4c68e-341">Even within the versions of TLS, there are various settings that can make the connections easier to decrypt.</span></span> <span data-ttu-id="4c68e-342">Il modo migliore consiste nel controllare e verificare se la connessione al server utilizza protocolli aggiornati e ben configurati.</span><span class="sxs-lookup"><span data-stu-id="4c68e-342">The best course of action is to check and see if the server connection is using up-to-date and well configured protocols.</span></span>

<span data-ttu-id="4c68e-343">Questo controllo può essere eseguito da un servizio esterno, ad esempio il test SSL del server SSL Labs.</span><span class="sxs-lookup"><span data-stu-id="4c68e-343">This check can be done by an external service such as SSL labs' SSL Server Test.</span></span> <span data-ttu-id="4c68e-344">Un'esecuzione dei test su un tipico endpoint di Azure, in questo caso un endpoint del bus di servizio, produce un punteggio quasi perfetto di un oggetto.</span><span class="sxs-lookup"><span data-stu-id="4c68e-344">A test run against a typical Azure endpoint, in this case a service bus endpoint, yields a near perfect score of A.</span></span>

<span data-ttu-id="4c68e-345">Anche i servizi come i database SQL di Azure usano la crittografia TLS per nascondere i dati.</span><span class="sxs-lookup"><span data-stu-id="4c68e-345">Even services like Azure SQL databases use TLS encryption to keep data hidden.</span></span> <span data-ttu-id="4c68e-346">La parte interessante sulla crittografia dei dati in transito con TLS è che non è possibile, neanche per Microsoft, restare in ascolto sulla connessione tra computer che eseguono TLS.</span><span class="sxs-lookup"><span data-stu-id="4c68e-346">The interesting part about encrypting the data in transit using TLS is that it isn't possible, even for Microsoft, to listen in on the connection between computers running TLS.</span></span> <span data-ttu-id="4c68e-347">Questo dovrebbe garantire la comodità per le aziende in cui i dati possono essere a rischio da Microsoft o addirittura da un attore di stato con più risorse rispetto all'utente malintenzionato standard.</span><span class="sxs-lookup"><span data-stu-id="4c68e-347">This should provide comfort for companies concerned that their data may be at risk from Microsoft proper or even a state actor with more resources than the standard attacker.</span></span>

![Figura 9-5 report dei Lab SSL che mostra un punteggio di un per un endpoint del bus di servizio.](./media/ssl-report.png)

<span data-ttu-id="4c68e-349">**Figura 9-5**.</span><span class="sxs-lookup"><span data-stu-id="4c68e-349">**Figure 9-5**.</span></span> <span data-ttu-id="4c68e-350">Report di Labs SSL che mostra un punteggio di un per un endpoint del bus di servizio.</span><span class="sxs-lookup"><span data-stu-id="4c68e-350">SSL labs report showing a score of A for a Service Bus endpoint.</span></span>

<span data-ttu-id="4c68e-351">Sebbene questo livello di crittografia non sia sufficiente per tutti i tempi, dovrebbe ispirare la sicurezza che le connessioni TLS di Azure siano abbastanza sicure.</span><span class="sxs-lookup"><span data-stu-id="4c68e-351">While this level of encryption isn't going to be sufficient for all time, it should inspire confidence that Azure TLS connections are quite secure.</span></span> <span data-ttu-id="4c68e-352">Azure continuerà a evolvere gli standard di sicurezza Man mano che la crittografia migliora.</span><span class="sxs-lookup"><span data-stu-id="4c68e-352">Azure will continue to evolve its security standards as encryption improves.</span></span> <span data-ttu-id="4c68e-353">È interessante tenere presente che qualcuno sta osservando gli standard di sicurezza e aggiornando Azure Man mano che migliorano.</span><span class="sxs-lookup"><span data-stu-id="4c68e-353">It's nice to know that there's somebody watching the security standards and updating Azure as they improve.</span></span>

### <a name="at-rest"></a><span data-ttu-id="4c68e-354">Inattivi</span><span class="sxs-lookup"><span data-stu-id="4c68e-354">At rest</span></span>

<span data-ttu-id="4c68e-355">In qualsiasi applicazione sono presenti diverse posizioni in cui i dati restano su disco.</span><span class="sxs-lookup"><span data-stu-id="4c68e-355">In any application, there are a number of places where data rests on disk.</span></span> <span data-ttu-id="4c68e-356">Il codice dell'applicazione viene caricato da un meccanismo di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="4c68e-356">The application code itself is loaded from some storage mechanism.</span></span> <span data-ttu-id="4c68e-357">La maggior parte delle applicazioni usa anche un tipo di database, ad esempio SQL Server, Cosmos DB o persino l'archiviazione di tabelle sorprendentemente conveniente.</span><span class="sxs-lookup"><span data-stu-id="4c68e-357">Most applications also use some kind of database such as SQL Server, Cosmos DB, or even the amazingly price-efficient Table Storage.</span></span> <span data-ttu-id="4c68e-358">Tutti questi database utilizzano l'archiviazione con crittografia eccessiva per garantire che nessuno diverso dalle applicazioni con le autorizzazioni appropriate possa leggere i dati.</span><span class="sxs-lookup"><span data-stu-id="4c68e-358">These databases all use heavily encrypted storage to ensure that nobody other than the applications with proper permissions can read your data.</span></span> <span data-ttu-id="4c68e-359">Anche gli operatori di sistema non possono leggere i dati crittografati.</span><span class="sxs-lookup"><span data-stu-id="4c68e-359">Even the system operators can't read data that has been encrypted.</span></span> <span data-ttu-id="4c68e-360">Quindi, i clienti possono rimanere sicuri che le informazioni segrete rimangano segrete.</span><span class="sxs-lookup"><span data-stu-id="4c68e-360">So customers can remain confident their secret information remains secret.</span></span>

### <a name="storage"></a><span data-ttu-id="4c68e-361">Archiviazione</span><span class="sxs-lookup"><span data-stu-id="4c68e-361">Storage</span></span>

<span data-ttu-id="4c68e-362">Il supporto di gran parte di Azure è il motore di archiviazione di Azure.</span><span class="sxs-lookup"><span data-stu-id="4c68e-362">The underpinning of much of Azure is the Azure Storage engine.</span></span> <span data-ttu-id="4c68e-363">I dischi delle macchine virtuali sono montati in archiviazione di Azure.</span><span class="sxs-lookup"><span data-stu-id="4c68e-363">Virtual machine disks are mounted on top of Azure Storage.</span></span> <span data-ttu-id="4c68e-364">I servizi Kubernetes di Azure vengono eseguiti in macchine virtuali che sono ospitate in archiviazione di Azure.</span><span class="sxs-lookup"><span data-stu-id="4c68e-364">Azure Kubernetes Services run on virtual machines that, themselves, are hosted on Azure Storage.</span></span> <span data-ttu-id="4c68e-365">Anche le tecnologie senza server, ad esempio le app funzioni di Azure e le istanze di contenitore di Azure, esauriscono il disco che fa parte di archiviazione di Azure.</span><span class="sxs-lookup"><span data-stu-id="4c68e-365">Even serverless technologies, such as Azure Functions Apps and Azure Container Instances, run out of disk that is part of Azure Storage.</span></span>

<span data-ttu-id="4c68e-366">Se archiviazione di Azure è ben crittografato, fornisce una base per la maggior parte degli altri elementi da crittografare.</span><span class="sxs-lookup"><span data-stu-id="4c68e-366">If Azure Storage is well encrypted, then it provides for a foundation for most everything else to also be encrypted.</span></span> <span data-ttu-id="4c68e-367">Archiviazione di Azure [è crittografato](https://docs.microsoft.com/azure/storage/common/storage-service-encryption) con AES a [256 bit](https://en.wikipedia.org/wiki/Advanced_Encryption_Standard)conforme a [FIPS 140-2](https://en.wikipedia.org/wiki/FIPS_140) .</span><span class="sxs-lookup"><span data-stu-id="4c68e-367">Azure Storage [is encrypted](https://docs.microsoft.com/azure/storage/common/storage-service-encryption) with [FIPS 140-2](https://en.wikipedia.org/wiki/FIPS_140) compliant [256-bit AES](https://en.wikipedia.org/wiki/Advanced_Encryption_Standard).</span></span> <span data-ttu-id="4c68e-368">Si tratta di una tecnologia di crittografia ben considerata che è stata l'oggetto di un controllo accademico esteso negli ultimi 20 anni.</span><span class="sxs-lookup"><span data-stu-id="4c68e-368">This is a well-regarded encryption technology having been the subject of extensive academic scrutiny over the last 20 or so years.</span></span> <span data-ttu-id="4c68e-369">Al momento, non esiste un attacco pratico noto che consentirebbe a qualcuno senza conoscere la chiave per leggere i dati crittografati da AES.</span><span class="sxs-lookup"><span data-stu-id="4c68e-369">At present, there's no known practical attack that would allow someone without knowledge of the key to read data encrypted by AES.</span></span>

<span data-ttu-id="4c68e-370">Per impostazione predefinita, le chiavi usate per la crittografia dell'archiviazione di Azure sono gestite da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="4c68e-370">By default, the keys used for encrypting Azure Storage are managed by Microsoft.</span></span> <span data-ttu-id="4c68e-371">Sono disponibili protezioni estese per impedire l'accesso dannoso a queste chiavi.</span><span class="sxs-lookup"><span data-stu-id="4c68e-371">There are extensive protections in place to ensure to prevent malicious access to these keys.</span></span> <span data-ttu-id="4c68e-372">Tuttavia, gli utenti con requisiti di crittografia specifici possono anche [fornire le proprie chiavi di archiviazione](https://docs.microsoft.com/azure/storage/common/storage-encryption-keys-powershell) gestite in Azure Key Vault.</span><span class="sxs-lookup"><span data-stu-id="4c68e-372">However, users with particular encryption requirements can also [provide their own storage keys](https://docs.microsoft.com/azure/storage/common/storage-encryption-keys-powershell) that are managed in Azure Key Vault.</span></span> <span data-ttu-id="4c68e-373">Queste chiavi possono essere revocate in qualsiasi momento, in modo che il rendering del contenuto dell'account di archiviazione non sia accessibile.</span><span class="sxs-lookup"><span data-stu-id="4c68e-373">These keys can be revoked at any time, which would effectively render the contents of the Storage account using them inaccessible.</span></span>

<span data-ttu-id="4c68e-374">Le macchine virtuali usano l'archiviazione crittografata, ma è possibile fornire un altro livello di crittografia usando tecnologie come BitLocker in Windows o DM-Crypt in Linux.</span><span class="sxs-lookup"><span data-stu-id="4c68e-374">Virtual machines use encrypted storage, but it's possible to provide another layer of encryption by using technologies like BitLocker on Windows or DM-Crypt on Linux.</span></span> <span data-ttu-id="4c68e-375">Queste tecnologie significano che anche se l'immagine del disco è stata persa, rimarrebbe quasi impossibile leggerla.</span><span class="sxs-lookup"><span data-stu-id="4c68e-375">These technologies mean that even if the disk image was leaked off of storage, it would remain near impossible to read it.</span></span>

### <a name="azure-sql"></a><span data-ttu-id="4c68e-376">SQL di Azure</span><span class="sxs-lookup"><span data-stu-id="4c68e-376">Azure SQL</span></span>

<span data-ttu-id="4c68e-377">I database ospitati in SQL di Azure usano una tecnologia denominata Transparent Data Encryption (Transparent Data [Encryption)](/sql/relational-databases/security/encryption/transparent-data-encryption) per garantire la crittografia dei dati.</span><span class="sxs-lookup"><span data-stu-id="4c68e-377">Databases hosted on Azure SQL use a technology called [Transparent Data Encryption (TDE)](/sql/relational-databases/security/encryption/transparent-data-encryption) to ensure data remains encrypted.</span></span> <span data-ttu-id="4c68e-378">Questa funzionalità è abilitata per impostazione predefinita in tutti i nuovi database SQL creati, ma deve essere abilitata manualmente per i database legacy.</span><span class="sxs-lookup"><span data-stu-id="4c68e-378">It's enabled by default on all newly created SQL databases, but must be enabled manually for legacy databases.</span></span> <span data-ttu-id="4c68e-379">Transparent Data Encryption esegue la crittografia e la decrittografia in tempo reale di non solo del database, ma anche dei backup e dei log delle transazioni.</span><span class="sxs-lookup"><span data-stu-id="4c68e-379">TDE executes real-time encryption and decryption of not just the database, but also the backups and transaction logs.</span></span>

<span data-ttu-id="4c68e-380">I parametri di crittografia vengono archiviati nel `master` database e, all'avvio, vengono letti in memoria per le operazioni rimanenti.</span><span class="sxs-lookup"><span data-stu-id="4c68e-380">The encryption parameters are stored in the `master` database and, on startup, are read into memory for the remaining operations.</span></span> <span data-ttu-id="4c68e-381">Ciò significa che il `master` database deve rimanere non crittografato.</span><span class="sxs-lookup"><span data-stu-id="4c68e-381">This means that the `master` database must remain unencrypted.</span></span> <span data-ttu-id="4c68e-382">La chiave effettiva viene gestita da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="4c68e-382">The actual key is managed by Microsoft.</span></span> <span data-ttu-id="4c68e-383">Tuttavia, gli utenti con requisiti di sicurezza esatti possono fornire la propria chiave in Key Vault in modo analogo a quanto avviene per archiviazione di Azure.</span><span class="sxs-lookup"><span data-stu-id="4c68e-383">However, users with exacting security requirements may provide their own key in Key Vault in much the same way as is done for Azure Storage.</span></span> <span data-ttu-id="4c68e-384">Il Key Vault fornisce servizi come la rotazione e la revoca delle chiavi.</span><span class="sxs-lookup"><span data-stu-id="4c68e-384">The Key Vault provides for such services as key rotation and revocation.</span></span>

<span data-ttu-id="4c68e-385">La parte "trasparente" di TDS deriva dal fatto che non sono necessarie modifiche client per l'utilizzo di un database crittografato.</span><span class="sxs-lookup"><span data-stu-id="4c68e-385">The "Transparent" part of TDS comes from the fact that there aren't client changes needed to use an encrypted database.</span></span> <span data-ttu-id="4c68e-386">Sebbene questo approccio offra una corretta sicurezza, la perdita della password del database è sufficiente per consentire agli utenti di decrittografare i dati.</span><span class="sxs-lookup"><span data-stu-id="4c68e-386">While this approach provides for good security, leaking the database password is enough for users to be able to decrypt the data.</span></span> <span data-ttu-id="4c68e-387">Esiste un altro approccio che crittografa singole colonne o tabelle in un database.</span><span class="sxs-lookup"><span data-stu-id="4c68e-387">There's another approach that encrypts individual columns or tables in a database.</span></span> <span data-ttu-id="4c68e-388">[Always Encrypted](https://docs.microsoft.com/azure/sql-database/sql-database-always-encrypted-azure-key-vault) garantisce che i dati crittografati non vengano visualizzati in testo normale all'interno del database.</span><span class="sxs-lookup"><span data-stu-id="4c68e-388">[Always Encrypted](https://docs.microsoft.com/azure/sql-database/sql-database-always-encrypted-azure-key-vault) ensures that at no point the encrypted data appears in plain text inside the database.</span></span>

<span data-ttu-id="4c68e-389">La configurazione di questo livello di crittografia richiede l'esecuzione di una procedura guidata in SQL Server Management Studio di selezionare il tipo di crittografia e la posizione in Key Vault per archiviare le chiavi associate.</span><span class="sxs-lookup"><span data-stu-id="4c68e-389">Setting up this tier of encryption requires running through a wizard in SQL Server Management Studio to select the sort of encryption and where in Key Vault to store the associated keys.</span></span>

![Figura 9-6 selezione di colonne in una tabella da crittografare con Always Encrypted](./media/always-encrypted.png)

<span data-ttu-id="4c68e-391">**Figura 9-6**.</span><span class="sxs-lookup"><span data-stu-id="4c68e-391">**Figure 9-6**.</span></span> <span data-ttu-id="4c68e-392">Selezione di colonne in una tabella da crittografare con Always Encrypted.</span><span class="sxs-lookup"><span data-stu-id="4c68e-392">Selecting columns in a table to be encrypted using Always Encrypted.</span></span>

<span data-ttu-id="4c68e-393">Le applicazioni client che leggono le informazioni da queste colonne crittografate devono avere un limite speciale per leggere i dati crittografati.</span><span class="sxs-lookup"><span data-stu-id="4c68e-393">Client applications that read information from these encrypted columns need to make special allowances to read encrypted data.</span></span> <span data-ttu-id="4c68e-394">È necessario aggiornare le stringhe di connessione con `Column Encryption Setting=Enabled` e le credenziali client devono essere recuperate dal Key Vault.</span><span class="sxs-lookup"><span data-stu-id="4c68e-394">Connection strings need to be updated with `Column Encryption Setting=Enabled` and client credentials must be retrieved from the Key Vault.</span></span> <span data-ttu-id="4c68e-395">Il client SQL Server deve quindi essere preimpostato con le chiavi di crittografia della colonna.</span><span class="sxs-lookup"><span data-stu-id="4c68e-395">The SQL Server client must then be primed with the column encryption keys.</span></span> <span data-ttu-id="4c68e-396">Al termine, le azioni rimanenti usano le interfacce standard per il client SQL.</span><span class="sxs-lookup"><span data-stu-id="4c68e-396">Once that is done, the remaining actions use the standard interfaces to SQL Client.</span></span> <span data-ttu-id="4c68e-397">Ovvero strumenti come elegante e Entity Framework, basati sul client SQL, continueranno a funzionare senza modifiche.</span><span class="sxs-lookup"><span data-stu-id="4c68e-397">That is, tools like Dapper and Entity Framework, which are built on top of SQL Client, will continue to work without changes.</span></span> <span data-ttu-id="4c68e-398">Always Encrypted potrebbe non essere ancora disponibile per ogni SQL Server driver in ogni lingua.</span><span class="sxs-lookup"><span data-stu-id="4c68e-398">Always Encrypted may not yet be available for every SQL Server driver on every language.</span></span>

<span data-ttu-id="4c68e-399">La combinazione di Transparent Data Encryption e Always Encrypted, entrambi utilizzabili con chiavi specifiche del client, garantisce che siano supportati anche i requisiti di crittografia più precisi.</span><span class="sxs-lookup"><span data-stu-id="4c68e-399">The combination of TDE and Always Encrypted, both of which can be used with client-specific keys, ensures that even the most exacting encryption requirements are supported.</span></span>

### <a name="cosmos-db"></a><span data-ttu-id="4c68e-400">Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="4c68e-400">Cosmos DB</span></span>

<span data-ttu-id="4c68e-401">Cosmos DB è il database più recente fornito da Microsoft in Azure.</span><span class="sxs-lookup"><span data-stu-id="4c68e-401">Cosmos DB is the newest database provided by Microsoft in Azure.</span></span> <span data-ttu-id="4c68e-402">È stato creato da zero con la sicurezza e la crittografia.</span><span class="sxs-lookup"><span data-stu-id="4c68e-402">It has been built from the ground up with security and cryptography in mind.</span></span> <span data-ttu-id="4c68e-403">La crittografia AES-256bit è standard per tutti i database Cosmos DB e non può essere disabilitata.</span><span class="sxs-lookup"><span data-stu-id="4c68e-403">AES-256bit encryption is standard for all Cosmos DB databases and can't be disabled.</span></span> <span data-ttu-id="4c68e-404">In combinazione con il requisito TLS 1,2 per la comunicazione, viene crittografata l'intera soluzione di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="4c68e-404">Coupled with the TLS 1.2 requirement for communication, the entire storage solution is encrypted.</span></span>

![Figura 9-7 flusso di crittografia dei dati in Cosmos DB](./media/cosmos-encryption.png)

<span data-ttu-id="4c68e-406">**Figura 9-7**.</span><span class="sxs-lookup"><span data-stu-id="4c68e-406">**Figure 9-7**.</span></span> <span data-ttu-id="4c68e-407">Il flusso di crittografia dei dati all'interno Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="4c68e-407">The flow of data encryption within Cosmos DB.</span></span>

<span data-ttu-id="4c68e-408">Sebbene Cosmos DB non fornisca le chiavi di crittografia del cliente, il team ha svolto un lavoro significativo per assicurarsi che rimanga compatibile con PCI-DSS senza questo.</span><span class="sxs-lookup"><span data-stu-id="4c68e-408">While Cosmos DB doesn't provide for supplying customer encryption keys, there has been significant work done by the team to ensure it remains PCI-DSS compliant without that.</span></span> <span data-ttu-id="4c68e-409">Cosmos DB non supporta ancora la crittografia di una singola colonna simile al Always Encrypted di Azure SQL.</span><span class="sxs-lookup"><span data-stu-id="4c68e-409">Cosmos DB also doesn't support any sort of single column encryption similar to Azure SQL's Always Encrypted yet.</span></span>

## <a name="keeping-secure"></a><span data-ttu-id="4c68e-410">Mantenimento della sicurezza</span><span class="sxs-lookup"><span data-stu-id="4c68e-410">Keeping secure</span></span>

<span data-ttu-id="4c68e-411">Azure dispone di tutti gli strumenti necessari per rilasciare un prodotto altamente protetto.</span><span class="sxs-lookup"><span data-stu-id="4c68e-411">Azure has all the tools necessary to release a highly secure product.</span></span> <span data-ttu-id="4c68e-412">Tuttavia, una catena è altrettanto complessa del suo collegamento più debole.</span><span class="sxs-lookup"><span data-stu-id="4c68e-412">However, a chain is only as strong as its weakest link.</span></span> <span data-ttu-id="4c68e-413">Se le applicazioni distribuite in Azure non sono sviluppate con un approccio di sicurezza appropriato e controlli di sicurezza efficaci, diventano il collegamento debole nella catena.</span><span class="sxs-lookup"><span data-stu-id="4c68e-413">If the applications deployed on top of Azure aren't developed with a proper security mindset and good security audits, then they become the weak link in the chain.</span></span> <span data-ttu-id="4c68e-414">Sono disponibili molti strumenti di analisi statica, librerie di crittografia e procedure di sicurezza eccezionali che è possibile usare per garantire che il software installato in Azure sia sicuro come Azure.</span><span class="sxs-lookup"><span data-stu-id="4c68e-414">There are many great static analysis tools, encryption libraries, and security practices that can be used to ensure that the software installed on Azure is as secure as Azure itself.</span></span> <span data-ttu-id="4c68e-415">Gli esempi includono [strumenti di analisi statica](https://www.whitesourcesoftware.com/), [librerie di crittografia](https://www.libressl.org/)e procedure di [sicurezza](https://azure.microsoft.com/resources/videos/red-vs-blue-internal-security-penetration-testing-of-microsoft-azure/).</span><span class="sxs-lookup"><span data-stu-id="4c68e-415">Examples include [static analysis tools](https://www.whitesourcesoftware.com/), [encryption libraries](https://www.libressl.org/), and [security practices](https://azure.microsoft.com/resources/videos/red-vs-blue-internal-security-penetration-testing-of-microsoft-azure/).</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="4c68e-416">[Precedente](security.md) 
> [Avanti](devops.md)</span><span class="sxs-lookup"><span data-stu-id="4c68e-416">[Previous](security.md)
[Next](devops.md)</span></span>
