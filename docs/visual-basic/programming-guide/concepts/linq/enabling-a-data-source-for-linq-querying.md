---
title: Abilitazione di un'origine dati per Querying2 LINQ
ms.date: 07/20/2015
ms.assetid: c412f0cf-ff0e-4993-ab3d-1b49e23f00f8
ms.openlocfilehash: 6d2601e807a00ce2a6f8c342a565f5542ffc8f5b
ms.sourcegitcommit: 69229651598b427c550223d3c58aba82e47b3f82
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/04/2018
ms.locfileid: "48582827"
---
# <a name="enabling-a-data-source-for-linq-querying"></a><span data-ttu-id="4fd0e-102">Abilitazione di un'origine dati per l'esecuzione di query LINQ</span><span class="sxs-lookup"><span data-stu-id="4fd0e-102">Enabling a Data Source for LINQ Querying</span></span>

<span data-ttu-id="4fd0e-103">Esistono diversi modi per estendere [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] in modo da consentire l'esecuzione di una query su un'origine dati nel modello [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4fd0e-103">There are various ways to extend [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] to enable any data source to be queried in the [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] pattern.</span></span> <span data-ttu-id="4fd0e-104">L'origine dati potrebbe, ad esempio, essere una struttura ad albero dei dati, un servizio Web, un file system o un database.</span><span class="sxs-lookup"><span data-stu-id="4fd0e-104">The data source might be a data structure, a Web service, a file system, or a database, to name some.</span></span> <span data-ttu-id="4fd0e-105">Il modello [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] consente ai client di eseguire una query su un'origine dati per la quale è attivata l'esecuzione di query[!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)], poiché la sintassi e il modello della query non vengono modificati.</span><span class="sxs-lookup"><span data-stu-id="4fd0e-105">The [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] pattern makes it easy for clients to query a data source for which [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] querying is enabled, because the syntax and pattern of the query does not change.</span></span> <span data-ttu-id="4fd0e-106">Di seguito vengono riportati i modi in cui è possibile estendere [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] a queste origini dati:</span><span class="sxs-lookup"><span data-stu-id="4fd0e-106">The ways in which [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] can be extended to these data sources include the following:</span></span>

-   <span data-ttu-id="4fd0e-107">Implementando l'interfaccia <xref:System.Collections.Generic.IEnumerable%601> in un tipo in modo da consentire l'esecuzione di query [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] to Objects per quel tipo.</span><span class="sxs-lookup"><span data-stu-id="4fd0e-107">Implementing the <xref:System.Collections.Generic.IEnumerable%601> interface in a type to enable [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] to Objects querying of that type.</span></span>

-   <span data-ttu-id="4fd0e-108">Creando metodi degli operatori query standard, ad esempio <xref:System.Linq.Enumerable.Where%2A> e <xref:System.Linq.Enumerable.Select%2A>, che estendono un tipo in modo da consentire l'esecuzione di query [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] personalizzate per quel tipo.</span><span class="sxs-lookup"><span data-stu-id="4fd0e-108">Creating standard query operator methods such as <xref:System.Linq.Enumerable.Where%2A> and <xref:System.Linq.Enumerable.Select%2A> that extend a type, to enable custom [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] querying of that type.</span></span>

-   <span data-ttu-id="4fd0e-109">Creando un provider per l'origine dati che implementi l'interfaccia <xref:System.Linq.IQueryable%601>.</span><span class="sxs-lookup"><span data-stu-id="4fd0e-109">Creating a provider for your data source that implements the <xref:System.Linq.IQueryable%601> interface.</span></span> <span data-ttu-id="4fd0e-110">Un provider che implementa questa interfaccia riceve le query [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] sotto forma di strutture ad albero dell'espressione, che possono essere eseguite in modo personalizzato, ad esempio in modalità remota.</span><span class="sxs-lookup"><span data-stu-id="4fd0e-110">A provider that implements this interface receives [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] queries in the form of expression trees, which it can execute in a custom way, for example remotely.</span></span>

-   <span data-ttu-id="4fd0e-111">Creazione di un provider per l'origine dati in grado di sfruttare una tecnologia [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] esistente.</span><span class="sxs-lookup"><span data-stu-id="4fd0e-111">Creating a provider for your data source that takes advantage of an existing [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] technology.</span></span> <span data-ttu-id="4fd0e-112">Tale provider consentirebbe non solo l'esecuzione di query, ma anche le operazioni di inserimento, aggiornamento ed eliminazione e il mapping per i tipi definiti dall'utente.</span><span class="sxs-lookup"><span data-stu-id="4fd0e-112">Such a provider would enable not only querying, but also insert, update, and delete operations and mapping for user-defined types.</span></span>

<span data-ttu-id="4fd0e-113">In questo argomento vengono descritte queste opzioni.</span><span class="sxs-lookup"><span data-stu-id="4fd0e-113">This topic discusses these options.</span></span>

## <a name="how-to-enable-linq-querying-of-your-data-source"></a><span data-ttu-id="4fd0e-114">Come attivare l'esecuzione di query LINQ sull'origine dati</span><span class="sxs-lookup"><span data-stu-id="4fd0e-114">How to Enable LINQ Querying of Your Data Source</span></span>

### <a name="in-memory-data"></a><span data-ttu-id="4fd0e-115">Dati in memoria</span><span class="sxs-lookup"><span data-stu-id="4fd0e-115">In-Memory Data</span></span>
 <span data-ttu-id="4fd0e-116">Per consentire l'esecuzione di query [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] sui dati in memoria sono disponibili due modi.</span><span class="sxs-lookup"><span data-stu-id="4fd0e-116">There are two ways you can enable [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] querying of in-memory data.</span></span> <span data-ttu-id="4fd0e-117">Se il tipo di dati implementa <xref:System.Collections.Generic.IEnumerable%601>, è possibile eseguire una query sui dati utilizzando [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] to Objects.</span><span class="sxs-lookup"><span data-stu-id="4fd0e-117">If the data is of a type that implements <xref:System.Collections.Generic.IEnumerable%601>, you can query the data by using [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] to Objects.</span></span> <span data-ttu-id="4fd0e-118">Se non ha senso abilitare l'enumerazione del tipo implementando l'interfaccia <xref:System.Collections.Generic.IEnumerable%601>, è possibile definire i metodi degli operatori query standard [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] in quel tipo oppure creare metodi degli operatori query standard [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] che estendono il tipo.</span><span class="sxs-lookup"><span data-stu-id="4fd0e-118">If it does not make sense to enable enumeration of your type by implementing the <xref:System.Collections.Generic.IEnumerable%601> interface, you can define [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] standard query operator methods in that type or create [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] standard query operator methods that extend the type.</span></span> <span data-ttu-id="4fd0e-119">Le implementazioni personalizzate degli operatori di query standard devono utilizzare l'esecuzione posticipata per restituire i risultati.</span><span class="sxs-lookup"><span data-stu-id="4fd0e-119">Custom implementations of the standard query operators should use deferred execution to return the results.</span></span>

### <a name="remote-data"></a><span data-ttu-id="4fd0e-120">Dati remoti</span><span class="sxs-lookup"><span data-stu-id="4fd0e-120">Remote Data</span></span>
 <span data-ttu-id="4fd0e-121">L'opzione migliore per abilitare l'esecuzione di query [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] su un'origine dati remota consiste nell'implementare l'interfaccia <xref:System.Linq.IQueryable%601>.</span><span class="sxs-lookup"><span data-stu-id="4fd0e-121">The best option for enabling [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] querying of a remote data source is to implement the <xref:System.Linq.IQueryable%601> interface.</span></span> <span data-ttu-id="4fd0e-122">È tuttavia diverso dall'estendere un provider come [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)] per un'origine dati.</span><span class="sxs-lookup"><span data-stu-id="4fd0e-122">However, this differs from extending a provider such as [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)] for a data source.</span></span> <span data-ttu-id="4fd0e-123">Nessun modello di provider per l'estensione esistente [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] tecnologie, ad esempio [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)], in altri tipi di origine dati sono disponibili in Visual Studio 2008.</span><span class="sxs-lookup"><span data-stu-id="4fd0e-123">No provider models for extending existing [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] technologies, such as [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)], to other types of data source are available in Visual Studio 2008.</span></span>

## <a name="iqueryable-linq-providers"></a><span data-ttu-id="4fd0e-124">Provider LINQ IQueryable</span><span class="sxs-lookup"><span data-stu-id="4fd0e-124">IQueryable LINQ Providers</span></span>
 <span data-ttu-id="4fd0e-125">I provider [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] che implementano <xref:System.Linq.IQueryable%601> possono variare notevolmente per quanto riguarda la complessità.</span><span class="sxs-lookup"><span data-stu-id="4fd0e-125">[!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] providers that implement <xref:System.Linq.IQueryable%601> can vary widely in their complexity.</span></span> <span data-ttu-id="4fd0e-126">In questa sezione vengono illustrati i diversi livelli di complessità.</span><span class="sxs-lookup"><span data-stu-id="4fd0e-126">This section discusses the different levels of complexity.</span></span>

 <span data-ttu-id="4fd0e-127">Un provider `IQueryable` meno complesso potrebbe interfacciarsi con un singolo metodo di un servizio Web.</span><span class="sxs-lookup"><span data-stu-id="4fd0e-127">A less complex `IQueryable` provider might interface with a single method of a Web service.</span></span> <span data-ttu-id="4fd0e-128">Questo tipo di provider è molto specifico poiché prevede informazioni specifiche nelle query che gestisce.</span><span class="sxs-lookup"><span data-stu-id="4fd0e-128">This type of provider is very specific because it expects specific information in the queries that it handles.</span></span> <span data-ttu-id="4fd0e-129">Ha un sistema del tipo chiuso, forse esponendo un solo tipo di risultato.</span><span class="sxs-lookup"><span data-stu-id="4fd0e-129">It has a closed type system, perhaps exposing a single result type.</span></span> <span data-ttu-id="4fd0e-130">La maggior parte dell'esecuzione della query avviene localmente, utilizzando ad esempio le implementazioni <xref:System.Linq.Enumerable> degli operatori di query standard.</span><span class="sxs-lookup"><span data-stu-id="4fd0e-130">Most of the execution of the query occurs locally, for example by using the <xref:System.Linq.Enumerable> implementations of the standard query operators.</span></span> <span data-ttu-id="4fd0e-131">Un provider meno complesso potrebbe esaminare solo un'espressione della chiamata al metodo nella struttura ad albero dell'espressione che rappresenta la query facendo sì che la logica rimanente della query venga gestita altrove.</span><span class="sxs-lookup"><span data-stu-id="4fd0e-131">A less complex provider might examine only one method call expression in the expression tree that represents the query, and let the remaining logic of the query be handled elsewhere.</span></span>

 <span data-ttu-id="4fd0e-132">Un provider `IQueryable` mediamente complesso potrebbe essere destinato a un'origine dati che ha un linguaggio di query parzialmente espressivo.</span><span class="sxs-lookup"><span data-stu-id="4fd0e-132">An `IQueryable` provider of medium complexity might target a data source that has a partially expressive query language.</span></span> <span data-ttu-id="4fd0e-133">Se è destinato a un servizio Web, potrebbe interagire con più metodi del servizio Web e selezionare il metodo da chiamare in base alla domanda posta dalla query.</span><span class="sxs-lookup"><span data-stu-id="4fd0e-133">If it targets a Web service, it might interface with more than one method of the Web service and select the method to call based on the question that the query poses.</span></span> <span data-ttu-id="4fd0e-134">Un provider mediamente complesso può avere un sistema di tipi più dettagliato rispetto a un provider semplice, ma rimane sempre un sistema di tipi fisso.</span><span class="sxs-lookup"><span data-stu-id="4fd0e-134">A provider of medium complexity would have a richer type system than a simple provider, but it would still be a fixed type system.</span></span> <span data-ttu-id="4fd0e-135">Ad esempio, il provider può esporre tipi che hanno relazioni uno-a-molti che possono essere attraversate, ma non fornisce la tecnologia di mapping per i tipi definiti dall'utente.</span><span class="sxs-lookup"><span data-stu-id="4fd0e-135">For example, the provider might expose types that have one-to-many relationships that can be traversed, but it would not provide mapping technology for user-defined types.</span></span>

 <span data-ttu-id="4fd0e-136">Un provider `IQueryable` complesso, ad esempio il provider [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)], può convertire le query [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] complete in un linguaggio di query espressivo, ad esempio SQL.</span><span class="sxs-lookup"><span data-stu-id="4fd0e-136">A complex `IQueryable` provider, such as the [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)] provider, might translate complete [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] queries to an expressive query language, such as SQL.</span></span> <span data-ttu-id="4fd0e-137">Un provider complesso è più generale di un provider meno complesso, poiché può gestire un'ampia gamma di domande nella query.</span><span class="sxs-lookup"><span data-stu-id="4fd0e-137">A complex provider is more general than a less complex provider, because it can handle a wider variety of questions in the query.</span></span> <span data-ttu-id="4fd0e-138">Ha anche un sistema di tipi aperto e pertanto deve contenere un'infrastruttura completa per eseguire il mapping dei tipi definiti dall'utente.</span><span class="sxs-lookup"><span data-stu-id="4fd0e-138">It also has an open type system and therefore must contain extensive infrastructure to map user-defined types.</span></span> <span data-ttu-id="4fd0e-139">Lo sviluppo di un provider complesso è molto impegnativo.</span><span class="sxs-lookup"><span data-stu-id="4fd0e-139">Developing a complex provider requires a significant amount of effort.</span></span>

## <a name="see-also"></a><span data-ttu-id="4fd0e-140">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="4fd0e-140">See Also</span></span>

- <xref:System.Linq.IQueryable%601>
- <xref:System.Collections.Generic.IEnumerable%601>
- <xref:System.Linq.Enumerable>
- [<span data-ttu-id="4fd0e-141">Panoramica degli operatori query standard (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="4fd0e-141">Standard Query Operators Overview (Visual Basic)</span></span>](../../../../visual-basic/programming-guide/concepts/linq/standard-query-operators-overview.md)
- [<span data-ttu-id="4fd0e-142">LINQ to Objects (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="4fd0e-142">LINQ to Objects (Visual Basic)</span></span>](../../../../visual-basic/programming-guide/concepts/linq/linq-to-objects.md)